#=============================
# Start of preamble
#=============================

# System properties

SHELL           =       /bin/sh

# Macros, these should be generic for all machines

LN      = ln -sf
MAKE    = make -i -r
RM      = /bin/rm -f
MV      = /bin/mv -f
CP      = /bin/cp -f
AR      = ar ru
M4      = m4
RANLIB	= ranlib
CPP     = /lib/cpp

.SUFFIXES: .f90 .F90 .F .i .o .f .c

# Substituted by Config_new.pl

DEVTOP      = CONFIGURE_DEVTOP
PERL        = CONFIGURE_PERL_PATH
REGISTRY    = CONFIGURE_REGISTRY
NETCDF_PATH = CONFIGURE_NETCDF_PATH
NETCDF_LIB  = CONFIGURE_NETCDF_LIB
PHDF5_PATH  = CONFIGURE_PHDF5_PATH
RTTOV_PATH  = CONFIGURE_RTTOV_PATH
RTTOV_LIB   = CONFIGURE_RTTOV_LIB
ENVCOMPDEFS = CONFIGURE_COMPILEFLAGS
DA_CORE     = CONFIGURE_DA_CORE
EM_CORE     = CONFIGURE_EM_CORE
NMM_CORE    = CONFIGURE_NMM_CORE
COAMPS_CORE = CONFIGURE_COAMPS_CORE
EXP_CORE    = CONFIGURE_EXP_CORE
FPPFLAGS1   = CONFIGURE_NETCDF_FLAG CONFIGURE_RTTOV_FLAG $(WORDSIZE_DEF) \
              -DLIMIT_ARGS -DWRFPLUS_TESTING -DPROMOTE_FLOAT
WRFIO       = CONFIGURE_WRFIO_NF wrfio_int wrfio_grib1
INCS        = -I. -I./inc CONFIGURE_RTTOV_INC -I$(MPICH)/include
INC         = $(DEVTOP)/inc

# switch to use separately installed ESMF library for coupling:  1==true
ESMF_COUPLING       = CONFIGURE_ESMF_COUPLING
ESMF_MOD_DEPENDENCE = CONFIGURE_ESMF_MOD_DEPENDENCE
ESMF_MOD_INC        = CONFIGURE_ESMF_MOD_INC
ESMF_IO_INC         = CONFIGURE_ESMF_IO_INC
ESMF_IO_DEFS        = CONFIGURE_ESMF_IO_DEFS
ESMF_TARGET         = CONFIGURE_ESMF_TARGET

# Short cuts to directories

ARCH      = $(DEVTOP)/arch
CHEM      = $(DEVTOP)/chem
CONVERTOR = $(DEVTOP)/convertor
DA        = $(DEVTOP)/da
DYN_EM    = $(DEVTOP)/dyn_em
DYN_EXP   = $(DEVTOP)/dyn_exp
DYN_NMM   = $(DEVTOP)/dyn_nmm
EXTERNAL  = $(DEVTOP)/external
FRAME     = $(DEVTOP)/frame
GEN_BE    = $(DEVTOP)/gen_be
INC       = $(DEVTOP)/inc
MAIN      = $(DEVTOP)/main
PHYS      = $(DEVTOP)/phys
RUN       = $(DEVTOP)/run
SCRIPTS   = $(DEVTOP)/scripts
SHARE     = $(DEVTOP)/share
TEST      = $(DEVTOP)/test
TOOLS     = $(DEVTOP)/tools

LAPACK        = $(EXTERNAL)/lapack
FFTPACK5      = $(EXTERNAL)/fftpack5
BLAS          = $(EXTERNAL)/blas
BUFR_NCEP_NCO = $(EXTERNAL)/bufr_ncep_nco
IO_GRIB1      = $(EXTERNAL)/io_grib1
IO_INT        = $(EXTERNAL)/io_int
ESMF_TIME_F90 = $(EXTERNAL)/esmf_time_f90
IO_NETCDF     = $(EXTERNAL)/io_netcdf
IOAPI_SHARE   = $(EXTERNAL)/ioapi_share

PHDF5_LIB     = -L$(EXTERNAL)/io_phdf5 -lwrfio_phdf5 -L$(PHDF5_PATH)/lib \
  -lhdf5_fortran -lhdf5 -lm -lz -L$(PHDF5PATH)/lib -lsz
LAPACK_LIB    = -llapack
BLAS_LIB      = -lblas
BUFR_LIB      = -lbufr
FFTPACK5_LIB  = -lfftpack5

#### Get core settings from environment (set in compile script)
#### Note to add a core, this has to be added to.

VAR4DPOSS=-DVAR4DPOSS

COREDEFS = -DEM_CORE=$(EM_CORE)         \
           -DDA_CORE=$(DA_CORE)         \
           -DNMM_CORE=$(NMM_CORE)       \
           -DCOAMPS_CORE=$(COAMPS_CORE) \
           -DEXP_CORE=$(EXP_CORE)       \
           -DNMM_MAX_DIM=1250

SOLVER=em

#### For wrfvar, always use RWORDSIZE 8

RWORDSIZE	=	8

DWORDSIZE	=	8
WORDSIZE_DEF	=	-DIWORDSIZE=4 -DDWORDSIZE=$(DWORDSIZE) -DRWORDSIZE=$(RWORDSIZE) -DLWORDSIZE=4

#### Single location for defining total number of domains.  You need
#### at least 1 + 2*(number of total nests).  For example, 1 coarse
#### grid + three fine grids = 1 + 2(3) = 7, so MAX_DOMAINS=7.

MAX_DOMAINS	=	1
MAX_PROC	=	1024

#### DM buffer length for the configuration flags.

CONFIG_BUF_LEN	=	8192

# defaults for occasional architecture specific settings

RSL             = $(EXTERNAL)/RSL_stubs
SED_FTN         = sed -f standard.sed
FCHOST          =
OMP             =
OMPCPP          =
MPI_LIB		=
DM_CPP_FLAGS	=
#### Architecture specific settings ####

