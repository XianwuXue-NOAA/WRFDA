<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/temp2.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" -->
<title>WRFDA Practice</title>
<!-- InstanceEndEditable -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<SCRIPT language=JavaScript src="../assets/menu_array_class.js" type=text/javascript></SCRIPT>
<SCRIPT language=JavaScript src="../assets/mmenu.js" type=text/javascript></SCRIPT>
<!-- InstanceBeginEditable name="head" -->
<!-- InstanceEndEditable -->
<link href="../assets/wrfdastyle.css" rel="stylesheet" type="text/css">
<style type="text/css">
<!--
a:link {
	text-decoration: none;
}
a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: underline;
}
a:active {
	text-decoration: none;
}
-->
</style></head>

<body id="top" bgcolor="#FFFFFF">
<table width="100%" border="2" cellpadding="0" cellspacing="0" bgcolor="cbffcd">
  <tr> 
    <td width="1485" colspan="3" bgcolor="#EEFFDD"><div align="center">
      <a href="../index.html"><img src="../images/header.png" alt="page header" height="125" border="0" align="left"></a>
    </div></td>
  </tr>
  <tr bgcolor="cbffcd" class="body"> 
    <td height="33" colspan="4" bgcolor="#99BB66">&nbsp;</td>
  </tr>
  <tr> 
    <td colspan="4" bgcolor="#EEFFDD"> <table width="90%" border="0" align="center" cellpadding="20" cellspacing="20">
        <tr> 
          <td valign="middle" bgcolor="#FFFFFF"><!-- InstanceBeginEditable name="maincontent" -->
            <span class="pagetitle">WRFDA Tools: Observation-based verification</span>
            <blockquote>
              <p>This exercise will teach you how to run WRFDA verification tools for observation-based verification.</p>
              <p><span class="body">Reference: <a href="../docs/WRFDA_Verification_Tools.pdf">Download the tutorial presentation</a></span></p>
            </blockquote>
            <span class="bodyh1">Source code</span>
            <blockquote>
              <p>Get the <a href="wrfda_code.html">pre-compiled code</a>, if you have not done so. </p>
              <p><span class="stylecode">WRFDA/var/build/da_verif_obs.exe</span> is the executable that will be used in this session. It will be called directly by scripts, so there is no need to have it in your working directory.</p>
            </blockquote>
            <p><span class="bodyh1">Choose your working directory</span> </p>
            <blockquote>
              <p>For this exercise you should create<span class="stylecode"> /kumquat/users/${USER}/DA/verif_obs</span> and use this as your working directory.</p>
              <blockquote>
                <p class="stylecode">mkdir /kumquat/users/${USER}/DA/verif_obs<br>
                                     cd /kumquat/users/${USER}/DA/verif_obs</p>
              </blockquote>
              <p>You will need two scripts from the WRFDA TOOLS package: da_run_suite_verif_obs.ksh and da_verif_obs_plot.ksh. Copy them into your working directory.</p>
              <blockquote>
                <p class="stylecode">cp /kumquat/wrfhelp/DATA/WRFDA/TOOLS/scripts/da_run_suite_verif_obs.ksh .<br>
                                     cp /kumquat/wrfhelp/DATA/WRFDA/TOOLS/scripts/da_verif_obs_plot.ksh .</p>
              </blockquote>
              <p>The easiest way to control these scripts is by creating a "wrapper" script that sets the appropriate environment variables, then calls the scripts in order. Open a new file "verif_obs_wrapper.ksh" in vi (or your preferred text editor), and type the following:</p>
              <blockquote>
                <p class="stylecode">&gt; vi verif_obs_wrapper.ksh<br>
                  #!/bin/ksh -aeux<br>
                  <br>
                  # Wrapper script for running WRFDA obs verification package<br>
                  <br>
                  # Settings for ./da_run_suite_verif_obs.ksh<br>
                  <br>
                  export CLEAN=false<br>
                  export INITIAL_DATE=2013122312<br>
                  export FINAL_DATE=2013122512<br>
                  export WRFVAR_DIR=/kumquat/users/${USER}/DA/WRFDA<br>
                  export SCRIPTS_DIR=/kumquat/wrfhelp/DATA/WRFDA/TOOLS/scripts<br>
                  export EXP_DIR=`pwd`/verify06<br>
                  export OB_DIR=/kumquat/wrfhelp/DATA/WRFDA/arctic_tutorial_case/ob/<br>
                  export FILTERED_OBS_DIR=/kumquat/wrfhelp/DATA/WRFDA/arctic_tutorial_case/filt_ob/<br>
                  export BE_DIR=/kumquat/wrfhelp/DATA/WRFDA/arctic_tutorial_case/be/<br>
                  export FC_DIR=/kumquat/wrfhelp/DATA/WRFDA/cycling/run<br>
                  export WINDOW_START=-3<br>
                  export WINDOW_END=3<br>
                  export CYCLE_PERIOD=6<br>
                  export NUM_PROCS=4<br>
                  export VERIFY_HOUR=6<br>
                  export RUN_CMD="mpirun -np $NUM_PROCS"<br>
                  export VERIFICATION_FILE_STRING=wrfout<br>
                  # Here is where you set the appropriate namelist variables that the script will use to run WRFDA<br>
                  export NL_ANALYSIS_TYPE=verify<br>
                  export NL_E_WE=181<br>
                  export NL_E_SN=181<br>
                  export NL_E_VERT=41<br>
                  export NL_DX=60000<br>
                  export NL_DY=60000<br>
                  export NL_SF_SURFACE_PHYSICS=2<br>
                  <br>
                  ./da_run_suite_verif_obs.ksh<br>
                  # Settings for da_verif_obs_plot.ksh<br>
                  <br>
                  export START_DATE=2013122312<br>
                  export END_DATE=2013122512<br>
                  export RUN_DIR=$EXP_DIR/plots<br>
                  export NUM_EXPT=1<br>
                  export REG_DIR=$EXP_DIR<br>
                  export EXP_NAMES='verify06'<br>
                  export EXP_LEGENDS='(/"verify06"/)'<br>
                  export EXP_DIRS="$EXP_DIR"<br>
                  export INTERVAL=6<br>
                  export NUM_PROCS=4<br>
                  export VERIFY_HOUR=00<br>
                  export GRAPHICS_DIR=/kumquat/wrfhelp/DATA/WRFDA/TOOLS/graphics/ncl<br>
                  export WRF_FILE="/kumquat/wrfhelp/DATA/WRFDA/cycling/run/2013122300/wrfout_d01_2013-12-23_00:00:00"<br>
                  export Verify_Date_Range="12z 23 Dec - 12z 25 Dec, 2015 (${INTERVAL} hour Cycle)"<br>
                  export OBS_TYPES=synop sound airep geoamv gpspw<br>
                  export NUM_OBS_TYPES=5<br>
                  export PLOT_WKS=pdf #"pdf" will save plots in pdf format; "x11" will display the plots and not save them<br>
                  <br>
                  ./da_verif_obs_plot.ksh</p>

                </blockquote>
                <p>Now make the script you just made executable using "chmod", then run it.</p>
                <blockquote>
                  <p class="stylecode">&gt; chmod +x verif_obs_wrapper.ksh</p>
                  <p class="stylecode">./verif_obs_wrapper.ksh</p>
                </blockquote>
              </blockquote>
            </blockquote>
            <span class="pagetitle">WRFDA Tools: Analysis-based verification</span>
            <blockquote>
              <p>This exercise will teach you how to run WRFDA verification tools for observation-based verification.</p>
              <p><span class="stylecode">WRFDA/var/build/da_verif_grid.exe</span> is the executable that will be used in this session. It will be called directly by scripts, so there is no need to have it in your working directory.</p>
              </blockquote>
              <p><span class="bodyh1">Choose your working directory</span> </p>
              <blockquote>
                <p>For this exercise you should create<span class="stylecode"> /kumquat/users/${USER}/DA/verif_obs</span> and use this as your working directory.</p>
                <blockquote>
                <p class="stylecode">mkdir /kumquat/users/${USER}/DA/verif_grid<br>
                                     cd /kumquat/users/${USER}/DA/verif_grid</p>
                </blockquote>
                <p>You will need a script from the WRFDA TOOLS package: da_verif_grid.ksh. Copy it into your working directory.</p>
                <blockquote>
                <p class="stylecode">cp /kumquat/wrfhelp/DATA/WRFDA/TOOLS/scripts/da_verif_grid.ksh .</p>
                </blockquote>
                <p>The easiest way to control this script is by creating a "wrapper" script that sets the appropriate environment variables, then calls the script. Open a new file "verif_grid_wrapper.ksh" in vi (or your preferred text editor), and type the following:</p>
                <blockquote>
                <p class="stylecode">&gt; vi verif_grid_wrapper.ksh<br>
                  #!/bin/ksh -aeux<br>
                  <br>
                  # Wrapper script for running WRFDA grid verification package<br>
                  <br>
                  export WRFVAR_DIR=/kumquat/users/${USER}/DA/WRFDA<br>
                  export SCRIPTS_DIR=/kumquat/wrfhelp/DATA/WRFDA/TOOLS/scripts<br>
                  export GRAPHICS_DIR=/kumquat/wrfhelp/DATA/WRFDA/TOOLS/graphics/ncl<br>
                  export NUM_EXPT=3<br>
                  export CONTROL_EXP_DIR=/kumquat/wrfhelp/DATA/WRFDA/verification/no_da<br>
                  export EXP_DIRS='/kumquat/wrfhelp/DATA/WRFDA/verification/conv_only /kumquat/wrfhelp/DATA/WRFDA/verification/rad_only /kumquat/wrfhelp/DATA/WRFDA/verification/all_obs'<br>
                  export EXP_NAMES='CONV_ONLY RAD_ONLY ALL_OBS'<br>
                  export VERIFICATION_FILE_STRING='wrfout'<br>
                  export EXP_LEGENDS='(/"Conv only","Rad only","All ob types"/)'<br>
                  export START_DATE=2013122312<br>
                  export END_DATE=2013122512<br>
                  export INTERVAL=06<br>
                  export VERIFY_HOUR=06<br>
                  <br>
                  ./da_verif_grid.ksh</p>
              </blockquote>
              <p>Now make the script you just made executable using "chmod", then run it.</p>
              <blockquote>
                <p class="stylecode">&gt; chmod +x verif_grid_wrapper.ksh</p>
                <p class="stylecode">./verif_grid_wrapper.ksh</p>
              </blockquote>
            </blockquote>
            <p>&nbsp;</p>
            <!-- InstanceEndEditable --><br>
            
          </td>
        </tr>
        <tr><td><a href="#top">back to top</a></td></tr>
    </table></td>
  </tr>
  <tr> 
    <td colspan="4" bgcolor="#99b86e">&nbsp;</td>
  </tr>
</table>

<map name="Map">
  <area shape="rect" coords="-189,-6,548,73" href="../../../index.html" alt="practice_page_header">
</map>
</body>
<!-- InstanceEnd --></html>
