<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!WRF:MODEL_LAYER:BOUNDARY<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<A NAME='MODULE_BC_EM'><A href='../../html_code/dyn_em/module_bc_em.F.html#MODULE_BC_EM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='4'>
<font color=#993300>MODULE </font><font color=#cc0000>module_bc_em</font> <A href='../../call_to/MODULE_BC_EM.html' TARGET='index'>8</A><a name='5'>
<a name='6'>
   USE <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_bc_em.F.html#module_bc_em.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_6"><a name='7'>
   USE <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_bc_em.F.html#module_bc_em.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_4"><a name='8'>
   USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/dyn_em/module_bc_em.F.html#module_bc_em.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_5"><a name='9'>
<a name='10'>
CONTAINS<a name='11'>
<a name='12'>
<font color=#447700>!------------------------------------------------------------------------<a name='13'></font>
<a name='14'>
<A NAME='SPEC_BDYUPDATE_PH'><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDYUPDATE_PH' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='15'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>spec_bdyupdate_ph</font>( ph_save, field,      &amp; <A href='../../call_to/SPEC_BDYUPDATE_PH.html' TARGET='index'>12</A><a name='16'>
                               field_tend, mu_tend, muts, dt,     &amp;<a name='17'>
                               variable_in, config_flags, &amp; <a name='18'>
                               spec_zone,                  &amp;<a name='19'>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='20'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='21'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='22'></font>
                               its,ite, jts,jte, kts,kte )<a name='23'>
<a name='24'>
<font color=#447700>!  This subroutine adds the tendencies in the boundary specified region.<a name='25'></font>
<font color=#447700>!  spec_zone is the width of the outer specified b.c.s that are set here.<a name='26'></font>
<font color=#447700>!  (JD August 2000)<a name='27'></font>
<a name='28'>
      IMPLICIT NONE<a name='29'>
<a name='30'>
      INTEGER,      INTENT(IN   )    :: ids,ide, jds,jde, kds,kde<a name='31'>
      INTEGER,      INTENT(IN   )    :: ims,ime, jms,jme, kms,kme<a name='32'>
      INTEGER,      INTENT(IN   )    :: ips,ipe, jps,jpe, kps,kpe<a name='33'>
      INTEGER,      INTENT(IN   )    :: its,ite, jts,jte, kts,kte<a name='34'>
      INTEGER,      INTENT(IN   )    :: spec_zone<a name='35'>
      CHARACTER,    INTENT(IN   )    :: variable_in<a name='36'>
      REAL,         INTENT(IN   )    :: dt<a name='37'>
<a name='38'>
<a name='39'>
      REAL,  DIMENSION( ims:ime , kms:kme , jms:jme ), INTENT(INOUT) :: field<a name='40'>
      REAL,  DIMENSION( ims:ime , kms:kme , jms:jme ), INTENT(IN   ) :: field_tend, ph_save<a name='41'>
      REAL,  DIMENSION( ims:ime , jms:jme ), INTENT(IN   ) :: mu_tend, muts<a name='42'>
      TYPE( grid_config_rec_type ) config_flags<a name='43'>
<a name='44'>
      CHARACTER  :: variable<a name='45'>
      INTEGER    :: i, j, k, ibs, ibe, jbs, jbe, itf, jtf, ktf<a name='46'>
      INTEGER    :: b_dist<a name='47'>
<a name='48'>
<font color=#447700>!     Local array<a name='49'></font>
<a name='50'>
      REAL,  DIMENSION( its:ite , jts:jte ) :: mu_old<a name='51'>
<a name='52'>
      variable = variable_in<a name='53'>
<a name='54'>
      IF (variable == 'U') variable = 'u'<a name='55'>
      IF (variable == 'V') variable = 'v'<a name='56'>
      IF (variable == 'M') variable = 'm'<a name='57'>
      IF (variable == 'H') variable = 'h'<a name='58'>
<a name='59'>
      ibs = ids<a name='60'>
      ibe = ide-1<a name='61'>
      itf = min(ite,ide-1)<a name='62'>
      jbs = jds<a name='63'>
      jbe = jde-1<a name='64'>
      jtf = min(jte,jde-1)<a name='65'>
      ktf = kde-1<a name='66'>
      IF (variable == 'u') ibe = ide<a name='67'>
      IF (variable == 'u') itf = min(ite,ide)<a name='68'>
      IF (variable == 'v') jbe = jde<a name='69'>
      IF (variable == 'v') jtf = min(jte,jde)<a name='70'>
      IF (variable == 'm') ktf = kte<a name='71'>
      IF (variable == 'h') ktf = kte<a name='72'>
<a name='73'>
      IF (jts - jbs .lt. spec_zone) THEN<a name='74'>
<font color=#447700>! Y-start boundary<a name='75'></font>
        DO j = jts, min(jtf,jbs+spec_zone-1)<a name='76'>
          b_dist = j - jbs<a name='77'>
          DO k = kts, ktf<a name='78'>
            DO i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='79'>
<a name='80'>
              mu_old(i,j) = muts(i,j) - dt*mu_tend(i,j)<a name='81'>
<a name='82'>
              field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j) + &amp;<a name='83'>
                   dt*field_tend(i,k,j)/muts(i,j) +               &amp;<a name='84'>
                   ph_save(i,k,j)*(mu_old(i,j)/muts(i,j) - 1.)<a name='85'>
<a name='86'>
            ENDDO<a name='87'>
          ENDDO<a name='88'>
        ENDDO<a name='89'>
      ENDIF <a name='90'>
      IF (jbe - jtf .lt. spec_zone) THEN <a name='91'>
<font color=#447700>! Y-end boundary <a name='92'></font>
        DO j = max(jts,jbe-spec_zone+1), jtf <a name='93'>
          b_dist = jbe - j <a name='94'>
          DO k = kts, ktf <a name='95'>
            DO i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='96'>
<a name='97'>
              mu_old(i,j) = muts(i,j) - dt*mu_tend(i,j)<a name='98'>
<a name='99'>
              field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j) + &amp;<a name='100'>
                   dt*field_tend(i,k,j)/muts(i,j) +               &amp;<a name='101'>
                   ph_save(i,k,j)*(mu_old(i,j)/muts(i,j) - 1.)<a name='102'>
<a name='103'>
            ENDDO<a name='104'>
          ENDDO<a name='105'>
        ENDDO<a name='106'>
      ENDIF <a name='107'>
<a name='108'>
      IF (its - ibs .lt. spec_zone) THEN<a name='109'>
<font color=#447700>! X-start boundary<a name='110'></font>
        DO i = its, min(itf,ibs+spec_zone-1)<a name='111'>
          b_dist = i - ibs<a name='112'>
          DO k = kts, ktf<a name='113'>
            DO j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='114'>
<a name='115'>
              mu_old(i,j) = muts(i,j) - dt*mu_tend(i,j)<a name='116'>
<a name='117'>
              field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j) + &amp;<a name='118'>
                   dt*field_tend(i,k,j)/muts(i,j) +               &amp;<a name='119'>
                   ph_save(i,k,j)*(mu_old(i,j)/muts(i,j) - 1.)<a name='120'>
<a name='121'>
            ENDDO<a name='122'>
          ENDDO<a name='123'>
        ENDDO<a name='124'>
      ENDIF <a name='125'>
<a name='126'>
      IF (ibe - itf .lt. spec_zone) THEN<a name='127'>
<font color=#447700>! X-end boundary<a name='128'></font>
        DO i = max(its,ibe-spec_zone+1), itf<a name='129'>
          b_dist = ibe - i<a name='130'>
          DO k = kts, ktf<a name='131'>
            DO j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='132'>
<a name='133'>
              mu_old(i,j) = muts(i,j) - dt*mu_tend(i,j)<a name='134'>
<a name='135'>
              field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j) + &amp;<a name='136'>
                   dt*field_tend(i,k,j)/muts(i,j) +               &amp;<a name='137'>
                   ph_save(i,k,j)*(mu_old(i,j)/muts(i,j) - 1.)<a name='138'>
<a name='139'>
            ENDDO<a name='140'>
          ENDDO<a name='141'>
        ENDDO<a name='142'>
      ENDIF <a name='143'>
<a name='144'>
   END SUBROUTINE spec_bdyupdate_ph<a name='145'>
<a name='146'>
<font color=#447700>!------------------------------------------------------------------------<a name='147'></font>
<a name='148'>
<A NAME='RELAX_BDY_DRY'><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='149'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>relax_bdy_dry</font> ( config_flags,                                    &amp; <A href='../../call_to/RELAX_BDY_DRY.html' TARGET='index'>12</A>,<A href='../../call_from/RELAX_BDY_DRY.html' TARGET='index'>6</A><a name='150'>
                              ru_tendf, rv_tendf, ph_tendf, t_tendf,           &amp;<a name='151'>
                              rw_tendf, mu_tend,                               &amp;<a name='152'>
                              ru, rv, ph, t,                                   &amp;<a name='153'>
                              w, mu, mut,                                      &amp;<a name='154'>
                              u_b, v_b, ph_b, t_b,                             &amp;<a name='155'>
                              w_b, mu_b,                                       &amp;<a name='156'>
                              u_bt, v_bt, ph_bt, t_bt,                         &amp;<a name='157'>
                              w_bt, mu_bt,                                     &amp;<a name='158'>
                              spec_bdy_width, spec_zone, relax_zone,           &amp;<a name='159'>
                              dtbc, fcx, gcx,             &amp;<a name='160'>
                              ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='161'></font>
                              ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='162'></font>
                              ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='163'></font>
                              ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='164'></font>
                              its, ite, jts, jte, kts, kte)<a name='165'>
   IMPLICIT NONE<a name='166'>
<a name='167'>
   <font color=#447700>!  Input data.<a name='168'></font>
   TYPE( grid_config_rec_type ) config_flags<a name='169'>
<a name='170'>
   INTEGER ,               INTENT(IN   ) :: ids, ide, jds, jde, kds, kde, &amp;<a name='171'>
                                            ims, ime, jms, jme, kms, kme, &amp;<a name='172'>
                                            ips, ipe, jps, jpe, kps, kpe, &amp; <a name='173'>
                                            its, ite, jts, jte, kts, kte<a name='174'>
   INTEGER ,               INTENT(IN   ) :: ijds, ijde<a name='175'>
   INTEGER ,               INTENT(IN   ) :: spec_bdy_width, spec_zone, relax_zone<a name='176'>
<a name='177'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) , INTENT(IN   ) :: ru,     &amp;<a name='178'>
                                                                      rv,     &amp;<a name='179'>
                                                                      ph,     &amp;<a name='180'>
                                                                      w,      &amp;<a name='181'>
                                                                      t<a name='182'>
   REAL , DIMENSION( ims:ime , jms:jme  ) , INTENT(IN   )          :: mu  , &amp;<a name='183'>
                                                                      mut<a name='184'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) , INTENT(INOUT) :: ru_tendf, &amp;<a name='185'>
                                                                      rv_tendf, &amp;<a name='186'>
                                                                      ph_tendf, &amp;<a name='187'>
                                                                      rw_tendf, &amp;<a name='188'>
                                                                      t_tendf<a name='189'>
   REAL , DIMENSION( ims:ime , jms:jme  ) , INTENT(INOUT)          :: mu_tend<a name='190'>
   REAL , DIMENSION( spec_bdy_width) , INTENT(IN   ) :: fcx, gcx<a name='191'>
<a name='192'>
   REAL,  DIMENSION( ijds:ijde , kds:kde , spec_bdy_width, 4 ), INTENT(IN   ) :: u_b, &amp;<a name='193'>
                                                                                 v_b, &amp;<a name='194'>
                                                                                 ph_b, &amp;<a name='195'>
                                                                                  w_b, &amp;<a name='196'>
                                                                                 t_b, &amp;<a name='197'>
                                                                                 u_bt, &amp;<a name='198'>
                                                                                 v_bt, &amp;<a name='199'>
                                                                                 ph_bt, &amp;<a name='200'>
                                                                                  w_bt, &amp;<a name='201'>
                                                                                 t_bt<a name='202'>
<a name='203'>
   REAL,  DIMENSION( ijds:ijde , 1:1     , spec_bdy_width, 4 ), INTENT(IN   ) :: mu_b, &amp;<a name='204'>
                                                                                 mu_bt<a name='205'>
   REAL, INTENT(IN   ) :: dtbc<a name='206'>
<a name='207'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) :: rfield<a name='208'>
   INTEGER :: i_start, i_end, j_start, j_end, i, j, k<a name='209'>
<a name='210'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_1"> ( ru, ru_tendf,             &amp;<a name='211'>
                               u_b, u_bt,       &amp;<a name='212'>
                               'u'        , config_flags, &amp;<a name='213'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='214'>
                               dtbc, fcx, gcx,             &amp;<a name='215'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='216'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='217'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='218'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='219'></font>
                               its,ite, jts,jte, kts,kte )<a name='220'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_2"> ( rv, rv_tendf,             &amp;<a name='221'>
                               v_b, v_bt,       &amp;<a name='222'>
                               'v'        , config_flags, &amp;<a name='223'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='224'>
                               dtbc, fcx, gcx,             &amp;<a name='225'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='226'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='227'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='228'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='229'></font>
                               its,ite, jts,jte, kts,kte )<a name='230'>
<a name='231'>
<font color=#447700>! rfield will be calculated beyond tile limits because relax_bdytend<a name='232'></font>
<font color=#447700>!   requires a 5-point stencil, and this avoids need for inter-tile/patch <a name='233'></font>
<font color=#447700>!   communication here<a name='234'></font>
           i_start = max(its-1, ids)<a name='235'>
           i_end = min(ite+1, ide-1)<a name='236'>
           j_start = max(jts-1, jds)<a name='237'>
           j_end = min(jte+1, jde-1)<a name='238'>
<a name='239'>
           DO j=j_start,j_end<a name='240'>
           DO k=kts,kte<a name='241'>
           DO i=i_start,i_end<a name='242'>
              rfield(i,k,j) = ph(i,k,j)*mut(i,j)<a name='243'>
           ENDDO<a name='244'>
           ENDDO<a name='245'>
           ENDDO<a name='246'>
           <a name='247'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_3"> ( rfield, ph_tendf,             &amp;<a name='248'>
                               ph_b, ph_bt,       &amp;<a name='249'>
                               'h'        , config_flags, &amp;<a name='250'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='251'>
                               dtbc, fcx, gcx,             &amp;<a name='252'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='253'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='254'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='255'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='256'></font>
                               its,ite, jts,jte, kts,kte )<a name='257'>
           DO j=j_start,j_end<a name='258'>
           DO k=kts,kte-1<a name='259'>
           DO i=i_start,i_end<a name='260'>
              rfield(i,k,j) = t(i,k,j)*mut(i,j)<a name='261'>
           ENDDO<a name='262'>
           ENDDO<a name='263'>
           ENDDO<a name='264'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_4"> ( rfield, t_tendf,              &amp;<a name='265'>
                               t_b, t_bt,       &amp;<a name='266'>
                               't'        , config_flags, &amp;<a name='267'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='268'>
                               dtbc, fcx, gcx,             &amp;<a name='269'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='270'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='271'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='272'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='273'></font>
                               its,ite, jts,jte, kts,kte )<a name='274'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_5"> ( mu, mu_tend,               &amp;<a name='275'>
                               mu_b, mu_bt,                &amp;<a name='276'>
                               'm'        , config_flags,  &amp;<a name='277'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='278'>
                               dtbc, fcx, gcx,             &amp;<a name='279'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='280'></font>
                               ids,ide, jds,jde, 1  ,1  ,  &amp; <font color=#447700>! domain dims<a name='281'></font>
                               ims,ime, jms,jme, 1  ,1  ,  &amp; <font color=#447700>! memory dims<a name='282'></font>
                               ips,ipe, jps,jpe, 1  ,1  ,  &amp; <font color=#447700>! patch  dims<a name='283'></font>
                               its,ite, jts,jte, 1  ,1   )<a name='284'>
<a name='285'>
         IF( config_flags%nested) THEN<a name='286'>
<a name='287'>
           i_start = max(its-1, ids)<a name='288'>
           i_end = min(ite+1, ide-1)<a name='289'>
           j_start = max(jts-1, jds)<a name='290'>
           j_end = min(jte+1, jde-1)<a name='291'>
<a name='292'>
           DO j=j_start,j_end<a name='293'>
           DO k=kts,kte<a name='294'>
           DO i=i_start,i_end<a name='295'>
              rfield(i,k,j) = w(i,k,j)*mut(i,j)<a name='296'>
           ENDDO<a name='297'>
           ENDDO<a name='298'>
           ENDDO<a name='299'>
           <a name='300'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_6"> ( rfield, rw_tendf,             &amp;<a name='301'>
                               w_b, w_bt,       &amp;<a name='302'>
                               'h'        , config_flags, &amp;<a name='303'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='304'>
                               dtbc, fcx, gcx,             &amp;<a name='305'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='306'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='307'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='308'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='309'></font>
                               its,ite, jts,jte, kts,kte )<a name='310'>
<a name='311'>
        END IF<a name='312'>
<a name='313'>
   END SUBROUTINE relax_bdy_dry <a name='314'>
<font color=#447700>!------------------------------------------------------------------------<a name='315'></font>
<A NAME='RELAX_BDY_SCALAR'><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_SCALAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='316'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>relax_bdy_scalar</font> ( scalar_tend,                &amp; <A href='../../call_to/RELAX_BDY_SCALAR.html' TARGET='index'>18</A>,<A href='../../call_from/RELAX_BDY_SCALAR.html' TARGET='index'>1</A><a name='317'>
                                 scalar, mu,                 &amp;<a name='318'>
                                 scalar_b, scalar_bt,        &amp;<a name='319'>
                                 spec_bdy_width, spec_zone, relax_zone,       &amp;<a name='320'>
                                 dtbc, fcx, gcx,             &amp;<a name='321'>
                                 ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='322'></font>
                                 ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='323'></font>
                                 ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='324'></font>
                                 ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='325'></font>
                                 its, ite, jts, jte, kts, kte)<a name='326'>
   IMPLICIT NONE<a name='327'>
<a name='328'>
   <font color=#447700>!  Input data.<a name='329'></font>
   TYPE( grid_config_rec_type ) config_flags<a name='330'>
<a name='331'>
   INTEGER ,               INTENT(IN   ) :: ids, ide, jds, jde, kds, kde, &amp;<a name='332'>
                                            ims, ime, jms, jme, kms, kme, &amp;<a name='333'>
                                            ips, ipe, jps, jpe, kps, kpe, &amp; <a name='334'>
                                            its, ite, jts, jte, kts, kte<a name='335'>
   INTEGER ,               INTENT(IN   ) :: ijds, ijde<a name='336'>
   INTEGER ,               INTENT(IN   ) :: spec_bdy_width, spec_zone, relax_zone<a name='337'>
<a name='338'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) , INTENT(IN   ) :: scalar<a name='339'>
   REAL , DIMENSION( ims:ime , jms:jme  ) , INTENT(IN   ) :: mu<a name='340'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) , INTENT(INOUT) :: scalar_tend<a name='341'>
   REAL , DIMENSION( spec_bdy_width) , INTENT(IN   ) :: fcx, gcx<a name='342'>
<a name='343'>
   REAL,  DIMENSION( ijds:ijde , kds:kde , spec_bdy_width, 4 ), INTENT(IN   ) :: scalar_b, &amp;<a name='344'>
                                                                                 scalar_bt<a name='345'>
   REAL, INTENT(IN   ) :: dtbc<a name='346'>
<font color=#447700>!Local<a name='347'></font>
   INTEGER :: i,j,k, i_start, i_end, j_start, j_end<a name='348'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) :: rscalar<a name='349'>
<a name='350'>
<font color=#447700>! rscalar will be calculated beyond tile limits because relax_bdytend<a name='351'></font>
<font color=#447700>!   requires a 5-point stencil, and this avoids need for inter-tile/patch <a name='352'></font>
<font color=#447700>!   communication here<a name='353'></font>
           i_start = max(its-1, ids)<a name='354'>
           i_end = min(ite+1, ide-1)<a name='355'>
           j_start = max(jts-1, jds)<a name='356'>
           j_end = min(jte+1, jde-1)<a name='357'>
<a name='358'>
           DO j=j_start,j_end<a name='359'>
           DO k=kts,min(kte,kde-1)<a name='360'>
           DO i=i_start,i_end<a name='361'>
              rscalar(i,k,j) = scalar(i,k,j)*mu(i,j)<a name='362'>
           ENDDO<a name='363'>
           ENDDO<a name='364'>
           ENDDO<a name='365'>
<a name='366'>
           CALL <A href='../../html_code/share/module_bc.F.html#RELAX_BDYTEND'>relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RELAX_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELAX_BDYTEND_7"> (rscalar, scalar_tend,             &amp;<a name='367'>
                               scalar_b, scalar_bt,       &amp;<a name='368'>
                               'q'        , config_flags, &amp;<a name='369'>
                               spec_bdy_width, spec_zone, relax_zone, &amp;<a name='370'>
                               dtbc, fcx, gcx,             &amp;<a name='371'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='372'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='373'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='374'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='375'></font>
                               its,ite, jts,jte, kts,kte )<a name='376'>
<a name='377'>
<a name='378'>
   END SUBROUTINE relax_bdy_scalar <a name='379'>
<a name='380'>
<font color=#447700>!------------------------------------------------------------------------<a name='381'></font>
<A NAME='SPEC_BDY_DRY'><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='382'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>spec_bdy_dry</font> ( config_flags,                        &amp; <A href='../../call_to/SPEC_BDY_DRY.html' TARGET='index'>12</A>,<A href='../../call_from/SPEC_BDY_DRY.html' TARGET='index'>6</A><a name='383'>
                             ru_tend, rv_tend, ph_tend, t_tend,   &amp;<a name='384'>
                             rw_tend, mu_tend,                    &amp;<a name='385'>
                             u_b, v_b, ph_b, t_b,                 &amp;<a name='386'>
                             w_b, mu_b,                           &amp;<a name='387'>
                             u_bt, v_bt, ph_bt, t_bt,             &amp;<a name='388'>
                             w_bt, mu_bt,                         &amp;<a name='389'>
                             spec_bdy_width, spec_zone,           &amp;<a name='390'>
                             ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='391'></font>
                             ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='392'></font>
                             ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='393'></font>
                             ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='394'></font>
                             its, ite, jts, jte, kts, kte)<a name='395'>
   IMPLICIT NONE<a name='396'>
<a name='397'>
   <font color=#447700>!  Input data.<a name='398'></font>
   TYPE( grid_config_rec_type ) config_flags<a name='399'>
<a name='400'>
<a name='401'>
   INTEGER ,               INTENT(IN   ) :: ids, ide, jds, jde, kds, kde, &amp;<a name='402'>
                                            ims, ime, jms, jme, kms, kme, &amp;<a name='403'>
                                            ips, ipe, jps, jpe, kps, kpe, &amp; <a name='404'>
                                            its, ite, jts, jte, kts, kte<a name='405'>
   INTEGER ,               INTENT(IN   ) :: ijds, ijde<a name='406'>
   INTEGER ,               INTENT(IN   ) :: spec_bdy_width, spec_zone<a name='407'>
<a name='408'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) , INTENT(OUT  ) :: ru_tend, &amp;<a name='409'>
                                                                      rv_tend, &amp;<a name='410'>
                                                                      ph_tend, &amp;<a name='411'>
                                                                      rw_tend, &amp;<a name='412'>
                                                                      t_tend<a name='413'>
   REAL , DIMENSION( ims:ime , jms:jme  ) , INTENT(OUT  )          :: mu_tend<a name='414'>
   REAL,  DIMENSION( ijds:ijde , kds:kde , spec_bdy_width, 4 ), INTENT(IN   ) :: u_b,  &amp;<a name='415'>
                                                                                 v_b,  &amp;<a name='416'>
                                                                                 ph_b, &amp;<a name='417'>
                                                                                  w_b, &amp;<a name='418'>
                                                                                 t_b,  &amp;<a name='419'>
                                                                                 u_bt, &amp;<a name='420'>
                                                                                 v_bt, &amp;<a name='421'>
                                                                                ph_bt, &amp;<a name='422'>
                                                                                 w_bt, &amp;<a name='423'>
                                                                                 t_bt<a name='424'>
<a name='425'>
   REAL,  DIMENSION( ijds:ijde , 1:1 ,     spec_bdy_width, 4 ), INTENT(IN   ) :: mu_b, &amp;<a name='426'>
                                                                                 mu_bt<a name='427'>
<a name='428'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_1"> (   ru_tend,                &amp;<a name='429'>
                               u_b, u_bt,    &amp;<a name='430'>
                               'u'     , config_flags, &amp;<a name='431'>
                               spec_bdy_width, spec_zone, &amp;<a name='432'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='433'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='434'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='435'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='436'></font>
                               its,ite, jts,jte, kts,kte )<a name='437'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_2"> (   rv_tend,                &amp;<a name='438'>
                               v_b, v_bt,    &amp;<a name='439'>
                               'v'     , config_flags, &amp;<a name='440'>
                               spec_bdy_width, spec_zone, &amp;<a name='441'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='442'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='443'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='444'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='445'></font>
                               its,ite, jts,jte, kts,kte )<a name='446'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_3"> (   ph_tend,                &amp;<a name='447'>
                               ph_b, ph_bt,    &amp;<a name='448'>
                               'h'     , config_flags, &amp;<a name='449'>
                               spec_bdy_width, spec_zone, &amp;<a name='450'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='451'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='452'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='453'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='454'></font>
                               its,ite, jts,jte, kts,kte )<a name='455'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_4"> (   t_tend,                &amp;<a name='456'>
                               t_b, t_bt,    &amp;<a name='457'>
                               't'     , config_flags, &amp;<a name='458'>
                               spec_bdy_width, spec_zone, &amp;<a name='459'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='460'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='461'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='462'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='463'></font>
                               its,ite, jts,jte, kts,kte )<a name='464'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_5"> (   mu_tend,                &amp;<a name='465'>
                               mu_b, mu_bt,       &amp;<a name='466'>
                               'm'     , config_flags, &amp;<a name='467'>
                               spec_bdy_width, spec_zone, &amp;<a name='468'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='469'></font>
                               ids,ide, jds,jde, 1  ,1  ,  &amp; <font color=#447700>! domain dims<a name='470'></font>
                               ims,ime, jms,jme, 1  ,1  ,  &amp; <font color=#447700>! memory dims<a name='471'></font>
                               ips,ipe, jps,jpe, 1  ,1  ,  &amp; <font color=#447700>! patch  dims<a name='472'></font>
                               its,ite, jts,jte, 1  ,1   )<a name='473'>
<a name='474'>
         if(config_flags%nested)                           &amp;<a name='475'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_6"> (   rw_tend,                    &amp;<a name='476'>
                               w_b, w_bt,                  &amp;<a name='477'>
                               'h'     , config_flags,     &amp;<a name='478'>
                               spec_bdy_width, spec_zone,  &amp;<a name='479'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='480'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='481'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='482'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='483'></font>
                               its,ite, jts,jte, kts,kte )<a name='484'>
<a name='485'>
   END SUBROUTINE spec_bdy_dry <a name='486'>
<a name='487'>
<font color=#447700>!------------------------------------------------------------------------<a name='488'></font>
<A NAME='SPEC_BDY_SCALAR'><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_SCALAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='489'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>spec_bdy_scalar</font> ( scalar_tend,    &amp; <A href='../../call_to/SPEC_BDY_SCALAR.html' TARGET='index'>50</A>,<A href='../../call_from/SPEC_BDY_SCALAR.html' TARGET='index'>1</A><a name='490'>
                                scalar_b, scalar_bt,             &amp;<a name='491'>
                          spec_bdy_width, spec_zone,                   &amp;<a name='492'>
                          ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='493'></font>
                          ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='494'></font>
                          ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='495'></font>
                          ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='496'></font>
                          its, ite, jts, jte, kts, kte)<a name='497'>
   IMPLICIT NONE<a name='498'>
<a name='499'>
   <font color=#447700>!  Input data.<a name='500'></font>
   TYPE( grid_config_rec_type ) config_flags<a name='501'>
<a name='502'>
<a name='503'>
   INTEGER ,               INTENT(IN   ) :: ids, ide, jds, jde, kds, kde, &amp;<a name='504'>
                                            ims, ime, jms, jme, kms, kme, &amp;<a name='505'>
                                            ips, ipe, jps, jpe, kps, kpe, &amp; <a name='506'>
                                            its, ite, jts, jte, kts, kte<a name='507'>
   INTEGER ,               INTENT(IN   ) :: ijds, ijde<a name='508'>
   INTEGER ,               INTENT(IN   ) :: spec_bdy_width, spec_zone<a name='509'>
<a name='510'>
   REAL , DIMENSION( ims:ime , kms:kme, jms:jme  ) , INTENT(OUT  ) :: scalar_tend<a name='511'>
   REAL,  DIMENSION( ijds:ijde , kds:kde , spec_bdy_width, 4 ), INTENT(IN   ) :: scalar_b, &amp;<a name='512'>
                                                                                 scalar_bt<a name='513'>
<font color=#447700>!Local<a name='514'></font>
   INTEGER :: i,j,k<a name='515'>
<a name='516'>
<a name='517'>
         CALL <A href='../../html_code/share/module_bc.F.html#SPEC_BDYTEND'>spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPEC_BDYTEND_7"> (   scalar_tend,                &amp;<a name='518'>
                               scalar_b, scalar_bt,    &amp;<a name='519'>
<font color=#447700>!                              scalar_xbdy, scalar_ybdy,       &amp;<a name='520'></font>
                               'q'     , config_flags, &amp;<a name='521'>
                               spec_bdy_width, spec_zone, &amp;<a name='522'>
                               ijds, ijde,                 &amp; <font color=#447700>! min/max(id,jd)<a name='523'></font>
                               ids,ide, jds,jde, kds,kde,  &amp; <font color=#447700>! domain dims<a name='524'></font>
                               ims,ime, jms,jme, kms,kme,  &amp; <font color=#447700>! memory dims<a name='525'></font>
                               ips,ipe, jps,jpe, kps,kpe,  &amp; <font color=#447700>! patch  dims<a name='526'></font>
                               its,ite, jts,jte, kts,kte )<a name='527'>
<a name='528'>
<a name='529'>
   END SUBROUTINE spec_bdy_scalar <a name='530'>
<a name='531'>
<font color=#447700>!------------------------------------------------------------------------<a name='532'></font>
<a name='533'>
<A NAME='SET_PHYS_BC_DRY_1'><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='534'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>set_phys_bc_dry_1</font>( config_flags, u_1, u_2, v_1, v_2,   &amp;,<A href='../../call_from/SET_PHYS_BC_DRY_1.html' TARGET='index'>14</A><a name='535'>
                                 rw_1, rw_2, w_1, w_2,           &amp;<a name='536'>
                                 t_1, t_2, tp_1, tp_2, pp, pip,  &amp;<a name='537'>
                                 ids,ide, jds,jde, kds,kde,      &amp;<a name='538'>
                                 ims,ime, jms,jme, kms,kme,      &amp;<a name='539'>
                                 ips,ipe, jps,jpe, kps,kpe,      &amp;<a name='540'>
                                 its,ite, jts,jte, kts,kte      )<a name='541'>
<a name='542'>
<font color=#447700>!<a name='543'></font>
<font color=#447700>!  this is just a wraper to call the boundary condition routines<a name='544'></font>
<font color=#447700>!  for each variable<a name='545'></font>
<font color=#447700>!<a name='546'></font>
<a name='547'>
      IMPLICIT NONE<a name='548'>
<a name='549'>
      INTEGER,      INTENT(IN   )    :: ids,ide, jds,jde, kds,kde<a name='550'>
      INTEGER,      INTENT(IN   )    :: ims,ime, jms,jme, kms,kme<a name='551'>
      INTEGER,      INTENT(IN   )    :: ips,ipe, jps,jpe, kps,kpe<a name='552'>
      INTEGER,      INTENT(IN   )    :: its,ite, jts,jte, kts,kte<a name='553'>
<a name='554'>
      TYPE( grid_config_rec_type ) config_flags<a name='555'>
<a name='556'>
      REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), INTENT(INOUT) :: &amp;<a name='557'>
           u_1,u_2, v_1, v_2, rw_1, rw_2, w_1, w_2,                  &amp;<a name='558'>
           t_1, t_2, tp_1, tp_2, pp, pip<a name='559'>
<a name='560'>
<a name='561'>
<a name='562'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_15">( u_1  , 'u', config_flags,               &amp;<a name='563'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='564'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='565'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='566'>
                              its, ite, jts, jte, kts, kte )<a name='567'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_16">( u_2  , 'u', config_flags,               &amp;<a name='568'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='569'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='570'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='571'>
                              its, ite, jts, jte, kts, kte )<a name='572'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_17">( v_1  , 'v', config_flags,               &amp;<a name='573'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='574'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='575'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='576'>
                              its, ite, jts, jte, kts, kte )<a name='577'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_18">( v_2  , 'v', config_flags,               &amp;<a name='578'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='579'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='580'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='581'>
                              its, ite, jts, jte, kts, kte )<a name='582'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_19">( rw_1 , 'w', config_flags,               &amp;<a name='583'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='584'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='585'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='586'>
                              its, ite, jts, jte, kts, kte )<a name='587'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_20">( rw_2 , 'w', config_flags,               &amp;<a name='588'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='589'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='590'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='591'>
                              its, ite, jts, jte, kts, kte )<a name='592'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_21">( w_1  , 'w', config_flags,               &amp;<a name='593'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='594'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='595'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='596'>
                              its, ite, jts, jte, kts, kte )<a name='597'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_22">( w_2  , 'w', config_flags,               &amp;<a name='598'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='599'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='600'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='601'>
                              its, ite, jts, jte, kts, kte )<a name='602'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_23">( t_1, 'p', config_flags,                 &amp;<a name='603'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='604'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='605'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='606'>
                              its, ite, jts, jte, kts, kte )<a name='607'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_24">( t_2, 'p', config_flags,                 &amp;<a name='608'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='609'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='610'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='611'>
                              its, ite, jts, jte, kts, kte )<a name='612'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_25">( tp_1, 'p', config_flags,                &amp;<a name='613'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='614'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='615'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='616'>
                              its, ite, jts, jte, kts, kte )<a name='617'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_26">( tp_2, 'p', config_flags,                &amp;<a name='618'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='619'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='620'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='621'>
                              its, ite, jts, jte, kts, kte )<a name='622'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_27">( pp , 'p', config_flags,                 &amp;<a name='623'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='624'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='625'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='626'>
                              its, ite, jts, jte, kts, kte )<a name='627'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_28">( pip , 'p', config_flags,                &amp;<a name='628'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='629'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='630'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='631'>
                              its, ite, jts, jte, kts, kte )<a name='632'>
<a name='633'>
  END SUBROUTINE set_phys_bc_dry_1<a name='634'>
<a name='635'>
<font color=#447700>!--------------------------------------------------------------<a name='636'></font>
<a name='637'>
<A NAME='SET_PHYS_BC_DRY_2'><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='638'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>set_phys_bc_dry_2</font>( config_flags,                     &amp; <A href='../../call_to/SET_PHYS_BC_DRY_2.html' TARGET='index'>3</A>,<A href='../../call_from/SET_PHYS_BC_DRY_2.html' TARGET='index'>12</A><a name='639'>
                                 u_1, u_2, v_1, v_2, w_1, w_2,     &amp;<a name='640'>
                                 t_1, t_2, ph_1, ph_2, mu_1, mu_2, &amp;<a name='641'>
                                 ids,ide, jds,jde, kds,kde,        &amp;<a name='642'>
                                 ims,ime, jms,jme, kms,kme,        &amp;<a name='643'>
                                 ips,ipe, jps,jpe, kps,kpe,        &amp;<a name='644'>
                                 its,ite, jts,jte, kts,kte        )<a name='645'>
<a name='646'>
<font color=#447700>!<a name='647'></font>
<font color=#447700>!  this is just a wraper to call the boundary condition routines<a name='648'></font>
<font color=#447700>!  for each variable<a name='649'></font>
<font color=#447700>!<a name='650'></font>
<a name='651'>
      IMPLICIT NONE<a name='652'>
<a name='653'>
      TYPE( grid_config_rec_type ) config_flags<a name='654'>
<a name='655'>
      INTEGER,      INTENT(IN   )    :: ids,ide, jds,jde, kds,kde<a name='656'>
      INTEGER,      INTENT(IN   )    :: ims,ime, jms,jme, kms,kme<a name='657'>
      INTEGER,      INTENT(IN   )    :: ips,ipe, jps,jpe, kps,kpe<a name='658'>
      INTEGER,      INTENT(IN   )    :: its,ite, jts,jte, kts,kte<a name='659'>
<a name='660'>
      REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), INTENT(INOUT) :: &amp;<a name='661'>
         u_1, u_2, v_1, v_2, w_1, w_2,                       &amp;<a name='662'>
         t_1, t_2, ph_1, ph_2<a name='663'>
<a name='664'>
      REAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: &amp;<a name='665'>
                             mu_1, mu_2<a name='666'>
<a name='667'>
<a name='668'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_29">( u_1, 'U', config_flags,           &amp;<a name='669'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='670'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='671'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='672'>
                              its, ite, jts, jte, kts, kte )<a name='673'>
<a name='674'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_30">( u_2, 'U', config_flags,           &amp;<a name='675'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='676'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='677'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='678'>
                              its, ite, jts, jte, kts, kte )<a name='679'>
<a name='680'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_31">( v_1 , 'V', config_flags,          &amp;<a name='681'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='682'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='683'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='684'>
                              its, ite, jts, jte, kts, kte )<a name='685'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_32">( v_2 , 'V', config_flags,          &amp;<a name='686'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='687'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='688'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='689'>
                              its, ite, jts, jte, kts, kte )<a name='690'>
<a name='691'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_33">( w_1, 'w', config_flags,           &amp;<a name='692'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='693'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='694'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='695'>
                              its, ite, jts, jte, kts, kte )<a name='696'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_34">( w_2, 'w', config_flags,           &amp;<a name='697'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='698'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='699'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='700'>
                              its, ite, jts, jte, kts, kte )<a name='701'>
<a name='702'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_35">( t_1, 'p', config_flags,           &amp;<a name='703'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='704'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='705'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='706'>
                              its, ite, jts, jte, kts, kte )<a name='707'>
<a name='708'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_36">( t_2, 'p', config_flags,           &amp;<a name='709'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='710'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='711'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='712'>
                              its, ite, jts, jte, kts, kte )<a name='713'>
<a name='714'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_37">( ph_1 , 'w', config_flags,         &amp;<a name='715'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='716'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='717'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='718'>
                              its, ite, jts, jte, kts, kte )<a name='719'>
<a name='720'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_38">( ph_2 , 'w', config_flags,         &amp;<a name='721'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='722'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='723'>
                              ips, ipe, jps, jpe, kps, kpe, &amp;<a name='724'>
                              its, ite, jts, jte, kts, kte )<a name='725'>
<a name='726'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC2D'>set_physical_bc2d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC2D_4">( mu_1, 't', config_flags, &amp;<a name='727'>
                              ids, ide, jds, jde,  &amp;<a name='728'>
                              ims, ime, jms, jme,  &amp;<a name='729'>
                              ips, ipe, jps, jpe,  &amp;<a name='730'>
                              its, ite, jts, jte  )<a name='731'>
<a name='732'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC2D'>set_physical_bc2d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC2D_5">( mu_2, 't', config_flags, &amp;<a name='733'>
                              ids, ide, jds, jde,  &amp;<a name='734'>
                              ims, ime, jms, jme,  &amp;<a name='735'>
                              ips, ipe, jps, jpe,  &amp;<a name='736'>
                              its, ite, jts, jte  )<a name='737'>
<a name='738'>
   END SUBROUTINE set_phys_bc_dry_2<a name='739'>
<a name='740'>
<font color=#447700>!------------------------------------------------------------------------<a name='741'></font>
<a name='742'>
<A NAME='SET_PHYS_BC_SMALLSTEP_1'><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_SMALLSTEP_1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='743'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>set_phys_bc_smallstep_1</font>( config_flags, ru_1, du, rv_1, dv,   &amp;,<A href='../../call_from/SET_PHYS_BC_SMALLSTEP_1.html' TARGET='index'>4</A><a name='744'>
                                       ids,ide, jds,jde, kds,kde,      &amp;<a name='745'>
                                       ims,ime, jms,jme, kms,kme,      &amp;<a name='746'>
                                       ips,ipe, jps,jpe, kps,kpe,      &amp;<a name='747'>
                                       its,ite, jts,jte, kts,kte      )<a name='748'>
<a name='749'>
<font color=#447700>!<a name='750'></font>
<font color=#447700>!  this is just a wraper to call the boundary condition routines<a name='751'></font>
<font color=#447700>!  for each variable<a name='752'></font>
<font color=#447700>!<a name='753'></font>
<a name='754'>
      IMPLICIT NONE<a name='755'>
<a name='756'>
      INTEGER,      INTENT(IN   )    :: ids,ide, jds,jde, kds,kde<a name='757'>
      INTEGER,      INTENT(IN   )    :: ims,ime, jms,jme, kms,kme<a name='758'>
      INTEGER,      INTENT(IN   )    :: ips,ipe, jps,jpe, kps,kpe<a name='759'>
      INTEGER,      INTENT(IN   )    :: its,ite, jts,jte, kts,kte<a name='760'>
<a name='761'>
      TYPE( grid_config_rec_type ) config_flags<a name='762'>
<a name='763'>
      REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), INTENT(INOUT) :: &amp;<a name='764'>
           ru_1,du, rv_1, dv<a name='765'>
<a name='766'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_SMALLSTEP_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_39">( ru_1  , 'u', config_flags,              &amp;<a name='767'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='768'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='769'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='770'>
                              its, ite, jts, jte, kts, kde )<a name='771'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_SMALLSTEP_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_40">( du , 'u', config_flags,                 &amp;<a name='772'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='773'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='774'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='775'>
                              its, ite, jts, jte, kts, kde )<a name='776'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_SMALLSTEP_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_41">( rv_1  , 'v', config_flags,              &amp;<a name='777'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='778'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='779'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='780'>
                              its, ite, jts, jte, kts, kde )<a name='781'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_PHYS_BC_SMALLSTEP_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_42">( dv  , 'v', config_flags,                &amp;<a name='782'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='783'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='784'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='785'>
                              its, ite, jts, jte, kts, kde )<a name='786'>
<a name='787'>
  END SUBROUTINE set_phys_bc_smallstep_1<a name='788'>
<a name='789'>
<font color=#447700>!-------------------------------------------------------------------<a name='790'></font>
<a name='791'>
<A NAME='RK_PHYS_BC_DRY_1'><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='792'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>rk_phys_bc_dry_1</font>( config_flags, u, v, rw, w,  &amp; <A href='../../call_to/RK_PHYS_BC_DRY_1.html' TARGET='index'>3</A>,<A href='../../call_from/RK_PHYS_BC_DRY_1.html' TARGET='index'>10</A><a name='793'>
                                muu, muv, mut, php, alt, p, &amp;<a name='794'>
                                ids,ide, jds,jde, kds,kde,  &amp;<a name='795'>
                                ims,ime, jms,jme, kms,kme,  &amp;<a name='796'>
                                ips,ipe, jps,jpe, kps,kpe,  &amp;<a name='797'>
                                its,ite, jts,jte, kts,kte  )<a name='798'>
<a name='799'>
<font color=#447700>!<a name='800'></font>
<font color=#447700>!  this is just a wraper to call the boundary condition routines<a name='801'></font>
<font color=#447700>!  for each variable<a name='802'></font>
<font color=#447700>!<a name='803'></font>
<a name='804'>
      IMPLICIT NONE<a name='805'>
<a name='806'>
      INTEGER,      INTENT(IN   )    :: ids,ide, jds,jde, kds,kde<a name='807'>
      INTEGER,      INTENT(IN   )    :: ims,ime, jms,jme, kms,kme<a name='808'>
      INTEGER,      INTENT(IN   )    :: ips,ipe, jps,jpe, kps,kpe<a name='809'>
      INTEGER,      INTENT(IN   )    :: its,ite, jts,jte, kts,kte<a name='810'>
<a name='811'>
      TYPE( grid_config_rec_type ) config_flags<a name='812'>
<a name='813'>
      REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                    &amp;<a name='814'>
                                INTENT(INOUT) ::  u, v, rw, w, php, alt, p<a name='815'>
      REAL, DIMENSION( ims:ime, jms:jme ),                             &amp;<a name='816'>
                                INTENT(INOUT) ::    muu, muv, mut<a name='817'>
<a name='818'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_43">( u  , 'u', config_flags,             &amp;<a name='819'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='820'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='821'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='822'>
                              its, ite, jts, jte, kts, kte )<a name='823'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_44">( v  , 'v', config_flags,             &amp;<a name='824'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='825'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='826'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='827'>
                              its, ite, jts, jte, kts, kte )<a name='828'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_45">(rw , 'w', config_flags,              &amp;<a name='829'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='830'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='831'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='832'>
                              its, ite, jts, jte, kts, kte )<a name='833'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_46">( w , 'w', config_flags,              &amp;<a name='834'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='835'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='836'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='837'>
                              its, ite, jts, jte, kts, kte )<a name='838'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_47">( php , 'w', config_flags,            &amp;<a name='839'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='840'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='841'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='842'>
                              its, ite, jts, jte, kts, kte )<a name='843'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_48">( alt, 't', config_flags,             &amp;<a name='844'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='845'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='846'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='847'>
                              its, ite, jts, jte, kts, kte )<a name='848'>
<a name='849'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_49">( p, 'p', config_flags,               &amp;<a name='850'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='851'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='852'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='853'>
                              its, ite, jts, jte, kts, kte )<a name='854'>
<a name='855'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC2D'>set_physical_bc2d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC2D_6">( muu, 'u', config_flags,  &amp;<a name='856'>
                              ids, ide, jds, jde,      &amp;<a name='857'>
                              ims, ime, jms, jme,      &amp;<a name='858'>
                              ips, ipe, jps, jpe,      &amp;<a name='859'>
                              its, ite, jts, jte  )<a name='860'>
<a name='861'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC2D'>set_physical_bc2d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC2D_7">( muv, 'v', config_flags,  &amp;<a name='862'>
                              ids, ide, jds, jde,      &amp;<a name='863'>
                              ims, ime, jms, jme,      &amp;<a name='864'>
                              ips, ipe, jps, jpe,      &amp;<a name='865'>
                              its, ite, jts, jte  )<a name='866'>
<a name='867'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC2D'>set_physical_bc2d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC2D_8">( mut, 't', config_flags,  &amp;<a name='868'>
                              ids, ide, jds, jde,      &amp;<a name='869'>
                              ims, ime, jms, jme,      &amp;<a name='870'>
                              ips, ipe, jps, jpe,      &amp;<a name='871'>
                              its, ite, jts, jte  )<a name='872'>
<a name='873'>
  END SUBROUTINE rk_phys_bc_dry_1<a name='874'>
<a name='875'>
<font color=#447700>!------------------------------------------------------------------------<a name='876'></font>
<a name='877'>
<A NAME='RK_PHYS_BC_DRY_2'><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='878'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>rk_phys_bc_dry_2</font>( config_flags, u, v, w,      &amp; <A href='../../call_to/RK_PHYS_BC_DRY_2.html' TARGET='index'>3</A>,<A href='../../call_from/RK_PHYS_BC_DRY_2.html' TARGET='index'>6</A><a name='879'>
                               t, ph, mu,                  &amp;<a name='880'>
                               ids,ide, jds,jde, kds,kde,  &amp;<a name='881'>
                               ims,ime, jms,jme, kms,kme,  &amp;<a name='882'>
                               ips,ipe, jps,jpe, kps,kpe,  &amp;<a name='883'>
                               its,ite, jts,jte, kts,kte  )<a name='884'>
<a name='885'>
<font color=#447700>!<a name='886'></font>
<font color=#447700>!  this is just a wraper to call the boundary condition routines<a name='887'></font>
<font color=#447700>!  for each variable<a name='888'></font>
<font color=#447700>!<a name='889'></font>
<a name='890'>
      IMPLICIT NONE<a name='891'>
<a name='892'>
      INTEGER,      INTENT(IN   )    :: ids,ide, jds,jde, kds,kde<a name='893'>
      INTEGER,      INTENT(IN   )    :: ims,ime, jms,jme, kms,kme<a name='894'>
      INTEGER,      INTENT(IN   )    :: ips,ipe, jps,jpe, kps,kpe<a name='895'>
      INTEGER,      INTENT(IN   )    :: its,ite, jts,jte, kts,kte<a name='896'>
<a name='897'>
      TYPE( grid_config_rec_type ) config_flags<a name='898'>
<a name='899'>
      REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), INTENT(INOUT) :: &amp;<a name='900'>
                             u, v, w, t, ph<a name='901'>
<a name='902'>
      REAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: &amp;<a name='903'>
                             mu<a name='904'>
<a name='905'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_50">( u   , 'U', config_flags,            &amp;<a name='906'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='907'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='908'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='909'>
                              its, ite, jts, jte, kts, kte )<a name='910'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_51">( v   , 'V', config_flags,            &amp;<a name='911'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='912'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='913'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='914'>
                              its, ite, jts, jte, kts, kte )<a name='915'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_52">( w  , 'w', config_flags,             &amp;<a name='916'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='917'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='918'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='919'>
                              its, ite, jts, jte, kts, kte )<a name='920'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_53">( t, 'p', config_flags,               &amp;<a name='921'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='922'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='923'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='924'>
                              its, ite, jts, jte, kts, kte )<a name='925'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC3D'>set_physical_bc3d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC3D_54">( ph  , 'w', config_flags,            &amp;<a name='926'>
                              ids, ide, jds, jde, kds, kde,       &amp;<a name='927'>
                              ims, ime, jms, jme, kms, kme,       &amp;<a name='928'>
                              ips, ipe, jps, jpe, kps, kpe,       &amp;<a name='929'>
                              its, ite, jts, jte, kts, kte )<a name='930'>
<a name='931'>
      CALL <A href='../../html_code/share/module_bc.F.html#SET_PHYSICAL_BC2D'>set_physical_bc2d</A><A href='../../html_code/dyn_em/module_bc_em.F.html#RK_PHYS_BC_DRY_2' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_PHYSICAL_BC2D_9">( mu, 't', config_flags, &amp;<a name='932'>
                              ids, ide, jds, jde,    &amp;<a name='933'>
                              ims, ime, jms, jme,    &amp;<a name='934'>
                              ips, ipe, jps, jpe,    &amp;<a name='935'>
                              its, ite, jts, jte    )<a name='936'>
<a name='937'>
  END SUBROUTINE rk_phys_bc_dry_2<a name='938'>
<a name='939'>
<font color=#447700>!---------------------------------------------------------------------<a name='940'></font>
<a name='941'>
<A NAME='SET_W_SURFACE'><A href='../../html_code/dyn_em/module_bc_em.F.html#SET_W_SURFACE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='942'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>set_w_surface</font>( config_flags,                                &amp; <A href='../../call_to/SET_W_SURFACE.html' TARGET='index'>2</A><a name='943'>
                            w, ht, u, v, cf1, cf2, cf3, rdx, rdy, msft,  &amp;<a name='944'>
                            ids, ide, jds, jde, kds, kde,                &amp;<a name='945'>
                            ips, ipe, jps, jpe, kps, kpe,                &amp;<a name='946'>
                            its, ite, jts, jte, kts, kte,                &amp;<a name='947'>
                            ims, ime, jms, jme, kms, kme                )<a name='948'>
  implicit none<a name='949'>
<a name='950'>
  TYPE( grid_config_rec_type ) config_flags<a name='951'>
<a name='952'>
  INTEGER ,       INTENT(IN   ) :: ids, ide, jds, jde, kds, kde, &amp;<a name='953'>
                                   ims, ime, jms, jme, kms, kme, &amp;<a name='954'>
                                   its, ite, jts, jte, kts, kte, &amp;<a name='955'>
                                   ips, ipe, jps, jpe, kps, kpe<a name='956'>
<a name='957'>
   REAL :: cf1, cf2, cf3, rdx, rdy<a name='958'>
<a name='959'>
<a name='960'>
   REAL , DIMENSION(  ims:ime , kms:kme, jms:jme ) ,                      &amp;<a name='961'>
                                               INTENT(IN   ) ::  u,       &amp;<a name='962'>
                                                                 v<a name='963'>
<a name='964'>
   REAL , DIMENSION(  ims:ime , kms:kme, jms:jme ) ,                      &amp;<a name='965'>
                                               INTENT(INOUT) ::  w<a name='966'>
<a name='967'>
   REAL , DIMENSION(  ims:ime , jms:jme ) , INTENT(IN   ) ::  ht, msft<a name='968'>
<a name='969'>
   INTEGER :: i,j<a name='970'>
   INTEGER :: ip1,im1,jp1,jm1<a name='971'>
<a name='972'>
<font color=#447700>!  set kinematic lower boundary condition on W<a name='973'></font>
<a name='974'>
     DO j = jts,min(jte,jde-1)<a name='975'>
       jm1 = max(j-1,jds)<a name='976'>
       jp1 = min(j+1,jde-1)<a name='977'>
     DO i = its,min(ite,ide-1)<a name='978'>
       im1 = max(i-1,ids)<a name='979'>
       ip1 = min(i+1,ide-1)<a name='980'>
<a name='981'>
         w(i,1,j)=  msft(i,j)*(                            &amp;<a name='982'>
                  .5*rdy*(                                   &amp;<a name='983'>
                           (ht(i,jp1)-ht(i,j  ))             &amp;<a name='984'>
          *(cf1*v(i,1,j+1)+cf2*v(i,2,j+1)+cf3*v(i,3,j+1))    &amp;<a name='985'>
                          +(ht(i,j  )-ht(i,jm1))             &amp;<a name='986'>
          *(cf1*v(i,1,j  )+cf2*v(i,2,j  )+cf3*v(i,3,j  ))  ) &amp;<a name='987'>
                 +.5*rdx*(                                   &amp;<a name='988'>
                           (ht(ip1,j)-ht(i,j  ))             &amp;<a name='989'>
          *(cf1*u(i+1,1,j)+cf2*u(i+1,2,j)+cf3*u(i+1,3,j))    &amp;<a name='990'>
                          +(ht(i  ,j)-ht(im1,j))             &amp;<a name='991'>
          *(cf1*u(i  ,1,j)+cf2*u(i  ,2,j)+cf3*u(i  ,3,j))  ) &amp;<a name='992'>
                                                            )<a name='993'>
      ENDDO<a name='994'>
      ENDDO<a name='995'>
<a name='996'>
  END SUBROUTINE set_w_surface<a name='997'>
<a name='998'>
END MODULE module_bc_em<a name='999'>
</pre></body></html>