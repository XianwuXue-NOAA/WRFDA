<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.18<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='A_MODULE_ADVECT_EM'><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_MODULE_ADVECT_EM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module     </font><font color=#cc0000>a_module_advect_em</font> <A href='../../call_to/A_MODULE_ADVECT_EM.html' TARGET='index'>2</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#module_advect_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_3"><a name='35'>
use <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_MODULE_BC'>a_module_bc</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#module_advect_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_MODULE_BC_1"><a name='36'>
use <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#module_advect_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_2"><a name='37'>
use <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#module_advect_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_2"><a name='38'>
use <A href='../../html_code/dyn_em/module_advect_em.F.html#MODULE_ADVECT_EM'>module_advect_em</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#module_advect_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_ADVECT_EM_1"><a name='39'>
<a name='40'>
USE <A href='../../html_code/frame/module_trace.F.html#MODULE_TRACE'>module_trace</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#module_advect_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_TRACE_2">, only : trace_entry, trace_exit<a name='41'>
<a name='42'>
<font color=#447700>!==============================================<a name='43'></font>
<font color=#447700>! all entries are defined explicitly<a name='44'></font>
<font color=#447700>!==============================================<a name='45'></font>
implicit none<a name='46'>
<a name='47'>
contains<a name='48'>
<a name='49'>
<A NAME='A_ADVECT_SCALAR'><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_SCALAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='50'>
<font color=#993300>subroutine </font><font color=#cc0000>a_advect_scalar</font>( field, a_field, field_old, a_field_old, a_tendency, ru, a_ru, rv, a_rv, rom, a_rom, config_flags, msft,&amp; <A href='../../call_to/A_ADVECT_SCALAR.html' TARGET='index'>4</A>,<A href='../../call_from/A_ADVECT_SCALAR.html' TARGET='index'>2</A><a name='51'>
&amp; fzm, fzp, rdx, rdy, rdzw, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='52'>
<font color=#447700>!******************************************************************<a name='53'></font>
<font color=#447700>!******************************************************************<a name='54'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='55'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='56'></font>
<font color=#447700>!******************************************************************<a name='57'></font>
<font color=#447700>!******************************************************************<a name='58'></font>
<font color=#447700>!==============================================<a name='59'></font>
<font color=#447700>! all entries are defined explicitly<a name='60'></font>
<font color=#447700>!==============================================<a name='61'></font>
implicit none<a name='62'>
<a name='63'>
<font color=#447700>!==============================================<a name='64'></font>
<font color=#447700>! declare arguments<a name='65'></font>
<font color=#447700>!==============================================<a name='66'></font>
integer, intent(in) :: ime<a name='67'>
integer, intent(in) :: ims<a name='68'>
integer, intent(in) :: jme<a name='69'>
integer, intent(in) :: jms<a name='70'>
integer, intent(in) :: kme<a name='71'>
integer, intent(in) :: kms<a name='72'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='73'>
real, intent(inout) :: a_field_old(ims:ime,kms:kme,jms:jme)<a name='74'>
real, intent(inout) :: a_rom(ims:ime,kms:kme,jms:jme)<a name='75'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='76'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='77'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='78'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='79'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='80'>
real, intent(in) :: field_old(ims:ime,kms:kme,jms:jme)<a name='81'>
real, intent(in) :: fzm(kms:kme)<a name='82'>
real, intent(in) :: fzp(kms:kme)<a name='83'>
integer, intent(in) :: ide<a name='84'>
integer, intent(in) :: ids<a name='85'>
integer, intent(in) :: ite<a name='86'>
integer, intent(in) :: its<a name='87'>
integer, intent(in) :: jde<a name='88'>
integer, intent(in) :: jds<a name='89'>
integer, intent(in) :: jte<a name='90'>
integer, intent(in) :: jts<a name='91'>
integer, intent(in) :: kde<a name='92'>
integer, intent(in) :: kte<a name='93'>
integer, intent(in) :: kts<a name='94'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='95'>
real, intent(in) :: rdx<a name='96'>
real, intent(in) :: rdy<a name='97'>
real, intent(in) :: rdzw(kms:kme)<a name='98'>
real, intent(in) :: rom(ims:ime,kms:kme,jms:jme)<a name='99'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='100'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='101'>
<a name='102'>
<font color=#447700>!==============================================<a name='103'></font>
<font color=#447700>! declare local variables<a name='104'></font>
<font color=#447700>!==============================================<a name='105'></font>
real a_fqx(its:ite+1,kts:kte)<a name='106'>
real a_fqy(its:ite,kts:kte,2)<a name='107'>
real a_ub<a name='108'>
real a_vb<a name='109'>
real a_vel<a name='110'>
real a_vflux(its:ite,kts:kte)<a name='111'>
logical degrade_xe<a name='112'>
logical degrade_xs<a name='113'>
logical degrade_ye<a name='114'>
logical degrade_ys<a name='115'>
integer horz_order<a name='116'>
integer i<a name='117'>
integer i_end<a name='118'>
integer i_end_f<a name='119'>
integer i_start<a name='120'>
integer i_start_f<a name='121'>
integer j<a name='122'>
integer j1<a name='123'>
integer j2<a name='124'>
integer j3<a name='125'>
integer j4<a name='126'>
integer j_end<a name='127'>
integer j_end_f<a name='128'>
integer j_start<a name='129'>
integer j_start_f<a name='130'>
integer jp0<a name='131'>
integer jp1<a name='132'>
integer jtmp<a name='133'>
integer k<a name='134'>
integer ktf<a name='135'>
real mrdx<a name='136'>
real mrdy<a name='137'>
logical specified<a name='138'>
real ub<a name='139'>
real vb<a name='140'>
real vel<a name='141'>
integer vert_order<a name='142'>
<a name='143'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_2">("a_advect_scalar")<a name='144'>
<a name='145'>
<font color=#447700>!----------------------------------------------<a name='146'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='147'></font>
<font color=#447700>!----------------------------------------------<a name='148'></font>
a_fqx(:,:) = 0.<a name='149'>
a_fqy(:,:,:) = 0.<a name='150'>
a_ub = 0.<a name='151'>
a_vb = 0.<a name='152'>
a_vel = 0.<a name='153'>
a_vflux(:,:) = 0.<a name='154'>
<a name='155'>
<font color=#447700>!----------------------------------------------<a name='156'></font>
<font color=#447700>! ROUTINE BODY<a name='157'></font>
<font color=#447700>!----------------------------------------------<a name='158'></font>
specified =  .false. <a name='159'>
<font color=#447700>! recompute : specified<a name='160'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='161'>
  specified =  .true. <a name='162'>
endif<a name='163'>
<font color=#447700>! recompute : specified<a name='164'></font>
ktf = min(kte,kde-1)<a name='165'>
<font color=#447700>! recompute : ktf<a name='166'></font>
horz_order = config_flags%h_sca_adv_order<a name='167'>
<font color=#447700>! recompute : horz_order<a name='168'></font>
vert_order = config_flags%v_sca_adv_order<a name='169'>
<font color=#447700>! recompute : vert_order<a name='170'></font>
horizontal_order_tesu: if (horz_order .eq. 6) then<a name='171'>
  ktf = min(kte,kde-1)<a name='172'>
else if (horz_order .eq. 5) then horizontal_order_tesu<a name='173'>
  ktf = min(kte,kde-1)<a name='174'>
else if (horz_order .eq. 4) then horizontal_order_tesu<a name='175'>
  ktf = min(kte,kde-1)<a name='176'>
else if (horz_order .eq. 3) then horizontal_order_tesu<a name='177'>
  ktf = min(kte,kde-1)<a name='178'>
endif horizontal_order_tesu<a name='179'>
<font color=#447700>! recompute : ktf<a name='180'></font>
i_start = its<a name='181'>
<font color=#447700>! recompute : i_start<a name='182'></font>
i_end = min(ite,ide-1)<a name='183'>
<font color=#447700>! recompute : i_end<a name='184'></font>
j_start = jts<a name='185'>
<font color=#447700>! recompute : j_start<a name='186'></font>
j_end = min(jte,jde-1)<a name='187'>
<font color=#447700>! recompute : j_end<a name='188'></font>
a_vert_order_test: if (vert_order .eq. 6) then<a name='189'>
  do j = j_end, j_start, -1<a name='190'>
    do k = kts, ktf<a name='191'>
      do i = i_start, i_end<a name='192'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='193'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='194'>
      end do<a name='195'>
    end do<a name='196'>
    do i = i_start, i_end<a name='197'>
      a_vel = 0.<a name='198'>
      k = ktf-1<a name='199'>
<font color=#447700>! recompute : k<a name='200'></font>
      vel = rom(i,k,j)<a name='201'>
<font color=#447700>! recompute : vel<a name='202'></font>
      k = ktf<a name='203'>
<font color=#447700>! recompute : k<a name='204'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='205'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='206'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='207'>
      a_vflux(i,k) = 0.<a name='208'>
<font color=#447700>! recdepend vars : ktf<a name='209'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3728<a name='210'></font>
<font color=#447700>! recompute vars : k<a name='211'></font>
      k = ktf-1<a name='212'>
<font color=#447700>! recompute vars : k<a name='213'></font>
      a_field(i,k-2,j) = a_field(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='214'>
      a_field(i,k-1,j) = a_field(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='215'>
      a_field(i,k+1,j) = a_field(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='216'>
      a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='217'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(field(i,k,j)+field(i,k-1,j))-0.083333333*(field(i,k+1,j)+field(i,k-2,j)))<a name='218'>
      a_vflux(i,k) = 0.<a name='219'>
<font color=#447700>! recdepend vars : ktf<a name='220'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3728<a name='221'></font>
<font color=#447700>! recompute vars : k<a name='222'></font>
      k = ktf-1<a name='223'>
<font color=#447700>! recompute vars : k<a name='224'></font>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='225'>
      a_vel = 0.<a name='226'>
<font color=#447700>! recdepend vars : kts<a name='227'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3723<a name='228'></font>
<font color=#447700>! recompute vars : k<a name='229'></font>
      k = kts+2<a name='230'>
<font color=#447700>! recompute vars : k<a name='231'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='232'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3724<a name='233'></font>
<font color=#447700>! recompute vars : vel<a name='234'></font>
      vel = rom(i,k,j)<a name='235'>
<font color=#447700>! recompute vars : vel<a name='236'></font>
      a_field(i,k-2,j) = a_field(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='237'>
      a_field(i,k-1,j) = a_field(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='238'>
      a_field(i,k+1,j) = a_field(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='239'>
      a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='240'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(field(i,k,j)+field(i,k-1,j))-0.083333333*(field(i,k+1,j)+field(i,k-2,j)))<a name='241'>
      a_vflux(i,k) = 0.<a name='242'>
<font color=#447700>! recdepend vars : kts<a name='243'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3723<a name='244'></font>
<font color=#447700>! recompute vars : k<a name='245'></font>
      k = kts+2<a name='246'>
<font color=#447700>! recompute vars : k<a name='247'></font>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='248'>
      a_vel = 0.<a name='249'>
<font color=#447700>! recdepend vars : kts<a name='250'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3720<a name='251'></font>
<font color=#447700>! recompute vars : k<a name='252'></font>
      k = kts+1<a name='253'>
<font color=#447700>! recompute vars : k<a name='254'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='255'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='256'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='257'>
      a_vflux(i,k) = 0.<a name='258'>
    end do<a name='259'>
    do k = kts+3, ktf-2<a name='260'>
      a_vel = 0.<a name='261'>
      do i = i_start, i_end<a name='262'>
        a_vel = 0.<a name='263'>
        vel = rom(i,k,j)<a name='264'>
<font color=#447700>! recompute : vel<a name='265'></font>
        a_field(i,k-3,j) = a_field(i,k-3,j)+0.016666667*a_vflux(i,k)*vel<a name='266'>
        a_field(i,k-2,j) = a_field(i,k-2,j)-0.13333333*a_vflux(i,k)*vel<a name='267'>
        a_field(i,k-1,j) = a_field(i,k-1,j)+0.61666667*a_vflux(i,k)*vel<a name='268'>
        a_field(i,k+2,j) = a_field(i,k+2,j)+0.016666667*a_vflux(i,k)*vel<a name='269'>
        a_field(i,k+1,j) = a_field(i,k+1,j)-0.13333333*a_vflux(i,k)*vel<a name='270'>
        a_field(i,k,j) = a_field(i,k,j)+0.61666667*a_vflux(i,k)*vel<a name='271'>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(field(i,k,j)+field(i,k-1,j))-0.13333333*(field(i,k+1,j)+field(i,k-2,j))+&amp;<a name='272'>
&amp;0.016666667*(field(i,k+2,j)+field(i,k-3,j)))<a name='273'>
        a_vflux(i,k) = 0.<a name='274'>
        a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='275'>
        a_vel = 0.<a name='276'>
      end do<a name='277'>
    end do<a name='278'>
  end do<a name='279'>
else if (vert_order .eq. 5) then a_vert_order_test<a name='280'>
  do j = j_end, j_start, -1<a name='281'>
    do k = kts, ktf<a name='282'>
      do i = i_start, i_end<a name='283'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='284'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='285'>
      end do<a name='286'>
    end do<a name='287'>
    do i = i_start, i_end<a name='288'>
      a_vel = 0.<a name='289'>
      k = ktf-1<a name='290'>
<font color=#447700>! recompute : k<a name='291'></font>
      vel = rom(i,k,j)<a name='292'>
<font color=#447700>! recompute : vel<a name='293'></font>
      k = ktf<a name='294'>
<font color=#447700>! recompute : k<a name='295'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='296'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='297'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='298'>
      a_vflux(i,k) = 0.<a name='299'>
<font color=#447700>! recdepend vars : ktf<a name='300'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3769<a name='301'></font>
<font color=#447700>! recompute vars : k<a name='302'></font>
      k = ktf-1<a name='303'>
<font color=#447700>! recompute vars : k<a name='304'></font>
      a_field(i,k-2,j) = a_field(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='305'>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='306'>
      a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='307'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='308'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(field(i,k,j)+field(i,k-1,j))-0.083333333*(field(i,k+1,j)+field(i,k-2,j))+0.083333333*&amp;<a name='309'>
&amp;(field(i,k+1,j)-field(i,k-2,j)-3.*(field(i,k,j)-field(i,k-1,j)))*sign(1.,-vel))<a name='310'>
      a_vflux(i,k) = 0.<a name='311'>
<font color=#447700>! recdepend vars : ktf<a name='312'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3769<a name='313'></font>
<font color=#447700>! recompute vars : k<a name='314'></font>
      k = ktf-1<a name='315'>
<font color=#447700>! recompute vars : k<a name='316'></font>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='317'>
      a_vel = 0.<a name='318'>
<font color=#447700>! recdepend vars : kts<a name='319'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3764<a name='320'></font>
<font color=#447700>! recompute vars : k<a name='321'></font>
      k = kts+2<a name='322'>
<font color=#447700>! recompute vars : k<a name='323'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='324'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3765<a name='325'></font>
<font color=#447700>! recompute vars : vel<a name='326'></font>
      vel = rom(i,k,j)<a name='327'>
<font color=#447700>! recompute vars : vel<a name='328'></font>
      a_field(i,k-2,j) = a_field(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='329'>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='330'>
      a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='331'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='332'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(field(i,k,j)+field(i,k-1,j))-0.083333333*(field(i,k+1,j)+field(i,k-2,j))+0.083333333*&amp;<a name='333'>
&amp;(field(i,k+1,j)-field(i,k-2,j)-3.*(field(i,k,j)-field(i,k-1,j)))*sign(1.,-vel))<a name='334'>
      a_vflux(i,k) = 0.<a name='335'>
<font color=#447700>! recdepend vars : kts<a name='336'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3764<a name='337'></font>
<font color=#447700>! recompute vars : k<a name='338'></font>
      k = kts+2<a name='339'>
<font color=#447700>! recompute vars : k<a name='340'></font>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='341'>
      a_vel = 0.<a name='342'>
<font color=#447700>! recdepend vars : kts<a name='343'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3761<a name='344'></font>
<font color=#447700>! recompute vars : k<a name='345'></font>
      k = kts+1<a name='346'>
<font color=#447700>! recompute vars : k<a name='347'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='348'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='349'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='350'>
      a_vflux(i,k) = 0.<a name='351'>
    end do<a name='352'>
    do k = kts+3, ktf-2<a name='353'>
      a_vel = 0.<a name='354'>
      do i = i_start, i_end<a name='355'>
        a_vel = 0.<a name='356'>
        vel = rom(i,k,j)<a name='357'>
<font color=#447700>! recompute : vel<a name='358'></font>
        a_field(i,k-3,j) = a_field(i,k-3,j)+a_vflux(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,-vel))<a name='359'>
        a_field(i,k-2,j) = a_field(i,k-2,j)+a_vflux(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,-vel))<a name='360'>
        a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,-vel))<a name='361'>
        a_field(i,k+2,j) = a_field(i,k+2,j)+a_vflux(i,k)*vel*(0.016666667-0.016666667*sign(1.,-vel))<a name='362'>
        a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,-vel))<a name='363'>
        a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*vel*(0.61666667-0.16666667*sign(1.,-vel))<a name='364'>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(field(i,k,j)+field(i,k-1,j))-0.13333333*(field(i,k+1,j)+field(i,k-2,j))+&amp;<a name='365'>
&amp;0.016666667*(field(i,k+2,j)+field(i,k-3,j))-0.016666667*(field(i,k+2,j)-field(i,k-3,j)-5.*(field(i,k+1,j)-field(i,k-2,j))+&amp;<a name='366'>
&amp;10.*(field(i,k,j)-field(i,k-1,j)))*sign(1.,-vel))<a name='367'>
        a_vflux(i,k) = 0.<a name='368'>
        a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='369'>
        a_vel = 0.<a name='370'>
      end do<a name='371'>
    end do<a name='372'>
  end do<a name='373'>
else if (vert_order .eq. 4) then a_vert_order_test<a name='374'>
  do j = j_end, j_start, -1<a name='375'>
    do k = kts, ktf<a name='376'>
      do i = i_start, i_end<a name='377'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='378'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='379'>
      end do<a name='380'>
    end do<a name='381'>
    do i = i_start, i_end<a name='382'>
      k = ktf<a name='383'>
<font color=#447700>! recompute : k<a name='384'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='385'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='386'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='387'>
      a_vflux(i,k) = 0.<a name='388'>
<font color=#447700>! recdepend vars : kts<a name='389'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3802<a name='390'></font>
<font color=#447700>! recompute vars : k<a name='391'></font>
      k = kts+1<a name='392'>
<font color=#447700>! recompute vars : k<a name='393'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='394'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='395'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='396'>
      a_vflux(i,k) = 0.<a name='397'>
    end do<a name='398'>
    do k = kts+2, ktf-1<a name='399'>
      a_vel = 0.<a name='400'>
      do i = i_start, i_end<a name='401'>
        a_vel = 0.<a name='402'>
        vel = rom(i,k,j)<a name='403'>
<font color=#447700>! recompute : vel<a name='404'></font>
        a_field(i,k-2,j) = a_field(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='405'>
        a_field(i,k-1,j) = a_field(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='406'>
        a_field(i,k+1,j) = a_field(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='407'>
        a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='408'>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(field(i,k,j)+field(i,k-1,j))-0.083333333*(field(i,k+1,j)+field(i,k-2,j)))<a name='409'>
        a_vflux(i,k) = 0.<a name='410'>
        a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='411'>
        a_vel = 0.<a name='412'>
      end do<a name='413'>
    end do<a name='414'>
  end do<a name='415'>
else if (vert_order .eq. 3) then a_vert_order_test<a name='416'>
  do j = j_end, j_start, -1<a name='417'>
    do k = kts, ktf<a name='418'>
      do i = i_start, i_end<a name='419'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='420'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='421'>
      end do<a name='422'>
    end do<a name='423'>
    do i = i_start, i_end<a name='424'>
      k = ktf<a name='425'>
<font color=#447700>! recompute : k<a name='426'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='427'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='428'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='429'>
      a_vflux(i,k) = 0.<a name='430'>
<font color=#447700>! recdepend vars : kts<a name='431'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3831<a name='432'></font>
<font color=#447700>! recompute vars : k<a name='433'></font>
      k = kts+1<a name='434'>
<font color=#447700>! recompute vars : k<a name='435'></font>
      a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='436'>
      a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='437'>
      a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='438'>
      a_vflux(i,k) = 0.<a name='439'>
    end do<a name='440'>
    do k = kts+2, ktf-1<a name='441'>
      a_vel = 0.<a name='442'>
      do i = i_start, i_end<a name='443'>
        a_vel = 0.<a name='444'>
        vel = rom(i,k,j)<a name='445'>
<font color=#447700>! recompute : vel<a name='446'></font>
        a_field(i,k-2,j) = a_field(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='447'>
        a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='448'>
        a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='449'>
        a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='450'>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(field(i,k,j)+field(i,k-1,j))-0.083333333*(field(i,k+1,j)+field(i,k-2,j))+&amp;<a name='451'>
&amp;0.083333333*(field(i,k+1,j)-field(i,k-2,j)-3.*(field(i,k,j)-field(i,k-1,j)))*sign(1.,-vel))<a name='452'>
        a_vflux(i,k) = 0.<a name='453'>
        a_rom(i,k,j) = a_rom(i,k,j)+a_vel<a name='454'>
        a_vel = 0.<a name='455'>
      end do<a name='456'>
    end do<a name='457'>
  end do<a name='458'>
else if (vert_order .eq. 2) then a_vert_order_test<a name='459'>
  do j = j_start, j_end<a name='460'>
    do k = kts, ktf<a name='461'>
      do i = i_start, i_end<a name='462'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='463'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='464'>
      end do<a name='465'>
    end do<a name='466'>
    do k = kts+1, ktf<a name='467'>
      do i = i_start, i_end<a name='468'>
        a_field(i,k-1,j) = a_field(i,k-1,j)+a_vflux(i,k)*rom(i,k,j)*fzp(k)<a name='469'>
        a_field(i,k,j) = a_field(i,k,j)+a_vflux(i,k)*rom(i,k,j)*fzm(k)<a name='470'>
        a_rom(i,k,j) = a_rom(i,k,j)+a_vflux(i,k)*(fzm(k)*field(i,k,j)+fzp(k)*field(i,k-1,j))<a name='471'>
        a_vflux(i,k) = 0.<a name='472'>
      end do<a name='473'>
    end do<a name='474'>
  end do<a name='475'>
endif a_vert_order_test<a name='476'>
<font color=#447700>! recdepend vars : its<a name='477'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3621<a name='478'></font>
<font color=#447700>! recompute vars : i_start<a name='479'></font>
i_start = its<a name='480'>
<font color=#447700>! recompute vars : i_start<a name='481'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='482'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3622<a name='483'></font>
<font color=#447700>! recompute vars : i_end<a name='484'></font>
i_end = min(ite,ide-1)<a name='485'>
<font color=#447700>! recompute vars : i_end<a name='486'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jde,jte<a name='487'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3624<a name='488'></font>
<font color=#447700>! recompute vars : j_end<a name='489'></font>
j_end = min(jte,jde-1)<a name='490'>
<font color=#447700>! recompute vars : j_end<a name='491'></font>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='492'>
  do i = i_start, i_end<a name='493'>
    a_vb = 0.<a name='494'>
    do k = kts, ktf<a name='495'>
      a_vb = 0.<a name='496'>
      vb = max(0.5*(rv(i,k,jte-1)+rv(i,k,jte)),0.)<a name='497'>
<font color=#447700>! recompute : vb<a name='498'></font>
      a_field(i,k,j_end) = a_field(i,k,j_end)-a_tendency(i,k,j_end)*rdy*(rv(i,k,jte)-rv(i,k,jte-1))<a name='499'>
      a_field_old(i,k,j_end-1) = a_field_old(i,k,j_end-1)+a_tendency(i,k,j_end)*rdy*vb<a name='500'>
      a_field_old(i,k,j_end) = a_field_old(i,k,j_end)-a_tendency(i,k,j_end)*rdy*vb<a name='501'>
      a_rv(i,k,jte-1) = a_rv(i,k,jte-1)+a_tendency(i,k,j_end)*rdy*field(i,k,j_end)<a name='502'>
      a_rv(i,k,jte) = a_rv(i,k,jte)-a_tendency(i,k,j_end)*rdy*field(i,k,j_end)<a name='503'>
      a_vb = a_vb-a_tendency(i,k,j_end)*rdy*(field_old(i,k,j_end)-field_old(i,k,j_end-1))<a name='504'>
      a_rv(i,k,jte-1) = a_rv(i,k,jte-1)+0.5*a_vb*(0.5+sign(0.5,0.5*(rv(i,k,jte-1)+rv(i,k,jte))-0.))<a name='505'>
      a_rv(i,k,jte) = a_rv(i,k,jte)+0.5*a_vb*(0.5+sign(0.5,0.5*(rv(i,k,jte-1)+rv(i,k,jte))-0.))<a name='506'>
      a_vb = 0.<a name='507'>
    end do<a name='508'>
  end do<a name='509'>
endif<a name='510'>
<font color=#447700>! recdepend vars : its<a name='511'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3621<a name='512'></font>
<font color=#447700>! recompute vars : i_start<a name='513'></font>
i_start = its<a name='514'>
<font color=#447700>! recompute vars : i_start<a name='515'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='516'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3622<a name='517'></font>
<font color=#447700>! recompute vars : i_end<a name='518'></font>
i_end = min(ite,ide-1)<a name='519'>
<font color=#447700>! recompute vars : i_end<a name='520'></font>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='521'>
  do i = i_start, i_end<a name='522'>
    a_vb = 0.<a name='523'>
    do k = kts, ktf<a name='524'>
      a_vb = 0.<a name='525'>
      vb = min(0.5*(rv(i,k,jts)+rv(i,k,jts+1)),0.)<a name='526'>
<font color=#447700>! recompute : vb<a name='527'></font>
      a_field(i,k,jts) = a_field(i,k,jts)-a_tendency(i,k,jts)*rdy*(rv(i,k,jts+1)-rv(i,k,jts))<a name='528'>
      a_field_old(i,k,jts+1) = a_field_old(i,k,jts+1)-a_tendency(i,k,jts)*rdy*vb<a name='529'>
      a_field_old(i,k,jts) = a_field_old(i,k,jts)+a_tendency(i,k,jts)*rdy*vb<a name='530'>
      a_rv(i,k,jts+1) = a_rv(i,k,jts+1)-a_tendency(i,k,jts)*rdy*field(i,k,jts)<a name='531'>
      a_rv(i,k,jts) = a_rv(i,k,jts)+a_tendency(i,k,jts)*rdy*field(i,k,jts)<a name='532'>
      a_vb = a_vb-a_tendency(i,k,jts)*rdy*(field_old(i,k,jts+1)-field_old(i,k,jts))<a name='533'>
      a_rv(i,k,jts+1) = a_rv(i,k,jts+1)+0.5*a_vb*(0.5+sign(0.5,0.-0.5*(rv(i,k,jts)+rv(i,k,jts+1))))<a name='534'>
      a_rv(i,k,jts) = a_rv(i,k,jts)+0.5*a_vb*(0.5+sign(0.5,0.-0.5*(rv(i,k,jts)+rv(i,k,jts+1))))<a name='535'>
      a_vb = 0.<a name='536'>
    end do<a name='537'>
  end do<a name='538'>
endif<a name='539'>
<font color=#447700>! recdepend vars : ide,ite<a name='540'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3622<a name='541'></font>
<font color=#447700>! recompute vars : i_end<a name='542'></font>
i_end = min(ite,ide-1)<a name='543'>
<font color=#447700>! recompute vars : i_end<a name='544'></font>
<font color=#447700>! recdepend vars : i_end,jts<a name='545'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3623<a name='546'></font>
<font color=#447700>! recompute vars : j_start<a name='547'></font>
j_start = jts<a name='548'>
<font color=#447700>! recompute vars : j_start<a name='549'></font>
<font color=#447700>! recdepend vars : i_end,j_start,jde,jte<a name='550'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3624<a name='551'></font>
<font color=#447700>! recompute vars : j_end<a name='552'></font>
j_end = min(jte,jde-1)<a name='553'>
<font color=#447700>! recompute vars : j_end<a name='554'></font>
if (config_flags%open_xe .and. ite .eq. ide) then<a name='555'>
  do j = j_start, j_end<a name='556'>
    a_ub = 0.<a name='557'>
    do k = kts, ktf<a name='558'>
      a_ub = 0.<a name='559'>
      ub = max(0.5*(ru(ite-1,k,j)+ru(ite,k,j)),0.)<a name='560'>
<font color=#447700>! recompute : ub<a name='561'></font>
      a_field(i_end,k,j) = a_field(i_end,k,j)-a_tendency(i_end,k,j)*rdx*(ru(ite,k,j)-ru(ite-1,k,j))<a name='562'>
      a_field_old(i_end-1,k,j) = a_field_old(i_end-1,k,j)+a_tendency(i_end,k,j)*rdx*ub<a name='563'>
      a_field_old(i_end,k,j) = a_field_old(i_end,k,j)-a_tendency(i_end,k,j)*rdx*ub<a name='564'>
      a_ru(ite-1,k,j) = a_ru(ite-1,k,j)+a_tendency(i_end,k,j)*rdx*field(i_end,k,j)<a name='565'>
      a_ru(ite,k,j) = a_ru(ite,k,j)-a_tendency(i_end,k,j)*rdx*field(i_end,k,j)<a name='566'>
      a_ub = a_ub-a_tendency(i_end,k,j)*rdx*(field_old(i_end,k,j)-field_old(i_end-1,k,j))<a name='567'>
      a_ru(ite-1,k,j) = a_ru(ite-1,k,j)+0.5*a_ub*(0.5+sign(0.5,0.5*(ru(ite-1,k,j)+ru(ite,k,j))-0.))<a name='568'>
      a_ru(ite,k,j) = a_ru(ite,k,j)+0.5*a_ub*(0.5+sign(0.5,0.5*(ru(ite-1,k,j)+ru(ite,k,j))-0.))<a name='569'>
      a_ub = 0.<a name='570'>
    end do<a name='571'>
  end do<a name='572'>
endif<a name='573'>
<font color=#447700>! recdepend vars : jts<a name='574'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3623<a name='575'></font>
<font color=#447700>! recompute vars : j_start<a name='576'></font>
j_start = jts<a name='577'>
<font color=#447700>! recompute vars : j_start<a name='578'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='579'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3624<a name='580'></font>
<font color=#447700>! recompute vars : j_end<a name='581'></font>
j_end = min(jte,jde-1)<a name='582'>
<font color=#447700>! recompute vars : j_end<a name='583'></font>
if (config_flags%open_xs .and. its .eq. ids) then<a name='584'>
  do j = j_start, j_end<a name='585'>
    a_ub = 0.<a name='586'>
    do k = kts, ktf<a name='587'>
      a_ub = 0.<a name='588'>
      ub = min(0.5*(ru(its,k,j)+ru(its+1,k,j)),0.)<a name='589'>
<font color=#447700>! recompute : ub<a name='590'></font>
      a_field(its,k,j) = a_field(its,k,j)-a_tendency(its,k,j)*rdx*(ru(its+1,k,j)-ru(its,k,j))<a name='591'>
      a_field_old(its+1,k,j) = a_field_old(its+1,k,j)-a_tendency(its,k,j)*rdx*ub<a name='592'>
      a_field_old(its,k,j) = a_field_old(its,k,j)+a_tendency(its,k,j)*rdx*ub<a name='593'>
      a_ru(its+1,k,j) = a_ru(its+1,k,j)-a_tendency(its,k,j)*rdx*field(its,k,j)<a name='594'>
      a_ru(its,k,j) = a_ru(its,k,j)+a_tendency(its,k,j)*rdx*field(its,k,j)<a name='595'>
      a_ub = a_ub-a_tendency(its,k,j)*rdx*(field_old(its+1,k,j)-field_old(its,k,j))<a name='596'>
      a_ru(its+1,k,j) = a_ru(its+1,k,j)+0.5*a_ub*(0.5+sign(0.5,0.-0.5*(ru(its,k,j)+ru(its+1,k,j))))<a name='597'>
      a_ru(its,k,j) = a_ru(its,k,j)+0.5*a_ub*(0.5+sign(0.5,0.-0.5*(ru(its,k,j)+ru(its+1,k,j))))<a name='598'>
      a_ub = 0.<a name='599'>
    end do<a name='600'>
  end do<a name='601'>
endif<a name='602'>
<font color=#447700>! recdepend vars : kde,kte<a name='603'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2795<a name='604'></font>
<font color=#447700>! recompute vars : ktf<a name='605'></font>
ktf = min(kte,kde-1)<a name='606'>
<font color=#447700>! recompute vars : ktf<a name='607'></font>
a_horizontal_order_test: if (horz_order .eq. 6) then<a name='608'>
  degrade_xs =  .true. <a name='609'>
<font color=#447700>! recompute : degrade_xs<a name='610'></font>
  degrade_xe =  .true. <a name='611'>
<font color=#447700>! recompute : degrade_xe<a name='612'></font>
  degrade_ys =  .true. <a name='613'>
<font color=#447700>! recompute : degrade_ys<a name='614'></font>
  degrade_ye =  .true. <a name='615'>
<font color=#447700>! recompute : degrade_ye<a name='616'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='617'>
    degrade_xs =  .false. <a name='618'>
  endif<a name='619'>
<font color=#447700>! recompute : degrade_xs<a name='620'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-3) then<a name='621'>
    degrade_xe =  .false. <a name='622'>
  endif<a name='623'>
<font color=#447700>! recompute : degrade_xe<a name='624'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='625'>
    degrade_ys =  .false. <a name='626'>
  endif<a name='627'>
<font color=#447700>! recompute : degrade_ys<a name='628'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-3) then<a name='629'>
    degrade_ye =  .false. <a name='630'>
  endif<a name='631'>
<font color=#447700>! recompute : degrade_ye<a name='632'></font>
<font color=#447700>! recompute : ktf<a name='633'></font>
  j_start = jts<a name='634'>
<font color=#447700>! recompute : j_start<a name='635'></font>
  j_end = min(jte,jde-1)<a name='636'>
<font color=#447700>! recompute : j_end<a name='637'></font>
  j_start_f = j_start<a name='638'>
<font color=#447700>! recompute : j_start_f<a name='639'></font>
  j_end_f = j_end+1<a name='640'>
<font color=#447700>! recompute : j_end_f<a name='641'></font>
  if (degrade_ys) then<a name='642'>
    j_start_f = jds+3<a name='643'>
  endif<a name='644'>
<font color=#447700>! recompute : j_start_f<a name='645'></font>
  if (degrade_ye) then<a name='646'>
    j_end_f = jde-3<a name='647'>
  endif<a name='648'>
<font color=#447700>! recompute : j_end_f<a name='649'></font>
  i_start = its<a name='650'>
<font color=#447700>! recompute : i_start<a name='651'></font>
  i_end = min(ite,ide-1)<a name='652'>
<font color=#447700>! recompute : i_end<a name='653'></font>
  j_start = jts<a name='654'>
<font color=#447700>! recompute : j_start<a name='655'></font>
  j_end = min(jte,jde-1)<a name='656'>
<font color=#447700>! recompute : j_end<a name='657'></font>
  i_start_f = i_start<a name='658'>
<font color=#447700>! recompute : i_start_f<a name='659'></font>
  i_end_f = i_end+1<a name='660'>
<font color=#447700>! recompute : i_end_f<a name='661'></font>
  if (degrade_xs) then<a name='662'>
    i_start = max(ids+1,its)<a name='663'>
    i_start_f = i_start+2<a name='664'>
  endif<a name='665'>
<font color=#447700>! recompute : i_start,i_start_f<a name='666'></font>
  if (degrade_xe) then<a name='667'>
    i_end = min(ide-2,ite)<a name='668'>
    i_end_f = ide-3<a name='669'>
  endif<a name='670'>
<font color=#447700>! recompute : i_end,i_end_f<a name='671'></font>
  do j = j_end, j_start, -1<a name='672'>
    do k = kts, ktf<a name='673'>
      do i = i_start, i_end<a name='674'>
        mrdx = msft(i,j)*rdx<a name='675'>
<font color=#447700>! recompute : mrdx<a name='676'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='677'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='678'>
      end do<a name='679'>
    end do<a name='680'>
    if (degrade_xe) then<a name='681'>
      i = ide-2<a name='682'>
<font color=#447700>! recompute : i<a name='683'></font>
      do k = kts, ktf<a name='684'>
        a_vel = 0.<a name='685'>
        vel = ru(i,k,j)<a name='686'>
<font color=#447700>! recompute : vel<a name='687'></font>
        a_field(i-2,k,j) = a_field(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='688'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='689'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='690'>
        a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='691'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(field(i,k,j)+field(i-1,k,j))-0.083333333*(field(i+1,k,j)+field(i-2,k,j)))<a name='692'>
        a_fqx(i,k) = 0.<a name='693'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel<a name='694'>
        a_vel = 0.<a name='695'>
      end do<a name='696'>
      if (i_end .eq. ide-2) then<a name='697'>
        i = ide-1<a name='698'>
<font color=#447700>! recompute : i<a name='699'></font>
        do k = kts, ktf<a name='700'>
          a_field(i-1,k,j) = a_field(i-1,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='701'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='702'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*(field(i,k,j)+field(i-1,k,j))<a name='703'>
          a_fqx(i,k) = 0.<a name='704'>
        end do<a name='705'>
      endif<a name='706'>
    endif<a name='707'>
    if (degrade_xs) then<a name='708'>
      i = ids+2<a name='709'>
<font color=#447700>! recompute : i<a name='710'></font>
      do k = kts, ktf<a name='711'>
        a_vel = 0.<a name='712'>
        vel = ru(i,k,j)<a name='713'>
<font color=#447700>! recompute : vel<a name='714'></font>
        a_field(i-2,k,j) = a_field(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='715'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='716'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='717'>
        a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='718'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(field(i,k,j)+field(i-1,k,j))-0.083333333*(field(i+1,k,j)+field(i-2,k,j)))<a name='719'>
        a_fqx(i,k) = 0.<a name='720'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel<a name='721'>
        a_vel = 0.<a name='722'>
      end do<a name='723'>
      if (i_start .eq. ids+1) then<a name='724'>
        i = ids+1<a name='725'>
<font color=#447700>! recompute : i<a name='726'></font>
        do k = kts, ktf<a name='727'>
          a_field(i-1,k,j) = a_field(i-1,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='728'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='729'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*(field(i,k,j)+field(i-1,k,j))<a name='730'>
          a_fqx(i,k) = 0.<a name='731'>
        end do<a name='732'>
      endif<a name='733'>
    endif<a name='734'>
    do k = kts, ktf<a name='735'>
      a_vel = 0.<a name='736'>
      do i = i_start_f, i_end_f<a name='737'>
        a_vel = 0.<a name='738'>
        vel = ru(i,k,j)<a name='739'>
<font color=#447700>! recompute : vel<a name='740'></font>
        a_field(i-3,k,j) = a_field(i-3,k,j)+0.016666667*a_fqx(i,k)*vel<a name='741'>
        a_field(i-2,k,j) = a_field(i-2,k,j)-0.13333333*a_fqx(i,k)*vel<a name='742'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+0.61666667*a_fqx(i,k)*vel<a name='743'>
        a_field(i+2,k,j) = a_field(i+2,k,j)+0.016666667*a_fqx(i,k)*vel<a name='744'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-0.13333333*a_fqx(i,k)*vel<a name='745'>
        a_field(i,k,j) = a_field(i,k,j)+0.61666667*a_fqx(i,k)*vel<a name='746'>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(field(i,k,j)+field(i-1,k,j))-0.13333333*(field(i+1,k,j)+field(i-2,k,j))+0.016666667*&amp;<a name='747'>
&amp;(field(i+2,k,j)+field(i-3,k,j)))<a name='748'>
        a_fqx(i,k) = 0.<a name='749'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel<a name='750'>
        a_vel = 0.<a name='751'>
      end do<a name='752'>
    end do<a name='753'>
  end do<a name='754'>
<font color=#447700>! recdepend vars : its<a name='755'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2833<a name='756'></font>
<font color=#447700>! recompute vars : i_start<a name='757'></font>
  i_start = its<a name='758'>
<font color=#447700>! recompute vars : i_start<a name='759'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='760'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2834<a name='761'></font>
<font color=#447700>! recompute vars : i_end<a name='762'></font>
  i_end = min(ite,ide-1)<a name='763'>
<font color=#447700>! recompute vars : i_end<a name='764'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='765'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2835<a name='766'></font>
<font color=#447700>! recompute vars : j_start<a name='767'></font>
  j_start = jts<a name='768'>
<font color=#447700>! recompute vars : j_start<a name='769'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='770'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2836<a name='771'></font>
<font color=#447700>! recompute vars : j_end<a name='772'></font>
  j_end = min(jte,jde-1)<a name='773'>
<font color=#447700>! recompute vars : j_end<a name='774'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='775'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2844<a name='776'></font>
<font color=#447700>! recompute vars : j_start<a name='777'></font>
  if (degrade_ys) then<a name='778'>
    j_start = max(jts,jds+1)<a name='779'>
  endif<a name='780'>
<font color=#447700>! recompute vars : j_start<a name='781'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='782'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2849<a name='783'></font>
<font color=#447700>! recompute vars : j_end<a name='784'></font>
  if (degrade_ye) then<a name='785'>
    j_end = min(jte,jde-2)<a name='786'>
  endif<a name='787'>
<font color=#447700>! recompute vars : j_end<a name='788'></font>
  a_j_loop_y_flux_6: do j = j_end+1, j_start, -1<a name='789'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2856<a name='790'></font>
<font color=#447700>! recompute vars : jp1<a name='791'></font>
    jp1 = 2<a name='792'>
<font color=#447700>! recompute vars : jp1<a name='793'></font>
<font color=#447700>! recdepend vars : jp1<a name='794'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2857<a name='795'></font>
<font color=#447700>! recompute vars : jp0<a name='796'></font>
    jp0 = 1<a name='797'>
<font color=#447700>! recompute vars : jp0<a name='798'></font>
    j_loop_y_flux_9c: do j4 = j_start, j-1<a name='799'>
      jtmp = jp1<a name='800'>
      jp1 = jp0<a name='801'>
      jp0 = jtmp<a name='802'>
    end do j_loop_y_flux_9c<a name='803'>
<font color=#447700>!    if (j .gt. j_start) then<a name='804'></font>
    if (j .gt. jds+1) then<a name='805'>
      do k = kts, ktf<a name='806'>
        do i = i_start, i_end<a name='807'>
          mrdy = msft(i,j-1)*rdy<a name='808'>
<font color=#447700>! recompute : mrdy<a name='809'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='810'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='811'>
        end do<a name='812'>
      end do<a name='813'>
    endif<a name='814'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='815'>
      do k = kts, ktf<a name='816'>
        a_vel = 0.<a name='817'>
        do i = i_start, i_end<a name='818'>
          a_vel = 0.<a name='819'>
          vel = rv(i,k,j)<a name='820'>
<font color=#447700>! recompute : vel<a name='821'></font>
          a_field(i,k,j-3) = a_field(i,k,j-3)+0.016666667*a_fqy(i,k,jp1)*vel<a name='822'>
          a_field(i,k,j-2) = a_field(i,k,j-2)-0.13333333*a_fqy(i,k,jp1)*vel<a name='823'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.61666667*a_fqy(i,k,jp1)*vel<a name='824'>
          a_field(i,k,j+2) = a_field(i,k,j+2)+0.016666667*a_fqy(i,k,jp1)*vel<a name='825'>
          a_field(i,k,j+1) = a_field(i,k,j+1)-0.13333333*a_fqy(i,k,jp1)*vel<a name='826'>
          a_field(i,k,j) = a_field(i,k,j)+0.61666667*a_fqy(i,k,jp1)*vel<a name='827'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(field(i,k,j)+field(i,k,j-1))-0.13333333*(field(i,k,j+1)+field(i,k,j-2))+&amp;<a name='828'>
&amp;0.016666667*(field(i,k,j+2)+field(i,k,j-3)))<a name='829'>
          a_fqy(i,k,jp1) = 0.<a name='830'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel<a name='831'>
          a_vel = 0.<a name='832'>
        end do<a name='833'>
      end do<a name='834'>
    else if (j .eq. jds+1) then<a name='835'>
      do k = kts, ktf<a name='836'>
        do i = i_start, i_end<a name='837'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='838'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='839'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*(field(i,k,j)+field(i,k,j-1))<a name='840'>
          a_fqy(i,k,jp1) = 0.<a name='841'>
        end do<a name='842'>
      end do<a name='843'>
    else if (j .eq. jds+2) then<a name='844'>
      do k = kts, ktf<a name='845'>
        a_vel = 0.<a name='846'>
        do i = i_start, i_end<a name='847'>
          a_vel = 0.<a name='848'>
          vel = rv(i,k,j)<a name='849'>
<font color=#447700>! recompute : vel<a name='850'></font>
          a_field(i,k,j-2) = a_field(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='851'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='852'>
          a_field(i,k,j+1) = a_field(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='853'>
          a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='854'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(field(i,k,j)+field(i,k,j-1))-0.083333333*(field(i,k,j+1)+field(i,k,j-2)))<a name='855'>
          a_fqy(i,k,jp1) = 0.<a name='856'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel<a name='857'>
          a_vel = 0.<a name='858'>
        end do<a name='859'>
      end do<a name='860'>
    else if (j .eq. jde-1) then<a name='861'>
      do k = kts, ktf<a name='862'>
        do i = i_start, i_end<a name='863'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='864'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='865'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*(field(i,k,j)+field(i,k,j-1))<a name='866'>
          a_fqy(i,k,jp1) = 0.<a name='867'>
        end do<a name='868'>
      end do<a name='869'>
    else if (j .eq. jde-2) then<a name='870'>
      do k = kts, ktf<a name='871'>
        a_vel = 0.<a name='872'>
        do i = i_start, i_end<a name='873'>
          a_vel = 0.<a name='874'>
          vel = rv(i,k,j)<a name='875'>
<font color=#447700>! recompute : vel<a name='876'></font>
          a_field(i,k,j-2) = a_field(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='877'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='878'>
          a_field(i,k,j+1) = a_field(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='879'>
          a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='880'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(field(i,k,j)+field(i,k,j-1))-0.083333333*(field(i,k,j+1)+field(i,k,j-2)))<a name='881'>
          a_fqy(i,k,jp1) = 0.<a name='882'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel<a name='883'>
          a_vel = 0.<a name='884'>
        end do<a name='885'>
      end do<a name='886'>
    endif<a name='887'>
  end do a_j_loop_y_flux_6<a name='888'>
else if (horz_order .eq. 5) then a_horizontal_order_test<a name='889'>
  degrade_xs =  .true. <a name='890'>
<font color=#447700>! recompute : degrade_xs<a name='891'></font>
  degrade_xe =  .true. <a name='892'>
<font color=#447700>! recompute : degrade_xe<a name='893'></font>
  degrade_ys =  .true. <a name='894'>
<font color=#447700>! recompute : degrade_ys<a name='895'></font>
  degrade_ye =  .true. <a name='896'>
<font color=#447700>! recompute : degrade_ye<a name='897'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='898'>
    degrade_xs =  .false. <a name='899'>
  endif<a name='900'>
<font color=#447700>! recompute : degrade_xs<a name='901'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-3) then<a name='902'>
    degrade_xe =  .false. <a name='903'>
  endif<a name='904'>
<font color=#447700>! recompute : degrade_xe<a name='905'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='906'>
    degrade_ys =  .false. <a name='907'>
  endif<a name='908'>
<font color=#447700>! recompute : degrade_ys<a name='909'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-3) then<a name='910'>
    degrade_ye =  .false. <a name='911'>
  endif<a name='912'>
<font color=#447700>! recompute : degrade_ye<a name='913'></font>
<font color=#447700>! recompute : ktf<a name='914'></font>
  j_start = jts<a name='915'>
<font color=#447700>! recompute : j_start<a name='916'></font>
  j_end = min(jte,jde-1)<a name='917'>
<font color=#447700>! recompute : j_end<a name='918'></font>
  j_start_f = j_start<a name='919'>
<font color=#447700>! recompute : j_start_f<a name='920'></font>
  j_end_f = j_end+1<a name='921'>
<font color=#447700>! recompute : j_end_f<a name='922'></font>
  if (degrade_ys) then<a name='923'>
    j_start_f = jds+3<a name='924'>
  endif<a name='925'>
<font color=#447700>! recompute : j_start_f<a name='926'></font>
  if (degrade_ye) then<a name='927'>
    j_end_f = jde-3<a name='928'>
  endif<a name='929'>
<font color=#447700>! recompute : j_end_f<a name='930'></font>
  i_start = its<a name='931'>
<font color=#447700>! recompute : i_start<a name='932'></font>
  i_end = min(ite,ide-1)<a name='933'>
<font color=#447700>! recompute : i_end<a name='934'></font>
  j_start = jts<a name='935'>
<font color=#447700>! recompute : j_start<a name='936'></font>
  j_end = min(jte,jde-1)<a name='937'>
<font color=#447700>! recompute : j_end<a name='938'></font>
  i_start_f = i_start<a name='939'>
<font color=#447700>! recompute : i_start_f<a name='940'></font>
  i_end_f = i_end+1<a name='941'>
<font color=#447700>! recompute : i_end_f<a name='942'></font>
  if (degrade_xs) then<a name='943'>
    i_start = max(ids+1,its)<a name='944'>
    i_start_f = i_start+2<a name='945'>
  endif<a name='946'>
<font color=#447700>! recompute : i_start,i_start_f<a name='947'></font>
  if (degrade_xe) then<a name='948'>
    i_end = min(ide-2,ite)<a name='949'>
    i_end_f = ide-3<a name='950'>
  endif<a name='951'>
<font color=#447700>! recompute : i_end,i_end_f<a name='952'></font>
  do j = j_end, j_start, -1<a name='953'>
    do k = kts, ktf<a name='954'>
      do i = i_start, i_end<a name='955'>
        mrdx = msft(i,j)*rdx<a name='956'>
<font color=#447700>! recompute : mrdx<a name='957'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='958'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='959'>
      end do<a name='960'>
    end do<a name='961'>
    if (degrade_xe) then<a name='962'>
      i = ide-2<a name='963'>
<font color=#447700>! recompute : i<a name='964'></font>
      do k = kts, ktf<a name='965'>
        a_vel = 0.<a name='966'>
        vel = ru(i,k,j)<a name='967'>
<font color=#447700>! recompute : vel<a name='968'></font>
        a_field(i-2,k,j) = a_field(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='969'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='970'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='971'>
        a_field(i,k,j) = a_field(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='972'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(field(i,k,j)+field(i-1,k,j))-0.083333333*(field(i+1,k,j)+field(i-2,k,j))+0.083333333*&amp;<a name='973'>
&amp;(field(i+1,k,j)-field(i-2,k,j)-3.*(field(i,k,j)-field(i-1,k,j)))*sign(1.,vel))<a name='974'>
        a_fqx(i,k) = 0.<a name='975'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel<a name='976'>
        a_vel = 0.<a name='977'>
      end do<a name='978'>
      if (i_end .eq. ide-2) then<a name='979'>
        i = ide-1<a name='980'>
<font color=#447700>! recompute : i<a name='981'></font>
        do k = kts, ktf<a name='982'>
          a_field(i-1,k,j) = a_field(i-1,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='983'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='984'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*(field(i,k,j)+field(i-1,k,j))<a name='985'>
          a_fqx(i,k) = 0.<a name='986'>
        end do<a name='987'>
      endif<a name='988'>
    endif<a name='989'>
    if (degrade_xs) then<a name='990'>
      i = ids+2<a name='991'>
<font color=#447700>! recompute : i<a name='992'></font>
      do k = kts, ktf<a name='993'>
        a_vel = 0.<a name='994'>
        vel = ru(i,k,j)<a name='995'>
<font color=#447700>! recompute : vel<a name='996'></font>
        a_field(i-2,k,j) = a_field(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='997'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='998'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='999'>
        a_field(i,k,j) = a_field(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='1000'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(field(i,k,j)+field(i-1,k,j))-0.083333333*(field(i+1,k,j)+field(i-2,k,j))+0.083333333*&amp;<a name='1001'>
&amp;(field(i+1,k,j)-field(i-2,k,j)-3.*(field(i,k,j)-field(i-1,k,j)))*sign(1.,vel))<a name='1002'>
        a_fqx(i,k) = 0.<a name='1003'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel<a name='1004'>
        a_vel = 0.<a name='1005'>
      end do<a name='1006'>
      if (i_start .eq. ids+1) then<a name='1007'>
        i = ids+1<a name='1008'>
<font color=#447700>! recompute : i<a name='1009'></font>
        do k = kts, ktf<a name='1010'>
          a_field(i-1,k,j) = a_field(i-1,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='1011'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqx(i,k)*ru(i,k,j)<a name='1012'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*(field(i,k,j)+field(i-1,k,j))<a name='1013'>
          a_fqx(i,k) = 0.<a name='1014'>
        end do<a name='1015'>
      endif<a name='1016'>
    endif<a name='1017'>
    do k = kts, ktf<a name='1018'>
      a_vel = 0.<a name='1019'>
      do i = i_start_f, i_end_f<a name='1020'>
        a_vel = 0.<a name='1021'>
        vel = ru(i,k,j)<a name='1022'>
<font color=#447700>! recompute : vel<a name='1023'></font>
        a_field(i-3,k,j) = a_field(i-3,k,j)+a_fqx(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='1024'>
        a_field(i-2,k,j) = a_field(i-2,k,j)+a_fqx(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='1025'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_fqx(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='1026'>
        a_field(i+2,k,j) = a_field(i+2,k,j)+a_fqx(i,k)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='1027'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_fqx(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='1028'>
        a_field(i,k,j) = a_field(i,k,j)+a_fqx(i,k)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='1029'>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(field(i,k,j)+field(i-1,k,j))-0.13333333*(field(i+1,k,j)+field(i-2,k,j))+0.016666667*&amp;<a name='1030'>
&amp;(field(i+2,k,j)+field(i-3,k,j))-0.016666667*(field(i+2,k,j)-field(i-3,k,j)-5.*(field(i+1,k,j)-field(i-2,k,j))+10.*&amp;<a name='1031'>
&amp;(field(i,k,j)-field(i-1,k,j)))*sign(1.,vel))<a name='1032'>
        a_fqx(i,k) = 0.<a name='1033'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel<a name='1034'>
        a_vel = 0.<a name='1035'>
      end do<a name='1036'>
    end do<a name='1037'>
  end do<a name='1038'>
<font color=#447700>! recdepend vars : its<a name='1039'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3057<a name='1040'></font>
<font color=#447700>! recompute vars : i_start<a name='1041'></font>
  i_start = its<a name='1042'>
<font color=#447700>! recompute vars : i_start<a name='1043'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='1044'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3058<a name='1045'></font>
<font color=#447700>! recompute vars : i_end<a name='1046'></font>
  i_end = min(ite,ide-1)<a name='1047'>
<font color=#447700>! recompute vars : i_end<a name='1048'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='1049'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3059<a name='1050'></font>
<font color=#447700>! recompute vars : j_start<a name='1051'></font>
  j_start = jts<a name='1052'>
<font color=#447700>! recompute vars : j_start<a name='1053'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='1054'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3060<a name='1055'></font>
<font color=#447700>! recompute vars : j_end<a name='1056'></font>
  j_end = min(jte,jde-1)<a name='1057'>
<font color=#447700>! recompute vars : j_end<a name='1058'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='1059'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3068<a name='1060'></font>
<font color=#447700>! recompute vars : j_start<a name='1061'></font>
  if (degrade_ys) then<a name='1062'>
    j_start = max(jts,jds+1)<a name='1063'>
  endif<a name='1064'>
<font color=#447700>! recompute vars : j_start<a name='1065'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='1066'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3073<a name='1067'></font>
<font color=#447700>! recompute vars : j_end<a name='1068'></font>
  if (degrade_ye) then<a name='1069'>
    j_end = min(jte,jde-2)<a name='1070'>
  endif<a name='1071'>
<font color=#447700>! recompute vars : j_end<a name='1072'></font>
<a name='1073'>
  a_j_loop_y_flux_5: do j = j_end+1, j_start, -1<a name='1074'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3080<a name='1075'></font>
<font color=#447700>! recompute vars : jp1<a name='1076'></font>
    jp1 = 2<a name='1077'>
<font color=#447700>! recompute vars : jp1<a name='1078'></font>
<font color=#447700>! recdepend vars : jp1<a name='1079'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3081<a name='1080'></font>
<font color=#447700>! recompute vars : jp0<a name='1081'></font>
    jp0 = 1<a name='1082'>
<font color=#447700>! recompute vars : jp0<a name='1083'></font>
    j_loop_y_flux_9a: do j1 = j_start, j-1<a name='1084'>
      jtmp = jp1<a name='1085'>
      jp1 = jp0<a name='1086'>
      jp0 = jtmp<a name='1087'>
    end do j_loop_y_flux_9a<a name='1088'>
<font color=#447700>!    if (j .gt. j_start) then<a name='1089'></font>
    if (j .gt. jds+1) then<a name='1090'>
      do k = kts, ktf<a name='1091'>
        do i = i_start, i_end<a name='1092'>
          mrdy = msft(i,j-1)*rdy<a name='1093'>
<font color=#447700>! recompute : mrdy<a name='1094'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='1095'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='1096'>
        end do<a name='1097'>
      end do<a name='1098'>
    endif<a name='1099'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='1100'>
      do k = kts, ktf<a name='1101'>
        a_vel = 0.<a name='1102'>
        do i = i_start, i_end<a name='1103'>
          a_vel = 0.<a name='1104'>
          vel = rv(i,k,j)<a name='1105'>
<font color=#447700>! recompute : vel<a name='1106'></font>
          a_field(i,k,j-3) = a_field(i,k,j-3)+a_fqy(i,k,jp1)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='1107'>
          a_field(i,k,j-2) = a_field(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='1108'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='1109'>
          a_field(i,k,j+2) = a_field(i,k,j+2)+a_fqy(i,k,jp1)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='1110'>
          a_field(i,k,j+1) = a_field(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='1111'>
          a_field(i,k,j) = a_field(i,k,j)+a_fqy(i,k,jp1)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='1112'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(field(i,k,j)+field(i,k,j-1))-0.13333333*(field(i,k,j+1)+field(i,k,j-2))+&amp;<a name='1113'>
&amp;0.016666667*(field(i,k,j+2)+field(i,k,j-3))-0.016666667*(field(i,k,j+2)-field(i,k,j-3)-5.*(field(i,k,j+1)-field(i,k,j-2)&amp;<a name='1114'>
&amp;)+10.*(field(i,k,j)-field(i,k,j-1)))*sign(1.,vel))<a name='1115'>
          a_fqy(i,k,jp1) = 0.<a name='1116'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel<a name='1117'>
          a_vel = 0.<a name='1118'>
        end do<a name='1119'>
      end do<a name='1120'>
<a name='1121'>
<a name='1122'>
<a name='1123'>
    else if (j .eq. jds+1) then<a name='1124'>
      do k = kts, ktf<a name='1125'>
        do i = i_start, i_end<a name='1126'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1127'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1128'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*(field(i,k,j)+field(i,k,j-1))<a name='1129'>
          a_fqy(i,k,jp1) = 0.<a name='1130'>
        end do<a name='1131'>
      end do<a name='1132'>
    else if (j .eq. jds+2) then<a name='1133'>
      do k = kts, ktf<a name='1134'>
        a_vel = 0.<a name='1135'>
        do i = i_start, i_end<a name='1136'>
          a_vel = 0.<a name='1137'>
          vel = rv(i,k,j)<a name='1138'>
<font color=#447700>! recompute : vel<a name='1139'></font>
          a_field(i,k,j-2) = a_field(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='1140'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='1141'>
          a_field(i,k,j+1) = a_field(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='1142'>
          a_field(i,k,j) = a_field(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='1143'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(field(i,k,j)+field(i,k,j-1))-0.083333333*(field(i,k,j+1)+field(i,k,j-2))+&amp;<a name='1144'>
&amp;0.083333333*(field(i,k,j+1)-field(i,k,j-2)-3.*(field(i,k,j)-field(i,k,j-1)))*sign(1.,vel))<a name='1145'>
          a_fqy(i,k,jp1) = 0.<a name='1146'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel<a name='1147'>
          a_vel = 0.<a name='1148'>
        end do<a name='1149'>
      end do<a name='1150'>
    else if (j .eq. jde-1) then<a name='1151'>
      do k = kts, ktf<a name='1152'>
        do i = i_start, i_end<a name='1153'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1154'>
          a_field(i,k,j) = a_field(i,k,j)+0.5*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1155'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*(field(i,k,j)+field(i,k,j-1))<a name='1156'>
          a_fqy(i,k,jp1) = 0.<a name='1157'>
        end do<a name='1158'>
      end do<a name='1159'>
    else if (j .eq. jde-2) then<a name='1160'>
      do k = kts, ktf<a name='1161'>
        a_vel = 0.<a name='1162'>
        do i = i_start, i_end<a name='1163'>
          a_vel = 0.<a name='1164'>
          vel = rv(i,k,j)<a name='1165'>
<font color=#447700>! recompute : vel<a name='1166'></font>
          a_field(i,k,j-2) = a_field(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='1167'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='1168'>
          a_field(i,k,j+1) = a_field(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='1169'>
          a_field(i,k,j) = a_field(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='1170'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(field(i,k,j)+field(i,k,j-1))-0.083333333*(field(i,k,j+1)+field(i,k,j-2))+&amp;<a name='1171'>
&amp;0.083333333*(field(i,k,j+1)-field(i,k,j-2)-3.*(field(i,k,j)-field(i,k,j-1)))*sign(1.,vel))<a name='1172'>
          a_fqy(i,k,jp1) = 0.<a name='1173'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel<a name='1174'>
          a_vel = 0.<a name='1175'>
        end do<a name='1176'>
      end do<a name='1177'>
    endif<a name='1178'>
  end do a_j_loop_y_flux_5<a name='1179'>
else if (horz_order .eq. 4) then a_horizontal_order_test<a name='1180'>
  degrade_xs =  .true. <a name='1181'>
<font color=#447700>! recompute : degrade_xs<a name='1182'></font>
  degrade_xe =  .true. <a name='1183'>
<font color=#447700>! recompute : degrade_xe<a name='1184'></font>
  degrade_ys =  .true. <a name='1185'>
<font color=#447700>! recompute : degrade_ys<a name='1186'></font>
  degrade_ye =  .true. <a name='1187'>
<font color=#447700>! recompute : degrade_ye<a name='1188'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='1189'>
    degrade_xs =  .false. <a name='1190'>
  endif<a name='1191'>
<font color=#447700>! recompute : degrade_xs<a name='1192'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='1193'>
    degrade_xe =  .false. <a name='1194'>
  endif<a name='1195'>
<font color=#447700>! recompute : degrade_xe<a name='1196'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='1197'>
    degrade_ys =  .false. <a name='1198'>
  endif<a name='1199'>
<font color=#447700>! recompute : degrade_ys<a name='1200'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='1201'>
    degrade_ye =  .false. <a name='1202'>
  endif<a name='1203'>
<font color=#447700>! recompute : degrade_ye<a name='1204'></font>
<font color=#447700>! recompute : ktf<a name='1205'></font>
  i_start = its<a name='1206'>
<font color=#447700>! recompute : i_start<a name='1207'></font>
  i_end = min(ite,ide-1)<a name='1208'>
<font color=#447700>! recompute : i_end<a name='1209'></font>
  i_start_f = i_start<a name='1210'>
<font color=#447700>! recompute : i_start_f<a name='1211'></font>
  i_end_f = i_end+1<a name='1212'>
<font color=#447700>! recompute : i_end_f<a name='1213'></font>
  if (degrade_xs) then<a name='1214'>
    i_start = ids+1<a name='1215'>
    i_start_f = i_start+1<a name='1216'>
  endif<a name='1217'>
<font color=#447700>! recompute : i_start_f<a name='1218'></font>
  if (degrade_xe) then<a name='1219'>
    i_end_f = ide-2<a name='1220'>
  endif<a name='1221'>
<font color=#447700>! recompute : i_end_f<a name='1222'></font>
  i_start = its<a name='1223'>
<font color=#447700>! recompute : i_start<a name='1224'></font>
  i_end = min(ite,ide-1)<a name='1225'>
<font color=#447700>! recompute : i_end<a name='1226'></font>
  j_start = jts<a name='1227'>
<font color=#447700>! recompute : j_start<a name='1228'></font>
  j_end = min(jte,jde-1)<a name='1229'>
<font color=#447700>! recompute : j_end<a name='1230'></font>
  j_start_f = j_start<a name='1231'>
<font color=#447700>! recompute : j_start_f<a name='1232'></font>
  j_end_f = j_end+1<a name='1233'>
<font color=#447700>! recompute : j_end_f<a name='1234'></font>
  if (degrade_ys) then<a name='1235'>
    j_start = jds+1<a name='1236'>
    j_start_f = j_start+1<a name='1237'>
  endif<a name='1238'>
<font color=#447700>! recompute : j_start,j_start_f<a name='1239'></font>
  if (degrade_ye) then<a name='1240'>
    j_end = jde-2<a name='1241'>
    j_end_f = jde-2<a name='1242'>
  endif<a name='1243'>
<font color=#447700>! recompute : j_end,j_end_f<a name='1244'></font>
  do j = j_end+1, j_start, -1<a name='1245'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3365<a name='1246'></font>
<font color=#447700>! recompute vars : jp1<a name='1247'></font>
    jp1 = 2<a name='1248'>
<font color=#447700>! recompute vars : jp1<a name='1249'></font>
<font color=#447700>! recdepend vars : jp1<a name='1250'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3366<a name='1251'></font>
<font color=#447700>! recompute vars : jp0<a name='1252'></font>
    jp0 = 1<a name='1253'>
<font color=#447700>! recompute vars : jp0<a name='1254'></font>
    do j2 = j_start, j-1<a name='1255'>
      jtmp = jp1<a name='1256'>
      jp1 = jp0<a name='1257'>
      jp0 = jtmp<a name='1258'>
    end do<a name='1259'>
<font color=#447700>!    if (j .gt. j_start) then<a name='1260'></font>
    if (j .gt. jds+1) then<a name='1261'>
      do k = kts, ktf<a name='1262'>
        do i = i_start, i_end<a name='1263'>
          mrdy = msft(i,j-1)*rdy<a name='1264'>
<font color=#447700>! recompute : mrdy<a name='1265'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='1266'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='1267'>
        end do<a name='1268'>
      end do<a name='1269'>
    endif<a name='1270'>
    if (j .lt. j_start_f .and. degrade_ys) then<a name='1271'>
      do k = kts, ktf<a name='1272'>
        do i = i_start, i_end<a name='1273'>
          a_field(i,k,j_start-1) = a_field(i,k,j_start-1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_start)<a name='1274'>
          a_field(i,k,j_start) = a_field(i,k,j_start)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_start)<a name='1275'>
          a_rv(i,k,j_start) = a_rv(i,k,j_start)+0.5*a_fqy(i,k,jp1)*(field(i,k,j_start)+field(i,k,j_start-1))<a name='1276'>
          a_fqy(i,k,jp1) = 0.<a name='1277'>
        end do<a name='1278'>
      end do<a name='1279'>
    else if (j .gt. j_end_f .and. degrade_ye) then<a name='1280'>
      do k = kts, ktf<a name='1281'>
        do i = i_start, i_end<a name='1282'>
          a_field(i,k,j_end+1) = a_field(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_end+1)<a name='1283'>
          a_field(i,k,j_end) = a_field(i,k,j_end)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_end+1)<a name='1284'>
          a_rv(i,k,j_end+1) = a_rv(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*(field(i,k,j_end+1)+field(i,k,j_end))<a name='1285'>
          a_fqy(i,k,jp1) = 0.<a name='1286'>
        end do<a name='1287'>
      end do<a name='1288'>
    else<a name='1289'>
      do k = kts, ktf<a name='1290'>
        do i = i_start, i_end<a name='1291'>
          a_field(i,k,j-2) = a_field(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1292'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1293'>
          a_field(i,k,j+1) = a_field(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1294'>
          a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_fqy(i,k,jp1)*rv(i,k,j)<a name='1295'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_fqy(i,k,jp1)*(0.58333333*(field(i,k,j)+field(i,k,j-1))-0.083333333*(field(i,k,j+1)+field(i,k,&amp;<a name='1296'>
&amp;j-2)))<a name='1297'>
          a_fqy(i,k,jp1) = 0.<a name='1298'>
        end do<a name='1299'>
      end do<a name='1300'>
    endif<a name='1301'>
  end do<a name='1302'>
<font color=#447700>! recdepend vars : its<a name='1303'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3278<a name='1304'></font>
<font color=#447700>! recompute vars : i_start<a name='1305'></font>
  i_start = its<a name='1306'>
<font color=#447700>! recompute vars : i_start<a name='1307'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='1308'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3279<a name='1309'></font>
<font color=#447700>! recompute vars : i_end<a name='1310'></font>
  i_end = min(ite,ide-1)<a name='1311'>
<font color=#447700>! recompute vars : i_end<a name='1312'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='1313'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3280<a name='1314'></font>
<font color=#447700>! recompute vars : j_start<a name='1315'></font>
  j_start = jts<a name='1316'>
<font color=#447700>! recompute vars : j_start<a name='1317'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='1318'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3281<a name='1319'></font>
<font color=#447700>! recompute vars : j_end<a name='1320'></font>
  j_end = min(jte,jde-1)<a name='1321'>
<font color=#447700>! recompute vars : j_end<a name='1322'></font>
<font color=#447700>! recdepend vars : degrade_xs,i_end,i_start,ids,j_end,j_start<a name='1323'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3289<a name='1324'></font>
<font color=#447700>! recompute vars : i_start<a name='1325'></font>
  if (degrade_xs) then<a name='1326'>
    i_start = ids+1<a name='1327'>
  endif<a name='1328'>
<font color=#447700>! recompute vars : i_start<a name='1329'></font>
<font color=#447700>! recdepend vars : degrade_xe,i_end,i_start,ide,j_end,j_start<a name='1330'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3294<a name='1331'></font>
<font color=#447700>! recompute vars : i_end<a name='1332'></font>
  if (degrade_xe) then<a name='1333'>
    i_end = ide-2<a name='1334'>
  endif<a name='1335'>
<font color=#447700>! recompute vars : i_end<a name='1336'></font>
  do j = j_start, j_end<a name='1337'>
    do k = kts, ktf<a name='1338'>
      do i = i_start, i_end<a name='1339'>
        mrdx = msft(i,j)*rdx<a name='1340'>
<font color=#447700>! recompute : mrdx<a name='1341'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='1342'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='1343'>
      end do<a name='1344'>
    end do<a name='1345'>
    if (degrade_xe) then<a name='1346'>
      do k = kts, ktf<a name='1347'>
        a_field(i_end+1,k,j) = a_field(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*ru(i_end+1,k,j)<a name='1348'>
        a_field(i_end,k,j) = a_field(i_end,k,j)+0.5*a_fqx(i_end+1,k)*ru(i_end+1,k,j)<a name='1349'>
        a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*(field(i_end+1,k,j)+field(i_end,k,j))<a name='1350'>
        a_fqx(i_end+1,k) = 0.<a name='1351'>
      end do<a name='1352'>
    endif<a name='1353'>
    if (degrade_xs) then<a name='1354'>
      do k = kts, ktf<a name='1355'>
        a_field(i_start-1,k,j) = a_field(i_start-1,k,j)+0.5*a_fqx(i_start,k)*ru(i_start,k,j)<a name='1356'>
        a_field(i_start,k,j) = a_field(i_start,k,j)+0.5*a_fqx(i_start,k)*ru(i_start,k,j)<a name='1357'>
        a_ru(i_start,k,j) = a_ru(i_start,k,j)+0.5*a_fqx(i_start,k)*(field(i_start,k,j)+field(i_start-1,k,j))<a name='1358'>
        a_fqx(i_start,k) = 0.<a name='1359'>
      end do<a name='1360'>
    endif<a name='1361'>
    do k = kts, ktf<a name='1362'>
      do i = i_start_f, i_end_f<a name='1363'>
        a_field(i-2,k,j) = a_field(i-2,k,j)-0.083333333*a_fqx(i,k)*ru(i,k,j)<a name='1364'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+0.58333333*a_fqx(i,k)*ru(i,k,j)<a name='1365'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-0.083333333*a_fqx(i,k)*ru(i,k,j)<a name='1366'>
        a_field(i,k,j) = a_field(i,k,j)+0.58333333*a_fqx(i,k)*ru(i,k,j)<a name='1367'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_fqx(i,k)*(0.58333333*(field(i,k,j)+field(i-1,k,j))-0.083333333*(field(i+1,k,j)+field(i-2,k,j)))<a name='1368'>
        a_fqx(i,k) = 0.<a name='1369'>
      end do<a name='1370'>
    end do<a name='1371'>
  end do<a name='1372'>
else if (horz_order .eq. 3) then a_horizontal_order_test<a name='1373'>
  degrade_xs =  .true. <a name='1374'>
<font color=#447700>! recompute : degrade_xs<a name='1375'></font>
  degrade_xe =  .true. <a name='1376'>
<font color=#447700>! recompute : degrade_xe<a name='1377'></font>
  degrade_ys =  .true. <a name='1378'>
<font color=#447700>! recompute : degrade_ys<a name='1379'></font>
  degrade_ye =  .true. <a name='1380'>
<font color=#447700>! recompute : degrade_ye<a name='1381'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='1382'>
    degrade_xs =  .false. <a name='1383'>
  endif<a name='1384'>
<font color=#447700>! recompute : degrade_xs<a name='1385'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='1386'>
    degrade_xe =  .false. <a name='1387'>
  endif<a name='1388'>
<font color=#447700>! recompute : degrade_xe<a name='1389'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='1390'>
    degrade_ys =  .false. <a name='1391'>
  endif<a name='1392'>
<font color=#447700>! recompute : degrade_ys<a name='1393'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='1394'>
    degrade_ye =  .false. <a name='1395'>
  endif<a name='1396'>
<font color=#447700>! recompute : degrade_ye<a name='1397'></font>
<font color=#447700>! recompute : ktf<a name='1398'></font>
  i_start = its<a name='1399'>
<font color=#447700>! recompute : i_start<a name='1400'></font>
  i_end = min(ite,ide-1)<a name='1401'>
<font color=#447700>! recompute : i_end<a name='1402'></font>
  i_start_f = i_start<a name='1403'>
<font color=#447700>! recompute : i_start_f<a name='1404'></font>
  i_end_f = i_end+1<a name='1405'>
<font color=#447700>! recompute : i_end_f<a name='1406'></font>
  if (degrade_xs) then<a name='1407'>
    i_start = ids+1<a name='1408'>
    i_start_f = i_start+1<a name='1409'>
  endif<a name='1410'>
<font color=#447700>! recompute : i_start_f<a name='1411'></font>
  if (degrade_xe) then<a name='1412'>
    i_end_f = ide-2<a name='1413'>
  endif<a name='1414'>
<font color=#447700>! recompute : i_end_f<a name='1415'></font>
  i_start = its<a name='1416'>
<font color=#447700>! recompute : i_start<a name='1417'></font>
  i_end = min(ite,ide-1)<a name='1418'>
<font color=#447700>! recompute : i_end<a name='1419'></font>
  j_start = jts<a name='1420'>
<font color=#447700>! recompute : j_start<a name='1421'></font>
  j_end = min(jte,jde-1)<a name='1422'>
<font color=#447700>! recompute : j_end<a name='1423'></font>
  j_start_f = j_start<a name='1424'>
<font color=#447700>! recompute : j_start_f<a name='1425'></font>
  j_end_f = j_end+1<a name='1426'>
<font color=#447700>! recompute : j_end_f<a name='1427'></font>
  if (degrade_ys) then<a name='1428'>
    j_start = jds+1<a name='1429'>
    j_start_f = j_start+1<a name='1430'>
  endif<a name='1431'>
<font color=#447700>! recompute : j_start,j_start_f<a name='1432'></font>
  if (degrade_ye) then<a name='1433'>
    j_end = jde-2<a name='1434'>
    j_end_f = jde-2<a name='1435'>
  endif<a name='1436'>
<font color=#447700>! recompute : j_end,j_end_f<a name='1437'></font>
  do j = j_end+1, j_start, -1<a name='1438'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3525<a name='1439'></font>
<font color=#447700>! recompute vars : jp1<a name='1440'></font>
    jp1 = 2<a name='1441'>
<font color=#447700>! recompute vars : jp1<a name='1442'></font>
<font color=#447700>! recdepend vars : jp1<a name='1443'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3526<a name='1444'></font>
<font color=#447700>! recompute vars : jp0<a name='1445'></font>
    jp0 = 1<a name='1446'>
<font color=#447700>! recompute vars : jp0<a name='1447'></font>
    do j3 = j_start, j-1<a name='1448'>
      jtmp = jp1<a name='1449'>
      jp1 = jp0<a name='1450'>
      jp0 = jtmp<a name='1451'>
    end do<a name='1452'>
<font color=#447700>!    if (j .gt. j_start) then<a name='1453'></font>
    if (j .gt. jds+1) then<a name='1454'>
      do k = kts, ktf<a name='1455'>
        do i = i_start, i_end<a name='1456'>
          mrdy = msft(i,j-1)*rdy<a name='1457'>
<font color=#447700>! recompute : mrdy<a name='1458'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='1459'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='1460'>
        end do<a name='1461'>
      end do<a name='1462'>
    endif<a name='1463'>
    if (j .lt. j_start_f .and. degrade_ys) then<a name='1464'>
      do k = kts, ktf<a name='1465'>
        do i = i_start, i_end<a name='1466'>
          a_field(i,k,j_start-1) = a_field(i,k,j_start-1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_start)<a name='1467'>
          a_field(i,k,j_start) = a_field(i,k,j_start)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_start)<a name='1468'>
          a_rv(i,k,j_start) = a_rv(i,k,j_start)+0.5*a_fqy(i,k,jp1)*(field(i,k,j_start)+field(i,k,j_start-1))<a name='1469'>
          a_fqy(i,k,jp1) = 0.<a name='1470'>
        end do<a name='1471'>
      end do<a name='1472'>
    else if (j .gt. j_end_f .and. degrade_ye) then<a name='1473'>
      do k = kts, ktf<a name='1474'>
        do i = i_start, i_end<a name='1475'>
          a_field(i,k,j_end+1) = a_field(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_end+1)<a name='1476'>
          a_field(i,k,j_end) = a_field(i,k,j_end)+0.5*a_fqy(i,k,jp1)*rv(i,k,j_end+1)<a name='1477'>
          a_rv(i,k,j_end+1) = a_rv(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*(field(i,k,j_end+1)+field(i,k,j_end))<a name='1478'>
          a_fqy(i,k,jp1) = 0.<a name='1479'>
        end do<a name='1480'>
      end do<a name='1481'>
    else<a name='1482'>
      do k = kts, ktf<a name='1483'>
        do i = i_start, i_end<a name='1484'>
          a_field(i,k,j-2) = a_field(i,k,j-2)+a_fqy(i,k,jp1)*rv(i,k,j)*((-0.083333333)+(-0.083333333)*sign(1.,rv(i,k,j)))<a name='1485'>
          a_field(i,k,j-1) = a_field(i,k,j-1)+a_fqy(i,k,jp1)*rv(i,k,j)*(0.58333333+0.25*sign(1.,rv(i,k,j)))<a name='1486'>
          a_field(i,k,j+1) = a_field(i,k,j+1)+a_fqy(i,k,jp1)*rv(i,k,j)*((-0.083333333)+0.083333333*sign(1.,rv(i,k,j)))<a name='1487'>
          a_field(i,k,j) = a_field(i,k,j)+a_fqy(i,k,jp1)*rv(i,k,j)*(0.58333333+(-0.25)*sign(1.,rv(i,k,j)))<a name='1488'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_fqy(i,k,jp1)*(0.58333333*(field(i,k,j)+field(i,k,j-1))-0.083333333*(field(i,k,j+1)+field(i,k,&amp;<a name='1489'>
&amp;j-2))+0.083333333*(field(i,k,j+1)-field(i,k,j-2)-3.*(field(i,k,j)-field(i,k,j-1)))*sign(1.,rv(i,k,j)))<a name='1490'>
          a_fqy(i,k,jp1) = 0.<a name='1491'>
        end do<a name='1492'>
      end do<a name='1493'>
    endif<a name='1494'>
  end do<a name='1495'>
<font color=#447700>! recdepend vars : its<a name='1496'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3438<a name='1497'></font>
<font color=#447700>! recompute vars : i_start<a name='1498'></font>
  i_start = its<a name='1499'>
<font color=#447700>! recompute vars : i_start<a name='1500'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='1501'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3439<a name='1502'></font>
<font color=#447700>! recompute vars : i_end<a name='1503'></font>
  i_end = min(ite,ide-1)<a name='1504'>
<font color=#447700>! recompute vars : i_end<a name='1505'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='1506'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3440<a name='1507'></font>
<font color=#447700>! recompute vars : j_start<a name='1508'></font>
  j_start = jts<a name='1509'>
<font color=#447700>! recompute vars : j_start<a name='1510'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='1511'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3441<a name='1512'></font>
<font color=#447700>! recompute vars : j_end<a name='1513'></font>
  j_end = min(jte,jde-1)<a name='1514'>
<font color=#447700>! recompute vars : j_end<a name='1515'></font>
<font color=#447700>! recdepend vars : degrade_xs,i_end,i_start,ids,j_end,j_start<a name='1516'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3449<a name='1517'></font>
<font color=#447700>! recompute vars : i_start<a name='1518'></font>
  if (degrade_xs) then<a name='1519'>
    i_start = ids+1<a name='1520'>
  endif<a name='1521'>
<font color=#447700>! recompute vars : i_start<a name='1522'></font>
<font color=#447700>! recdepend vars : degrade_xe,i_end,i_start,ide,j_end,j_start<a name='1523'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3454<a name='1524'></font>
<font color=#447700>! recompute vars : i_end<a name='1525'></font>
  if (degrade_xe) then<a name='1526'>
    i_end = ide-2<a name='1527'>
  endif<a name='1528'>
<font color=#447700>! recompute vars : i_end<a name='1529'></font>
  do j = j_start, j_end<a name='1530'>
    do k = kts, ktf<a name='1531'>
      do i = i_start, i_end<a name='1532'>
        mrdx = msft(i,j)*rdx<a name='1533'>
<font color=#447700>! recompute : mrdx<a name='1534'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='1535'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='1536'>
      end do<a name='1537'>
    end do<a name='1538'>
    if (degrade_xe) then<a name='1539'>
      do k = kts, ktf<a name='1540'>
        a_field(i_end+1,k,j) = a_field(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*ru(i_end+1,k,j)<a name='1541'>
        a_field(i_end,k,j) = a_field(i_end,k,j)+0.5*a_fqx(i_end+1,k)*ru(i_end+1,k,j)<a name='1542'>
        a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*(field(i_end+1,k,j)+field(i_end,k,j))<a name='1543'>
        a_fqx(i_end+1,k) = 0.<a name='1544'>
      end do<a name='1545'>
    endif<a name='1546'>
    if (degrade_xs) then<a name='1547'>
      do k = kts, ktf<a name='1548'>
        a_field(i_start-1,k,j) = a_field(i_start-1,k,j)+0.5*a_fqx(i_start,k)*ru(i_start,k,j)<a name='1549'>
        a_field(i_start,k,j) = a_field(i_start,k,j)+0.5*a_fqx(i_start,k)*ru(i_start,k,j)<a name='1550'>
        a_ru(i_start,k,j) = a_ru(i_start,k,j)+0.5*a_fqx(i_start,k)*(field(i_start,k,j)+field(i_start-1,k,j))<a name='1551'>
        a_fqx(i_start,k) = 0.<a name='1552'>
      end do<a name='1553'>
    endif<a name='1554'>
    do k = kts, ktf<a name='1555'>
      do i = i_start_f, i_end_f<a name='1556'>
        a_field(i-2,k,j) = a_field(i-2,k,j)+a_fqx(i,k)*ru(i,k,j)*((-0.083333333)+(-0.083333333)*sign(1.,ru(i,k,j)))<a name='1557'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_fqx(i,k)*ru(i,k,j)*(0.58333333+0.25*sign(1.,ru(i,k,j)))<a name='1558'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_fqx(i,k)*ru(i,k,j)*((-0.083333333)+0.083333333*sign(1.,ru(i,k,j)))<a name='1559'>
        a_field(i,k,j) = a_field(i,k,j)+a_fqx(i,k)*ru(i,k,j)*(0.58333333+(-0.25)*sign(1.,ru(i,k,j)))<a name='1560'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_fqx(i,k)*(0.58333333*(field(i,k,j)+field(i-1,k,j))-0.083333333*(field(i+1,k,j)+field(i-2,k,j))+&amp;<a name='1561'>
&amp;0.083333333*(field(i+1,k,j)-field(i-2,k,j)-3.*(field(i,k,j)-field(i-1,k,j)))*sign(1.,ru(i,k,j)))<a name='1562'>
        a_fqx(i,k) = 0.<a name='1563'>
      end do<a name='1564'>
    end do<a name='1565'>
  end do<a name='1566'>
else if (horz_order .eq. 2) then a_horizontal_order_test<a name='1567'>
  j_start = jts<a name='1568'>
<font color=#447700>! recompute : j_start<a name='1569'></font>
  j_end = min(jte,jde-1)<a name='1570'>
<font color=#447700>! recompute : j_end<a name='1571'></font>
  i_start = its<a name='1572'>
<font color=#447700>! recompute : i_start<a name='1573'></font>
  i_end = min(ite,ide-1)<a name='1574'>
<font color=#447700>! recompute : i_end<a name='1575'></font>
  if (config_flags%open_ys .or. specified) then<a name='1576'>
    j_start = max(jds+1,jts)<a name='1577'>
  endif<a name='1578'>
<font color=#447700>! recompute : j_start<a name='1579'></font>
  if (config_flags%open_ye .or. specified) then<a name='1580'>
    j_end = min(jde-2,jte)<a name='1581'>
  endif<a name='1582'>
<font color=#447700>! recompute : j_end<a name='1583'></font>
  do j = j_start, j_end<a name='1584'>
    do k = kts, ktf<a name='1585'>
      do i = i_start, i_end<a name='1586'>
        mrdy = msft(i,j)*rdy<a name='1587'>
<font color=#447700>! recompute : mrdy<a name='1588'></font>
        a_field(i,k,j-1) = a_field(i,k,j-1)+0.5*a_tendency(i,k,j)*mrdy*rv(i,k,j)<a name='1589'>
        a_field(i,k,j+1) = a_field(i,k,j+1)-0.5*a_tendency(i,k,j)*mrdy*rv(i,k,j+1)<a name='1590'>
        a_field(i,k,j) = a_field(i,k,j)-0.5*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)-rv(i,k,j))<a name='1591'>
        a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.5*a_tendency(i,k,j)*mrdy*(field(i,k,j+1)+field(i,k,j))<a name='1592'>
        a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_tendency(i,k,j)*mrdy*(field(i,k,j)+field(i,k,j-1))<a name='1593'>
      end do<a name='1594'>
    end do<a name='1595'>
  end do<a name='1596'>
<font color=#447700>! recdepend vars : its<a name='1597'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3574<a name='1598'></font>
<font color=#447700>! recompute vars : i_start<a name='1599'></font>
  i_start = its<a name='1600'>
<font color=#447700>! recompute vars : i_start<a name='1601'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='1602'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3575<a name='1603'></font>
<font color=#447700>! recompute vars : i_end<a name='1604'></font>
  i_end = min(ite,ide-1)<a name='1605'>
<font color=#447700>! recompute vars : i_end<a name='1606'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='1607'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3576<a name='1608'></font>
<font color=#447700>! recompute vars : j_start<a name='1609'></font>
  j_start = jts<a name='1610'>
<font color=#447700>! recompute vars : j_start<a name='1611'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='1612'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3577<a name='1613'></font>
<font color=#447700>! recompute vars : j_end<a name='1614'></font>
  j_end = min(jte,jde-1)<a name='1615'>
<font color=#447700>! recompute vars : j_end<a name='1616'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,ids,its,j_end,j_start,spe<a name='1617'></font>
<font color=#447700>! cified<a name='1618'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3579<a name='1619'></font>
<font color=#447700>! recompute vars : i_start<a name='1620'></font>
  if (config_flags%open_xs .or. specified) then<a name='1621'>
    i_start = max(ids+1,its)<a name='1622'>
  endif<a name='1623'>
<font color=#447700>! recompute vars : i_start<a name='1624'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,ide,ite,j_end,j_start,spe<a name='1625'></font>
<font color=#447700>! cified<a name='1626'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:3580<a name='1627'></font>
<font color=#447700>! recompute vars : i_end<a name='1628'></font>
  if (config_flags%open_xe .or. specified) then<a name='1629'>
    i_end = min(ide-2,ite)<a name='1630'>
  endif<a name='1631'>
<font color=#447700>! recompute vars : i_end<a name='1632'></font>
  do j = j_start, j_end<a name='1633'>
    do k = kts, ktf<a name='1634'>
      do i = i_start, i_end<a name='1635'>
        mrdx = msft(i,j)*rdx<a name='1636'>
<font color=#447700>! recompute : mrdx<a name='1637'></font>
        a_field(i-1,k,j) = a_field(i-1,k,j)+0.5*a_tendency(i,k,j)*mrdx*ru(i,k,j)<a name='1638'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-0.5*a_tendency(i,k,j)*mrdx*ru(i+1,k,j)<a name='1639'>
        a_field(i,k,j) = a_field(i,k,j)-0.5*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)-ru(i,k,j))<a name='1640'>
        a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.5*a_tendency(i,k,j)*mrdx*(field(i+1,k,j)+field(i,k,j))<a name='1641'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_tendency(i,k,j)*mrdx*(field(i,k,j)+field(i-1,k,j))<a name='1642'>
      end do<a name='1643'>
    end do<a name='1644'>
  end do<a name='1645'>
endif a_horizontal_order_test<a name='1646'>
<a name='1647'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_2">("a_advect_scalar")<a name='1648'>
<a name='1649'>
end subroutine a_advect_scalar<a name='1650'>
<a name='1651'>
<a name='1652'>
<A NAME='A_ADVECT_U'><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_U' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1653'>
<font color=#993300>subroutine </font><font color=#cc0000>a_advect_u</font>( u, a_u, u_old, a_u_old, a_tendency, ru, a_ru, rv, a_rv, rom, a_rom, mut, a_mut, config_flags, msfu, fzm, &amp; <A href='../../call_to/A_ADVECT_U.html' TARGET='index'>1</A>,<A href='../../call_from/A_ADVECT_U.html' TARGET='index'>2</A><a name='1654'>
&amp;fzp, rdx, rdy, rdzw, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='1655'>
<font color=#447700>!******************************************************************<a name='1656'></font>
<font color=#447700>!******************************************************************<a name='1657'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1658'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1659'></font>
<font color=#447700>!******************************************************************<a name='1660'></font>
<font color=#447700>!******************************************************************<a name='1661'></font>
<font color=#447700>!==============================================<a name='1662'></font>
<font color=#447700>! all entries are defined explicitly<a name='1663'></font>
<font color=#447700>!==============================================<a name='1664'></font>
implicit none<a name='1665'>
<a name='1666'>
<font color=#447700>!==============================================<a name='1667'></font>
<font color=#447700>! declare arguments<a name='1668'></font>
<font color=#447700>!==============================================<a name='1669'></font>
integer, intent(in) :: ime<a name='1670'>
integer, intent(in) :: ims<a name='1671'>
integer, intent(in) :: jme<a name='1672'>
integer, intent(in) :: jms<a name='1673'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='1674'>
integer, intent(in) :: kme<a name='1675'>
integer, intent(in) :: kms<a name='1676'>
real, intent(inout) :: a_rom(ims:ime,kms:kme,jms:jme)<a name='1677'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='1678'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='1679'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='1680'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='1681'>
real, intent(inout) :: a_u_old(ims:ime,kms:kme,jms:jme)<a name='1682'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='1683'>
real, intent(in) :: fzm(kms:kme)<a name='1684'>
real, intent(in) :: fzp(kms:kme)<a name='1685'>
integer, intent(in) :: ide<a name='1686'>
integer, intent(in) :: ids<a name='1687'>
integer, intent(in) :: ite<a name='1688'>
integer, intent(in) :: its<a name='1689'>
integer, intent(in) :: jde<a name='1690'>
integer, intent(in) :: jds<a name='1691'>
integer, intent(in) :: jte<a name='1692'>
integer, intent(in) :: jts<a name='1693'>
integer, intent(in) :: kde<a name='1694'>
integer, intent(in) :: kte<a name='1695'>
integer, intent(in) :: kts<a name='1696'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='1697'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='1698'>
real, intent(in) :: rdx<a name='1699'>
real, intent(in) :: rdy<a name='1700'>
real, intent(in) :: rdzw(kms:kme)<a name='1701'>
real, intent(in) :: rom(ims:ime,kms:kme,jms:jme)<a name='1702'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='1703'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='1704'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='1705'>
real, intent(in) :: u_old(ims:ime,kms:kme,jms:jme)<a name='1706'>
<a name='1707'>
<font color=#447700>!==============================================<a name='1708'></font>
<font color=#447700>! declare local variables<a name='1709'></font>
<font color=#447700>!==============================================<a name='1710'></font>
real a_dvm<a name='1711'>
real a_dvp<a name='1712'>
real a_fqx(its-1:ite+1,kts:kte)<a name='1713'>
real a_fqy(its:ite,kts:kte,2)<a name='1714'>
real a_ub<a name='1715'>
real a_vb<a name='1716'>
real a_vel<a name='1717'>
real a_vflux(its:ite,kts:kte)<a name='1718'>
real a_vw<a name='1719'>
logical degrade_xe<a name='1720'>
logical degrade_xs<a name='1721'>
logical degrade_ye<a name='1722'>
logical degrade_ys<a name='1723'>
real dvm<a name='1724'>
real dvp<a name='1725'>
integer horz_order<a name='1726'>
integer i<a name='1727'>
integer i_end<a name='1728'>
integer i_end_f<a name='1729'>
integer i_start<a name='1730'>
integer i_start_f<a name='1731'>
integer im<a name='1732'>
integer imax<a name='1733'>
integer imin<a name='1734'>
integer ip<a name='1735'>
integer j<a name='1736'>
integer j1<a name='1737'>
integer j2<a name='1738'>
integer j3<a name='1739'>
integer j4<a name='1740'>
integer j_end<a name='1741'>
integer j_end_f<a name='1742'>
integer j_start<a name='1743'>
integer j_start_f<a name='1744'>
integer jp0<a name='1745'>
integer jp1<a name='1746'>
integer jtmp<a name='1747'>
integer k<a name='1748'>
integer ktf<a name='1749'>
real mrdx<a name='1750'>
real mrdy<a name='1751'>
logical specified<a name='1752'>
real ub<a name='1753'>
real vb<a name='1754'>
real vel<a name='1755'>
integer vert_order<a name='1756'>
real vw<a name='1757'>
<a name='1758'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_U' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_3">("a_advect_u")<a name='1759'>
<a name='1760'>
<font color=#447700>!----------------------------------------------<a name='1761'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='1762'></font>
<font color=#447700>!----------------------------------------------<a name='1763'></font>
a_dvm = 0.<a name='1764'>
a_dvp = 0.<a name='1765'>
a_fqx(:,:) = 0.<a name='1766'>
a_fqy(:,:,:) = 0.<a name='1767'>
a_ub = 0.<a name='1768'>
a_vb = 0.<a name='1769'>
a_vel = 0.<a name='1770'>
a_vflux(:,:) = 0.<a name='1771'>
a_vw = 0.<a name='1772'>
<a name='1773'>
<font color=#447700>!----------------------------------------------<a name='1774'></font>
<font color=#447700>! ROUTINE BODY<a name='1775'></font>
<font color=#447700>!----------------------------------------------<a name='1776'></font>
specified =  .false. <a name='1777'>
<font color=#447700>! recompute : specified<a name='1778'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='1779'>
  specified =  .true. <a name='1780'>
endif<a name='1781'>
<font color=#447700>! recompute : specified<a name='1782'></font>
horz_order = config_flags%h_mom_adv_order<a name='1783'>
<font color=#447700>! recompute : horz_order<a name='1784'></font>
vert_order = config_flags%v_mom_adv_order<a name='1785'>
<font color=#447700>! recompute : vert_order<a name='1786'></font>
ktf = min(kte,kde-1)<a name='1787'>
<font color=#447700>! recompute : ktf<a name='1788'></font>
imin = ids<a name='1789'>
<font color=#447700>! recompute : imin<a name='1790'></font>
imax = ide-1<a name='1791'>
<font color=#447700>! recompute : imax<a name='1792'></font>
if (config_flags%open_xs) then<a name='1793'>
  imin = ids<a name='1794'>
endif<a name='1795'>
<font color=#447700>! recompute : imin<a name='1796'></font>
if (config_flags%open_xe) then<a name='1797'>
  imax = ide-1<a name='1798'>
endif<a name='1799'>
<font color=#447700>! recompute : imax<a name='1800'></font>
i_start = its<a name='1801'>
<font color=#447700>! recompute : i_start<a name='1802'></font>
i_end = ite<a name='1803'>
<font color=#447700>! recompute : i_end<a name='1804'></font>
j_start = jts<a name='1805'>
<font color=#447700>! recompute : j_start<a name='1806'></font>
j_end = min(jte,jde-1)<a name='1807'>
<font color=#447700>! recompute : j_end<a name='1808'></font>
if (config_flags%open_ys .or. specified) then<a name='1809'>
  i_start = max(ids+1,its)<a name='1810'>
endif<a name='1811'>
<font color=#447700>! recompute : i_start<a name='1812'></font>
if (config_flags%open_ye .or. specified) then<a name='1813'>
  i_end = min(ide-1,ite)<a name='1814'>
endif<a name='1815'>
<font color=#447700>! recompute : i_end<a name='1816'></font>
a_vert_order_test: if (vert_order .eq. 6) then<a name='1817'>
  do j = j_end, j_start, -1<a name='1818'>
    do k = kts, ktf<a name='1819'>
      do i = i_start, i_end<a name='1820'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='1821'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='1822'>
      end do<a name='1823'>
    end do<a name='1824'>
    do i = i_start, i_end<a name='1825'>
      a_vel = 0.<a name='1826'>
      k = ktf-1<a name='1827'>
<font color=#447700>! recompute : k<a name='1828'></font>
      vel = 0.5*(rom(i,k,j)+rom(i-1,k,j))<a name='1829'>
<font color=#447700>! recompute : vel<a name='1830'></font>
      k = ktf<a name='1831'>
<font color=#447700>! recompute : k<a name='1832'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1833'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1834'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='1835'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='1836'>
      a_vflux(i,k) = 0.<a name='1837'>
<font color=#447700>! recdepend vars : ktf<a name='1838'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1251<a name='1839'></font>
<font color=#447700>! recompute vars : k<a name='1840'></font>
      k = ktf-1<a name='1841'>
<font color=#447700>! recompute vars : k<a name='1842'></font>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='1843'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='1844'>
      a_u(i,k+1,j) = a_u(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='1845'>
      a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='1846'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(u(i,k,j)+u(i,k-1,j))-0.083333333*(u(i,k+1,j)+u(i,k-2,j)))<a name='1847'>
      a_vflux(i,k) = 0.<a name='1848'>
<font color=#447700>! recdepend vars : ktf<a name='1849'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1251<a name='1850'></font>
<font color=#447700>! recompute vars : k<a name='1851'></font>
      k = ktf-1<a name='1852'>
<font color=#447700>! recompute vars : k<a name='1853'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='1854'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='1855'>
      a_vel = 0.<a name='1856'>
<font color=#447700>! recdepend vars : kts<a name='1857'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1246<a name='1858'></font>
<font color=#447700>! recompute vars : k<a name='1859'></font>
      k = kts+2<a name='1860'>
<font color=#447700>! recompute vars : k<a name='1861'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='1862'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1247<a name='1863'></font>
<font color=#447700>! recompute vars : vel<a name='1864'></font>
      vel = 0.5*(rom(i,k,j)+rom(i-1,k,j))<a name='1865'>
<font color=#447700>! recompute vars : vel<a name='1866'></font>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='1867'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='1868'>
      a_u(i,k+1,j) = a_u(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='1869'>
      a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='1870'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(u(i,k,j)+u(i,k-1,j))-0.083333333*(u(i,k+1,j)+u(i,k-2,j)))<a name='1871'>
      a_vflux(i,k) = 0.<a name='1872'>
<font color=#447700>! recdepend vars : kts<a name='1873'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1246<a name='1874'></font>
<font color=#447700>! recompute vars : k<a name='1875'></font>
      k = kts+2<a name='1876'>
<font color=#447700>! recompute vars : k<a name='1877'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='1878'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='1879'>
      a_vel = 0.<a name='1880'>
<font color=#447700>! recdepend vars : kts<a name='1881'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1243<a name='1882'></font>
<font color=#447700>! recompute vars : k<a name='1883'></font>
      k = kts+1<a name='1884'>
<font color=#447700>! recompute vars : k<a name='1885'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1886'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1887'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='1888'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='1889'>
      a_vflux(i,k) = 0.<a name='1890'>
    end do<a name='1891'>
    do k = kts+3, ktf-2<a name='1892'>
      a_vel = 0.<a name='1893'>
      do i = i_start, i_end<a name='1894'>
        a_vel = 0.<a name='1895'>
        vel = 0.5*(rom(i-1,k,j)+rom(i,k,j))<a name='1896'>
<font color=#447700>! recompute : vel<a name='1897'></font>
        a_u(i,k-3,j) = a_u(i,k-3,j)+0.016666667*a_vflux(i,k)*vel<a name='1898'>
        a_u(i,k-2,j) = a_u(i,k-2,j)-0.13333333*a_vflux(i,k)*vel<a name='1899'>
        a_u(i,k-1,j) = a_u(i,k-1,j)+0.61666667*a_vflux(i,k)*vel<a name='1900'>
        a_u(i,k+2,j) = a_u(i,k+2,j)+0.016666667*a_vflux(i,k)*vel<a name='1901'>
        a_u(i,k+1,j) = a_u(i,k+1,j)-0.13333333*a_vflux(i,k)*vel<a name='1902'>
        a_u(i,k,j) = a_u(i,k,j)+0.61666667*a_vflux(i,k)*vel<a name='1903'>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(u(i,k,j)+u(i,k-1,j))-0.13333333*(u(i,k+1,j)+u(i,k-2,j))+0.016666667*(u(i,k+2,j)+&amp;<a name='1904'>
&amp;u(i,k-3,j)))<a name='1905'>
        a_vflux(i,k) = 0.<a name='1906'>
        a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='1907'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='1908'>
        a_vel = 0.<a name='1909'>
      end do<a name='1910'>
    end do<a name='1911'>
  end do<a name='1912'>
else if (vert_order .eq. 5) then a_vert_order_test<a name='1913'>
  do j = j_end, j_start, -1<a name='1914'>
    do k = kts, ktf<a name='1915'>
      do i = i_start, i_end<a name='1916'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='1917'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='1918'>
      end do<a name='1919'>
    end do<a name='1920'>
    do i = i_start, i_end<a name='1921'>
      a_vel = 0.<a name='1922'>
      k = ktf-1<a name='1923'>
<font color=#447700>! recompute : k<a name='1924'></font>
      vel = 0.5*(rom(i,k,j)+rom(i-1,k,j))<a name='1925'>
<font color=#447700>! recompute : vel<a name='1926'></font>
      k = ktf<a name='1927'>
<font color=#447700>! recompute : k<a name='1928'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1929'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1930'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='1931'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='1932'>
      a_vflux(i,k) = 0.<a name='1933'>
<font color=#447700>! recdepend vars : ktf<a name='1934'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1291<a name='1935'></font>
<font color=#447700>! recompute vars : k<a name='1936'></font>
      k = ktf-1<a name='1937'>
<font color=#447700>! recompute vars : k<a name='1938'></font>
      a_u(i,k-2,j) = a_u(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='1939'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='1940'>
      a_u(i,k+1,j) = a_u(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='1941'>
      a_u(i,k,j) = a_u(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='1942'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(u(i,k,j)+u(i,k-1,j))-0.083333333*(u(i,k+1,j)+u(i,k-2,j))+0.083333333*(u(i,k+1,j)-u(i,&amp;<a name='1943'>
&amp;k-2,j)-3.*(u(i,k,j)-u(i,k-1,j)))*sign(1.,-vel))<a name='1944'>
      a_vflux(i,k) = 0.<a name='1945'>
<font color=#447700>! recdepend vars : ktf<a name='1946'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1291<a name='1947'></font>
<font color=#447700>! recompute vars : k<a name='1948'></font>
      k = ktf-1<a name='1949'>
<font color=#447700>! recompute vars : k<a name='1950'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='1951'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='1952'>
      a_vel = 0.<a name='1953'>
<font color=#447700>! recdepend vars : kts<a name='1954'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1286<a name='1955'></font>
<font color=#447700>! recompute vars : k<a name='1956'></font>
      k = kts+2<a name='1957'>
<font color=#447700>! recompute vars : k<a name='1958'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='1959'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1287<a name='1960'></font>
<font color=#447700>! recompute vars : vel<a name='1961'></font>
      vel = 0.5*(rom(i,k,j)+rom(i-1,k,j))<a name='1962'>
<font color=#447700>! recompute vars : vel<a name='1963'></font>
      a_u(i,k-2,j) = a_u(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='1964'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='1965'>
      a_u(i,k+1,j) = a_u(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='1966'>
      a_u(i,k,j) = a_u(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='1967'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(u(i,k,j)+u(i,k-1,j))-0.083333333*(u(i,k+1,j)+u(i,k-2,j))+0.083333333*(u(i,k+1,j)-u(i,&amp;<a name='1968'>
&amp;k-2,j)-3.*(u(i,k,j)-u(i,k-1,j)))*sign(1.,-vel))<a name='1969'>
      a_vflux(i,k) = 0.<a name='1970'>
<font color=#447700>! recdepend vars : kts<a name='1971'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1286<a name='1972'></font>
<font color=#447700>! recompute vars : k<a name='1973'></font>
      k = kts+2<a name='1974'>
<font color=#447700>! recompute vars : k<a name='1975'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='1976'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='1977'>
      a_vel = 0.<a name='1978'>
<font color=#447700>! recdepend vars : kts<a name='1979'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1283<a name='1980'></font>
<font color=#447700>! recompute vars : k<a name='1981'></font>
      k = kts+1<a name='1982'>
<font color=#447700>! recompute vars : k<a name='1983'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1984'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='1985'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='1986'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='1987'>
      a_vflux(i,k) = 0.<a name='1988'>
    end do<a name='1989'>
    do k = kts+3, ktf-2<a name='1990'>
      a_vel = 0.<a name='1991'>
      do i = i_start, i_end<a name='1992'>
        a_vel = 0.<a name='1993'>
        vel = 0.5*(rom(i-1,k,j)+rom(i,k,j))<a name='1994'>
<font color=#447700>! recompute : vel<a name='1995'></font>
        a_u(i,k-3,j) = a_u(i,k-3,j)+a_vflux(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,-vel))<a name='1996'>
        a_u(i,k-2,j) = a_u(i,k-2,j)+a_vflux(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,-vel))<a name='1997'>
        a_u(i,k-1,j) = a_u(i,k-1,j)+a_vflux(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,-vel))<a name='1998'>
        a_u(i,k+2,j) = a_u(i,k+2,j)+a_vflux(i,k)*vel*(0.016666667-0.016666667*sign(1.,-vel))<a name='1999'>
        a_u(i,k+1,j) = a_u(i,k+1,j)+a_vflux(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,-vel))<a name='2000'>
        a_u(i,k,j) = a_u(i,k,j)+a_vflux(i,k)*vel*(0.61666667-0.16666667*sign(1.,-vel))<a name='2001'>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(u(i,k,j)+u(i,k-1,j))-0.13333333*(u(i,k+1,j)+u(i,k-2,j))+0.016666667*(u(i,k+2,j)+&amp;<a name='2002'>
&amp;u(i,k-3,j))-0.016666667*(u(i,k+2,j)-u(i,k-3,j)-5.*(u(i,k+1,j)-u(i,k-2,j))+10.*(u(i,k,j)-u(i,k-1,j)))*sign(1.,-vel))<a name='2003'>
        a_vflux(i,k) = 0.<a name='2004'>
        a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='2005'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='2006'>
        a_vel = 0.<a name='2007'>
      end do<a name='2008'>
    end do<a name='2009'>
  end do<a name='2010'>
else if (vert_order .eq. 4) then a_vert_order_test<a name='2011'>
  do j = j_end, j_start, -1<a name='2012'>
    do k = kts, ktf<a name='2013'>
      do i = i_start, i_end<a name='2014'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='2015'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='2016'>
      end do<a name='2017'>
    end do<a name='2018'>
    do i = i_start, i_end<a name='2019'>
      k = ktf<a name='2020'>
<font color=#447700>! recompute : k<a name='2021'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2022'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2023'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='2024'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='2025'>
      a_vflux(i,k) = 0.<a name='2026'>
<font color=#447700>! recdepend vars : kts<a name='2027'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1323<a name='2028'></font>
<font color=#447700>! recompute vars : k<a name='2029'></font>
      k = kts+1<a name='2030'>
<font color=#447700>! recompute vars : k<a name='2031'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2032'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2033'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='2034'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='2035'>
      a_vflux(i,k) = 0.<a name='2036'>
    end do<a name='2037'>
    do k = kts+2, ktf-1<a name='2038'>
      a_vel = 0.<a name='2039'>
      do i = i_start, i_end<a name='2040'>
        a_vel = 0.<a name='2041'>
        vel = 0.5*(rom(i-1,k,j)+rom(i,k,j))<a name='2042'>
<font color=#447700>! recompute : vel<a name='2043'></font>
        a_u(i,k-2,j) = a_u(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='2044'>
        a_u(i,k-1,j) = a_u(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='2045'>
        a_u(i,k+1,j) = a_u(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='2046'>
        a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='2047'>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(u(i,k,j)+u(i,k-1,j))-0.083333333*(u(i,k+1,j)+u(i,k-2,j)))<a name='2048'>
        a_vflux(i,k) = 0.<a name='2049'>
        a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='2050'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='2051'>
        a_vel = 0.<a name='2052'>
      end do<a name='2053'>
    end do<a name='2054'>
  end do<a name='2055'>
else if (vert_order .eq. 3) then a_vert_order_test<a name='2056'>
  do j = j_end, j_start, -1<a name='2057'>
    do k = kts, ktf<a name='2058'>
      do i = i_start, i_end<a name='2059'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='2060'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='2061'>
      end do<a name='2062'>
    end do<a name='2063'>
    do i = i_start, i_end<a name='2064'>
      k = ktf<a name='2065'>
<font color=#447700>! recompute : k<a name='2066'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2067'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2068'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='2069'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='2070'>
      a_vflux(i,k) = 0.<a name='2071'>
<font color=#447700>! recdepend vars : kts<a name='2072'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1353<a name='2073'></font>
<font color=#447700>! recompute vars : k<a name='2074'></font>
      k = kts+1<a name='2075'>
<font color=#447700>! recompute vars : k<a name='2076'></font>
      a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2077'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2078'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='2079'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='2080'>
      a_vflux(i,k) = 0.<a name='2081'>
    end do<a name='2082'>
    do k = kts+2, ktf-1<a name='2083'>
      a_vel = 0.<a name='2084'>
      do i = i_start, i_end<a name='2085'>
        a_vel = 0.<a name='2086'>
        vel = 0.5*(rom(i-1,k,j)+rom(i,k,j))<a name='2087'>
<font color=#447700>! recompute : vel<a name='2088'></font>
        a_u(i,k-2,j) = a_u(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='2089'>
        a_u(i,k-1,j) = a_u(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='2090'>
        a_u(i,k+1,j) = a_u(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='2091'>
        a_u(i,k,j) = a_u(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='2092'>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(u(i,k,j)+u(i,k-1,j))-0.083333333*(u(i,k+1,j)+u(i,k-2,j))+0.083333333*(u(i,k+1,j)-&amp;<a name='2093'>
&amp;u(i,k-2,j)-3.*(u(i,k,j)-u(i,k-1,j)))*sign(1.,-vel))<a name='2094'>
        a_vflux(i,k) = 0.<a name='2095'>
        a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vel<a name='2096'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='2097'>
        a_vel = 0.<a name='2098'>
      end do<a name='2099'>
    end do<a name='2100'>
  end do<a name='2101'>
else if (vert_order .eq. 2) then a_vert_order_test<a name='2102'>
  do j = j_start, j_end<a name='2103'>
    do k = kts, ktf<a name='2104'>
      do i = i_start, i_end<a name='2105'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='2106'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='2107'>
      end do<a name='2108'>
    end do<a name='2109'>
    do k = kts+1, ktf<a name='2110'>
      do i = i_start, i_end<a name='2111'>
        a_rom(i-1,k,j) = a_rom(i-1,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2112'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*u(i,k,j)+fzp(k)*u(i,k-1,j))<a name='2113'>
        a_u(i,k-1,j) = a_u(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzp(k)<a name='2114'>
        a_u(i,k,j) = a_u(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i-1,k,j))*fzm(k)<a name='2115'>
        a_vflux(i,k) = 0.<a name='2116'>
      end do<a name='2117'>
    end do<a name='2118'>
  end do<a name='2119'>
endif a_vert_order_test<a name='2120'>
<font color=#447700>! recdepend vars : its<a name='2121'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1152<a name='2122'></font>
<font color=#447700>! recompute vars : i_start<a name='2123'></font>
i_start = its<a name='2124'>
<font color=#447700>! recompute vars : i_start<a name='2125'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='2126'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1153<a name='2127'></font>
<font color=#447700>! recompute vars : i_end<a name='2128'></font>
i_end = min(ite,ide)<a name='2129'>
<font color=#447700>! recompute vars : i_end<a name='2130'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ids,its<a name='2131'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1157<a name='2132'></font>
<font color=#447700>! recompute vars : i_start<a name='2133'></font>
if (config_flags%open_xs) then<a name='2134'>
  i_start = max(ids+1,its)<a name='2135'>
endif<a name='2136'>
<font color=#447700>! recompute vars : i_start<a name='2137'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ide,ite<a name='2138'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1161<a name='2139'></font>
<font color=#447700>! recompute vars : i_end<a name='2140'></font>
if (config_flags%open_xe) then<a name='2141'>
  i_end = min(ite,ide-1)<a name='2142'>
endif<a name='2143'>
<font color=#447700>! recompute vars : i_end<a name='2144'></font>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='2145'>
  do i = i_start, i_end<a name='2146'>
    a_dvm = 0.<a name='2147'>
    a_dvp = 0.<a name='2148'>
    a_vb = 0.<a name='2149'>
    a_vw = 0.<a name='2150'>
    mrdy = msfu(i,jte-1)*rdy<a name='2151'>
<font color=#447700>! recompute : mrdy<a name='2152'></font>
    ip = min(imax,i)<a name='2153'>
<font color=#447700>! recompute : ip<a name='2154'></font>
    im = max(imin,i-1)<a name='2155'>
<font color=#447700>! recompute : im<a name='2156'></font>
    do k = kts, ktf<a name='2157'>
      a_dvm = 0.<a name='2158'>
      a_dvp = 0.<a name='2159'>
      a_vb = 0.<a name='2160'>
      a_vw = 0.<a name='2161'>
      vw = 0.5*(rv(ip,k,jte)+rv(im,k,jte))<a name='2162'>
<font color=#447700>! recompute : vw<a name='2163'></font>
      vb = max(vw,0.)<a name='2164'>
<font color=#447700>! recompute : vb<a name='2165'></font>
      dvm = rv(ip,k,jte)-rv(ip,k,jte-1)<a name='2166'>
<font color=#447700>! recompute : dvm<a name='2167'></font>
      dvp = rv(im,k,jte)-rv(im,k,jte-1)<a name='2168'>
<font color=#447700>! recompute : dvp<a name='2169'></font>
      a_dvm = a_dvm-0.5*a_tendency(i,k,jte-1)*mrdy*u(i,k,jte-1)<a name='2170'>
      a_dvp = a_dvp-0.5*a_tendency(i,k,jte-1)*mrdy*u(i,k,jte-1)<a name='2171'>
      a_u(i,k,jte-1) = a_u(i,k,jte-1)-0.5*a_tendency(i,k,jte-1)*mrdy*(dvm+dvp)<a name='2172'>
      a_u_old(i,k,jte-2) = a_u_old(i,k,jte-2)+a_tendency(i,k,jte-1)*mrdy*vb<a name='2173'>
      a_u_old(i,k,jte-1) = a_u_old(i,k,jte-1)-a_tendency(i,k,jte-1)*mrdy*vb<a name='2174'>
      a_vb = a_vb-a_tendency(i,k,jte-1)*mrdy*(u_old(i,k,jte-1)-u_old(i,k,jte-2))<a name='2175'>
      a_rv(im,k,jte-1) = a_rv(im,k,jte-1)-a_dvp<a name='2176'>
      a_rv(im,k,jte) = a_rv(im,k,jte)+a_dvp<a name='2177'>
      a_dvp = 0.<a name='2178'>
      a_rv(ip,k,jte-1) = a_rv(ip,k,jte-1)-a_dvm<a name='2179'>
      a_rv(ip,k,jte) = a_rv(ip,k,jte)+a_dvm<a name='2180'>
      a_dvm = 0.<a name='2181'>
      a_vw = a_vw+a_vb*(0.5+sign(0.5,vw-0.))<a name='2182'>
      a_vb = 0.<a name='2183'>
      a_rv(im,k,jte) = a_rv(im,k,jte)+0.5*a_vw<a name='2184'>
      a_rv(ip,k,jte) = a_rv(ip,k,jte)+0.5*a_vw<a name='2185'>
      a_vw = 0.<a name='2186'>
    end do<a name='2187'>
  end do<a name='2188'>
endif<a name='2189'>
<font color=#447700>! recdepend vars : its<a name='2190'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1152<a name='2191'></font>
<font color=#447700>! recompute vars : i_start<a name='2192'></font>
i_start = its<a name='2193'>
<font color=#447700>! recompute vars : i_start<a name='2194'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='2195'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1153<a name='2196'></font>
<font color=#447700>! recompute vars : i_end<a name='2197'></font>
i_end = min(ite,ide)<a name='2198'>
<font color=#447700>! recompute vars : i_end<a name='2199'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ids,its<a name='2200'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1157<a name='2201'></font>
<font color=#447700>! recompute vars : i_start<a name='2202'></font>
if (config_flags%open_xs) then<a name='2203'>
  i_start = max(ids+1,its)<a name='2204'>
endif<a name='2205'>
<font color=#447700>! recompute vars : i_start<a name='2206'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ide,ite<a name='2207'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1161<a name='2208'></font>
<font color=#447700>! recompute vars : i_end<a name='2209'></font>
if (config_flags%open_xe) then<a name='2210'>
  i_end = min(ite,ide-1)<a name='2211'>
endif<a name='2212'>
<font color=#447700>! recompute vars : i_end<a name='2213'></font>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='2214'>
  do i = i_start, i_end<a name='2215'>
    a_dvm = 0.<a name='2216'>
    a_dvp = 0.<a name='2217'>
    a_vb = 0.<a name='2218'>
    a_vw = 0.<a name='2219'>
    mrdy = msfu(i,jts)*rdy<a name='2220'>
<font color=#447700>! recompute : mrdy<a name='2221'></font>
    ip = min(imax,i)<a name='2222'>
<font color=#447700>! recompute : ip<a name='2223'></font>
    im = max(imin,i-1)<a name='2224'>
<font color=#447700>! recompute : im<a name='2225'></font>
    do k = kts, ktf<a name='2226'>
      a_dvm = 0.<a name='2227'>
      a_dvp = 0.<a name='2228'>
      a_vb = 0.<a name='2229'>
      a_vw = 0.<a name='2230'>
      vw = 0.5*(rv(ip,k,jts)+rv(im,k,jts))<a name='2231'>
<font color=#447700>! recompute : vw<a name='2232'></font>
      vb = min(vw,0.)<a name='2233'>
<font color=#447700>! recompute : vb<a name='2234'></font>
      dvm = rv(ip,k,jts+1)-rv(ip,k,jts)<a name='2235'>
<font color=#447700>! recompute : dvm<a name='2236'></font>
      dvp = rv(im,k,jts+1)-rv(im,k,jts)<a name='2237'>
<font color=#447700>! recompute : dvp<a name='2238'></font>
      a_dvm = a_dvm-0.5*a_tendency(i,k,jts)*mrdy*u(i,k,jts)<a name='2239'>
      a_dvp = a_dvp-0.5*a_tendency(i,k,jts)*mrdy*u(i,k,jts)<a name='2240'>
      a_u(i,k,jts) = a_u(i,k,jts)-0.5*a_tendency(i,k,jts)*mrdy*(dvm+dvp)<a name='2241'>
      a_u_old(i,k,jts+1) = a_u_old(i,k,jts+1)-a_tendency(i,k,jts)*mrdy*vb<a name='2242'>
      a_u_old(i,k,jts) = a_u_old(i,k,jts)+a_tendency(i,k,jts)*mrdy*vb<a name='2243'>
      a_vb = a_vb-a_tendency(i,k,jts)*mrdy*(u_old(i,k,jts+1)-u_old(i,k,jts))<a name='2244'>
      a_rv(im,k,jts+1) = a_rv(im,k,jts+1)+a_dvp<a name='2245'>
      a_rv(im,k,jts) = a_rv(im,k,jts)-a_dvp<a name='2246'>
      a_dvp = 0.<a name='2247'>
      a_rv(ip,k,jts+1) = a_rv(ip,k,jts+1)+a_dvm<a name='2248'>
      a_rv(ip,k,jts) = a_rv(ip,k,jts)-a_dvm<a name='2249'>
      a_dvm = 0.<a name='2250'>
      a_vw = a_vw+a_vb*(0.5+sign(0.5,0.-vw))<a name='2251'>
      a_vb = 0.<a name='2252'>
      a_rv(im,k,jts) = a_rv(im,k,jts)+0.5*a_vw<a name='2253'>
      a_rv(ip,k,jts) = a_rv(ip,k,jts)+0.5*a_vw<a name='2254'>
      a_vw = 0.<a name='2255'>
    end do<a name='2256'>
  end do<a name='2257'>
endif<a name='2258'>
if (config_flags%open_xe .and. ite .eq. ide) then<a name='2259'>
  j_start = jts<a name='2260'>
<font color=#447700>! recompute : j_start<a name='2261'></font>
  j_end = min(jte,jde-1)<a name='2262'>
<font color=#447700>! recompute : j_end<a name='2263'></font>
  do j = j_start, j_end<a name='2264'>
    a_ub = 0.<a name='2265'>
    do k = kts, ktf<a name='2266'>
      a_ub = 0.<a name='2267'>
      ub = max(ru(ite,k,j)+cb*mut(ite-1,j),0.)<a name='2268'>
<font color=#447700>! recompute : ub<a name='2269'></font>
      a_u_old(ite-1,k,j) = a_u_old(ite-1,k,j)+a_tendency(ite,k,j)*rdx*ub<a name='2270'>
      a_u_old(ite,k,j) = a_u_old(ite,k,j)-a_tendency(ite,k,j)*rdx*ub<a name='2271'>
      a_ub = a_ub-a_tendency(ite,k,j)*rdx*(u_old(ite,k,j)-u_old(ite-1,k,j))<a name='2272'>
      a_mut(ite-1,j) = a_mut(ite-1,j)+a_ub*(0.5+sign(0.5,ru(ite,k,j)+cb*mut(ite-1,j)-0.))*cb<a name='2273'>
      a_ru(ite,k,j) = a_ru(ite,k,j)+a_ub*(0.5+sign(0.5,ru(ite,k,j)+cb*mut(ite-1,j)-0.))<a name='2274'>
      a_ub = 0.<a name='2275'>
    end do<a name='2276'>
  end do<a name='2277'>
endif<a name='2278'>
if (config_flags%open_xs .and. its .eq. ids) then<a name='2279'>
  j_start = jts<a name='2280'>
<font color=#447700>! recompute : j_start<a name='2281'></font>
  j_end = min(jte,jde-1)<a name='2282'>
<font color=#447700>! recompute : j_end<a name='2283'></font>
  do j = j_start, j_end<a name='2284'>
    a_ub = 0.<a name='2285'>
    do k = kts, ktf<a name='2286'>
      a_ub = 0.<a name='2287'>
      ub = min(ru(its,k,j)-cb*mut(its,j),0.)<a name='2288'>
<font color=#447700>! recompute : ub<a name='2289'></font>
      a_u_old(its+1,k,j) = a_u_old(its+1,k,j)-a_tendency(its,k,j)*rdx*ub<a name='2290'>
      a_u_old(its,k,j) = a_u_old(its,k,j)+a_tendency(its,k,j)*rdx*ub<a name='2291'>
      a_ub = a_ub-a_tendency(its,k,j)*rdx*(u_old(its+1,k,j)-u_old(its,k,j))<a name='2292'>
      a_mut(its,j) = a_mut(its,j)-a_ub*(0.5+sign(0.5,0.-(ru(its,k,j)-cb*mut(its,j))))*cb<a name='2293'>
      a_ru(its,k,j) = a_ru(its,k,j)+a_ub*(0.5+sign(0.5,0.-(ru(its,k,j)-cb*mut(its,j))))<a name='2294'>
      a_ub = 0.<a name='2295'>
    end do<a name='2296'>
  end do<a name='2297'>
endif<a name='2298'>
a_horizontal_order_test: if (horz_order .eq. 6) then<a name='2299'>
  degrade_xs =  .true. <a name='2300'>
<font color=#447700>! recompute : degrade_xs<a name='2301'></font>
  degrade_xe =  .true. <a name='2302'>
<font color=#447700>! recompute : degrade_xe<a name='2303'></font>
  degrade_ys =  .true. <a name='2304'>
<font color=#447700>! recompute : degrade_ys<a name='2305'></font>
  degrade_ye =  .true. <a name='2306'>
<font color=#447700>! recompute : degrade_ye<a name='2307'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='2308'>
    degrade_xs =  .false. <a name='2309'>
  endif<a name='2310'>
<font color=#447700>! recompute : degrade_xs<a name='2311'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='2312'>
    degrade_xe =  .false. <a name='2313'>
  endif<a name='2314'>
<font color=#447700>! recompute : degrade_xe<a name='2315'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='2316'>
    degrade_ys =  .false. <a name='2317'>
  endif<a name='2318'>
<font color=#447700>! recompute : degrade_ys<a name='2319'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-3) then<a name='2320'>
    degrade_ye =  .false. <a name='2321'>
  endif<a name='2322'>
<font color=#447700>! recompute : degrade_ye<a name='2323'></font>
  j_start = jts<a name='2324'>
<font color=#447700>! recompute : j_start<a name='2325'></font>
  j_end = min(jte,jde-1)<a name='2326'>
<font color=#447700>! recompute : j_end<a name='2327'></font>
  j_start_f = j_start<a name='2328'>
<font color=#447700>! recompute : j_start_f<a name='2329'></font>
  j_end_f = j_end+1<a name='2330'>
<font color=#447700>! recompute : j_end_f<a name='2331'></font>
  if (degrade_ys) then<a name='2332'>
    j_start_f = jds+3<a name='2333'>
  endif<a name='2334'>
<font color=#447700>! recompute : j_start_f<a name='2335'></font>
  if (degrade_ye) then<a name='2336'>
    j_end_f = jde-3<a name='2337'>
  endif<a name='2338'>
<font color=#447700>! recompute : j_end_f<a name='2339'></font>
  i_start = its<a name='2340'>
<font color=#447700>! recompute : i_start<a name='2341'></font>
  i_end = ite<a name='2342'>
<font color=#447700>! recompute : i_end<a name='2343'></font>
  j_start = jts<a name='2344'>
<font color=#447700>! recompute : j_start<a name='2345'></font>
  j_end = min(jte,jde-1)<a name='2346'>
<font color=#447700>! recompute : j_end<a name='2347'></font>
  i_start_f = i_start<a name='2348'>
<font color=#447700>! recompute : i_start_f<a name='2349'></font>
  i_end_f = i_end+1<a name='2350'>
<font color=#447700>! recompute : i_end_f<a name='2351'></font>
  if (degrade_xs) then<a name='2352'>
    i_start = max(ids+1,its)<a name='2353'>
    i_start_f = ids+3<a name='2354'>
  endif<a name='2355'>
<font color=#447700>! recompute : i_start,i_start_f<a name='2356'></font>
  if (degrade_xe) then<a name='2357'>
    i_end = min(ide-1,ite)<a name='2358'>
    i_end_f = ide-2<a name='2359'>
  endif<a name='2360'>
<font color=#447700>! recompute : i_end,i_end_f<a name='2361'></font>
  do j = j_end, j_start, -1<a name='2362'>
    do k = kts, ktf<a name='2363'>
      do i = i_start, i_end<a name='2364'>
        mrdx = msfu(i,j)*rdx<a name='2365'>
<font color=#447700>! recompute : mrdx<a name='2366'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='2367'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='2368'>
      end do<a name='2369'>
    end do<a name='2370'>
    if (degrade_xe) then<a name='2371'>
      do k = kts, ktf<a name='2372'>
        a_vel = 0.<a name='2373'>
        i = ide-1<a name='2374'>
<font color=#447700>! recompute : i<a name='2375'></font>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='2376'>
<font color=#447700>! recompute : vel<a name='2377'></font>
        a_u(i-2,k,j) = a_u(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='2378'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='2379'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='2380'>
        a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='2381'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(u(i,k,j)+u(i-1,k,j))-0.083333333*(u(i+1,k,j)+u(i-2,k,j)))<a name='2382'>
        a_fqx(i,k) = 0.<a name='2383'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='2384'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='2385'>
        a_vel = 0.<a name='2386'>
      end do<a name='2387'>
      if (i_end .eq. ide-1) then<a name='2388'>
        i = ide<a name='2389'>
<font color=#447700>! recompute : i<a name='2390'></font>
        do k = kts, ktf<a name='2391'>
          a_ub = 0.<a name='2392'>
          ub = u(i,k,j)<a name='2393'>
<font color=#447700>! recompute : ub<a name='2394'></font>
          if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='2395'>
            ub = u(i-1,k,j)<a name='2396'>
          endif<a name='2397'>
<font color=#447700>! recompute : ub<a name='2398'></font>
          a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='2399'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='2400'>
          a_u(i-1,k,j) = a_u(i-1,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2401'>
          a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2402'>
          a_fqx(i,k) = 0.<a name='2403'>
          if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='2404'>
            a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='2405'>
            a_ub = 0.<a name='2406'>
          endif<a name='2407'>
          a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='2408'>
          a_ub = 0.<a name='2409'>
        end do<a name='2410'>
      endif<a name='2411'>
    endif<a name='2412'>
    if (degrade_xs) then<a name='2413'>
      i = ids+2<a name='2414'>
<font color=#447700>! recompute : i<a name='2415'></font>
      do k = kts, ktf<a name='2416'>
        a_vel = 0.<a name='2417'>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='2418'>
<font color=#447700>! recompute : vel<a name='2419'></font>
        a_u(i-2,k,j) = a_u(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='2420'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='2421'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='2422'>
        a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='2423'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(u(i,k,j)+u(i-1,k,j))-0.083333333*(u(i+1,k,j)+u(i-2,k,j)))<a name='2424'>
        a_fqx(i,k) = 0.<a name='2425'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='2426'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='2427'>
        a_vel = 0.<a name='2428'>
      end do<a name='2429'>
      if (i_start .eq. ids+1) then<a name='2430'>
        i = ids+1<a name='2431'>
<font color=#447700>! recompute : i<a name='2432'></font>
        do k = kts, ktf<a name='2433'>
          a_ub = 0.<a name='2434'>
          ub = u(i-1,k,j)<a name='2435'>
<font color=#447700>! recompute : ub<a name='2436'></font>
          if (specified .and. u(i,k,j) .lt. 0.) then<a name='2437'>
            ub = u(i,k,j)<a name='2438'>
          endif<a name='2439'>
<font color=#447700>! recompute : ub<a name='2440'></font>
          a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='2441'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='2442'>
          a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2443'>
          a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2444'>
          a_fqx(i,k) = 0.<a name='2445'>
          if (specified .and. u(i,k,j) .lt. 0.) then<a name='2446'>
            a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='2447'>
            a_ub = 0.<a name='2448'>
          endif<a name='2449'>
          a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='2450'>
          a_ub = 0.<a name='2451'>
        end do<a name='2452'>
      endif<a name='2453'>
    endif<a name='2454'>
    do k = kts, ktf<a name='2455'>
      a_vel = 0.<a name='2456'>
      do i = i_start_f, i_end_f<a name='2457'>
        a_vel = 0.<a name='2458'>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='2459'>
<font color=#447700>! recompute : vel<a name='2460'></font>
        a_u(i-3,k,j) = a_u(i-3,k,j)+0.016666667*a_fqx(i,k)*vel<a name='2461'>
        a_u(i-2,k,j) = a_u(i-2,k,j)-0.13333333*a_fqx(i,k)*vel<a name='2462'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.61666667*a_fqx(i,k)*vel<a name='2463'>
        a_u(i+2,k,j) = a_u(i+2,k,j)+0.016666667*a_fqx(i,k)*vel<a name='2464'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.13333333*a_fqx(i,k)*vel<a name='2465'>
        a_u(i,k,j) = a_u(i,k,j)+0.61666667*a_fqx(i,k)*vel<a name='2466'>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(u(i,k,j)+u(i-1,k,j))-0.13333333*(u(i+1,k,j)+u(i-2,k,j))+0.016666667*(u(i+2,k,j)+u(i-&amp;<a name='2467'>
&amp;3,k,j)))<a name='2468'>
        a_fqx(i,k) = 0.<a name='2469'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='2470'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='2471'>
        a_vel = 0.<a name='2472'>
      end do<a name='2473'>
    end do<a name='2474'>
  end do<a name='2475'>
<font color=#447700>! recdepend vars : its<a name='2476'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:249<a name='2477'></font>
<font color=#447700>! recompute vars : i_start<a name='2478'></font>
  i_start = its<a name='2479'>
<font color=#447700>! recompute vars : i_start<a name='2480'></font>
<font color=#447700>! recdepend vars : i_start,ite<a name='2481'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:250<a name='2482'></font>
<font color=#447700>! recompute vars : i_end<a name='2483'></font>
  i_end = ite<a name='2484'>
<font color=#447700>! recompute vars : i_end<a name='2485'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ids,its,specified<a name='2486'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:251<a name='2487'></font>
<font color=#447700>! recompute vars : i_start<a name='2488'></font>
  if (config_flags%open_xs .or. specified) then<a name='2489'>
    i_start = max(ids+1,its)<a name='2490'>
  endif<a name='2491'>
<font color=#447700>! recompute vars : i_start<a name='2492'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ide,ite,specified<a name='2493'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:252<a name='2494'></font>
<font color=#447700>! recompute vars : i_end<a name='2495'></font>
  if (config_flags%open_xe .or. specified) then<a name='2496'>
    i_end = min(ide-1,ite)<a name='2497'>
  endif<a name='2498'>
<font color=#447700>! recompute vars : i_end<a name='2499'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='2500'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:254<a name='2501'></font>
<font color=#447700>! recompute vars : j_start<a name='2502'></font>
  j_start = jts<a name='2503'>
<font color=#447700>! recompute vars : j_start<a name='2504'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='2505'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:255<a name='2506'></font>
<font color=#447700>! recompute vars : j_end<a name='2507'></font>
  j_end = min(jte,jde-1)<a name='2508'>
<font color=#447700>! recompute vars : j_end<a name='2509'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='2510'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:263<a name='2511'></font>
<font color=#447700>! recompute vars : j_start<a name='2512'></font>
  if (degrade_ys) then<a name='2513'>
    j_start = max(jts,jds+1)<a name='2514'>
  endif<a name='2515'>
<font color=#447700>! recompute vars : j_start<a name='2516'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='2517'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:268<a name='2518'></font>
<font color=#447700>! recompute vars : j_end<a name='2519'></font>
  if (degrade_ye) then<a name='2520'>
    j_end = min(jte,jde-2)<a name='2521'>
  endif<a name='2522'>
<font color=#447700>! recompute vars : j_end<a name='2523'></font>
  a_j_loop_y_flux_6: do j = j_end+1, j_start, -1<a name='2524'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:275<a name='2525'></font>
<font color=#447700>! recompute vars : jp1<a name='2526'></font>
    jp1 = 2<a name='2527'>
<font color=#447700>! recompute vars : jp1<a name='2528'></font>
<font color=#447700>! recdepend vars : jp1<a name='2529'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:276<a name='2530'></font>
<font color=#447700>! recompute vars : jp0<a name='2531'></font>
    jp0 = 1<a name='2532'>
<font color=#447700>! recompute vars : jp0<a name='2533'></font>
    j_loop_y_flux_9c: do j4 = j_start, j-1<a name='2534'>
      jtmp = jp1<a name='2535'>
      jp1 = jp0<a name='2536'>
      jp0 = jtmp<a name='2537'>
    end do j_loop_y_flux_9c<a name='2538'>
<font color=#447700>!    if (j .gt. j_start) then<a name='2539'></font>
    if (j .gt. jds+1) then<a name='2540'>
      do k = kts, ktf<a name='2541'>
        do i = i_start, i_end<a name='2542'>
          mrdy = msfu(i,j-1)*rdy<a name='2543'>
<font color=#447700>! recompute : mrdy<a name='2544'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='2545'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='2546'>
        end do<a name='2547'>
      end do<a name='2548'>
    endif<a name='2549'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='2550'>
      do k = kts, ktf<a name='2551'>
        a_vel = 0.<a name='2552'>
        do i = i_start, i_end<a name='2553'>
          a_vel = 0.<a name='2554'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='2555'>
<font color=#447700>! recompute : vel<a name='2556'></font>
          a_u(i,k,j-3) = a_u(i,k,j-3)+0.016666667*a_fqy(i,k,jp1)*vel<a name='2557'>
          a_u(i,k,j-2) = a_u(i,k,j-2)-0.13333333*a_fqy(i,k,jp1)*vel<a name='2558'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.61666667*a_fqy(i,k,jp1)*vel<a name='2559'>
          a_u(i,k,j+2) = a_u(i,k,j+2)+0.016666667*a_fqy(i,k,jp1)*vel<a name='2560'>
          a_u(i,k,j+1) = a_u(i,k,j+1)-0.13333333*a_fqy(i,k,jp1)*vel<a name='2561'>
          a_u(i,k,j) = a_u(i,k,j)+0.61666667*a_fqy(i,k,jp1)*vel<a name='2562'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(u(i,k,j)+u(i,k,j-1))-0.13333333*(u(i,k,j+1)+u(i,k,j-2))+0.016666667*(u(i,k,j+2)&amp;<a name='2563'>
&amp;+u(i,k,j-3)))<a name='2564'>
          a_fqy(i,k,jp1) = 0.<a name='2565'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='2566'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='2567'>
          a_vel = 0.<a name='2568'>
        end do<a name='2569'>
      end do<a name='2570'>
    else if (j .eq. jds+1) then<a name='2571'>
      do k = kts, ktf<a name='2572'>
        do i = i_start, i_end<a name='2573'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2574'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2575'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2576'>
          a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2577'>
          a_fqy(i,k,jp1) = 0.<a name='2578'>
        end do<a name='2579'>
      end do<a name='2580'>
    else if (j .eq. jds+2) then<a name='2581'>
      do k = kts, ktf<a name='2582'>
        a_vel = 0.<a name='2583'>
        do i = i_start, i_end<a name='2584'>
          a_vel = 0.<a name='2585'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='2586'>
<font color=#447700>! recompute : vel<a name='2587'></font>
          a_u(i,k,j-2) = a_u(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='2588'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='2589'>
          a_u(i,k,j+1) = a_u(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='2590'>
          a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='2591'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(u(i,k,j)+u(i,k,j-1))-0.083333333*(u(i,k,j+1)+u(i,k,j-2)))<a name='2592'>
          a_fqy(i,k,jp1) = 0.<a name='2593'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='2594'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='2595'>
          a_vel = 0.<a name='2596'>
        end do<a name='2597'>
      end do<a name='2598'>
    else if (j .eq. jde-1) then<a name='2599'>
      do k = kts, ktf<a name='2600'>
        do i = i_start, i_end<a name='2601'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2602'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2603'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2604'>
          a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2605'>
          a_fqy(i,k,jp1) = 0.<a name='2606'>
        end do<a name='2607'>
      end do<a name='2608'>
    else if (j .eq. jde-2) then<a name='2609'>
      do k = kts, ktf<a name='2610'>
        a_vel = 0.<a name='2611'>
        do i = i_start, i_end<a name='2612'>
          a_vel = 0.<a name='2613'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='2614'>
<font color=#447700>! recompute : vel<a name='2615'></font>
          a_u(i,k,j-2) = a_u(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='2616'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='2617'>
          a_u(i,k,j+1) = a_u(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='2618'>
          a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='2619'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(u(i,k,j)+u(i,k,j-1))-0.083333333*(u(i,k,j+1)+u(i,k,j-2)))<a name='2620'>
          a_fqy(i,k,jp1) = 0.<a name='2621'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='2622'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='2623'>
          a_vel = 0.<a name='2624'>
        end do<a name='2625'>
      end do<a name='2626'>
    endif<a name='2627'>
  end do a_j_loop_y_flux_6<a name='2628'>
else if (horz_order .eq. 5) then a_horizontal_order_test<a name='2629'>
  degrade_xs =  .true. <a name='2630'>
<font color=#447700>! recompute : degrade_xs<a name='2631'></font>
  degrade_xe =  .true. <a name='2632'>
<font color=#447700>! recompute : degrade_xe<a name='2633'></font>
  degrade_ys =  .true. <a name='2634'>
<font color=#447700>! recompute : degrade_ys<a name='2635'></font>
  degrade_ye =  .true. <a name='2636'>
<font color=#447700>! recompute : degrade_ye<a name='2637'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='2638'>
    degrade_xs =  .false. <a name='2639'>
  endif<a name='2640'>
<font color=#447700>! recompute : degrade_xs<a name='2641'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='2642'>
    degrade_xe =  .false. <a name='2643'>
  endif<a name='2644'>
<font color=#447700>! recompute : degrade_xe<a name='2645'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='2646'>
    degrade_ys =  .false. <a name='2647'>
  endif<a name='2648'>
<font color=#447700>! recompute : degrade_ys<a name='2649'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-3) then<a name='2650'>
    degrade_ye =  .false. <a name='2651'>
  endif<a name='2652'>
<font color=#447700>! recompute : degrade_ye<a name='2653'></font>
  j_start = jts<a name='2654'>
<font color=#447700>! recompute : j_start<a name='2655'></font>
  j_end = min(jte,jde-1)<a name='2656'>
<font color=#447700>! recompute : j_end<a name='2657'></font>
  j_start_f = j_start<a name='2658'>
<font color=#447700>! recompute : j_start_f<a name='2659'></font>
  j_end_f = j_end+1<a name='2660'>
<font color=#447700>! recompute : j_end_f<a name='2661'></font>
  if (degrade_ys) then<a name='2662'>
    j_start_f = jds+3<a name='2663'>
  endif<a name='2664'>
<font color=#447700>! recompute : j_start_f<a name='2665'></font>
  if (degrade_ye) then<a name='2666'>
    j_end_f = jde-3<a name='2667'>
  endif<a name='2668'>
<font color=#447700>! recompute : j_end_f<a name='2669'></font>
  i_start = its<a name='2670'>
<font color=#447700>! recompute : i_start<a name='2671'></font>
  i_end = ite<a name='2672'>
<font color=#447700>! recompute : i_end<a name='2673'></font>
  j_start = jts<a name='2674'>
<font color=#447700>! recompute : j_start<a name='2675'></font>
  j_end = min(jte,jde-1)<a name='2676'>
<font color=#447700>! recompute : j_end<a name='2677'></font>
  i_start_f = i_start<a name='2678'>
<font color=#447700>! recompute : i_start_f<a name='2679'></font>
  i_end_f = i_end+1<a name='2680'>
<font color=#447700>! recompute : i_end_f<a name='2681'></font>
  if (degrade_xs) then<a name='2682'>
    i_start = max(ids+1,its)<a name='2683'>
    i_start_f = ids+3<a name='2684'>
  endif<a name='2685'>
<font color=#447700>! recompute : i_start,i_start_f<a name='2686'></font>
  if (degrade_xe) then<a name='2687'>
    i_end = min(ide-1,ite)<a name='2688'>
    i_end_f = ide-2<a name='2689'>
  endif<a name='2690'>
<font color=#447700>! recompute : i_end,i_end_f<a name='2691'></font>
  do j = j_end, j_start, -1<a name='2692'>
    do k = kts, ktf<a name='2693'>
      do i = i_start, i_end<a name='2694'>
        mrdx = msfu(i,j)*rdx<a name='2695'>
<font color=#447700>! recompute : mrdx<a name='2696'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='2697'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='2698'>
      end do<a name='2699'>
    end do<a name='2700'>
    if (degrade_xe) then<a name='2701'>
      do k = kts, ktf<a name='2702'>
        a_vel = 0.<a name='2703'>
        i = ide-1<a name='2704'>
<font color=#447700>! recompute : i<a name='2705'></font>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='2706'>
<font color=#447700>! recompute : vel<a name='2707'></font>
        a_u(i-2,k,j) = a_u(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='2708'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='2709'>
        a_u(i+1,k,j) = a_u(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='2710'>
        a_u(i,k,j) = a_u(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='2711'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(u(i,k,j)+u(i-1,k,j))-0.083333333*(u(i+1,k,j)+u(i-2,k,j))+0.083333333*(u(i+1,k,j)-u(i-&amp;<a name='2712'>
&amp;2,k,j)-3.*(u(i,k,j)-u(i-1,k,j)))*sign(1.,vel))<a name='2713'>
        a_fqx(i,k) = 0.<a name='2714'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='2715'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='2716'>
        a_vel = 0.<a name='2717'>
      end do<a name='2718'>
      if (i_end .eq. ide-1) then<a name='2719'>
        i = ide<a name='2720'>
<font color=#447700>! recompute : i<a name='2721'></font>
        do k = kts, ktf<a name='2722'>
          a_ub = 0.<a name='2723'>
          ub = u(i,k,j)<a name='2724'>
<font color=#447700>! recompute : ub<a name='2725'></font>
          if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='2726'>
            ub = u(i-1,k,j)<a name='2727'>
          endif<a name='2728'>
<font color=#447700>! recompute : ub<a name='2729'></font>
          a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='2730'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='2731'>
          a_u(i-1,k,j) = a_u(i-1,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2732'>
          a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2733'>
          a_fqx(i,k) = 0.<a name='2734'>
          if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='2735'>
            a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='2736'>
            a_ub = 0.<a name='2737'>
          endif<a name='2738'>
          a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='2739'>
          a_ub = 0.<a name='2740'>
        end do<a name='2741'>
      endif<a name='2742'>
    endif<a name='2743'>
    if (degrade_xs) then<a name='2744'>
      i = ids+2<a name='2745'>
<font color=#447700>! recompute : i<a name='2746'></font>
      do k = kts, ktf<a name='2747'>
        a_vel = 0.<a name='2748'>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='2749'>
<font color=#447700>! recompute : vel<a name='2750'></font>
        a_u(i-2,k,j) = a_u(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='2751'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='2752'>
        a_u(i+1,k,j) = a_u(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='2753'>
        a_u(i,k,j) = a_u(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='2754'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(u(i,k,j)+u(i-1,k,j))-0.083333333*(u(i+1,k,j)+u(i-2,k,j))+0.083333333*(u(i+1,k,j)-u(i-&amp;<a name='2755'>
&amp;2,k,j)-3.*(u(i,k,j)-u(i-1,k,j)))*sign(1.,vel))<a name='2756'>
        a_fqx(i,k) = 0.<a name='2757'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='2758'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='2759'>
        a_vel = 0.<a name='2760'>
      end do<a name='2761'>
      if (i_start .eq. ids+1) then<a name='2762'>
        i = ids+1<a name='2763'>
<font color=#447700>! recompute : i<a name='2764'></font>
        do k = kts, ktf<a name='2765'>
          a_ub = 0.<a name='2766'>
          ub = u(i-1,k,j)<a name='2767'>
<font color=#447700>! recompute : ub<a name='2768'></font>
          if (specified .and. u(i,k,j) .lt. 0.) then<a name='2769'>
            ub = u(i,k,j)<a name='2770'>
          endif<a name='2771'>
<font color=#447700>! recompute : ub<a name='2772'></font>
          a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='2773'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='2774'>
          a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2775'>
          a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='2776'>
          a_fqx(i,k) = 0.<a name='2777'>
          if (specified .and. u(i,k,j) .lt. 0.) then<a name='2778'>
            a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='2779'>
            a_ub = 0.<a name='2780'>
          endif<a name='2781'>
          a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='2782'>
          a_ub = 0.<a name='2783'>
        end do<a name='2784'>
      endif<a name='2785'>
    endif<a name='2786'>
    do k = kts, ktf<a name='2787'>
      a_vel = 0.<a name='2788'>
      do i = i_start_f, i_end_f<a name='2789'>
        a_vel = 0.<a name='2790'>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='2791'>
<font color=#447700>! recompute : vel<a name='2792'></font>
        a_u(i-3,k,j) = a_u(i-3,k,j)+a_fqx(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='2793'>
        a_u(i-2,k,j) = a_u(i-2,k,j)+a_fqx(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='2794'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_fqx(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='2795'>
        a_u(i+2,k,j) = a_u(i+2,k,j)+a_fqx(i,k)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='2796'>
        a_u(i+1,k,j) = a_u(i+1,k,j)+a_fqx(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='2797'>
        a_u(i,k,j) = a_u(i,k,j)+a_fqx(i,k)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='2798'>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(u(i,k,j)+u(i-1,k,j))-0.13333333*(u(i+1,k,j)+u(i-2,k,j))+0.016666667*(u(i+2,k,j)+u(i-&amp;<a name='2799'>
&amp;3,k,j))-0.016666667*(u(i+2,k,j)-u(i-3,k,j)-5.*(u(i+1,k,j)-u(i-2,k,j))+10.*(u(i,k,j)-u(i-1,k,j)))*sign(1.,vel))<a name='2800'>
        a_fqx(i,k) = 0.<a name='2801'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='2802'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='2803'>
        a_vel = 0.<a name='2804'>
      end do<a name='2805'>
    end do<a name='2806'>
  end do<a name='2807'>
<font color=#447700>! recdepend vars : its<a name='2808'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:488<a name='2809'></font>
<font color=#447700>! recompute vars : i_start<a name='2810'></font>
  i_start = its<a name='2811'>
<font color=#447700>! recompute vars : i_start<a name='2812'></font>
<font color=#447700>! recdepend vars : i_start,ite<a name='2813'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:489<a name='2814'></font>
<font color=#447700>! recompute vars : i_end<a name='2815'></font>
  i_end = ite<a name='2816'>
<font color=#447700>! recompute vars : i_end<a name='2817'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ids,its,specified<a name='2818'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:490<a name='2819'></font>
<font color=#447700>! recompute vars : i_start<a name='2820'></font>
  if (config_flags%open_xs .or. specified) then<a name='2821'>
    i_start = max(ids+1,its)<a name='2822'>
  endif<a name='2823'>
<font color=#447700>! recompute vars : i_start<a name='2824'></font>
<font color=#447700>! recdepend vars : config_flags,i_end,i_start,ide,ite,specified<a name='2825'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:491<a name='2826'></font>
<font color=#447700>! recompute vars : i_end<a name='2827'></font>
  if (config_flags%open_xe .or. specified) then<a name='2828'>
    i_end = min(ide-1,ite)<a name='2829'>
  endif<a name='2830'>
<font color=#447700>! recompute vars : i_end<a name='2831'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='2832'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:493<a name='2833'></font>
<font color=#447700>! recompute vars : j_start<a name='2834'></font>
  j_start = jts<a name='2835'>
<font color=#447700>! recompute vars : j_start<a name='2836'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='2837'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:494<a name='2838'></font>
<font color=#447700>! recompute vars : j_end<a name='2839'></font>
  j_end = min(jte,jde-1)<a name='2840'>
<font color=#447700>! recompute vars : j_end<a name='2841'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='2842'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:502<a name='2843'></font>
<font color=#447700>! recompute vars : j_start<a name='2844'></font>
  if (degrade_ys) then<a name='2845'>
    j_start = max(jts,jds+1)<a name='2846'>
  endif<a name='2847'>
<font color=#447700>! recompute vars : j_start<a name='2848'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='2849'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:507<a name='2850'></font>
<font color=#447700>! recompute vars : j_end<a name='2851'></font>
  if (degrade_ye) then<a name='2852'>
    j_end = min(jte,jde-2)<a name='2853'>
  endif<a name='2854'>
<font color=#447700>! recompute vars : j_end<a name='2855'></font>
  a_j_loop_y_flux_5: do j = j_end+1, j_start, -1<a name='2856'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:514<a name='2857'></font>
<font color=#447700>! recompute vars : jp1<a name='2858'></font>
    jp1 = 2<a name='2859'>
<font color=#447700>! recompute vars : jp1<a name='2860'></font>
<font color=#447700>! recdepend vars : jp1<a name='2861'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:515<a name='2862'></font>
<font color=#447700>! recompute vars : jp0<a name='2863'></font>
    jp0 = 1<a name='2864'>
<font color=#447700>! recompute vars : jp0<a name='2865'></font>
    j_loop_y_flux_9a: do j1 = j_start, j-1<a name='2866'>
      jtmp = jp1<a name='2867'>
      jp1 = jp0<a name='2868'>
      jp0 = jtmp<a name='2869'>
    end do j_loop_y_flux_9a<a name='2870'>
<font color=#447700>!    if (j .gt. j_start) then<a name='2871'></font>
    if (j .gt. jds+1) then<a name='2872'>
      do k = kts, ktf<a name='2873'>
        do i = i_start, i_end<a name='2874'>
          mrdy = msfu(i,j-1)*rdy<a name='2875'>
<font color=#447700>! recompute : mrdy<a name='2876'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='2877'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='2878'>
        end do<a name='2879'>
      end do<a name='2880'>
    endif<a name='2881'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='2882'>
      do k = kts, ktf<a name='2883'>
        a_vel = 0.<a name='2884'>
        do i = i_start, i_end<a name='2885'>
          a_vel = 0.<a name='2886'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='2887'>
<font color=#447700>! recompute : vel<a name='2888'></font>
          a_u(i,k,j-3) = a_u(i,k,j-3)+a_fqy(i,k,jp1)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='2889'>
          a_u(i,k,j-2) = a_u(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='2890'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='2891'>
          a_u(i,k,j+2) = a_u(i,k,j+2)+a_fqy(i,k,jp1)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='2892'>
          a_u(i,k,j+1) = a_u(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='2893'>
          a_u(i,k,j) = a_u(i,k,j)+a_fqy(i,k,jp1)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='2894'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(u(i,k,j)+u(i,k,j-1))-0.13333333*(u(i,k,j+1)+u(i,k,j-2))+0.016666667*(u(i,k,j+2)&amp;<a name='2895'>
&amp;+u(i,k,j-3))-0.016666667*(u(i,k,j+2)-u(i,k,j-3)-5.*(u(i,k,j+1)-u(i,k,j-2))+10.*(u(i,k,j)-u(i,k,j-1)))*sign(1.,vel))<a name='2896'>
          a_fqy(i,k,jp1) = 0.<a name='2897'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='2898'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='2899'>
          a_vel = 0.<a name='2900'>
        end do<a name='2901'>
      end do<a name='2902'>
    else if (j .eq. jds+1) then<a name='2903'>
      do k = kts, ktf<a name='2904'>
        do i = i_start, i_end<a name='2905'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2906'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2907'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2908'>
          a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2909'>
          a_fqy(i,k,jp1) = 0.<a name='2910'>
        end do<a name='2911'>
      end do<a name='2912'>
    else if (j .eq. jds+2) then<a name='2913'>
      do k = kts, ktf<a name='2914'>
        a_vel = 0.<a name='2915'>
        do i = i_start, i_end<a name='2916'>
          a_vel = 0.<a name='2917'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='2918'>
<font color=#447700>! recompute : vel<a name='2919'></font>
          a_u(i,k,j-2) = a_u(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='2920'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='2921'>
          a_u(i,k,j+1) = a_u(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='2922'>
          a_u(i,k,j) = a_u(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='2923'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(u(i,k,j)+u(i,k,j-1))-0.083333333*(u(i,k,j+1)+u(i,k,j-2))+0.083333333*(u(i,k,j+&amp;<a name='2924'>
&amp;1)-u(i,k,j-2)-3.*(u(i,k,j)-u(i,k,j-1)))*sign(1.,vel))<a name='2925'>
          a_fqy(i,k,jp1) = 0.<a name='2926'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='2927'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='2928'>
          a_vel = 0.<a name='2929'>
        end do<a name='2930'>
      end do<a name='2931'>
    else if (j .eq. jde-1) then<a name='2932'>
      do k = kts, ktf<a name='2933'>
        do i = i_start, i_end<a name='2934'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2935'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(u(i,k,j)+u(i,k,j-1))<a name='2936'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2937'>
          a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i-1,k,j))<a name='2938'>
          a_fqy(i,k,jp1) = 0.<a name='2939'>
        end do<a name='2940'>
      end do<a name='2941'>
    else if (j .eq. jde-2) then<a name='2942'>
      do k = kts, ktf<a name='2943'>
        a_vel = 0.<a name='2944'>
        do i = i_start, i_end<a name='2945'>
          a_vel = 0.<a name='2946'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='2947'>
<font color=#447700>! recompute : vel<a name='2948'></font>
          a_u(i,k,j-2) = a_u(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='2949'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='2950'>
          a_u(i,k,j+1) = a_u(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='2951'>
          a_u(i,k,j) = a_u(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='2952'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(u(i,k,j)+u(i,k,j-1))-0.083333333*(u(i,k,j+1)+u(i,k,j-2))+0.083333333*(u(i,k,j+&amp;<a name='2953'>
&amp;1)-u(i,k,j-2)-3.*(u(i,k,j)-u(i,k,j-1)))*sign(1.,vel))<a name='2954'>
          a_fqy(i,k,jp1) = 0.<a name='2955'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='2956'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='2957'>
          a_vel = 0.<a name='2958'>
        end do<a name='2959'>
      end do<a name='2960'>
    endif<a name='2961'>
  end do a_j_loop_y_flux_5<a name='2962'>
else if (horz_order .eq. 4) then a_horizontal_order_test<a name='2963'>
  degrade_xs =  .true. <a name='2964'>
<font color=#447700>! recompute : degrade_xs<a name='2965'></font>
  degrade_xe =  .true. <a name='2966'>
<font color=#447700>! recompute : degrade_xe<a name='2967'></font>
  degrade_ys =  .true. <a name='2968'>
<font color=#447700>! recompute : degrade_ys<a name='2969'></font>
  degrade_ye =  .true. <a name='2970'>
<font color=#447700>! recompute : degrade_ye<a name='2971'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='2972'>
    degrade_xs =  .false. <a name='2973'>
  endif<a name='2974'>
<font color=#447700>! recompute : degrade_xs<a name='2975'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-1) then<a name='2976'>
    degrade_xe =  .false. <a name='2977'>
  endif<a name='2978'>
<font color=#447700>! recompute : degrade_xe<a name='2979'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='2980'>
    degrade_ys =  .false. <a name='2981'>
  endif<a name='2982'>
<font color=#447700>! recompute : degrade_ys<a name='2983'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='2984'>
    degrade_ye =  .false. <a name='2985'>
  endif<a name='2986'>
<font color=#447700>! recompute : degrade_ye<a name='2987'></font>
  i_start = its<a name='2988'>
<font color=#447700>! recompute : i_start<a name='2989'></font>
  i_end = ite<a name='2990'>
<font color=#447700>! recompute : i_end<a name='2991'></font>
  i_start_f = i_start<a name='2992'>
<font color=#447700>! recompute : i_start_f<a name='2993'></font>
  i_end_f = i_end+1<a name='2994'>
<font color=#447700>! recompute : i_end_f<a name='2995'></font>
  if (degrade_xs) then<a name='2996'>
    i_start = ids+1<a name='2997'>
    i_start_f = i_start+1<a name='2998'>
  endif<a name='2999'>
<font color=#447700>! recompute : i_start_f<a name='3000'></font>
  if (degrade_xe) then<a name='3001'>
    i_end_f = ide-1<a name='3002'>
  endif<a name='3003'>
<font color=#447700>! recompute : i_end_f<a name='3004'></font>
  i_start = its<a name='3005'>
<font color=#447700>! recompute : i_start<a name='3006'></font>
  i_end = ite<a name='3007'>
<font color=#447700>! recompute : i_end<a name='3008'></font>
  if (config_flags%open_xs .or. specified) then<a name='3009'>
    i_start = max(ids+1,its)<a name='3010'>
  endif<a name='3011'>
<font color=#447700>! recompute : i_start<a name='3012'></font>
  if (config_flags%open_xe .or. specified) then<a name='3013'>
    i_end = min(ide-1,ite)<a name='3014'>
  endif<a name='3015'>
<font color=#447700>! recompute : i_end<a name='3016'></font>
  j_start = jts<a name='3017'>
<font color=#447700>! recompute : j_start<a name='3018'></font>
  j_end = min(jte,jde-1)<a name='3019'>
<font color=#447700>! recompute : j_end<a name='3020'></font>
  j_start_f = j_start<a name='3021'>
<font color=#447700>! recompute : j_start_f<a name='3022'></font>
  j_end_f = j_end+1<a name='3023'>
<font color=#447700>! recompute : j_end_f<a name='3024'></font>
  if (degrade_ys) then<a name='3025'>
    j_start = jds+1<a name='3026'>
    j_start_f = j_start+1<a name='3027'>
  endif<a name='3028'>
<font color=#447700>! recompute : j_start,j_start_f<a name='3029'></font>
  if (degrade_ye) then<a name='3030'>
    j_end = jde-2<a name='3031'>
    j_end_f = jde-2<a name='3032'>
  endif<a name='3033'>
<font color=#447700>! recompute : j_end,j_end_f<a name='3034'></font>
  do j = j_end+1, j_start, -1<a name='3035'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:816<a name='3036'></font>
<font color=#447700>! recompute vars : jp1<a name='3037'></font>
    jp1 = 2<a name='3038'>
<font color=#447700>! recompute vars : jp1<a name='3039'></font>
<font color=#447700>! recdepend vars : jp1<a name='3040'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:817<a name='3041'></font>
<font color=#447700>! recompute vars : jp0<a name='3042'></font>
    jp0 = 1<a name='3043'>
<font color=#447700>! recompute vars : jp0<a name='3044'></font>
    do j2 = j_start, j-1<a name='3045'>
      jtmp = jp1<a name='3046'>
      jp1 = jp0<a name='3047'>
      jp0 = jtmp<a name='3048'>
    end do<a name='3049'>
<font color=#447700>!    if (j .gt. j_start) then<a name='3050'></font>
    if (j .gt. jds+1) then<a name='3051'>
      do k = kts, ktf<a name='3052'>
        do i = i_start, i_end<a name='3053'>
          mrdy = msfu(i,j-1)*rdy<a name='3054'>
<font color=#447700>! recompute : mrdy<a name='3055'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='3056'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='3057'>
        end do<a name='3058'>
      end do<a name='3059'>
    endif<a name='3060'>
    if (j .lt. j_start_f .and. degrade_ys) then<a name='3061'>
      do k = kts, ktf<a name='3062'>
        do i = i_start, i_end<a name='3063'>
          a_rv(i-1,k,j_start) = a_rv(i-1,k,j_start)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_start)+u(i,k,j_start-1))<a name='3064'>
          a_rv(i,k,j_start) = a_rv(i,k,j_start)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_start)+u(i,k,j_start-1))<a name='3065'>
          a_u(i,k,j_start-1) = a_u(i,k,j_start-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_start)+rv(i-1,k,j_start))<a name='3066'>
          a_u(i,k,j_start) = a_u(i,k,j_start)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_start)+rv(i-1,k,j_start))<a name='3067'>
          a_fqy(i,k,jp1) = 0.<a name='3068'>
        end do<a name='3069'>
      end do<a name='3070'>
    else if (j .gt. j_end_f .and. degrade_ye) then<a name='3071'>
      do k = kts, ktf<a name='3072'>
        do i = i_start, i_end<a name='3073'>
          a_rv(i-1,k,j_end+1) = a_rv(i-1,k,j_end+1)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_end+1)+u(i,k,j_end))<a name='3074'>
          a_rv(i,k,j_end+1) = a_rv(i,k,j_end+1)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_end+1)+u(i,k,j_end))<a name='3075'>
          a_u(i,k,j_end+1) = a_u(i,k,j_end+1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_end+1)+rv(i-1,k,j_end+1))<a name='3076'>
          a_u(i,k,j_end) = a_u(i,k,j_end)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_end+1)+rv(i-1,k,j_end+1))<a name='3077'>
          a_fqy(i,k,jp1) = 0.<a name='3078'>
        end do<a name='3079'>
      end do<a name='3080'>
    else<a name='3081'>
      do k = kts, ktf<a name='3082'>
        a_vel = 0.<a name='3083'>
        do i = i_start, i_end<a name='3084'>
          a_vel = 0.<a name='3085'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='3086'>
<font color=#447700>! recompute : vel<a name='3087'></font>
          a_u(i,k,j-2) = a_u(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='3088'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='3089'>
          a_u(i,k,j+1) = a_u(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='3090'>
          a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='3091'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(u(i,k,j)+u(i,k,j-1))-0.083333333*(u(i,k,j+1)+u(i,k,j-2)))<a name='3092'>
          a_fqy(i,k,jp1) = 0.<a name='3093'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='3094'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='3095'>
          a_vel = 0.<a name='3096'>
        end do<a name='3097'>
      end do<a name='3098'>
    endif<a name='3099'>
  end do<a name='3100'>
<font color=#447700>! recdepend vars : its<a name='3101'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:720<a name='3102'></font>
<font color=#447700>! recompute vars : i_start<a name='3103'></font>
  i_start = its<a name='3104'>
<font color=#447700>! recompute vars : i_start<a name='3105'></font>
<font color=#447700>! recdepend vars : i_start,ite<a name='3106'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:721<a name='3107'></font>
<font color=#447700>! recompute vars : i_end<a name='3108'></font>
  i_end = ite<a name='3109'>
<font color=#447700>! recompute vars : i_end<a name='3110'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='3111'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:722<a name='3112'></font>
<font color=#447700>! recompute vars : j_start<a name='3113'></font>
  j_start = jts<a name='3114'>
<font color=#447700>! recompute vars : j_start<a name='3115'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='3116'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:723<a name='3117'></font>
<font color=#447700>! recompute vars : j_end<a name='3118'></font>
  j_end = min(jte,jde-1)<a name='3119'>
<font color=#447700>! recompute vars : j_end<a name='3120'></font>
<font color=#447700>! recdepend vars : degrade_xs,i_end,i_start,ids,j_end,j_start<a name='3121'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:731<a name='3122'></font>
<font color=#447700>! recompute vars : i_start<a name='3123'></font>
  if (degrade_xs) then<a name='3124'>
    i_start = ids+1<a name='3125'>
  endif<a name='3126'>
<font color=#447700>! recompute vars : i_start<a name='3127'></font>
<font color=#447700>! recdepend vars : degrade_xe,i_end,i_start,ide,j_end,j_start<a name='3128'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:736<a name='3129'></font>
<font color=#447700>! recompute vars : i_end<a name='3130'></font>
  if (degrade_xe) then<a name='3131'>
    i_end = ide-1<a name='3132'>
  endif<a name='3133'>
<font color=#447700>! recompute vars : i_end<a name='3134'></font>
  do j = j_end, j_start, -1<a name='3135'>
    do k = kts, ktf<a name='3136'>
      do i = i_start, i_end<a name='3137'>
        mrdx = msfu(i,j)*rdx<a name='3138'>
<font color=#447700>! recompute : mrdx<a name='3139'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='3140'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='3141'>
      end do<a name='3142'>
    end do<a name='3143'>
    if (degrade_xe) then<a name='3144'>
      i = i_end+1<a name='3145'>
<font color=#447700>! recompute : i<a name='3146'></font>
      do k = kts, ktf<a name='3147'>
        a_ub = 0.<a name='3148'>
        ub = u(i,k,j)<a name='3149'>
<font color=#447700>! recompute : ub<a name='3150'></font>
        if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='3151'>
          ub = u(i-1,k,j)<a name='3152'>
        endif<a name='3153'>
<font color=#447700>! recompute : ub<a name='3154'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='3155'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='3156'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3157'>
        a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3158'>
        a_fqx(i,k) = 0.<a name='3159'>
        if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='3160'>
          a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='3161'>
          a_ub = 0.<a name='3162'>
        endif<a name='3163'>
        a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='3164'>
        a_ub = 0.<a name='3165'>
      end do<a name='3166'>
    endif<a name='3167'>
    if (degrade_xs) then<a name='3168'>
      i = i_start<a name='3169'>
<font color=#447700>! recompute : i<a name='3170'></font>
      do k = kts, ktf<a name='3171'>
        a_ub = 0.<a name='3172'>
        ub = u(i-1,k,j)<a name='3173'>
<font color=#447700>! recompute : ub<a name='3174'></font>
        if (specified .and. u(i,k,j) .lt. 0.) then<a name='3175'>
          ub = u(i,k,j)<a name='3176'>
        endif<a name='3177'>
<font color=#447700>! recompute : ub<a name='3178'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='3179'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='3180'>
        a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3181'>
        a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3182'>
        a_fqx(i,k) = 0.<a name='3183'>
        if (specified .and. u(i,k,j) .lt. 0.) then<a name='3184'>
          a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='3185'>
          a_ub = 0.<a name='3186'>
        endif<a name='3187'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='3188'>
        a_ub = 0.<a name='3189'>
      end do<a name='3190'>
    endif<a name='3191'>
    do k = kts, ktf<a name='3192'>
      a_vel = 0.<a name='3193'>
      do i = i_start_f, i_end_f<a name='3194'>
        a_vel = 0.<a name='3195'>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='3196'>
<font color=#447700>! recompute : vel<a name='3197'></font>
        a_u(i-2,k,j) = a_u(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='3198'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='3199'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='3200'>
        a_u(i,k,j) = a_u(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='3201'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(u(i,k,j)+u(i-1,k,j))-0.083333333*(u(i+1,k,j)+u(i-2,k,j)))<a name='3202'>
        a_fqx(i,k) = 0.<a name='3203'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='3204'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='3205'>
        a_vel = 0.<a name='3206'>
      end do<a name='3207'>
    end do<a name='3208'>
  end do<a name='3209'>
else if (horz_order .eq. 3) then a_horizontal_order_test<a name='3210'>
  degrade_xs =  .true. <a name='3211'>
<font color=#447700>! recompute : degrade_xs<a name='3212'></font>
  degrade_xe =  .true. <a name='3213'>
<font color=#447700>! recompute : degrade_xe<a name='3214'></font>
  degrade_ys =  .true. <a name='3215'>
<font color=#447700>! recompute : degrade_ys<a name='3216'></font>
  degrade_ye =  .true. <a name='3217'>
<font color=#447700>! recompute : degrade_ye<a name='3218'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='3219'>
    degrade_xs =  .false. <a name='3220'>
  endif<a name='3221'>
<font color=#447700>! recompute : degrade_xs<a name='3222'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-1) then<a name='3223'>
    degrade_xe =  .false. <a name='3224'>
  endif<a name='3225'>
<font color=#447700>! recompute : degrade_xe<a name='3226'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='3227'>
    degrade_ys =  .false. <a name='3228'>
  endif<a name='3229'>
<font color=#447700>! recompute : degrade_ys<a name='3230'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='3231'>
    degrade_ye =  .false. <a name='3232'>
  endif<a name='3233'>
<font color=#447700>! recompute : degrade_ye<a name='3234'></font>
  i_start = its<a name='3235'>
<font color=#447700>! recompute : i_start<a name='3236'></font>
  i_end = ite<a name='3237'>
<font color=#447700>! recompute : i_end<a name='3238'></font>
  i_start_f = i_start<a name='3239'>
<font color=#447700>! recompute : i_start_f<a name='3240'></font>
  i_end_f = i_end+1<a name='3241'>
<font color=#447700>! recompute : i_end_f<a name='3242'></font>
  if (degrade_xs) then<a name='3243'>
    i_start = ids+1<a name='3244'>
    i_start_f = i_start+1<a name='3245'>
  endif<a name='3246'>
<font color=#447700>! recompute : i_start_f<a name='3247'></font>
  if (degrade_xe) then<a name='3248'>
    i_end_f = ide-1<a name='3249'>
  endif<a name='3250'>
<font color=#447700>! recompute : i_end_f<a name='3251'></font>
  i_start = its<a name='3252'>
<font color=#447700>! recompute : i_start<a name='3253'></font>
  i_end = ite<a name='3254'>
<font color=#447700>! recompute : i_end<a name='3255'></font>
  if (config_flags%open_xs .or. specified) then<a name='3256'>
    i_start = max(ids+1,its)<a name='3257'>
  endif<a name='3258'>
<font color=#447700>! recompute : i_start<a name='3259'></font>
  if (config_flags%open_xe .or. specified) then<a name='3260'>
    i_end = min(ide-1,ite)<a name='3261'>
  endif<a name='3262'>
<font color=#447700>! recompute : i_end<a name='3263'></font>
  j_start = jts<a name='3264'>
<font color=#447700>! recompute : j_start<a name='3265'></font>
  j_end = min(jte,jde-1)<a name='3266'>
<font color=#447700>! recompute : j_end<a name='3267'></font>
  j_start_f = j_start<a name='3268'>
<font color=#447700>! recompute : j_start_f<a name='3269'></font>
  j_end_f = j_end+1<a name='3270'>
<font color=#447700>! recompute : j_end_f<a name='3271'></font>
  if (degrade_ys) then<a name='3272'>
    j_start = jds+1<a name='3273'>
    j_start_f = j_start+1<a name='3274'>
  endif<a name='3275'>
<font color=#447700>! recompute : j_start,j_start_f<a name='3276'></font>
  if (degrade_ye) then<a name='3277'>
    j_end = jde-2<a name='3278'>
    j_end_f = jde-2<a name='3279'>
  endif<a name='3280'>
<font color=#447700>! recompute : j_end,j_end_f<a name='3281'></font>
  do j = j_end+1, j_start, -1<a name='3282'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:994<a name='3283'></font>
<font color=#447700>! recompute vars : jp1<a name='3284'></font>
    jp1 = 2<a name='3285'>
<font color=#447700>! recompute vars : jp1<a name='3286'></font>
<font color=#447700>! recdepend vars : jp1<a name='3287'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:995<a name='3288'></font>
<font color=#447700>! recompute vars : jp0<a name='3289'></font>
    jp0 = 1<a name='3290'>
<font color=#447700>! recompute vars : jp0<a name='3291'></font>
    do j3 = j_start, j-1<a name='3292'>
      jtmp = jp1<a name='3293'>
      jp1 = jp0<a name='3294'>
      jp0 = jtmp<a name='3295'>
    end do<a name='3296'>
<font color=#447700>!      if (j .gt. j_start) then<a name='3297'></font>
    if (j .gt. jds+1) then<a name='3298'>
      do k = kts, ktf<a name='3299'>
        do i = i_start, i_end<a name='3300'>
          mrdy = msfu(i,j-1)*rdy<a name='3301'>
<font color=#447700>! recompute : mrdy<a name='3302'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='3303'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='3304'>
        end do<a name='3305'>
      end do<a name='3306'>
    endif<a name='3307'>
    if (j .lt. j_start_f .and. degrade_ys) then<a name='3308'>
      do k = kts, ktf<a name='3309'>
        do i = i_start, i_end<a name='3310'>
          a_rv(i-1,k,j_start) = a_rv(i-1,k,j_start)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_start)+u(i,k,j_start-1))<a name='3311'>
          a_rv(i,k,j_start) = a_rv(i,k,j_start)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_start)+u(i,k,j_start-1))<a name='3312'>
          a_u(i,k,j_start-1) = a_u(i,k,j_start-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_start)+rv(i-1,k,j_start))<a name='3313'>
          a_u(i,k,j_start) = a_u(i,k,j_start)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_start)+rv(i-1,k,j_start))<a name='3314'>
          a_fqy(i,k,jp1) = 0.<a name='3315'>
        end do<a name='3316'>
      end do<a name='3317'>
    else if (j .gt. j_end_f .and. degrade_ye) then<a name='3318'>
      do k = kts, ktf<a name='3319'>
        do i = i_start, i_end<a name='3320'>
          a_rv(i-1,k,j_end+1) = a_rv(i-1,k,j_end+1)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_end+1)+u(i,k,j_end))<a name='3321'>
          a_rv(i,k,j_end+1) = a_rv(i,k,j_end+1)+0.25*a_fqy(i,k,jp1)*(u(i,k,j_end+1)+u(i,k,j_end))<a name='3322'>
          a_u(i,k,j_end+1) = a_u(i,k,j_end+1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_end+1)+rv(i-1,k,j_end+1))<a name='3323'>
          a_u(i,k,j_end) = a_u(i,k,j_end)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j_end+1)+rv(i-1,k,j_end+1))<a name='3324'>
          a_fqy(i,k,jp1) = 0.<a name='3325'>
        end do<a name='3326'>
      end do<a name='3327'>
    else<a name='3328'>
      do k = kts, ktf<a name='3329'>
        a_vel = 0.<a name='3330'>
        do i = i_start, i_end<a name='3331'>
          a_vel = 0.<a name='3332'>
          vel = 0.5*(rv(i,k,j)+rv(i-1,k,j))<a name='3333'>
<font color=#447700>! recompute : vel<a name='3334'></font>
          a_u(i,k,j-2) = a_u(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='3335'>
          a_u(i,k,j-1) = a_u(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='3336'>
          a_u(i,k,j+1) = a_u(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='3337'>
          a_u(i,k,j) = a_u(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='3338'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(u(i,k,j)+u(i,k,j-1))-0.083333333*(u(i,k,j+1)+u(i,k,j-2))+0.083333333*(u(i,k,j+&amp;<a name='3339'>
&amp;1)-u(i,k,j-2)-3.*(u(i,k,j)-u(i,k,j-1)))*sign(1.,vel))<a name='3340'>
          a_fqy(i,k,jp1) = 0.<a name='3341'>
          a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.5*a_vel<a name='3342'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='3343'>
          a_vel = 0.<a name='3344'>
        end do<a name='3345'>
      end do<a name='3346'>
    endif<a name='3347'>
  end do<a name='3348'>
<font color=#447700>! recdepend vars : its<a name='3349'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:899<a name='3350'></font>
<font color=#447700>! recompute vars : i_start<a name='3351'></font>
  i_start = its<a name='3352'>
<font color=#447700>! recompute vars : i_start<a name='3353'></font>
<font color=#447700>! recdepend vars : i_start,ite<a name='3354'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:900<a name='3355'></font>
<font color=#447700>! recompute vars : i_end<a name='3356'></font>
  i_end = ite<a name='3357'>
<font color=#447700>! recompute vars : i_end<a name='3358'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='3359'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:901<a name='3360'></font>
<font color=#447700>! recompute vars : j_start<a name='3361'></font>
  j_start = jts<a name='3362'>
<font color=#447700>! recompute vars : j_start<a name='3363'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='3364'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:902<a name='3365'></font>
<font color=#447700>! recompute vars : j_end<a name='3366'></font>
  j_end = min(jte,jde-1)<a name='3367'>
<font color=#447700>! recompute vars : j_end<a name='3368'></font>
<font color=#447700>! recdepend vars : degrade_xs,i_end,i_start,ids,j_end,j_start<a name='3369'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:910<a name='3370'></font>
<font color=#447700>! recompute vars : i_start<a name='3371'></font>
  if (degrade_xs) then<a name='3372'>
    i_start = ids+1<a name='3373'>
  endif<a name='3374'>
<font color=#447700>! recompute vars : i_start<a name='3375'></font>
<font color=#447700>! recdepend vars : degrade_xe,i_end,i_start,ide,j_end,j_start<a name='3376'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:915<a name='3377'></font>
<font color=#447700>! recompute vars : i_end<a name='3378'></font>
  if (degrade_xe) then<a name='3379'>
    i_end = ide-1<a name='3380'>
  endif<a name='3381'>
<font color=#447700>! recompute vars : i_end<a name='3382'></font>
  do j = j_end, j_start, -1<a name='3383'>
    do k = kts, ktf<a name='3384'>
      do i = i_start, i_end<a name='3385'>
        mrdx = msfu(i,j)*rdx<a name='3386'>
<font color=#447700>! recompute : mrdx<a name='3387'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='3388'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='3389'>
      end do<a name='3390'>
    end do<a name='3391'>
    if (degrade_xe) then<a name='3392'>
      i = i_end+1<a name='3393'>
<font color=#447700>! recompute : i<a name='3394'></font>
      do k = kts, ktf<a name='3395'>
        a_ub = 0.<a name='3396'>
        ub = u(i,k,j)<a name='3397'>
<font color=#447700>! recompute : ub<a name='3398'></font>
        if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='3399'>
          ub = u(i-1,k,j)<a name='3400'>
        endif<a name='3401'>
<font color=#447700>! recompute : ub<a name='3402'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='3403'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i-1,k,j)+ub)<a name='3404'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3405'>
        a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3406'>
        a_fqx(i,k) = 0.<a name='3407'>
        if (specified .and. u(i-1,k,j) .gt. 0.) then<a name='3408'>
          a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='3409'>
          a_ub = 0.<a name='3410'>
        endif<a name='3411'>
        a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='3412'>
        a_ub = 0.<a name='3413'>
      end do<a name='3414'>
    endif<a name='3415'>
    if (degrade_xs) then<a name='3416'>
      i = i_start<a name='3417'>
<font color=#447700>! recompute : i<a name='3418'></font>
      do k = kts, ktf<a name='3419'>
        a_ub = 0.<a name='3420'>
        ub = u(i-1,k,j)<a name='3421'>
<font color=#447700>! recompute : ub<a name='3422'></font>
        if (specified .and. u(i,k,j) .lt. 0.) then<a name='3423'>
          ub = u(i,k,j)<a name='3424'>
        endif<a name='3425'>
<font color=#447700>! recompute : ub<a name='3426'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='3427'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(u(i,k,j)+ub)<a name='3428'>
        a_u(i,k,j) = a_u(i,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3429'>
        a_ub = a_ub+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i-1,k,j))<a name='3430'>
        a_fqx(i,k) = 0.<a name='3431'>
        if (specified .and. u(i,k,j) .lt. 0.) then<a name='3432'>
          a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='3433'>
          a_ub = 0.<a name='3434'>
        endif<a name='3435'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='3436'>
        a_ub = 0.<a name='3437'>
      end do<a name='3438'>
    endif<a name='3439'>
    do k = kts, ktf<a name='3440'>
      a_vel = 0.<a name='3441'>
      do i = i_start_f, i_end_f<a name='3442'>
        a_vel = 0.<a name='3443'>
        vel = 0.5*(ru(i,k,j)+ru(i-1,k,j))<a name='3444'>
<font color=#447700>! recompute : vel<a name='3445'></font>
        a_u(i-2,k,j) = a_u(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='3446'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='3447'>
        a_u(i+1,k,j) = a_u(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='3448'>
        a_u(i,k,j) = a_u(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='3449'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(u(i,k,j)+u(i-1,k,j))-0.083333333*(u(i+1,k,j)+u(i-2,k,j))+0.083333333*(u(i+1,k,j)-u(i-&amp;<a name='3450'>
&amp;2,k,j)-3.*(u(i,k,j)-u(i-1,k,j)))*sign(1.,vel))<a name='3451'>
        a_fqx(i,k) = 0.<a name='3452'>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.5*a_vel<a name='3453'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='3454'>
        a_vel = 0.<a name='3455'>
      end do<a name='3456'>
    end do<a name='3457'>
  end do<a name='3458'>
else if (horz_order .eq. 2) then a_horizontal_order_test<a name='3459'>
  i_start = its<a name='3460'>
<font color=#447700>! recompute : i_start<a name='3461'></font>
  i_end = ite<a name='3462'>
<font color=#447700>! recompute : i_end<a name='3463'></font>
  j_start = jts<a name='3464'>
<font color=#447700>! recompute : j_start<a name='3465'></font>
  j_end = min(jte,jde-1)<a name='3466'>
<font color=#447700>! recompute : j_end<a name='3467'></font>
  if (config_flags%open_xs) then<a name='3468'>
    i_start = max(ids+1,its)<a name='3469'>
  endif<a name='3470'>
<font color=#447700>! recompute : i_start<a name='3471'></font>
  if (config_flags%open_xe) then<a name='3472'>
    i_end = min(ide-1,ite)<a name='3473'>
  endif<a name='3474'>
<font color=#447700>! recompute : i_end<a name='3475'></font>
  if (specified) then<a name='3476'>
    i_start = max(ids+2,its)<a name='3477'>
  endif<a name='3478'>
<font color=#447700>! recompute : i_start<a name='3479'></font>
  if (specified) then<a name='3480'>
    i_end = min(ide-2,ite)<a name='3481'>
  endif<a name='3482'>
<font color=#447700>! recompute : i_end<a name='3483'></font>
  if (config_flags%open_ys .or. specified) then<a name='3484'>
    j_start = max(jds+1,jts)<a name='3485'>
  endif<a name='3486'>
<font color=#447700>! recompute : j_start<a name='3487'></font>
  if (config_flags%open_ye .or. specified) then<a name='3488'>
    j_end = min(jde-2,jte)<a name='3489'>
  endif<a name='3490'>
<font color=#447700>! recompute : j_end<a name='3491'></font>
  do j = j_start, j_end<a name='3492'>
    do k = kts, ktf<a name='3493'>
      do i = i_start, i_end<a name='3494'>
        mrdy = msfu(i,j)*rdy<a name='3495'>
<font color=#447700>! recompute : mrdy<a name='3496'></font>
        a_rv(i-1,k,j+1) = a_rv(i-1,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(u(i,k,j+1)+u(i,k,j))<a name='3497'>
        a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(u(i,k,j+1)+u(i,k,j))<a name='3498'>
        a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdy*(u(i,k,j)+u(i,k,j-1))<a name='3499'>
        a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_tendency(i,k,j)*mrdy*(u(i,k,j)+u(i,k,j-1))<a name='3500'>
        a_u(i,k,j-1) = a_u(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j)+rv(i-1,k,j))<a name='3501'>
        a_u(i,k,j+1) = a_u(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i-1,k,j+1))<a name='3502'>
        a_u(i,k,j) = a_u(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i-1,k,j+1)-(rv(i,k,j)+rv(i-1,k,j)))<a name='3503'>
      end do<a name='3504'>
    end do<a name='3505'>
  end do<a name='3506'>
<font color=#447700>! recdepend vars : jts<a name='3507'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1049<a name='3508'></font>
<font color=#447700>! recompute vars : j_start<a name='3509'></font>
  j_start = jts<a name='3510'>
<font color=#447700>! recompute vars : j_start<a name='3511'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='3512'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1050<a name='3513'></font>
<font color=#447700>! recompute vars : j_end<a name='3514'></font>
  j_end = min(jte,jde-1)<a name='3515'>
<font color=#447700>! recompute vars : j_end<a name='3516'></font>
  if (specified .and. ite .ge. ide-1) then<a name='3517'>
    do j = j_start, j_end<a name='3518'>
      a_ub = 0.<a name='3519'>
      do k = kts, ktf<a name='3520'>
        a_ub = 0.<a name='3521'>
        i = ide-1<a name='3522'>
<font color=#447700>! recompute : i<a name='3523'></font>
        mrdx = msfu(i,j)*rdx<a name='3524'>
<font color=#447700>! recompute : mrdx<a name='3525'></font>
        ub = u(i+1,k,j)<a name='3526'>
<font color=#447700>! recompute : ub<a name='3527'></font>
        if (u(i,k,j) .gt. 0.) then<a name='3528'>
          ub = u(i,k,j)<a name='3529'>
        endif<a name='3530'>
<font color=#447700>! recompute : ub<a name='3531'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdx*(u(i,k,j)+u(i-1,k,j))<a name='3532'>
        a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ub+u(i,k,j))<a name='3533'>
        a_ru(i,k,j) = a_ru(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ub+u(i,k,j)-(u(i,k,j)+u(i-1,k,j)))<a name='3534'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdx*(ru(i,k,j)+ru(i-1,k,j))<a name='3535'>
        a_u(i,k,j) = a_u(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i,k,j)-(ru(i,k,j)+ru(i-1,k,j)))<a name='3536'>
        a_ub = a_ub-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i,k,j))<a name='3537'>
        if (u(i,k,j) .gt. 0.) then<a name='3538'>
          a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='3539'>
          a_ub = 0.<a name='3540'>
        endif<a name='3541'>
        a_u(i+1,k,j) = a_u(i+1,k,j)+a_ub<a name='3542'>
        a_ub = 0.<a name='3543'>
      end do<a name='3544'>
    end do<a name='3545'>
  endif<a name='3546'>
<font color=#447700>! recdepend vars : jts<a name='3547'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1049<a name='3548'></font>
<font color=#447700>! recompute vars : j_start<a name='3549'></font>
  j_start = jts<a name='3550'>
<font color=#447700>! recompute vars : j_start<a name='3551'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='3552'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1050<a name='3553'></font>
<font color=#447700>! recompute vars : j_end<a name='3554'></font>
  j_end = min(jte,jde-1)<a name='3555'>
<font color=#447700>! recompute vars : j_end<a name='3556'></font>
  if (specified .and. its .le. ids+1) then<a name='3557'>
    do j = j_start, j_end<a name='3558'>
      a_ub = 0.<a name='3559'>
      do k = kts, ktf<a name='3560'>
        a_ub = 0.<a name='3561'>
        i = ids+1<a name='3562'>
<font color=#447700>! recompute : i<a name='3563'></font>
        mrdx = msfu(i,j)*rdx<a name='3564'>
<font color=#447700>! recompute : mrdx<a name='3565'></font>
        ub = u(i-1,k,j)<a name='3566'>
<font color=#447700>! recompute : ub<a name='3567'></font>
        if (u(i,k,j) .lt. 0.) then<a name='3568'>
          ub = u(i,k,j)<a name='3569'>
        endif<a name='3570'>
<font color=#447700>! recompute : ub<a name='3571'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdx*(u(i,k,j)+ub)<a name='3572'>
        a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(u(i+1,k,j)+u(i,k,j))<a name='3573'>
        a_ru(i,k,j) = a_ru(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(u(i+1,k,j)+u(i,k,j)-(u(i,k,j)+ub))<a name='3574'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i,k,j))<a name='3575'>
        a_u(i,k,j) = a_u(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i,k,j)-(ru(i,k,j)+ru(i-1,k,j)))<a name='3576'>
        a_ub = a_ub+0.25*a_tendency(i,k,j)*mrdx*(ru(i,k,j)+ru(i-1,k,j))<a name='3577'>
        if (u(i,k,j) .lt. 0.) then<a name='3578'>
          a_u(i,k,j) = a_u(i,k,j)+a_ub<a name='3579'>
          a_ub = 0.<a name='3580'>
        endif<a name='3581'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+a_ub<a name='3582'>
        a_ub = 0.<a name='3583'>
      end do<a name='3584'>
    end do<a name='3585'>
  endif<a name='3586'>
<font color=#447700>! recdepend vars : jts<a name='3587'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1049<a name='3588'></font>
<font color=#447700>! recompute vars : j_start<a name='3589'></font>
  j_start = jts<a name='3590'>
<font color=#447700>! recompute vars : j_start<a name='3591'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='3592'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1050<a name='3593'></font>
<font color=#447700>! recompute vars : j_end<a name='3594'></font>
  j_end = min(jte,jde-1)<a name='3595'>
<font color=#447700>! recompute vars : j_end<a name='3596'></font>
  do j = j_start, j_end<a name='3597'>
    do k = kts, ktf<a name='3598'>
      do i = i_start, i_end<a name='3599'>
        mrdx = msfu(i,j)*rdx<a name='3600'>
<font color=#447700>! recompute : mrdx<a name='3601'></font>
        a_ru(i-1,k,j) = a_ru(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdx*(u(i,k,j)+u(i-1,k,j))<a name='3602'>
        a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(u(i+1,k,j)+u(i,k,j))<a name='3603'>
        a_ru(i,k,j) = a_ru(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(u(i+1,k,j)+u(i,k,j)-(u(i,k,j)+u(i-1,k,j)))<a name='3604'>
        a_u(i-1,k,j) = a_u(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdx*(ru(i,k,j)+ru(i-1,k,j))<a name='3605'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i,k,j))<a name='3606'>
        a_u(i,k,j) = a_u(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i,k,j)-(ru(i,k,j)+ru(i-1,k,j)))<a name='3607'>
      end do<a name='3608'>
    end do<a name='3609'>
  end do<a name='3610'>
endif a_horizontal_order_test<a name='3611'>
<a name='3612'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_U' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_3">("a_advect_u")<a name='3613'>
<a name='3614'>
end subroutine a_advect_u<a name='3615'>
<a name='3616'>
<a name='3617'>
<A NAME='A_ADVECT_V'><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_V' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3618'>
<font color=#993300>subroutine </font><font color=#cc0000>a_advect_v</font>( v, a_v, v_old, a_v_old, a_tendency, ru, a_ru, rv, a_rv, rom, a_rom, mut, a_mut, config_flags, msfv, fzm, &amp; <A href='../../call_to/A_ADVECT_V.html' TARGET='index'>1</A>,<A href='../../call_from/A_ADVECT_V.html' TARGET='index'>2</A><a name='3619'>
&amp;fzp, rdx, rdy, rdzw, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='3620'>
<font color=#447700>!******************************************************************<a name='3621'></font>
<font color=#447700>!******************************************************************<a name='3622'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='3623'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='3624'></font>
<font color=#447700>!******************************************************************<a name='3625'></font>
<font color=#447700>!******************************************************************<a name='3626'></font>
<font color=#447700>!==============================================<a name='3627'></font>
<font color=#447700>! all entries are defined explicitly<a name='3628'></font>
<font color=#447700>!==============================================<a name='3629'></font>
implicit none<a name='3630'>
<a name='3631'>
<font color=#447700>!==============================================<a name='3632'></font>
<font color=#447700>! declare arguments<a name='3633'></font>
<font color=#447700>!==============================================<a name='3634'></font>
integer, intent(in) :: ime<a name='3635'>
integer, intent(in) :: ims<a name='3636'>
integer, intent(in) :: jme<a name='3637'>
integer, intent(in) :: jms<a name='3638'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='3639'>
integer, intent(in) :: kme<a name='3640'>
integer, intent(in) :: kms<a name='3641'>
real, intent(inout) :: a_rom(ims:ime,kms:kme,jms:jme)<a name='3642'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='3643'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='3644'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='3645'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='3646'>
real, intent(inout) :: a_v_old(ims:ime,kms:kme,jms:jme)<a name='3647'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='3648'>
real, intent(in) :: fzm(kms:kme)<a name='3649'>
real, intent(in) :: fzp(kms:kme)<a name='3650'>
integer, intent(in) :: ide<a name='3651'>
integer, intent(in) :: ids<a name='3652'>
integer, intent(in) :: ite<a name='3653'>
integer, intent(in) :: its<a name='3654'>
integer, intent(in) :: jde<a name='3655'>
integer, intent(in) :: jds<a name='3656'>
integer, intent(in) :: jte<a name='3657'>
integer, intent(in) :: jts<a name='3658'>
integer, intent(in) :: kde<a name='3659'>
integer, intent(in) :: kte<a name='3660'>
integer, intent(in) :: kts<a name='3661'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='3662'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='3663'>
real, intent(in) :: rdx<a name='3664'>
real, intent(in) :: rdy<a name='3665'>
real, intent(in) :: rdzw(kms:kme)<a name='3666'>
real, intent(in) :: rom(ims:ime,kms:kme,jms:jme)<a name='3667'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='3668'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='3669'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='3670'>
real, intent(in) :: v_old(ims:ime,kms:kme,jms:jme)<a name='3671'>
<a name='3672'>
<font color=#447700>!==============================================<a name='3673'></font>
<font color=#447700>! declare local variables<a name='3674'></font>
<font color=#447700>!==============================================<a name='3675'></font>
real a_dum<a name='3676'>
real a_dup<a name='3677'>
real a_fqx(its:ite+1,kts:kte)<a name='3678'>
real a_fqy(its:ite,kts:kte,2)<a name='3679'>
real a_ub<a name='3680'>
real a_uw<a name='3681'>
real a_vb<a name='3682'>
real a_vel<a name='3683'>
real a_vflux(its:ite,kts:kte)<a name='3684'>
logical degrade_xe<a name='3685'>
logical degrade_xs<a name='3686'>
logical degrade_ye<a name='3687'>
logical degrade_ys<a name='3688'>
real dum<a name='3689'>
real dup<a name='3690'>
integer horz_order<a name='3691'>
integer i<a name='3692'>
integer i_end<a name='3693'>
integer i_end_f<a name='3694'>
integer i_start<a name='3695'>
integer i_start_f<a name='3696'>
integer j<a name='3697'>
integer j1<a name='3698'>
integer j2<a name='3699'>
integer j3<a name='3700'>
integer j4<a name='3701'>
integer j_end<a name='3702'>
integer j_end_f<a name='3703'>
integer j_start<a name='3704'>
integer j_start_f<a name='3705'>
integer jm<a name='3706'>
integer jmax<a name='3707'>
integer jmin<a name='3708'>
integer jp<a name='3709'>
integer jp0<a name='3710'>
integer jp1<a name='3711'>
integer jtmp<a name='3712'>
integer k<a name='3713'>
integer ktf<a name='3714'>
real mrdx<a name='3715'>
real mrdy<a name='3716'>
logical specified<a name='3717'>
real ub<a name='3718'>
real uw<a name='3719'>
real vb<a name='3720'>
real vel<a name='3721'>
integer vert_order<a name='3722'>
<a name='3723'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_V' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_4">("a_advect_v")<a name='3724'>
<a name='3725'>
<font color=#447700>!----------------------------------------------<a name='3726'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='3727'></font>
<font color=#447700>!----------------------------------------------<a name='3728'></font>
a_dum = 0.<a name='3729'>
a_dup = 0.<a name='3730'>
a_fqx(:,:) = 0.<a name='3731'>
a_fqy(:,:,:) = 0.<a name='3732'>
a_ub = 0.<a name='3733'>
a_uw = 0.<a name='3734'>
a_vb = 0.<a name='3735'>
a_vel = 0.<a name='3736'>
a_vflux(:,:) = 0.<a name='3737'>
<a name='3738'>
<font color=#447700>!----------------------------------------------<a name='3739'></font>
<font color=#447700>! ROUTINE BODY<a name='3740'></font>
<font color=#447700>!----------------------------------------------<a name='3741'></font>
specified =  .false. <a name='3742'>
<font color=#447700>! recompute : specified<a name='3743'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='3744'>
  specified =  .true. <a name='3745'>
endif<a name='3746'>
<font color=#447700>! recompute : specified<a name='3747'></font>
ktf = min(kte,kde-1)<a name='3748'>
<font color=#447700>! recompute : ktf<a name='3749'></font>
horz_order = config_flags%h_mom_adv_order<a name='3750'>
<font color=#447700>! recompute : horz_order<a name='3751'></font>
vert_order = config_flags%v_mom_adv_order<a name='3752'>
<font color=#447700>! recompute : vert_order<a name='3753'></font>
horizontal_order_tesu: if (horz_order .eq. 6) then<a name='3754'>
  ktf = min(kte,kde-1)<a name='3755'>
else if (horz_order .eq. 4) then horizontal_order_tesu<a name='3756'>
  ktf = min(kte,kde-1)<a name='3757'>
else if (horz_order .eq. 3) then horizontal_order_tesu<a name='3758'>
  ktf = min(kte,kde-1)<a name='3759'>
endif horizontal_order_tesu<a name='3760'>
<font color=#447700>! recompute : ktf<a name='3761'></font>
jmin = jds<a name='3762'>
<font color=#447700>! recompute : jmin<a name='3763'></font>
jmax = jde-1<a name='3764'>
<font color=#447700>! recompute : jmax<a name='3765'></font>
if (config_flags%open_ys) then<a name='3766'>
  jmin = jds<a name='3767'>
endif<a name='3768'>
<font color=#447700>! recompute : jmin<a name='3769'></font>
if (config_flags%open_ye) then<a name='3770'>
  jmax = jde-1<a name='3771'>
endif<a name='3772'>
<font color=#447700>! recompute : jmax<a name='3773'></font>
i_start = its<a name='3774'>
<font color=#447700>! recompute : i_start<a name='3775'></font>
i_end = min(ite,ide-1)<a name='3776'>
<font color=#447700>! recompute : i_end<a name='3777'></font>
j_start = jts<a name='3778'>
<font color=#447700>! recompute : j_start<a name='3779'></font>
j_end = jte<a name='3780'>
<font color=#447700>! recompute : j_end<a name='3781'></font>
if (config_flags%open_ys .or. specified) then<a name='3782'>
  j_start = max(jds+1,jts)<a name='3783'>
endif<a name='3784'>
<font color=#447700>! recompute : j_start<a name='3785'></font>
if (config_flags%open_ye .or. specified) then<a name='3786'>
  j_end = min(jde-1,jte)<a name='3787'>
endif<a name='3788'>
<font color=#447700>! recompute : j_end<a name='3789'></font>
a_vert_order_test: if (vert_order .eq. 6) then<a name='3790'>
  do j = j_end, j_start, -1<a name='3791'>
    do k = kts, ktf<a name='3792'>
      do i = i_start, i_end<a name='3793'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='3794'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='3795'>
      end do<a name='3796'>
    end do<a name='3797'>
    do i = i_start, i_end<a name='3798'>
      a_vel = 0.<a name='3799'>
      k = ktf-1<a name='3800'>
<font color=#447700>! recompute : k<a name='3801'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='3802'>
<font color=#447700>! recompute : vel<a name='3803'></font>
      k = ktf<a name='3804'>
<font color=#447700>! recompute : k<a name='3805'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3806'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3807'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='3808'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='3809'>
      a_vflux(i,k) = 0.<a name='3810'>
<font color=#447700>! recdepend vars : ktf<a name='3811'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2544<a name='3812'></font>
<font color=#447700>! recompute vars : k<a name='3813'></font>
      k = ktf-1<a name='3814'>
<font color=#447700>! recompute vars : k<a name='3815'></font>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='3816'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='3817'>
      a_v(i,k+1,j) = a_v(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='3818'>
      a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='3819'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(v(i,k,j)+v(i,k-1,j))-0.083333333*(v(i,k+1,j)+v(i,k-2,j)))<a name='3820'>
      a_vflux(i,k) = 0.<a name='3821'>
<font color=#447700>! recdepend vars : ktf<a name='3822'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2544<a name='3823'></font>
<font color=#447700>! recompute vars : k<a name='3824'></font>
      k = ktf-1<a name='3825'>
<font color=#447700>! recompute vars : k<a name='3826'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='3827'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='3828'>
      a_vel = 0.<a name='3829'>
<font color=#447700>! recdepend vars : kts<a name='3830'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2539<a name='3831'></font>
<font color=#447700>! recompute vars : k<a name='3832'></font>
      k = kts+2<a name='3833'>
<font color=#447700>! recompute vars : k<a name='3834'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='3835'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2540<a name='3836'></font>
<font color=#447700>! recompute vars : vel<a name='3837'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='3838'>
<font color=#447700>! recompute vars : vel<a name='3839'></font>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='3840'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='3841'>
      a_v(i,k+1,j) = a_v(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='3842'>
      a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='3843'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(v(i,k,j)+v(i,k-1,j))-0.083333333*(v(i,k+1,j)+v(i,k-2,j)))<a name='3844'>
      a_vflux(i,k) = 0.<a name='3845'>
<font color=#447700>! recdepend vars : kts<a name='3846'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2539<a name='3847'></font>
<font color=#447700>! recompute vars : k<a name='3848'></font>
      k = kts+2<a name='3849'>
<font color=#447700>! recompute vars : k<a name='3850'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='3851'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='3852'>
      a_vel = 0.<a name='3853'>
<font color=#447700>! recdepend vars : kts<a name='3854'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2536<a name='3855'></font>
<font color=#447700>! recompute vars : k<a name='3856'></font>
      k = kts+1<a name='3857'>
<font color=#447700>! recompute vars : k<a name='3858'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3859'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3860'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='3861'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='3862'>
      a_vflux(i,k) = 0.<a name='3863'>
    end do<a name='3864'>
    do k = kts+3, ktf-2<a name='3865'>
      a_vel = 0.<a name='3866'>
      do i = i_start, i_end<a name='3867'>
        a_vel = 0.<a name='3868'>
        vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='3869'>
<font color=#447700>! recompute : vel<a name='3870'></font>
        a_v(i,k-3,j) = a_v(i,k-3,j)+0.016666667*a_vflux(i,k)*vel<a name='3871'>
        a_v(i,k-2,j) = a_v(i,k-2,j)-0.13333333*a_vflux(i,k)*vel<a name='3872'>
        a_v(i,k-1,j) = a_v(i,k-1,j)+0.61666667*a_vflux(i,k)*vel<a name='3873'>
        a_v(i,k+2,j) = a_v(i,k+2,j)+0.016666667*a_vflux(i,k)*vel<a name='3874'>
        a_v(i,k+1,j) = a_v(i,k+1,j)-0.13333333*a_vflux(i,k)*vel<a name='3875'>
        a_v(i,k,j) = a_v(i,k,j)+0.61666667*a_vflux(i,k)*vel<a name='3876'>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(v(i,k,j)+v(i,k-1,j))-0.13333333*(v(i,k+1,j)+v(i,k-2,j))+0.016666667*(v(i,k+2,j)+&amp;<a name='3877'>
&amp;v(i,k-3,j)))<a name='3878'>
        a_vflux(i,k) = 0.<a name='3879'>
        a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='3880'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='3881'>
        a_vel = 0.<a name='3882'>
      end do<a name='3883'>
    end do<a name='3884'>
  end do<a name='3885'>
else if (vert_order .eq. 5) then a_vert_order_test<a name='3886'>
  do j = j_end, j_start, -1<a name='3887'>
    do k = kts, ktf<a name='3888'>
      do i = i_start, i_end<a name='3889'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='3890'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='3891'>
      end do<a name='3892'>
    end do<a name='3893'>
    do i = i_start, i_end<a name='3894'>
      a_vel = 0.<a name='3895'>
      k = ktf-1<a name='3896'>
<font color=#447700>! recompute : k<a name='3897'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='3898'>
<font color=#447700>! recompute : vel<a name='3899'></font>
      k = ktf<a name='3900'>
<font color=#447700>! recompute : k<a name='3901'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3902'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3903'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='3904'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='3905'>
      a_vflux(i,k) = 0.<a name='3906'>
<font color=#447700>! recdepend vars : ktf<a name='3907'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2587<a name='3908'></font>
<font color=#447700>! recompute vars : k<a name='3909'></font>
      k = ktf-1<a name='3910'>
<font color=#447700>! recompute vars : k<a name='3911'></font>
      a_v(i,k-2,j) = a_v(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='3912'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='3913'>
      a_v(i,k+1,j) = a_v(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='3914'>
      a_v(i,k,j) = a_v(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='3915'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(v(i,k,j)+v(i,k-1,j))-0.083333333*(v(i,k+1,j)+v(i,k-2,j))+0.083333333*(v(i,k+1,j)-v(i,&amp;<a name='3916'>
&amp;k-2,j)-3.*(v(i,k,j)-v(i,k-1,j)))*sign(1.,-vel))<a name='3917'>
      a_vflux(i,k) = 0.<a name='3918'>
<font color=#447700>! recdepend vars : ktf<a name='3919'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2587<a name='3920'></font>
<font color=#447700>! recompute vars : k<a name='3921'></font>
      k = ktf-1<a name='3922'>
<font color=#447700>! recompute vars : k<a name='3923'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='3924'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='3925'>
      a_vel = 0.<a name='3926'>
<font color=#447700>! recdepend vars : kts<a name='3927'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2582<a name='3928'></font>
<font color=#447700>! recompute vars : k<a name='3929'></font>
      k = kts+2<a name='3930'>
<font color=#447700>! recompute vars : k<a name='3931'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='3932'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2583<a name='3933'></font>
<font color=#447700>! recompute vars : vel<a name='3934'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='3935'>
<font color=#447700>! recompute vars : vel<a name='3936'></font>
      a_v(i,k-2,j) = a_v(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='3937'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='3938'>
      a_v(i,k+1,j) = a_v(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='3939'>
      a_v(i,k,j) = a_v(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='3940'>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(v(i,k,j)+v(i,k-1,j))-0.083333333*(v(i,k+1,j)+v(i,k-2,j))+0.083333333*(v(i,k+1,j)-v(i,&amp;<a name='3941'>
&amp;k-2,j)-3.*(v(i,k,j)-v(i,k-1,j)))*sign(1.,-vel))<a name='3942'>
      a_vflux(i,k) = 0.<a name='3943'>
<font color=#447700>! recdepend vars : kts<a name='3944'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2582<a name='3945'></font>
<font color=#447700>! recompute vars : k<a name='3946'></font>
      k = kts+2<a name='3947'>
<font color=#447700>! recompute vars : k<a name='3948'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='3949'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='3950'>
      a_vel = 0.<a name='3951'>
<font color=#447700>! recdepend vars : kts<a name='3952'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2579<a name='3953'></font>
<font color=#447700>! recompute vars : k<a name='3954'></font>
      k = kts+1<a name='3955'>
<font color=#447700>! recompute vars : k<a name='3956'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3957'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3958'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='3959'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='3960'>
      a_vflux(i,k) = 0.<a name='3961'>
    end do<a name='3962'>
    do k = kts+3, ktf-2<a name='3963'>
      a_vel = 0.<a name='3964'>
      do i = i_start, i_end<a name='3965'>
        a_vel = 0.<a name='3966'>
        vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='3967'>
<font color=#447700>! recompute : vel<a name='3968'></font>
        a_v(i,k-3,j) = a_v(i,k-3,j)+a_vflux(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,-vel))<a name='3969'>
        a_v(i,k-2,j) = a_v(i,k-2,j)+a_vflux(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,-vel))<a name='3970'>
        a_v(i,k-1,j) = a_v(i,k-1,j)+a_vflux(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,-vel))<a name='3971'>
        a_v(i,k+2,j) = a_v(i,k+2,j)+a_vflux(i,k)*vel*(0.016666667-0.016666667*sign(1.,-vel))<a name='3972'>
        a_v(i,k+1,j) = a_v(i,k+1,j)+a_vflux(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,-vel))<a name='3973'>
        a_v(i,k,j) = a_v(i,k,j)+a_vflux(i,k)*vel*(0.61666667-0.16666667*sign(1.,-vel))<a name='3974'>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(v(i,k,j)+v(i,k-1,j))-0.13333333*(v(i,k+1,j)+v(i,k-2,j))+0.016666667*(v(i,k+2,j)+&amp;<a name='3975'>
&amp;v(i,k-3,j))-0.016666667*(v(i,k+2,j)-v(i,k-3,j)-5.*(v(i,k+1,j)-v(i,k-2,j))+10.*(v(i,k,j)-v(i,k-1,j)))*sign(1.,-vel))<a name='3976'>
        a_vflux(i,k) = 0.<a name='3977'>
        a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='3978'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='3979'>
        a_vel = 0.<a name='3980'>
      end do<a name='3981'>
    end do<a name='3982'>
  end do<a name='3983'>
else if (vert_order .eq. 4) then a_vert_order_test<a name='3984'>
  do j = j_end, j_start, -1<a name='3985'>
    do k = kts, ktf<a name='3986'>
      do i = i_start, i_end<a name='3987'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='3988'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='3989'>
      end do<a name='3990'>
    end do<a name='3991'>
    do i = i_start, i_end<a name='3992'>
      k = ktf<a name='3993'>
<font color=#447700>! recompute : k<a name='3994'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3995'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='3996'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='3997'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='3998'>
      a_vflux(i,k) = 0.<a name='3999'>
<font color=#447700>! recdepend vars : kts<a name='4000'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2622<a name='4001'></font>
<font color=#447700>! recompute vars : k<a name='4002'></font>
      k = kts+1<a name='4003'>
<font color=#447700>! recompute vars : k<a name='4004'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4005'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4006'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='4007'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='4008'>
      a_vflux(i,k) = 0.<a name='4009'>
    end do<a name='4010'>
    do k = kts+2, ktf-1<a name='4011'>
      a_vel = 0.<a name='4012'>
      do i = i_start, i_end<a name='4013'>
        a_vel = 0.<a name='4014'>
        vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='4015'>
<font color=#447700>! recompute : vel<a name='4016'></font>
        a_v(i,k-2,j) = a_v(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='4017'>
        a_v(i,k-1,j) = a_v(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='4018'>
        a_v(i,k+1,j) = a_v(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='4019'>
        a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='4020'>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(v(i,k,j)+v(i,k-1,j))-0.083333333*(v(i,k+1,j)+v(i,k-2,j)))<a name='4021'>
        a_vflux(i,k) = 0.<a name='4022'>
        a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='4023'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='4024'>
        a_vel = 0.<a name='4025'>
      end do<a name='4026'>
    end do<a name='4027'>
  end do<a name='4028'>
else if (vert_order .eq. 3) then a_vert_order_test<a name='4029'>
  do j = j_end, j_start, -1<a name='4030'>
    do k = kts, ktf<a name='4031'>
      do i = i_start, i_end<a name='4032'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='4033'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='4034'>
      end do<a name='4035'>
    end do<a name='4036'>
    do i = i_start, i_end<a name='4037'>
      k = ktf<a name='4038'>
<font color=#447700>! recompute : k<a name='4039'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4040'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4041'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='4042'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='4043'>
      a_vflux(i,k) = 0.<a name='4044'>
<font color=#447700>! recdepend vars : kts<a name='4045'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2655<a name='4046'></font>
<font color=#447700>! recompute vars : k<a name='4047'></font>
      k = kts+1<a name='4048'>
<font color=#447700>! recompute vars : k<a name='4049'></font>
      a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4050'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4051'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='4052'>
      a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='4053'>
      a_vflux(i,k) = 0.<a name='4054'>
    end do<a name='4055'>
    do k = kts+2, ktf-1<a name='4056'>
      a_vel = 0.<a name='4057'>
      do i = i_start, i_end<a name='4058'>
        a_vel = 0.<a name='4059'>
        vel = 0.5*(rom(i,k,j)+rom(i,k,j-1))<a name='4060'>
<font color=#447700>! recompute : vel<a name='4061'></font>
        a_v(i,k-2,j) = a_v(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='4062'>
        a_v(i,k-1,j) = a_v(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='4063'>
        a_v(i,k+1,j) = a_v(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='4064'>
        a_v(i,k,j) = a_v(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='4065'>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(v(i,k,j)+v(i,k-1,j))-0.083333333*(v(i,k+1,j)+v(i,k-2,j))+0.083333333*(v(i,k+1,j)-&amp;<a name='4066'>
&amp;v(i,k-2,j)-3.*(v(i,k,j)-v(i,k-1,j)))*sign(1.,-vel))<a name='4067'>
        a_vflux(i,k) = 0.<a name='4068'>
        a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vel<a name='4069'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='4070'>
        a_vel = 0.<a name='4071'>
      end do<a name='4072'>
    end do<a name='4073'>
  end do<a name='4074'>
else if (vert_order .eq. 2) then a_vert_order_test<a name='4075'>
  do j = j_start, j_end<a name='4076'>
    do k = kts, ktf<a name='4077'>
      do i = i_start, i_end<a name='4078'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzw(k)<a name='4079'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzw(k)<a name='4080'>
      end do<a name='4081'>
    end do<a name='4082'>
    do k = kts+1, ktf<a name='4083'>
      do i = i_start, i_end<a name='4084'>
        a_rom(i,k,j-1) = a_rom(i,k,j-1)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4085'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vflux(i,k)*(fzm(k)*v(i,k,j)+fzp(k)*v(i,k-1,j))<a name='4086'>
        a_v(i,k-1,j) = a_v(i,k-1,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzp(k)<a name='4087'>
        a_v(i,k,j) = a_v(i,k,j)+0.5*a_vflux(i,k)*(rom(i,k,j)+rom(i,k,j-1))*fzm(k)<a name='4088'>
        a_vflux(i,k) = 0.<a name='4089'>
      end do<a name='4090'>
    end do<a name='4091'>
  end do<a name='4092'>
endif a_vert_order_test<a name='4093'>
<font color=#447700>! recdepend vars : jts<a name='4094'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2438<a name='4095'></font>
<font color=#447700>! recompute vars : j_start<a name='4096'></font>
j_start = jts<a name='4097'>
<font color=#447700>! recompute vars : j_start<a name='4098'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='4099'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2439<a name='4100'></font>
<font color=#447700>! recompute vars : j_end<a name='4101'></font>
j_end = min(jte,jde)<a name='4102'>
<font color=#447700>! recompute vars : j_end<a name='4103'></font>
<font color=#447700>! recdepend vars : config_flags,j_end,j_start,jds,jts<a name='4104'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2444<a name='4105'></font>
<font color=#447700>! recompute vars : j_start<a name='4106'></font>
if (config_flags%open_ys) then<a name='4107'>
  j_start = max(jds+1,jts)<a name='4108'>
endif<a name='4109'>
<font color=#447700>! recompute vars : j_start<a name='4110'></font>
<font color=#447700>! recdepend vars : config_flags,j_end,j_start,jde,jte<a name='4111'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2448<a name='4112'></font>
<font color=#447700>! recompute vars : j_end<a name='4113'></font>
if (config_flags%open_ye) then<a name='4114'>
  j_end = min(jte,jde-1)<a name='4115'>
endif<a name='4116'>
<font color=#447700>! recompute vars : j_end<a name='4117'></font>
if (config_flags%open_xe .and. ite .eq. ide) then<a name='4118'>
  do j = j_start, j_end<a name='4119'>
    a_dum = 0.<a name='4120'>
    a_dup = 0.<a name='4121'>
    a_ub = 0.<a name='4122'>
    a_uw = 0.<a name='4123'>
    mrdx = msfv(ite-1,j)*rdx<a name='4124'>
<font color=#447700>! recompute : mrdx<a name='4125'></font>
    jp = min(jmax,j)<a name='4126'>
<font color=#447700>! recompute : jp<a name='4127'></font>
    jm = max(jmin,j-1)<a name='4128'>
<font color=#447700>! recompute : jm<a name='4129'></font>
    do k = kts, ktf<a name='4130'>
      a_dum = 0.<a name='4131'>
      a_dup = 0.<a name='4132'>
      a_ub = 0.<a name='4133'>
      a_uw = 0.<a name='4134'>
      uw = 0.5*(ru(ite,k,jp)+ru(ite,k,jm))<a name='4135'>
<font color=#447700>! recompute : uw<a name='4136'></font>
      ub = max(uw,0.)<a name='4137'>
<font color=#447700>! recompute : ub<a name='4138'></font>
      dup = ru(ite,k,jp)-ru(ite-1,k,jp)<a name='4139'>
<font color=#447700>! recompute : dup<a name='4140'></font>
      dum = ru(ite,k,jm)-ru(ite-1,k,jm)<a name='4141'>
<font color=#447700>! recompute : dum<a name='4142'></font>
      a_dum = a_dum-0.5*a_tendency(ite-1,k,j)*mrdx*v(ite-1,k,j)<a name='4143'>
      a_dup = a_dup-0.5*a_tendency(ite-1,k,j)*mrdx*v(ite-1,k,j)<a name='4144'>
      a_ub = a_ub-a_tendency(ite-1,k,j)*mrdx*(v_old(ite-1,k,j)-v_old(ite-2,k,j))<a name='4145'>
      a_v(ite-1,k,j) = a_v(ite-1,k,j)-0.5*a_tendency(ite-1,k,j)*mrdx*(dup+dum)<a name='4146'>
      a_v_old(ite-2,k,j) = a_v_old(ite-2,k,j)+a_tendency(ite-1,k,j)*mrdx*ub<a name='4147'>
      a_v_old(ite-1,k,j) = a_v_old(ite-1,k,j)-a_tendency(ite-1,k,j)*mrdx*ub<a name='4148'>
      a_ru(ite-1,k,jm) = a_ru(ite-1,k,jm)-a_dum<a name='4149'>
      a_ru(ite,k,jm) = a_ru(ite,k,jm)+a_dum<a name='4150'>
      a_dum = 0.<a name='4151'>
      a_ru(ite-1,k,jp) = a_ru(ite-1,k,jp)-a_dup<a name='4152'>
      a_ru(ite,k,jp) = a_ru(ite,k,jp)+a_dup<a name='4153'>
      a_dup = 0.<a name='4154'>
      a_uw = a_uw+a_ub*(0.5+sign(0.5,uw-0.))<a name='4155'>
      a_ub = 0.<a name='4156'>
      a_ru(ite,k,jm) = a_ru(ite,k,jm)+0.5*a_uw<a name='4157'>
      a_ru(ite,k,jp) = a_ru(ite,k,jp)+0.5*a_uw<a name='4158'>
      a_uw = 0.<a name='4159'>
    end do<a name='4160'>
  end do<a name='4161'>
endif<a name='4162'>
<font color=#447700>! recdepend vars : jts<a name='4163'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2438<a name='4164'></font>
<font color=#447700>! recompute vars : j_start<a name='4165'></font>
j_start = jts<a name='4166'>
<font color=#447700>! recompute vars : j_start<a name='4167'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='4168'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2439<a name='4169'></font>
<font color=#447700>! recompute vars : j_end<a name='4170'></font>
j_end = min(jte,jde)<a name='4171'>
<font color=#447700>! recompute vars : j_end<a name='4172'></font>
<font color=#447700>! recdepend vars : config_flags,j_end,j_start,jds,jts<a name='4173'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2444<a name='4174'></font>
<font color=#447700>! recompute vars : j_start<a name='4175'></font>
if (config_flags%open_ys) then<a name='4176'>
  j_start = max(jds+1,jts)<a name='4177'>
endif<a name='4178'>
<font color=#447700>! recompute vars : j_start<a name='4179'></font>
<font color=#447700>! recdepend vars : config_flags,j_end,j_start,jde,jte<a name='4180'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2448<a name='4181'></font>
<font color=#447700>! recompute vars : j_end<a name='4182'></font>
if (config_flags%open_ye) then<a name='4183'>
  j_end = min(jte,jde-1)<a name='4184'>
endif<a name='4185'>
<font color=#447700>! recompute vars : j_end<a name='4186'></font>
if (config_flags%open_xs .and. its .eq. ids) then<a name='4187'>
  do j = j_start, j_end<a name='4188'>
    a_dum = 0.<a name='4189'>
    a_dup = 0.<a name='4190'>
    a_ub = 0.<a name='4191'>
    a_uw = 0.<a name='4192'>
    mrdx = msfv(its,j)*rdx<a name='4193'>
<font color=#447700>! recompute : mrdx<a name='4194'></font>
    jp = min(jmax,j)<a name='4195'>
<font color=#447700>! recompute : jp<a name='4196'></font>
    jm = max(jmin,j-1)<a name='4197'>
<font color=#447700>! recompute : jm<a name='4198'></font>
    do k = kts, ktf<a name='4199'>
      a_dum = 0.<a name='4200'>
      a_dup = 0.<a name='4201'>
      a_ub = 0.<a name='4202'>
      a_uw = 0.<a name='4203'>
      uw = 0.5*(ru(its,k,jp)+ru(its,k,jm))<a name='4204'>
<font color=#447700>! recompute : uw<a name='4205'></font>
      ub = min(uw,0.)<a name='4206'>
<font color=#447700>! recompute : ub<a name='4207'></font>
      dup = ru(its+1,k,jp)-ru(its,k,jp)<a name='4208'>
<font color=#447700>! recompute : dup<a name='4209'></font>
      dum = ru(its+1,k,jm)-ru(its,k,jm)<a name='4210'>
<font color=#447700>! recompute : dum<a name='4211'></font>
      a_dum = a_dum-0.5*a_tendency(its,k,j)*mrdx*v(its,k,j)<a name='4212'>
      a_dup = a_dup-0.5*a_tendency(its,k,j)*mrdx*v(its,k,j)<a name='4213'>
      a_ub = a_ub-a_tendency(its,k,j)*mrdx*(v_old(its+1,k,j)-v_old(its,k,j))<a name='4214'>
      a_v(its,k,j) = a_v(its,k,j)-0.5*a_tendency(its,k,j)*mrdx*(dup+dum)<a name='4215'>
      a_v_old(its+1,k,j) = a_v_old(its+1,k,j)-a_tendency(its,k,j)*mrdx*ub<a name='4216'>
      a_v_old(its,k,j) = a_v_old(its,k,j)+a_tendency(its,k,j)*mrdx*ub<a name='4217'>
      a_ru(its+1,k,jm) = a_ru(its+1,k,jm)+a_dum<a name='4218'>
      a_ru(its,k,jm) = a_ru(its,k,jm)-a_dum<a name='4219'>
      a_dum = 0.<a name='4220'>
      a_ru(its+1,k,jp) = a_ru(its+1,k,jp)+a_dup<a name='4221'>
      a_ru(its,k,jp) = a_ru(its,k,jp)-a_dup<a name='4222'>
      a_dup = 0.<a name='4223'>
      a_uw = a_uw+a_ub*(0.5+sign(0.5,0.-uw))<a name='4224'>
      a_ub = 0.<a name='4225'>
      a_ru(its,k,jm) = a_ru(its,k,jm)+0.5*a_uw<a name='4226'>
      a_ru(its,k,jp) = a_ru(its,k,jp)+0.5*a_uw<a name='4227'>
      a_uw = 0.<a name='4228'>
    end do<a name='4229'>
  end do<a name='4230'>
endif<a name='4231'>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='4232'>
  i_start = its<a name='4233'>
<font color=#447700>! recompute : i_start<a name='4234'></font>
  i_end = min(ite,ide-1)<a name='4235'>
<font color=#447700>! recompute : i_end<a name='4236'></font>
  do i = i_start, i_end<a name='4237'>
    a_vb = 0.<a name='4238'>
    do k = kts, ktf<a name='4239'>
      a_vb = 0.<a name='4240'>
      vb = max(rv(i,k,jte)+cb*mut(i,jte-1),0.)<a name='4241'>
<font color=#447700>! recompute : vb<a name='4242'></font>
      a_v_old(i,k,jte-1) = a_v_old(i,k,jte-1)+a_tendency(i,k,jte)*rdy*vb<a name='4243'>
      a_v_old(i,k,jte) = a_v_old(i,k,jte)-a_tendency(i,k,jte)*rdy*vb<a name='4244'>
      a_vb = a_vb-a_tendency(i,k,jte)*rdy*(v_old(i,k,jte)-v_old(i,k,jte-1))<a name='4245'>
      a_mut(i,jte-1) = a_mut(i,jte-1)+a_vb*(0.5+sign(0.5,rv(i,k,jte)+cb*mut(i,jte-1)-0.))*cb<a name='4246'>
      a_rv(i,k,jte) = a_rv(i,k,jte)+a_vb*(0.5+sign(0.5,rv(i,k,jte)+cb*mut(i,jte-1)-0.))<a name='4247'>
      a_vb = 0.<a name='4248'>
    end do<a name='4249'>
  end do<a name='4250'>
endif<a name='4251'>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='4252'>
  i_start = its<a name='4253'>
<font color=#447700>! recompute : i_start<a name='4254'></font>
  i_end = min(ite,ide-1)<a name='4255'>
<font color=#447700>! recompute : i_end<a name='4256'></font>
  do i = i_start, i_end<a name='4257'>
    a_vb = 0.<a name='4258'>
    do k = kts, ktf<a name='4259'>
      a_vb = 0.<a name='4260'>
      vb = min(rv(i,k,jts)-cb*mut(i,jts),0.)<a name='4261'>
<font color=#447700>! recompute : vb<a name='4262'></font>
      a_v_old(i,k,jts+1) = a_v_old(i,k,jts+1)-a_tendency(i,k,jts)*rdy*vb<a name='4263'>
      a_v_old(i,k,jts) = a_v_old(i,k,jts)+a_tendency(i,k,jts)*rdy*vb<a name='4264'>
      a_vb = a_vb-a_tendency(i,k,jts)*rdy*(v_old(i,k,jts+1)-v_old(i,k,jts))<a name='4265'>
      a_mut(i,jts) = a_mut(i,jts)-a_vb*(0.5+sign(0.5,0.-(rv(i,k,jts)-cb*mut(i,jts))))*cb<a name='4266'>
      a_rv(i,k,jts) = a_rv(i,k,jts)+a_vb*(0.5+sign(0.5,0.-(rv(i,k,jts)-cb*mut(i,jts))))<a name='4267'>
      a_vb = 0.<a name='4268'>
    end do<a name='4269'>
  end do<a name='4270'>
endif<a name='4271'>
<font color=#447700>! recdepend vars : kde,kte<a name='4272'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1491<a name='4273'></font>
<font color=#447700>! recompute vars : ktf<a name='4274'></font>
ktf = min(kte,kde-1)<a name='4275'>
<font color=#447700>! recompute vars : ktf<a name='4276'></font>
a_horizontal_order_test: if (horz_order .eq. 6) then<a name='4277'>
  degrade_xs =  .true. <a name='4278'>
<font color=#447700>! recompute : degrade_xs<a name='4279'></font>
  degrade_xe =  .true. <a name='4280'>
<font color=#447700>! recompute : degrade_xe<a name='4281'></font>
  degrade_ys =  .true. <a name='4282'>
<font color=#447700>! recompute : degrade_ys<a name='4283'></font>
  degrade_ye =  .true. <a name='4284'>
<font color=#447700>! recompute : degrade_ye<a name='4285'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='4286'>
    degrade_xs =  .false. <a name='4287'>
  endif<a name='4288'>
<font color=#447700>! recompute : degrade_xs<a name='4289'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-3) then<a name='4290'>
    degrade_xe =  .false. <a name='4291'>
  endif<a name='4292'>
<font color=#447700>! recompute : degrade_xe<a name='4293'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='4294'>
    degrade_ys =  .false. <a name='4295'>
  endif<a name='4296'>
<font color=#447700>! recompute : degrade_ys<a name='4297'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='4298'>
    degrade_ye =  .false. <a name='4299'>
  endif<a name='4300'>
<font color=#447700>! recompute : degrade_ye<a name='4301'></font>
<font color=#447700>! recompute : ktf<a name='4302'></font>
  j_start = jts<a name='4303'>
<font color=#447700>! recompute : j_start<a name='4304'></font>
  j_end = jte<a name='4305'>
<font color=#447700>! recompute : j_end<a name='4306'></font>
  j_start_f = j_start<a name='4307'>
<font color=#447700>! recompute : j_start_f<a name='4308'></font>
  j_end_f = j_end+1<a name='4309'>
<font color=#447700>! recompute : j_end_f<a name='4310'></font>
  if (degrade_ys) then<a name='4311'>
    j_start_f = jds+3<a name='4312'>
  endif<a name='4313'>
<font color=#447700>! recompute : j_start_f<a name='4314'></font>
  if (degrade_ye) then<a name='4315'>
    j_end_f = jde-2<a name='4316'>
  endif<a name='4317'>
<font color=#447700>! recompute : j_end_f<a name='4318'></font>
  i_start = its<a name='4319'>
<font color=#447700>! recompute : i_start<a name='4320'></font>
  i_end = min(ite,ide-1)<a name='4321'>
<font color=#447700>! recompute : i_end<a name='4322'></font>
  j_start = jts<a name='4323'>
<font color=#447700>! recompute : j_start<a name='4324'></font>
  j_end = jte<a name='4325'>
<font color=#447700>! recompute : j_end<a name='4326'></font>
  if (config_flags%open_ys .or. specified) then<a name='4327'>
    j_start = max(jds+1,jts)<a name='4328'>
  endif<a name='4329'>
<font color=#447700>! recompute : j_start<a name='4330'></font>
  if (config_flags%open_ye .or. specified) then<a name='4331'>
    j_end = min(jde-1,jte)<a name='4332'>
  endif<a name='4333'>
<font color=#447700>! recompute : j_end<a name='4334'></font>
  i_start_f = i_start<a name='4335'>
<font color=#447700>! recompute : i_start_f<a name='4336'></font>
  i_end_f = i_end+1<a name='4337'>
<font color=#447700>! recompute : i_end_f<a name='4338'></font>
  if (degrade_xs) then<a name='4339'>
    i_start = max(ids+1,its)<a name='4340'>
    i_start_f = i_start+2<a name='4341'>
  endif<a name='4342'>
<font color=#447700>! recompute : i_start,i_start_f<a name='4343'></font>
  if (degrade_xe) then<a name='4344'>
    i_end = min(ide-2,ite)<a name='4345'>
    i_end_f = ide-3<a name='4346'>
  endif<a name='4347'>
<font color=#447700>! recompute : i_end,i_end_f<a name='4348'></font>
  do j = j_end, j_start, -1<a name='4349'>
    do k = kts, ktf<a name='4350'>
      do i = i_start, i_end<a name='4351'>
        mrdx = msfv(i,j)*rdx<a name='4352'>
<font color=#447700>! recompute : mrdx<a name='4353'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='4354'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='4355'>
      end do<a name='4356'>
    end do<a name='4357'>
    if (degrade_xe) then<a name='4358'>
      i = ide-2<a name='4359'>
<font color=#447700>! recompute : i<a name='4360'></font>
      do k = kts, ktf<a name='4361'>
        a_vel = 0.<a name='4362'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='4363'>
<font color=#447700>! recompute : vel<a name='4364'></font>
        a_v(i-2,k,j) = a_v(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='4365'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='4366'>
        a_v(i+1,k,j) = a_v(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='4367'>
        a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='4368'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(v(i,k,j)+v(i-1,k,j))-0.083333333*(v(i+1,k,j)+v(i-2,k,j)))<a name='4369'>
        a_fqx(i,k) = 0.<a name='4370'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='4371'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='4372'>
        a_vel = 0.<a name='4373'>
      end do<a name='4374'>
      if (i_end .eq. ide-2) then<a name='4375'>
        i = ide-1<a name='4376'>
<font color=#447700>! recompute : i<a name='4377'></font>
        do k = kts, ktf<a name='4378'>
          a_ru(i_end+1,k,j-1) = a_ru(i_end+1,k,j-1)+0.25*a_fqx(i,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='4379'>
          a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.25*a_fqx(i,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='4380'>
          a_v(i_end+1,k,j) = a_v(i_end+1,k,j)+0.25*a_fqx(i,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='4381'>
          a_v(i_end,k,j) = a_v(i_end,k,j)+0.25*a_fqx(i,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='4382'>
          a_fqx(i,k) = 0.<a name='4383'>
        end do<a name='4384'>
      endif<a name='4385'>
    endif<a name='4386'>
    if (degrade_xs) then<a name='4387'>
      i = ids+2<a name='4388'>
<font color=#447700>! recompute : i<a name='4389'></font>
      do k = kts, ktf<a name='4390'>
        a_vel = 0.<a name='4391'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='4392'>
<font color=#447700>! recompute : vel<a name='4393'></font>
        a_v(i-2,k,j) = a_v(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='4394'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='4395'>
        a_v(i+1,k,j) = a_v(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='4396'>
        a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='4397'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(v(i,k,j)+v(i-1,k,j))-0.083333333*(v(i+1,k,j)+v(i-2,k,j)))<a name='4398'>
        a_fqx(i,k) = 0.<a name='4399'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='4400'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='4401'>
        a_vel = 0.<a name='4402'>
      end do<a name='4403'>
      if (i_start .eq. ids+1) then<a name='4404'>
        i = ids+1<a name='4405'>
<font color=#447700>! recompute : i<a name='4406'></font>
        do k = kts, ktf<a name='4407'>
          a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.25*a_fqx(i,k)*(v(i,k,j)+v(i-1,k,j))<a name='4408'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(v(i,k,j)+v(i-1,k,j))<a name='4409'>
          a_v(i-1,k,j) = a_v(i-1,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i,k,j-1))<a name='4410'>
          a_v(i,k,j) = a_v(i,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i,k,j-1))<a name='4411'>
          a_fqx(i,k) = 0.<a name='4412'>
        end do<a name='4413'>
      endif<a name='4414'>
    endif<a name='4415'>
    do k = kts, ktf<a name='4416'>
      a_vel = 0.<a name='4417'>
      do i = i_start_f, i_end_f<a name='4418'>
        a_vel = 0.<a name='4419'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='4420'>
<font color=#447700>! recompute : vel<a name='4421'></font>
        a_v(i-3,k,j) = a_v(i-3,k,j)+0.016666667*a_fqx(i,k)*vel<a name='4422'>
        a_v(i-2,k,j) = a_v(i-2,k,j)-0.13333333*a_fqx(i,k)*vel<a name='4423'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+0.61666667*a_fqx(i,k)*vel<a name='4424'>
        a_v(i+2,k,j) = a_v(i+2,k,j)+0.016666667*a_fqx(i,k)*vel<a name='4425'>
        a_v(i+1,k,j) = a_v(i+1,k,j)-0.13333333*a_fqx(i,k)*vel<a name='4426'>
        a_v(i,k,j) = a_v(i,k,j)+0.61666667*a_fqx(i,k)*vel<a name='4427'>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(v(i,k,j)+v(i-1,k,j))-0.13333333*(v(i+1,k,j)+v(i-2,k,j))+0.016666667*(v(i+2,k,j)+v(i-&amp;<a name='4428'>
&amp;3,k,j)))<a name='4429'>
        a_fqx(i,k) = 0.<a name='4430'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='4431'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='4432'>
        a_vel = 0.<a name='4433'>
      end do<a name='4434'>
    end do<a name='4435'>
  end do<a name='4436'>
<font color=#447700>! recdepend vars : its<a name='4437'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1530<a name='4438'></font>
<font color=#447700>! recompute vars : i_start<a name='4439'></font>
  i_start = its<a name='4440'>
<font color=#447700>! recompute vars : i_start<a name='4441'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='4442'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1531<a name='4443'></font>
<font color=#447700>! recompute vars : i_end<a name='4444'></font>
  i_end = min(ite,ide-1)<a name='4445'>
<font color=#447700>! recompute vars : i_end<a name='4446'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='4447'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1532<a name='4448'></font>
<font color=#447700>! recompute vars : j_start<a name='4449'></font>
  j_start = jts<a name='4450'>
<font color=#447700>! recompute vars : j_start<a name='4451'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jte<a name='4452'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1533<a name='4453'></font>
<font color=#447700>! recompute vars : j_end<a name='4454'></font>
  j_end = jte<a name='4455'>
<font color=#447700>! recompute vars : j_end<a name='4456'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='4457'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1541<a name='4458'></font>
<font color=#447700>! recompute vars : j_start<a name='4459'></font>
  if (degrade_ys) then<a name='4460'>
    j_start = max(jts,jds+1)<a name='4461'>
  endif<a name='4462'>
<font color=#447700>! recompute vars : j_start<a name='4463'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='4464'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1546<a name='4465'></font>
<font color=#447700>! recompute vars : j_end<a name='4466'></font>
  if (degrade_ye) then<a name='4467'>
    j_end = min(jte,jde-1)<a name='4468'>
  endif<a name='4469'>
<font color=#447700>! recompute vars : j_end<a name='4470'></font>
  a_j_loop_y_flux_6: do j = j_end+1, j_start, -1<a name='4471'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1553<a name='4472'></font>
<font color=#447700>! recompute vars : jp1<a name='4473'></font>
    jp1 = 2<a name='4474'>
<font color=#447700>! recompute vars : jp1<a name='4475'></font>
<font color=#447700>! recdepend vars : jp1<a name='4476'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1554<a name='4477'></font>
<font color=#447700>! recompute vars : jp0<a name='4478'></font>
    jp0 = 1<a name='4479'>
<font color=#447700>! recompute vars : jp0<a name='4480'></font>
    j_loop_y_flux_9c: do j4 = j_start, j-1<a name='4481'>
      jtmp = jp1<a name='4482'>
      jp1 = jp0<a name='4483'>
      jp0 = jtmp<a name='4484'>
    end do j_loop_y_flux_9c<a name='4485'>
<font color=#447700>!     if (j .gt. j_start) then<a name='4486'></font>
    if (j .gt. jds+1) then<a name='4487'>
      do k = kts, ktf<a name='4488'>
        do i = i_start, i_end<a name='4489'>
          mrdy = msfv(i,j-1)*rdy<a name='4490'>
<font color=#447700>! recompute : mrdy<a name='4491'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='4492'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='4493'>
        end do<a name='4494'>
      end do<a name='4495'>
    endif<a name='4496'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='4497'>
      do k = kts, ktf<a name='4498'>
        a_vel = 0.<a name='4499'>
        do i = i_start, i_end<a name='4500'>
          a_vel = 0.<a name='4501'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='4502'>
<font color=#447700>! recompute : vel<a name='4503'></font>
          a_v(i,k,j-3) = a_v(i,k,j-3)+0.016666667*a_fqy(i,k,jp1)*vel<a name='4504'>
          a_v(i,k,j-2) = a_v(i,k,j-2)-0.13333333*a_fqy(i,k,jp1)*vel<a name='4505'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.61666667*a_fqy(i,k,jp1)*vel<a name='4506'>
          a_v(i,k,j+2) = a_v(i,k,j+2)+0.016666667*a_fqy(i,k,jp1)*vel<a name='4507'>
          a_v(i,k,j+1) = a_v(i,k,j+1)-0.13333333*a_fqy(i,k,jp1)*vel<a name='4508'>
          a_v(i,k,j) = a_v(i,k,j)+0.61666667*a_fqy(i,k,jp1)*vel<a name='4509'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(v(i,k,j)+v(i,k,j-1))-0.13333333*(v(i,k,j+1)+v(i,k,j-2))+0.016666667*(v(i,k,j+2)&amp;<a name='4510'>
&amp;+v(i,k,j-3)))<a name='4511'>
          a_fqy(i,k,jp1) = 0.<a name='4512'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='4513'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='4514'>
          a_vel = 0.<a name='4515'>
        end do<a name='4516'>
      end do<a name='4517'>
    else if (j .eq. jds+1) then<a name='4518'>
      do k = kts, ktf<a name='4519'>
        a_vb = 0.<a name='4520'>
        do i = i_start, i_end<a name='4521'>
          a_vb = 0.<a name='4522'>
          vb = v(i,k,j-1)<a name='4523'>
<font color=#447700>! recompute : vb<a name='4524'></font>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='4525'>
            vb = v(i,k,j)<a name='4526'>
          endif<a name='4527'>
<font color=#447700>! recompute : vb<a name='4528'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='4529'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='4530'>
          a_v(i,k,j) = a_v(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4531'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4532'>
          a_fqy(i,k,jp1) = 0.<a name='4533'>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='4534'>
            a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='4535'>
            a_vb = 0.<a name='4536'>
          endif<a name='4537'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='4538'>
          a_vb = 0.<a name='4539'>
        end do<a name='4540'>
      end do<a name='4541'>
    else if (j .eq. jds+2) then<a name='4542'>
      do k = kts, ktf<a name='4543'>
        a_vel = 0.<a name='4544'>
        do i = i_start, i_end<a name='4545'>
          a_vel = 0.<a name='4546'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='4547'>
<font color=#447700>! recompute : vel<a name='4548'></font>
          a_v(i,k,j-2) = a_v(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='4549'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='4550'>
          a_v(i,k,j+1) = a_v(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='4551'>
          a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='4552'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(v(i,k,j)+v(i,k,j-1))-0.083333333*(v(i,k,j+1)+v(i,k,j-2)))<a name='4553'>
          a_fqy(i,k,jp1) = 0.<a name='4554'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='4555'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='4556'>
          a_vel = 0.<a name='4557'>
        end do<a name='4558'>
      end do<a name='4559'>
    else if (j .eq. jde) then<a name='4560'>
      do k = kts, ktf<a name='4561'>
        a_vb = 0.<a name='4562'>
        do i = i_start, i_end<a name='4563'>
          a_vb = 0.<a name='4564'>
          vb = v(i,k,j)<a name='4565'>
<font color=#447700>! recompute : vb<a name='4566'></font>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='4567'>
            vb = v(i,k,j-1)<a name='4568'>
          endif<a name='4569'>
<font color=#447700>! recompute : vb<a name='4570'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='4571'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='4572'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4573'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4574'>
          a_fqy(i,k,jp1) = 0.<a name='4575'>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='4576'>
            a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='4577'>
            a_vb = 0.<a name='4578'>
          endif<a name='4579'>
          a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='4580'>
          a_vb = 0.<a name='4581'>
        end do<a name='4582'>
      end do<a name='4583'>
    else if (j .eq. jde-1) then<a name='4584'>
      do k = kts, ktf<a name='4585'>
        a_vel = 0.<a name='4586'>
        do i = i_start, i_end<a name='4587'>
          a_vel = 0.<a name='4588'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='4589'>
<font color=#447700>! recompute : vel<a name='4590'></font>
          a_v(i,k,j-2) = a_v(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='4591'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='4592'>
          a_v(i,k,j+1) = a_v(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='4593'>
          a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='4594'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(v(i,k,j)+v(i,k,j-1))-0.083333333*(v(i,k,j+1)+v(i,k,j-2)))<a name='4595'>
          a_fqy(i,k,jp1) = 0.<a name='4596'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='4597'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='4598'>
          a_vel = 0.<a name='4599'>
        end do<a name='4600'>
      end do<a name='4601'>
    endif<a name='4602'>
  end do a_j_loop_y_flux_6<a name='4603'>
else if (horz_order .eq. 5) then a_horizontal_order_test<a name='4604'>
  degrade_xs =  .true. <a name='4605'>
<font color=#447700>! recompute : degrade_xs<a name='4606'></font>
  degrade_xe =  .true. <a name='4607'>
<font color=#447700>! recompute : degrade_xe<a name='4608'></font>
  degrade_ys =  .true. <a name='4609'>
<font color=#447700>! recompute : degrade_ys<a name='4610'></font>
  degrade_ye =  .true. <a name='4611'>
<font color=#447700>! recompute : degrade_ye<a name='4612'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='4613'>
    degrade_xs =  .false. <a name='4614'>
  endif<a name='4615'>
<font color=#447700>! recompute : degrade_xs<a name='4616'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-3) then<a name='4617'>
    degrade_xe =  .false. <a name='4618'>
  endif<a name='4619'>
<font color=#447700>! recompute : degrade_xe<a name='4620'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='4621'>
    degrade_ys =  .false. <a name='4622'>
  endif<a name='4623'>
<font color=#447700>! recompute : degrade_ys<a name='4624'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='4625'>
    degrade_ye =  .false. <a name='4626'>
  endif<a name='4627'>
<font color=#447700>! recompute : degrade_ye<a name='4628'></font>
  j_start = jts<a name='4629'>
<font color=#447700>! recompute : j_start<a name='4630'></font>
  j_end = jte<a name='4631'>
<font color=#447700>! recompute : j_end<a name='4632'></font>
  j_start_f = j_start<a name='4633'>
<font color=#447700>! recompute : j_start_f<a name='4634'></font>
  j_end_f = j_end+1<a name='4635'>
<font color=#447700>! recompute : j_end_f<a name='4636'></font>
  if (degrade_ys) then<a name='4637'>
    j_start_f = jds+3<a name='4638'>
  endif<a name='4639'>
<font color=#447700>! recompute : j_start_f<a name='4640'></font>
  if (degrade_ye) then<a name='4641'>
    j_end_f = jde-2<a name='4642'>
  endif<a name='4643'>
<font color=#447700>! recompute : j_end_f<a name='4644'></font>
  i_start = its<a name='4645'>
<font color=#447700>! recompute : i_start<a name='4646'></font>
  i_end = min(ite,ide-1)<a name='4647'>
<font color=#447700>! recompute : i_end<a name='4648'></font>
  j_start = jts<a name='4649'>
<font color=#447700>! recompute : j_start<a name='4650'></font>
  j_end = jte<a name='4651'>
<font color=#447700>! recompute : j_end<a name='4652'></font>
  if (config_flags%open_ys .or. specified) then<a name='4653'>
    j_start = max(jds+1,jts)<a name='4654'>
  endif<a name='4655'>
<font color=#447700>! recompute : j_start<a name='4656'></font>
  if (config_flags%open_ye .or. specified) then<a name='4657'>
    j_end = min(jde-1,jte)<a name='4658'>
  endif<a name='4659'>
<font color=#447700>! recompute : j_end<a name='4660'></font>
  i_start_f = i_start<a name='4661'>
<font color=#447700>! recompute : i_start_f<a name='4662'></font>
  i_end_f = i_end+1<a name='4663'>
<font color=#447700>! recompute : i_end_f<a name='4664'></font>
  if (degrade_xs) then<a name='4665'>
    i_start = max(ids+1,its)<a name='4666'>
    i_start_f = i_start+2<a name='4667'>
  endif<a name='4668'>
<font color=#447700>! recompute : i_start,i_start_f<a name='4669'></font>
  if (degrade_xe) then<a name='4670'>
    i_end = min(ide-2,ite)<a name='4671'>
    i_end_f = ide-3<a name='4672'>
  endif<a name='4673'>
<font color=#447700>! recompute : i_end,i_end_f<a name='4674'></font>
  do j = j_end, j_start, -1<a name='4675'>
    do k = kts, ktf<a name='4676'>
      do i = i_start, i_end<a name='4677'>
        mrdx = msfv(i,j)*rdx<a name='4678'>
<font color=#447700>! recompute : mrdx<a name='4679'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='4680'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='4681'>
      end do<a name='4682'>
    end do<a name='4683'>
    if (degrade_xe) then<a name='4684'>
      i = ide-2<a name='4685'>
<font color=#447700>! recompute : i<a name='4686'></font>
      do k = kts, ktf<a name='4687'>
        a_vel = 0.<a name='4688'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='4689'>
<font color=#447700>! recompute : vel<a name='4690'></font>
        a_v(i-2,k,j) = a_v(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='4691'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='4692'>
        a_v(i+1,k,j) = a_v(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='4693'>
        a_v(i,k,j) = a_v(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='4694'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(v(i,k,j)+v(i-1,k,j))-0.083333333*(v(i+1,k,j)+v(i-2,k,j))+0.083333333*(v(i+1,k,j)-v(i-&amp;<a name='4695'>
&amp;2,k,j)-3.*(v(i,k,j)-v(i-1,k,j)))*sign(1.,vel))<a name='4696'>
        a_fqx(i,k) = 0.<a name='4697'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='4698'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='4699'>
        a_vel = 0.<a name='4700'>
      end do<a name='4701'>
      if (i_end .eq. ide-2) then<a name='4702'>
        i = ide-1<a name='4703'>
<font color=#447700>! recompute : i<a name='4704'></font>
        do k = kts, ktf<a name='4705'>
          a_ru(i_end+1,k,j-1) = a_ru(i_end+1,k,j-1)+0.25*a_fqx(i,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='4706'>
          a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.25*a_fqx(i,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='4707'>
          a_v(i_end+1,k,j) = a_v(i_end+1,k,j)+0.25*a_fqx(i,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='4708'>
          a_v(i_end,k,j) = a_v(i_end,k,j)+0.25*a_fqx(i,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='4709'>
          a_fqx(i,k) = 0.<a name='4710'>
        end do<a name='4711'>
      endif<a name='4712'>
    endif<a name='4713'>
    if (degrade_xs) then<a name='4714'>
      i = ids+2<a name='4715'>
<font color=#447700>! recompute : i<a name='4716'></font>
      do k = kts, ktf<a name='4717'>
        a_vel = 0.<a name='4718'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='4719'>
<font color=#447700>! recompute : vel<a name='4720'></font>
        a_v(i-2,k,j) = a_v(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='4721'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='4722'>
        a_v(i+1,k,j) = a_v(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='4723'>
        a_v(i,k,j) = a_v(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='4724'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(v(i,k,j)+v(i-1,k,j))-0.083333333*(v(i+1,k,j)+v(i-2,k,j))+0.083333333*(v(i+1,k,j)-v(i-&amp;<a name='4725'>
&amp;2,k,j)-3.*(v(i,k,j)-v(i-1,k,j)))*sign(1.,vel))<a name='4726'>
        a_fqx(i,k) = 0.<a name='4727'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='4728'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='4729'>
        a_vel = 0.<a name='4730'>
      end do<a name='4731'>
      if (i_start .eq. ids+1) then<a name='4732'>
        i = ids+1<a name='4733'>
<font color=#447700>! recompute : i<a name='4734'></font>
        do k = kts, ktf<a name='4735'>
          a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.25*a_fqx(i,k)*(v(i,k,j)+v(i-1,k,j))<a name='4736'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_fqx(i,k)*(v(i,k,j)+v(i-1,k,j))<a name='4737'>
          a_v(i-1,k,j) = a_v(i-1,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i,k,j-1))<a name='4738'>
          a_v(i,k,j) = a_v(i,k,j)+0.25*a_fqx(i,k)*(ru(i,k,j)+ru(i,k,j-1))<a name='4739'>
          a_fqx(i,k) = 0.<a name='4740'>
        end do<a name='4741'>
      endif<a name='4742'>
    endif<a name='4743'>
    do k = kts, ktf<a name='4744'>
      a_vel = 0.<a name='4745'>
      do i = i_start_f, i_end_f<a name='4746'>
        a_vel = 0.<a name='4747'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='4748'>
<font color=#447700>! recompute : vel<a name='4749'></font>
        a_v(i-3,k,j) = a_v(i-3,k,j)+a_fqx(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='4750'>
        a_v(i-2,k,j) = a_v(i-2,k,j)+a_fqx(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='4751'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+a_fqx(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='4752'>
        a_v(i+2,k,j) = a_v(i+2,k,j)+a_fqx(i,k)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='4753'>
        a_v(i+1,k,j) = a_v(i+1,k,j)+a_fqx(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='4754'>
        a_v(i,k,j) = a_v(i,k,j)+a_fqx(i,k)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='4755'>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(v(i,k,j)+v(i-1,k,j))-0.13333333*(v(i+1,k,j)+v(i-2,k,j))+0.016666667*(v(i+2,k,j)+v(i-&amp;<a name='4756'>
&amp;3,k,j))-0.016666667*(v(i+2,k,j)-v(i-3,k,j)-5.*(v(i+1,k,j)-v(i-2,k,j))+10.*(v(i,k,j)-v(i-1,k,j)))*sign(1.,vel))<a name='4757'>
        a_fqx(i,k) = 0.<a name='4758'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='4759'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='4760'>
        a_vel = 0.<a name='4761'>
      end do<a name='4762'>
    end do<a name='4763'>
  end do<a name='4764'>
<font color=#447700>! recdepend vars : its<a name='4765'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1765<a name='4766'></font>
<font color=#447700>! recompute vars : i_start<a name='4767'></font>
  i_start = its<a name='4768'>
<font color=#447700>! recompute vars : i_start<a name='4769'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='4770'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1766<a name='4771'></font>
<font color=#447700>! recompute vars : i_end<a name='4772'></font>
  i_end = min(ite,ide-1)<a name='4773'>
<font color=#447700>! recompute vars : i_end<a name='4774'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='4775'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1767<a name='4776'></font>
<font color=#447700>! recompute vars : j_start<a name='4777'></font>
  j_start = jts<a name='4778'>
<font color=#447700>! recompute vars : j_start<a name='4779'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jte<a name='4780'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1768<a name='4781'></font>
<font color=#447700>! recompute vars : j_end<a name='4782'></font>
  j_end = jte<a name='4783'>
<font color=#447700>! recompute vars : j_end<a name='4784'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='4785'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1776<a name='4786'></font>
<font color=#447700>! recompute vars : j_start<a name='4787'></font>
  if (degrade_ys) then<a name='4788'>
    j_start = max(jts,jds+1)<a name='4789'>
  endif<a name='4790'>
<font color=#447700>! recompute vars : j_start<a name='4791'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='4792'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:1781<a name='4793'></font>
<font color=#447700>! recompute vars : j_end<a name='4794'></font>
  if (degrade_ye) then<a name='4795'>
    j_end = min(jte,jde-1)<a name='4796'>
  endif<a name='4797'>
<font color=#447700>! recompute vars : j_end<a name='4798'></font>
  a_j_loop_y_flux_5: do j = j_end+1, j_start, -1<a name='4799'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1788<a name='4800'></font>
<font color=#447700>! recompute vars : jp1<a name='4801'></font>
    jp1 = 2<a name='4802'>
<font color=#447700>! recompute vars : jp1<a name='4803'></font>
<font color=#447700>! recdepend vars : jp1<a name='4804'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1789<a name='4805'></font>
<font color=#447700>! recompute vars : jp0<a name='4806'></font>
    jp0 = 1<a name='4807'>
<font color=#447700>! recompute vars : jp0<a name='4808'></font>
    j_loop_y_flux_9a: do j1 = j_start, j-1<a name='4809'>
      jtmp = jp1<a name='4810'>
      jp1 = jp0<a name='4811'>
      jp0 = jtmp<a name='4812'>
    end do j_loop_y_flux_9a<a name='4813'>
<font color=#447700>!    if (j .gt. j_start) then<a name='4814'></font>
    if (j .gt. jds+1) then<a name='4815'>
      do k = kts, ktf<a name='4816'>
        do i = i_start, i_end<a name='4817'>
          mrdy = msfv(i,j-1)*rdy<a name='4818'>
<font color=#447700>! recompute : mrdy<a name='4819'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='4820'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='4821'>
        end do<a name='4822'>
      end do<a name='4823'>
    endif<a name='4824'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='4825'>
      do k = kts, ktf<a name='4826'>
        a_vel = 0.<a name='4827'>
        do i = i_start, i_end<a name='4828'>
          a_vel = 0.<a name='4829'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='4830'>
<font color=#447700>! recompute : vel<a name='4831'></font>
          a_v(i,k,j-3) = a_v(i,k,j-3)+a_fqy(i,k,jp1)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='4832'>
          a_v(i,k,j-2) = a_v(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='4833'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='4834'>
          a_v(i,k,j+2) = a_v(i,k,j+2)+a_fqy(i,k,jp1)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='4835'>
          a_v(i,k,j+1) = a_v(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='4836'>
          a_v(i,k,j) = a_v(i,k,j)+a_fqy(i,k,jp1)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='4837'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(v(i,k,j)+v(i,k,j-1))-0.13333333*(v(i,k,j+1)+v(i,k,j-2))+0.016666667*(v(i,k,j+2)&amp;<a name='4838'>
&amp;+v(i,k,j-3))-0.016666667*(v(i,k,j+2)-v(i,k,j-3)-5.*(v(i,k,j+1)-v(i,k,j-2))+10.*(v(i,k,j)-v(i,k,j-1)))*sign(1.,vel))<a name='4839'>
          a_fqy(i,k,jp1) = 0.<a name='4840'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='4841'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='4842'>
          a_vel = 0.<a name='4843'>
        end do<a name='4844'>
      end do<a name='4845'>
    else if (j .eq. jds+1) then<a name='4846'>
      do k = kts, ktf<a name='4847'>
        a_vb = 0.<a name='4848'>
        do i = i_start, i_end<a name='4849'>
          a_vb = 0.<a name='4850'>
          vb = v(i,k,j-1)<a name='4851'>
<font color=#447700>! recompute : vb<a name='4852'></font>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='4853'>
            vb = v(i,k,j)<a name='4854'>
          endif<a name='4855'>
<font color=#447700>! recompute : vb<a name='4856'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='4857'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='4858'>
          a_v(i,k,j) = a_v(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4859'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4860'>
          a_fqy(i,k,jp1) = 0.<a name='4861'>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='4862'>
            a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='4863'>
            a_vb = 0.<a name='4864'>
          endif<a name='4865'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='4866'>
          a_vb = 0.<a name='4867'>
        end do<a name='4868'>
      end do<a name='4869'>
    else if (j .eq. jds+2) then<a name='4870'>
      do k = kts, ktf<a name='4871'>
        a_vel = 0.<a name='4872'>
        do i = i_start, i_end<a name='4873'>
          a_vel = 0.<a name='4874'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='4875'>
<font color=#447700>! recompute : vel<a name='4876'></font>
          a_v(i,k,j-2) = a_v(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='4877'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='4878'>
          a_v(i,k,j+1) = a_v(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='4879'>
          a_v(i,k,j) = a_v(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='4880'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(v(i,k,j)+v(i,k,j-1))-0.083333333*(v(i,k,j+1)+v(i,k,j-2))+0.083333333*(v(i,k,j+&amp;<a name='4881'>
&amp;1)-v(i,k,j-2)-3.*(v(i,k,j)-v(i,k,j-1)))*sign(1.,vel))<a name='4882'>
          a_fqy(i,k,jp1) = 0.<a name='4883'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='4884'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='4885'>
          a_vel = 0.<a name='4886'>
        end do<a name='4887'>
      end do<a name='4888'>
    else if (j .eq. jde) then<a name='4889'>
      do k = kts, ktf<a name='4890'>
        a_vb = 0.<a name='4891'>
        do i = i_start, i_end<a name='4892'>
          a_vb = 0.<a name='4893'>
          vb = v(i,k,j)<a name='4894'>
<font color=#447700>! recompute : vb<a name='4895'></font>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='4896'>
            vb = v(i,k,j-1)<a name='4897'>
          endif<a name='4898'>
<font color=#447700>! recompute : vb<a name='4899'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='4900'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='4901'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4902'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='4903'>
          a_fqy(i,k,jp1) = 0.<a name='4904'>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='4905'>
            a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='4906'>
            a_vb = 0.<a name='4907'>
          endif<a name='4908'>
          a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='4909'>
          a_vb = 0.<a name='4910'>
        end do<a name='4911'>
      end do<a name='4912'>
    else if (j .eq. jde-1) then<a name='4913'>
      do k = kts, ktf<a name='4914'>
        a_vel = 0.<a name='4915'>
        do i = i_start, i_end<a name='4916'>
          a_vel = 0.<a name='4917'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='4918'>
<font color=#447700>! recompute : vel<a name='4919'></font>
          a_v(i,k,j-2) = a_v(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='4920'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='4921'>
          a_v(i,k,j+1) = a_v(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='4922'>
          a_v(i,k,j) = a_v(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='4923'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(v(i,k,j)+v(i,k,j-1))-0.083333333*(v(i,k,j+1)+v(i,k,j-2))+0.083333333*(v(i,k,j+&amp;<a name='4924'>
&amp;1)-v(i,k,j-2)-3.*(v(i,k,j)-v(i,k,j-1)))*sign(1.,vel))<a name='4925'>
          a_fqy(i,k,jp1) = 0.<a name='4926'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='4927'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='4928'>
          a_vel = 0.<a name='4929'>
        end do<a name='4930'>
      end do<a name='4931'>
    endif<a name='4932'>
  end do a_j_loop_y_flux_5<a name='4933'>
else if (horz_order .eq. 4) then a_horizontal_order_test<a name='4934'>
  degrade_xs =  .true. <a name='4935'>
<font color=#447700>! recompute : degrade_xs<a name='4936'></font>
  degrade_xe =  .true. <a name='4937'>
<font color=#447700>! recompute : degrade_xe<a name='4938'></font>
  degrade_ys =  .true. <a name='4939'>
<font color=#447700>! recompute : degrade_ys<a name='4940'></font>
  degrade_ye =  .true. <a name='4941'>
<font color=#447700>! recompute : degrade_ye<a name='4942'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='4943'>
    degrade_xs =  .false. <a name='4944'>
  endif<a name='4945'>
<font color=#447700>! recompute : degrade_xs<a name='4946'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='4947'>
    degrade_xe =  .false. <a name='4948'>
  endif<a name='4949'>
<font color=#447700>! recompute : degrade_xe<a name='4950'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='4951'>
    degrade_ys =  .false. <a name='4952'>
  endif<a name='4953'>
<font color=#447700>! recompute : degrade_ys<a name='4954'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-1) then<a name='4955'>
    degrade_ye =  .false. <a name='4956'>
  endif<a name='4957'>
<font color=#447700>! recompute : degrade_ye<a name='4958'></font>
<font color=#447700>! recompute : ktf<a name='4959'></font>
  i_start = its<a name='4960'>
<font color=#447700>! recompute : i_start<a name='4961'></font>
  i_end = min(ite,ide-1)<a name='4962'>
<font color=#447700>! recompute : i_end<a name='4963'></font>
  j_start = jts<a name='4964'>
<font color=#447700>! recompute : j_start<a name='4965'></font>
  j_end = jte<a name='4966'>
<font color=#447700>! recompute : j_end<a name='4967'></font>
  if (config_flags%open_ys .or. specified) then<a name='4968'>
    j_start = max(jds+1,jts)<a name='4969'>
  endif<a name='4970'>
<font color=#447700>! recompute : j_start<a name='4971'></font>
  if (config_flags%open_ye .or. specified) then<a name='4972'>
    j_end = min(jde-1,jte)<a name='4973'>
  endif<a name='4974'>
<font color=#447700>! recompute : j_end<a name='4975'></font>
  i_start_f = i_start<a name='4976'>
<font color=#447700>! recompute : i_start_f<a name='4977'></font>
  i_end_f = i_end+1<a name='4978'>
<font color=#447700>! recompute : i_end_f<a name='4979'></font>
  if (degrade_xs) then<a name='4980'>
    i_start = ids+1<a name='4981'>
    i_start_f = i_start+1<a name='4982'>
  endif<a name='4983'>
<font color=#447700>! recompute : i_start,i_start_f<a name='4984'></font>
  if (degrade_xe) then<a name='4985'>
    i_end = ide-2<a name='4986'>
    i_end_f = ide-2<a name='4987'>
  endif<a name='4988'>
<font color=#447700>! recompute : i_end,i_end_f<a name='4989'></font>
  do j = j_start, j_end<a name='4990'>
    a_vel = 0.<a name='4991'>
    do k = kts, ktf<a name='4992'>
      do i = i_start, i_end<a name='4993'>
        mrdx = msfv(i,j)*rdx<a name='4994'>
<font color=#447700>! recompute : mrdx<a name='4995'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='4996'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='4997'>
      end do<a name='4998'>
    end do<a name='4999'>
    if (degrade_xe) then<a name='5000'>
      do k = kts, ktf<a name='5001'>
        a_ru(i_end+1,k,j-1) = a_ru(i_end+1,k,j-1)+0.25*a_fqx(i_end+1,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='5002'>
        a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.25*a_fqx(i_end+1,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='5003'>
        a_v(i_end+1,k,j) = a_v(i_end+1,k,j)+0.25*a_fqx(i_end+1,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='5004'>
        a_v(i_end,k,j) = a_v(i_end,k,j)+0.25*a_fqx(i_end+1,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='5005'>
        a_fqx(i_end+1,k) = 0.<a name='5006'>
      end do<a name='5007'>
    endif<a name='5008'>
    if (degrade_xs) then<a name='5009'>
      do k = kts, ktf<a name='5010'>
        a_ru(i_start,k,j-1) = a_ru(i_start,k,j-1)+0.25*a_fqx(i_start,k)*(v(i_start,k,j)+v(i_start-1,k,j))<a name='5011'>
        a_ru(i_start,k,j) = a_ru(i_start,k,j)+0.25*a_fqx(i_start,k)*(v(i_start,k,j)+v(i_start-1,k,j))<a name='5012'>
        a_v(i_start-1,k,j) = a_v(i_start-1,k,j)+0.25*a_fqx(i_start,k)*(ru(i_start,k,j)+ru(i_start,k,j-1))<a name='5013'>
        a_v(i_start,k,j) = a_v(i_start,k,j)+0.25*a_fqx(i_start,k)*(ru(i_start,k,j)+ru(i_start,k,j-1))<a name='5014'>
        a_fqx(i_start,k) = 0.<a name='5015'>
      end do<a name='5016'>
    endif<a name='5017'>
    do k = kts, ktf<a name='5018'>
      a_vel = 0.<a name='5019'>
      do i = i_start_f, i_end_f<a name='5020'>
        a_vel = 0.<a name='5021'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='5022'>
<font color=#447700>! recompute : vel<a name='5023'></font>
        a_v(i-2,k,j) = a_v(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='5024'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='5025'>
        a_v(i+1,k,j) = a_v(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='5026'>
        a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='5027'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(v(i,k,j)+v(i-1,k,j))-0.083333333*(v(i+1,k,j)+v(i-2,k,j)))<a name='5028'>
        a_fqx(i,k) = 0.<a name='5029'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='5030'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='5031'>
        a_vel = 0.<a name='5032'>
      end do<a name='5033'>
    end do<a name='5034'>
  end do<a name='5035'>
<font color=#447700>! recdepend vars : its<a name='5036'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1998<a name='5037'></font>
<font color=#447700>! recompute vars : i_start<a name='5038'></font>
  i_start = its<a name='5039'>
<font color=#447700>! recompute vars : i_start<a name='5040'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='5041'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:1999<a name='5042'></font>
<font color=#447700>! recompute vars : i_end<a name='5043'></font>
  i_end = min(ite,ide-1)<a name='5044'>
<font color=#447700>! recompute vars : i_end<a name='5045'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='5046'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2000<a name='5047'></font>
<font color=#447700>! recompute vars : j_start<a name='5048'></font>
  j_start = jts<a name='5049'>
<font color=#447700>! recompute vars : j_start<a name='5050'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jte<a name='5051'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2001<a name='5052'></font>
<font color=#447700>! recompute vars : j_end<a name='5053'></font>
  j_end = jte<a name='5054'>
<font color=#447700>! recompute vars : j_end<a name='5055'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds<a name='5056'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2010<a name='5057'></font>
<font color=#447700>! recompute vars : j_start<a name='5058'></font>
  if (degrade_ys) then<a name='5059'>
    j_start = jds+1<a name='5060'>
  endif<a name='5061'>
<font color=#447700>! recompute vars : j_start<a name='5062'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde<a name='5063'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2015<a name='5064'></font>
<font color=#447700>! recompute vars : j_end<a name='5065'></font>
  if (degrade_ye) then<a name='5066'>
    j_end = jde-1<a name='5067'>
  endif<a name='5068'>
<font color=#447700>! recompute vars : j_end<a name='5069'></font>
  do j = j_end+1, j_start, -1<a name='5070'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2023<a name='5071'></font>
<font color=#447700>! recompute vars : jp0<a name='5072'></font>
    jp0 = 1<a name='5073'>
<font color=#447700>! recompute vars : jp0<a name='5074'></font>
<font color=#447700>! recdepend vars : jp0<a name='5075'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2024<a name='5076'></font>
<font color=#447700>! recompute vars : jp1<a name='5077'></font>
    jp1 = 2<a name='5078'>
<font color=#447700>! recompute vars : jp1<a name='5079'></font>
    do j2 = j_start, j-1<a name='5080'>
      jtmp = jp1<a name='5081'>
      jp1 = jp0<a name='5082'>
      jp0 = jtmp<a name='5083'>
    end do<a name='5084'>
<font color=#447700>!    if (j .gt. j_start) then<a name='5085'></font>
    if (j .gt. jds+1) then<a name='5086'>
      do k = kts, ktf<a name='5087'>
        do i = i_start, i_end<a name='5088'>
          mrdy = msfv(i,j-1)*rdy<a name='5089'>
<font color=#447700>! recompute : mrdy<a name='5090'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='5091'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='5092'>
        end do<a name='5093'>
      end do<a name='5094'>
    endif<a name='5095'>
    if (j .eq. j_start .and. degrade_ys) then<a name='5096'>
      do k = kts, ktf<a name='5097'>
        a_vb = 0.<a name='5098'>
        do i = i_start, i_end<a name='5099'>
          a_vb = 0.<a name='5100'>
          vb = v(i,k,j-1)<a name='5101'>
<font color=#447700>! recompute : vb<a name='5102'></font>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='5103'>
            vb = v(i,k,j)<a name='5104'>
          endif<a name='5105'>
<font color=#447700>! recompute : vb<a name='5106'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='5107'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='5108'>
          a_v(i,k,j) = a_v(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5109'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5110'>
          a_fqy(i,k,jp1) = 0.<a name='5111'>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='5112'>
            a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='5113'>
            a_vb = 0.<a name='5114'>
          endif<a name='5115'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='5116'>
          a_vb = 0.<a name='5117'>
        end do<a name='5118'>
      end do<a name='5119'>
    else if (j .eq. j_end+1 .and. degrade_ye) then<a name='5120'>
      do k = kts, ktf<a name='5121'>
        a_vb = 0.<a name='5122'>
        do i = i_start, i_end<a name='5123'>
          a_vb = 0.<a name='5124'>
          vb = v(i,k,j)<a name='5125'>
<font color=#447700>! recompute : vb<a name='5126'></font>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='5127'>
            vb = v(i,k,j-1)<a name='5128'>
          endif<a name='5129'>
<font color=#447700>! recompute : vb<a name='5130'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='5131'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='5132'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5133'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5134'>
          a_fqy(i,k,jp1) = 0.<a name='5135'>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='5136'>
            a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='5137'>
            a_vb = 0.<a name='5138'>
          endif<a name='5139'>
          a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='5140'>
          a_vb = 0.<a name='5141'>
        end do<a name='5142'>
      end do<a name='5143'>
    else<a name='5144'>
      do k = kts, ktf<a name='5145'>
        a_vel = 0.<a name='5146'>
        do i = i_start, i_end<a name='5147'>
          a_vel = 0.<a name='5148'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='5149'>
<font color=#447700>! recompute : vel<a name='5150'></font>
          a_v(i,k,j-2) = a_v(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='5151'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='5152'>
          a_v(i,k,j+1) = a_v(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='5153'>
          a_v(i,k,j) = a_v(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='5154'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(v(i,k,j)+v(i,k,j-1))-0.083333333*(v(i,k,j+1)+v(i,k,j-2)))<a name='5155'>
          a_fqy(i,k,jp1) = 0.<a name='5156'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='5157'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='5158'>
          a_vel = 0.<a name='5159'>
        end do<a name='5160'>
      end do<a name='5161'>
    endif<a name='5162'>
  end do<a name='5163'>
else if (horz_order .eq. 3) then a_horizontal_order_test<a name='5164'>
  degrade_xs =  .true. <a name='5165'>
<font color=#447700>! recompute : degrade_xs<a name='5166'></font>
  degrade_xe =  .true. <a name='5167'>
<font color=#447700>! recompute : degrade_xe<a name='5168'></font>
  degrade_ys =  .true. <a name='5169'>
<font color=#447700>! recompute : degrade_ys<a name='5170'></font>
  degrade_ye =  .true. <a name='5171'>
<font color=#447700>! recompute : degrade_ye<a name='5172'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='5173'>
    degrade_xs =  .false. <a name='5174'>
  endif<a name='5175'>
<font color=#447700>! recompute : degrade_xs<a name='5176'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='5177'>
    degrade_xe =  .false. <a name='5178'>
  endif<a name='5179'>
<font color=#447700>! recompute : degrade_xe<a name='5180'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='5181'>
    degrade_ys =  .false. <a name='5182'>
  endif<a name='5183'>
<font color=#447700>! recompute : degrade_ys<a name='5184'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-1) then<a name='5185'>
    degrade_ye =  .false. <a name='5186'>
  endif<a name='5187'>
<font color=#447700>! recompute : degrade_ye<a name='5188'></font>
<font color=#447700>! recompute : ktf<a name='5189'></font>
  i_start = its<a name='5190'>
<font color=#447700>! recompute : i_start<a name='5191'></font>
  i_end = min(ite,ide-1)<a name='5192'>
<font color=#447700>! recompute : i_end<a name='5193'></font>
  j_start = jts<a name='5194'>
<font color=#447700>! recompute : j_start<a name='5195'></font>
  j_end = jte<a name='5196'>
<font color=#447700>! recompute : j_end<a name='5197'></font>
  if (config_flags%open_ys .or. specified) then<a name='5198'>
    j_start = max(jds+1,jts)<a name='5199'>
  endif<a name='5200'>
<font color=#447700>! recompute : j_start<a name='5201'></font>
  if (config_flags%open_ye .or. specified) then<a name='5202'>
    j_end = min(jde-1,jte)<a name='5203'>
  endif<a name='5204'>
<font color=#447700>! recompute : j_end<a name='5205'></font>
  i_start_f = i_start<a name='5206'>
<font color=#447700>! recompute : i_start_f<a name='5207'></font>
  i_end_f = i_end+1<a name='5208'>
<font color=#447700>! recompute : i_end_f<a name='5209'></font>
  if (degrade_xs) then<a name='5210'>
    i_start = ids+1<a name='5211'>
    i_start_f = i_start+1<a name='5212'>
  endif<a name='5213'>
<font color=#447700>! recompute : i_start,i_start_f<a name='5214'></font>
  if (degrade_xe) then<a name='5215'>
    i_end = ide-2<a name='5216'>
    i_end_f = ide-2<a name='5217'>
  endif<a name='5218'>
<font color=#447700>! recompute : i_end,i_end_f<a name='5219'></font>
  do j = j_start, j_end<a name='5220'>
    a_vel = 0.<a name='5221'>
    do k = kts, ktf<a name='5222'>
      do i = i_start, i_end<a name='5223'>
        mrdx = msfv(i,j)*rdx<a name='5224'>
<font color=#447700>! recompute : mrdx<a name='5225'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='5226'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='5227'>
      end do<a name='5228'>
    end do<a name='5229'>
    if (degrade_xe) then<a name='5230'>
      do k = kts, ktf<a name='5231'>
        a_ru(i_end+1,k,j-1) = a_ru(i_end+1,k,j-1)+0.25*a_fqx(i_end+1,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='5232'>
        a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.25*a_fqx(i_end+1,k)*(v(i_end+1,k,j)+v(i_end,k,j))<a name='5233'>
        a_v(i_end+1,k,j) = a_v(i_end+1,k,j)+0.25*a_fqx(i_end+1,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='5234'>
        a_v(i_end,k,j) = a_v(i_end,k,j)+0.25*a_fqx(i_end+1,k)*(ru(i_end+1,k,j)+ru(i_end+1,k,j-1))<a name='5235'>
        a_fqx(i_end+1,k) = 0.<a name='5236'>
      end do<a name='5237'>
    endif<a name='5238'>
    if (degrade_xs) then<a name='5239'>
      do k = kts, ktf<a name='5240'>
        a_ru(i_start,k,j-1) = a_ru(i_start,k,j-1)+0.25*a_fqx(i_start,k)*(v(i_start,k,j)+v(i_start-1,k,j))<a name='5241'>
        a_ru(i_start,k,j) = a_ru(i_start,k,j)+0.25*a_fqx(i_start,k)*(v(i_start,k,j)+v(i_start-1,k,j))<a name='5242'>
        a_v(i_start-1,k,j) = a_v(i_start-1,k,j)+0.25*a_fqx(i_start,k)*(ru(i_start,k,j)+ru(i_start,k,j-1))<a name='5243'>
        a_v(i_start,k,j) = a_v(i_start,k,j)+0.25*a_fqx(i_start,k)*(ru(i_start,k,j)+ru(i_start,k,j-1))<a name='5244'>
        a_fqx(i_start,k) = 0.<a name='5245'>
      end do<a name='5246'>
    endif<a name='5247'>
    do k = kts, ktf<a name='5248'>
      a_vel = 0.<a name='5249'>
      do i = i_start_f, i_end_f<a name='5250'>
        a_vel = 0.<a name='5251'>
        vel = 0.5*(ru(i,k,j)+ru(i,k,j-1))<a name='5252'>
<font color=#447700>! recompute : vel<a name='5253'></font>
        a_v(i-2,k,j) = a_v(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='5254'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='5255'>
        a_v(i+1,k,j) = a_v(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='5256'>
        a_v(i,k,j) = a_v(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='5257'>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(v(i,k,j)+v(i-1,k,j))-0.083333333*(v(i+1,k,j)+v(i-2,k,j))+0.083333333*(v(i+1,k,j)-v(i-&amp;<a name='5258'>
&amp;2,k,j)-3.*(v(i,k,j)-v(i-1,k,j)))*sign(1.,vel))<a name='5259'>
        a_fqx(i,k) = 0.<a name='5260'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.5*a_vel<a name='5261'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_vel<a name='5262'>
        a_vel = 0.<a name='5263'>
      end do<a name='5264'>
    end do<a name='5265'>
  end do<a name='5266'>
<font color=#447700>! recdepend vars : its<a name='5267'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2173<a name='5268'></font>
<font color=#447700>! recompute vars : i_start<a name='5269'></font>
  i_start = its<a name='5270'>
<font color=#447700>! recompute vars : i_start<a name='5271'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='5272'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2174<a name='5273'></font>
<font color=#447700>! recompute vars : i_end<a name='5274'></font>
  i_end = min(ite,ide-1)<a name='5275'>
<font color=#447700>! recompute vars : i_end<a name='5276'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='5277'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2175<a name='5278'></font>
<font color=#447700>! recompute vars : j_start<a name='5279'></font>
  j_start = jts<a name='5280'>
<font color=#447700>! recompute vars : j_start<a name='5281'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jte<a name='5282'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2176<a name='5283'></font>
<font color=#447700>! recompute vars : j_end<a name='5284'></font>
  j_end = jte<a name='5285'>
<font color=#447700>! recompute vars : j_end<a name='5286'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds<a name='5287'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2185<a name='5288'></font>
<font color=#447700>! recompute vars : j_start<a name='5289'></font>
  if (degrade_ys) then<a name='5290'>
    j_start = jds+1<a name='5291'>
  endif<a name='5292'>
<font color=#447700>! recompute vars : j_start<a name='5293'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde<a name='5294'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:2190<a name='5295'></font>
<font color=#447700>! recompute vars : j_end<a name='5296'></font>
  if (degrade_ye) then<a name='5297'>
    j_end = jde-1<a name='5298'>
  endif<a name='5299'>
<font color=#447700>! recompute vars : j_end<a name='5300'></font>
  do j = j_end+1, j_start, -1<a name='5301'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2198<a name='5302'></font>
<font color=#447700>! recompute vars : jp0<a name='5303'></font>
    jp0 = 1<a name='5304'>
<font color=#447700>! recompute vars : jp0<a name='5305'></font>
<font color=#447700>! recdepend vars : jp0<a name='5306'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2199<a name='5307'></font>
<font color=#447700>! recompute vars : jp1<a name='5308'></font>
    jp1 = 2<a name='5309'>
<font color=#447700>! recompute vars : jp1<a name='5310'></font>
    do j3 = j_start, j-1<a name='5311'>
      jtmp = jp1<a name='5312'>
      jp1 = jp0<a name='5313'>
      jp0 = jtmp<a name='5314'>
    end do<a name='5315'>
<font color=#447700>!    if (j .gt. j_start) then<a name='5316'></font>
    if (j .gt. jds+1) then<a name='5317'>
      do k = kts, ktf<a name='5318'>
        do i = i_start, i_end<a name='5319'>
          mrdy = msfv(i,j-1)*rdy<a name='5320'>
<font color=#447700>! recompute : mrdy<a name='5321'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='5322'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='5323'>
        end do<a name='5324'>
      end do<a name='5325'>
    endif<a name='5326'>
    if (j .eq. j_start .and. degrade_ys) then<a name='5327'>
      do k = kts, ktf<a name='5328'>
        a_vb = 0.<a name='5329'>
        do i = i_start, i_end<a name='5330'>
          a_vb = 0.<a name='5331'>
          vb = v(i,k,j-1)<a name='5332'>
<font color=#447700>! recompute : vb<a name='5333'></font>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='5334'>
            vb = v(i,k,j)<a name='5335'>
          endif<a name='5336'>
<font color=#447700>! recompute : vb<a name='5337'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='5338'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(v(i,k,j)+vb)<a name='5339'>
          a_v(i,k,j) = a_v(i,k,j)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5340'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5341'>
          a_fqy(i,k,jp1) = 0.<a name='5342'>
          if (specified .and. v(i,k,j) .lt. 0.) then<a name='5343'>
            a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='5344'>
            a_vb = 0.<a name='5345'>
          endif<a name='5346'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='5347'>
          a_vb = 0.<a name='5348'>
        end do<a name='5349'>
      end do<a name='5350'>
    else if (j .eq. j_end+1 .and. degrade_ye) then<a name='5351'>
      do k = kts, ktf<a name='5352'>
        a_vb = 0.<a name='5353'>
        do i = i_start, i_end<a name='5354'>
          a_vb = 0.<a name='5355'>
          vb = v(i,k,j)<a name='5356'>
<font color=#447700>! recompute : vb<a name='5357'></font>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='5358'>
            vb = v(i,k,j-1)<a name='5359'>
          endif<a name='5360'>
<font color=#447700>! recompute : vb<a name='5361'></font>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='5362'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_fqy(i,k,jp1)*(vb+v(i,k,j-1))<a name='5363'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5364'>
          a_vb = a_vb+0.25*a_fqy(i,k,jp1)*(rv(i,k,j)+rv(i,k,j-1))<a name='5365'>
          a_fqy(i,k,jp1) = 0.<a name='5366'>
          if (specified .and. v(i,k,j-1) .gt. 0.) then<a name='5367'>
            a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='5368'>
            a_vb = 0.<a name='5369'>
          endif<a name='5370'>
          a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='5371'>
          a_vb = 0.<a name='5372'>
        end do<a name='5373'>
      end do<a name='5374'>
    else<a name='5375'>
      do k = kts, ktf<a name='5376'>
        a_vel = 0.<a name='5377'>
        do i = i_start, i_end<a name='5378'>
          a_vel = 0.<a name='5379'>
          vel = 0.5*(rv(i,k,j)+rv(i,k,j-1))<a name='5380'>
<font color=#447700>! recompute : vel<a name='5381'></font>
          a_v(i,k,j-2) = a_v(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='5382'>
          a_v(i,k,j-1) = a_v(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='5383'>
          a_v(i,k,j+1) = a_v(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='5384'>
          a_v(i,k,j) = a_v(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='5385'>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(v(i,k,j)+v(i,k,j-1))-0.083333333*(v(i,k,j+1)+v(i,k,j-2))+0.083333333*(v(i,k,j+&amp;<a name='5386'>
&amp;1)-v(i,k,j-2)-3.*(v(i,k,j)-v(i,k,j-1)))*sign(1.,vel))<a name='5387'>
          a_fqy(i,k,jp1) = 0.<a name='5388'>
          a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.5*a_vel<a name='5389'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_vel<a name='5390'>
          a_vel = 0.<a name='5391'>
        end do<a name='5392'>
      end do<a name='5393'>
    endif<a name='5394'>
  end do<a name='5395'>
else if (horz_order .eq. 2) then a_horizontal_order_test<a name='5396'>
  i_start = its<a name='5397'>
<font color=#447700>! recompute : i_start<a name='5398'></font>
  i_end = min(ite,ide-1)<a name='5399'>
<font color=#447700>! recompute : i_end<a name='5400'></font>
  j_start = jts<a name='5401'>
<font color=#447700>! recompute : j_start<a name='5402'></font>
  j_end = jte<a name='5403'>
<font color=#447700>! recompute : j_end<a name='5404'></font>
  if (config_flags%open_ys) then<a name='5405'>
    j_start = max(jds+1,jts)<a name='5406'>
  endif<a name='5407'>
<font color=#447700>! recompute : j_start<a name='5408'></font>
  if (config_flags%open_ye) then<a name='5409'>
    j_end = min(jde-1,jte)<a name='5410'>
  endif<a name='5411'>
<font color=#447700>! recompute : j_end<a name='5412'></font>
  if (specified) then<a name='5413'>
    j_start = max(jds+2,jts)<a name='5414'>
  endif<a name='5415'>
<font color=#447700>! recompute : j_start<a name='5416'></font>
  if (specified) then<a name='5417'>
    j_end = min(jde-2,jte)<a name='5418'>
  endif<a name='5419'>
<font color=#447700>! recompute : j_end<a name='5420'></font>
  if (config_flags%open_xs .or. specified) then<a name='5421'>
    i_start = max(ids+1,its)<a name='5422'>
  endif<a name='5423'>
<font color=#447700>! recompute : i_start<a name='5424'></font>
  if (config_flags%open_xe .or. specified) then<a name='5425'>
    i_end = min(ide-2,ite)<a name='5426'>
  endif<a name='5427'>
<font color=#447700>! recompute : i_end<a name='5428'></font>
  do j = j_start, j_end<a name='5429'>
    do k = kts, ktf<a name='5430'>
      do i = i_start, i_end<a name='5431'>
        mrdx = msfv(i,j)*rdx<a name='5432'>
<font color=#447700>! recompute : mrdx<a name='5433'></font>
        a_ru(i+1,k,j-1) = a_ru(i+1,k,j-1)-0.25*a_tendency(i,k,j)*mrdx*(v(i+1,k,j)+v(i,k,j))<a name='5434'>
        a_ru(i,k,j-1) = a_ru(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdx*(v(i,k,j)+v(i-1,k,j))<a name='5435'>
        a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(v(i+1,k,j)+v(i,k,j))<a name='5436'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_tendency(i,k,j)*mrdx*(v(i,k,j)+v(i-1,k,j))<a name='5437'>
        a_v(i-1,k,j) = a_v(i-1,k,j)+0.25*a_tendency(i,k,j)*mrdx*(ru(i,k,j)+ru(i,k,j-1))<a name='5438'>
        a_v(i+1,k,j) = a_v(i+1,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i+1,k,j-1))<a name='5439'>
        a_v(i,k,j) = a_v(i,k,j)-0.25*a_tendency(i,k,j)*mrdx*(ru(i+1,k,j)+ru(i+1,k,j-1)-(ru(i,k,j)+ru(i,k,j-1)))<a name='5440'>
      end do<a name='5441'>
    end do<a name='5442'>
  end do<a name='5443'>
<font color=#447700>! recdepend vars : its<a name='5444'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2319<a name='5445'></font>
<font color=#447700>! recompute vars : i_start<a name='5446'></font>
  i_start = its<a name='5447'>
<font color=#447700>! recompute vars : i_start<a name='5448'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='5449'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2320<a name='5450'></font>
<font color=#447700>! recompute vars : i_end<a name='5451'></font>
  i_end = min(ite,ide-1)<a name='5452'>
<font color=#447700>! recompute vars : i_end<a name='5453'></font>
  if (specified .and. jte .ge. jde-1) then<a name='5454'>
    j = jde-1<a name='5455'>
<font color=#447700>! recompute : j<a name='5456'></font>
    do k = kts, ktf<a name='5457'>
      a_vb = 0.<a name='5458'>
      do i = i_start, i_end<a name='5459'>
        a_vb = 0.<a name='5460'>
        mrdy = msfv(i,j)*rdy<a name='5461'>
<font color=#447700>! recompute : mrdy<a name='5462'></font>
        vb = v(i,k,j+1)<a name='5463'>
<font color=#447700>! recompute : vb<a name='5464'></font>
        if (v(i,k,j) .gt. 0.) then<a name='5465'>
          vb = v(i,k,j)<a name='5466'>
        endif<a name='5467'>
<font color=#447700>! recompute : vb<a name='5468'></font>
        a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j)+v(i,k,j-1))<a name='5469'>
        a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(vb+v(i,k,j))<a name='5470'>
        a_rv(i,k,j) = a_rv(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(vb+v(i,k,j)-(v(i,k,j)+v(i,k,j-1)))<a name='5471'>
        a_v(i,k,j-1) = a_v(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j)+rv(i,k,j-1))<a name='5472'>
        a_v(i,k,j) = a_v(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i,k,j)-(rv(i,k,j)+rv(i,k,j-1)))<a name='5473'>
        a_vb = a_vb-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i,k,j))<a name='5474'>
        if (v(i,k,j) .gt. 0.) then<a name='5475'>
          a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='5476'>
          a_vb = 0.<a name='5477'>
        endif<a name='5478'>
        a_v(i,k,j+1) = a_v(i,k,j+1)+a_vb<a name='5479'>
        a_vb = 0.<a name='5480'>
      end do<a name='5481'>
    end do<a name='5482'>
  endif<a name='5483'>
<font color=#447700>! recdepend vars : its<a name='5484'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2319<a name='5485'></font>
<font color=#447700>! recompute vars : i_start<a name='5486'></font>
  i_start = its<a name='5487'>
<font color=#447700>! recompute vars : i_start<a name='5488'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='5489'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2320<a name='5490'></font>
<font color=#447700>! recompute vars : i_end<a name='5491'></font>
  i_end = min(ite,ide-1)<a name='5492'>
<font color=#447700>! recompute vars : i_end<a name='5493'></font>
  if (specified .and. jts .le. jds+1) then<a name='5494'>
    j = jds+1<a name='5495'>
<font color=#447700>! recompute : j<a name='5496'></font>
    do k = kts, ktf<a name='5497'>
      a_vb = 0.<a name='5498'>
      do i = i_start, i_end<a name='5499'>
        a_vb = 0.<a name='5500'>
        mrdy = msfv(i,j)*rdy<a name='5501'>
<font color=#447700>! recompute : mrdy<a name='5502'></font>
        vb = v(i,k,j-1)<a name='5503'>
<font color=#447700>! recompute : vb<a name='5504'></font>
        if (v(i,k,j) .lt. 0.) then<a name='5505'>
          vb = v(i,k,j)<a name='5506'>
        endif<a name='5507'>
<font color=#447700>! recompute : vb<a name='5508'></font>
        a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j)+vb)<a name='5509'>
        a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j+1)+v(i,k,j))<a name='5510'>
        a_rv(i,k,j) = a_rv(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j+1)+v(i,k,j)-(v(i,k,j)+vb))<a name='5511'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i,k,j))<a name='5512'>
        a_v(i,k,j) = a_v(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i,k,j)-(rv(i,k,j)+rv(i,k,j-1)))<a name='5513'>
        a_vb = a_vb+0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j)+rv(i,k,j-1))<a name='5514'>
        if (v(i,k,j) .lt. 0.) then<a name='5515'>
          a_v(i,k,j) = a_v(i,k,j)+a_vb<a name='5516'>
          a_vb = 0.<a name='5517'>
        endif<a name='5518'>
        a_v(i,k,j-1) = a_v(i,k,j-1)+a_vb<a name='5519'>
        a_vb = 0.<a name='5520'>
      end do<a name='5521'>
    end do<a name='5522'>
  endif<a name='5523'>
<font color=#447700>! recdepend vars : its<a name='5524'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2319<a name='5525'></font>
<font color=#447700>! recompute vars : i_start<a name='5526'></font>
  i_start = its<a name='5527'>
<font color=#447700>! recompute vars : i_start<a name='5528'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='5529'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:2320<a name='5530'></font>
<font color=#447700>! recompute vars : i_end<a name='5531'></font>
  i_end = min(ite,ide-1)<a name='5532'>
<font color=#447700>! recompute vars : i_end<a name='5533'></font>
  do j = j_start, j_end<a name='5534'>
    do k = kts, ktf<a name='5535'>
      do i = i_start, i_end<a name='5536'>
        mrdy = msfv(i,j)*rdy<a name='5537'>
<font color=#447700>! recompute : mrdy<a name='5538'></font>
        a_rv(i,k,j-1) = a_rv(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j)+v(i,k,j-1))<a name='5539'>
        a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j+1)+v(i,k,j))<a name='5540'>
        a_rv(i,k,j) = a_rv(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(v(i,k,j+1)+v(i,k,j)-(v(i,k,j)+v(i,k,j-1)))<a name='5541'>
        a_v(i,k,j-1) = a_v(i,k,j-1)+0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j)+rv(i,k,j-1))<a name='5542'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i,k,j))<a name='5543'>
        a_v(i,k,j) = a_v(i,k,j)-0.25*a_tendency(i,k,j)*mrdy*(rv(i,k,j+1)+rv(i,k,j)-(rv(i,k,j)+rv(i,k,j-1)))<a name='5544'>
      end do<a name='5545'>
    end do<a name='5546'>
  end do<a name='5547'>
endif a_horizontal_order_test<a name='5548'>
<a name='5549'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_V' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_4">("a_advect_v")<a name='5550'>
<a name='5551'>
end subroutine a_advect_v<a name='5552'>
<a name='5553'>
<a name='5554'>
<A NAME='A_ADVECT_W'><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_W' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5555'>
<font color=#993300>subroutine </font><font color=#cc0000>a_advect_w</font>( w, a_w, w_old, a_w_old, a_tendency, ru, a_ru, rv, a_rv, rom, a_rom, config_flags, msft, fzm, fzp, rdx, rdy, &amp; <A href='../../call_to/A_ADVECT_W.html' TARGET='index'>1</A>,<A href='../../call_from/A_ADVECT_W.html' TARGET='index'>2</A><a name='5556'>
&amp;rdzu, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='5557'>
<font color=#447700>!******************************************************************<a name='5558'></font>
<font color=#447700>!******************************************************************<a name='5559'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5560'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5561'></font>
<font color=#447700>!******************************************************************<a name='5562'></font>
<font color=#447700>!******************************************************************<a name='5563'></font>
<font color=#447700>!==============================================<a name='5564'></font>
<font color=#447700>! all entries are defined explicitly<a name='5565'></font>
<font color=#447700>!==============================================<a name='5566'></font>
implicit none<a name='5567'>
<a name='5568'>
<font color=#447700>!==============================================<a name='5569'></font>
<font color=#447700>! declare arguments<a name='5570'></font>
<font color=#447700>!==============================================<a name='5571'></font>
integer, intent(in) :: ime<a name='5572'>
integer, intent(in) :: ims<a name='5573'>
integer, intent(in) :: jme<a name='5574'>
integer, intent(in) :: jms<a name='5575'>
integer, intent(in) :: kme<a name='5576'>
integer, intent(in) :: kms<a name='5577'>
real, intent(inout) :: a_rom(ims:ime,kms:kme,jms:jme)<a name='5578'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='5579'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='5580'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='5581'>
real, intent(inout) :: a_w(ims:ime,kms:kme,jms:jme)<a name='5582'>
real, intent(inout) :: a_w_old(ims:ime,kms:kme,jms:jme)<a name='5583'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='5584'>
real, intent(in) :: fzm(kms:kme)<a name='5585'>
real, intent(in) :: fzp(kms:kme)<a name='5586'>
integer, intent(in) :: ide<a name='5587'>
integer, intent(in) :: ids<a name='5588'>
integer, intent(in) :: ite<a name='5589'>
integer, intent(in) :: its<a name='5590'>
integer, intent(in) :: jde<a name='5591'>
integer, intent(in) :: jds<a name='5592'>
integer, intent(in) :: jte<a name='5593'>
integer, intent(in) :: jts<a name='5594'>
integer, intent(in) :: kde<a name='5595'>
integer, intent(in) :: kte<a name='5596'>
integer, intent(in) :: kts<a name='5597'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='5598'>
real, intent(in) :: rdx<a name='5599'>
real, intent(in) :: rdy<a name='5600'>
real, intent(in) :: rdzu(kms:kme)<a name='5601'>
real, intent(in) :: rom(ims:ime,kms:kme,jms:jme)<a name='5602'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='5603'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='5604'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='5605'>
real, intent(in) :: w_old(ims:ime,kms:kme,jms:jme)<a name='5606'>
<a name='5607'>
<font color=#447700>!==============================================<a name='5608'></font>
<font color=#447700>! declare local variables<a name='5609'></font>
<font color=#447700>!==============================================<a name='5610'></font>
real a_fqx(its:ite+1,kts:kte)<a name='5611'>
real a_fqy(its:ite,kts:kte,2)<a name='5612'>
real a_ub<a name='5613'>
real a_uw<a name='5614'>
real a_vb<a name='5615'>
real a_vel<a name='5616'>
real a_vflux(its:ite,kts:kte)<a name='5617'>
real a_vw<a name='5618'>
logical degrade_xe<a name='5619'>
logical degrade_xs<a name='5620'>
logical degrade_ye<a name='5621'>
logical degrade_ys<a name='5622'>
integer horz_order<a name='5623'>
integer i<a name='5624'>
integer i_end<a name='5625'>
integer i_end_f<a name='5626'>
integer i_start<a name='5627'>
integer i_start_f<a name='5628'>
integer j<a name='5629'>
integer j1<a name='5630'>
integer j2<a name='5631'>
integer j3<a name='5632'>
integer j4<a name='5633'>
integer j_end<a name='5634'>
integer j_end_f<a name='5635'>
integer j_start<a name='5636'>
integer j_start_f<a name='5637'>
integer jp0<a name='5638'>
integer jp1<a name='5639'>
integer jtmp<a name='5640'>
integer k<a name='5641'>
integer ktf<a name='5642'>
real mrdx<a name='5643'>
real mrdy<a name='5644'>
logical specified<a name='5645'>
real ub<a name='5646'>
real uw<a name='5647'>
real vb<a name='5648'>
real vel<a name='5649'>
integer vert_order<a name='5650'>
real vw<a name='5651'>
<a name='5652'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_W' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_5">("a_advect_w")<a name='5653'>
<a name='5654'>
<font color=#447700>!----------------------------------------------<a name='5655'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='5656'></font>
<font color=#447700>!----------------------------------------------<a name='5657'></font>
a_fqx(:,:) = 0.<a name='5658'>
a_fqy(:,:,:) = 0.<a name='5659'>
a_ub = 0.<a name='5660'>
a_uw = 0.<a name='5661'>
a_vb = 0.<a name='5662'>
a_vel = 0.<a name='5663'>
a_vflux(:,:) = 0.<a name='5664'>
a_vw = 0.<a name='5665'>
<a name='5666'>
<font color=#447700>!----------------------------------------------<a name='5667'></font>
<font color=#447700>! ROUTINE BODY<a name='5668'></font>
<font color=#447700>!----------------------------------------------<a name='5669'></font>
specified =  .false. <a name='5670'>
<font color=#447700>! recompute : specified<a name='5671'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='5672'>
  specified =  .true. <a name='5673'>
endif<a name='5674'>
<font color=#447700>! recompute : specified<a name='5675'></font>
ktf = min(kte,kde-1)<a name='5676'>
<font color=#447700>! recompute : ktf<a name='5677'></font>
horz_order = config_flags%h_sca_adv_order<a name='5678'>
<font color=#447700>! recompute : horz_order<a name='5679'></font>
vert_order = config_flags%v_sca_adv_order<a name='5680'>
<font color=#447700>! recompute : vert_order<a name='5681'></font>
horizontal_order_tesu: if (horz_order .eq. 6) then<a name='5682'>
else if (horz_order .eq. 4) then horizontal_order_tesu<a name='5683'>
  ktf = min(kte,kde-1)<a name='5684'>
else if (horz_order .eq. 3) then horizontal_order_tesu<a name='5685'>
  ktf = min(kte,kde-1)<a name='5686'>
endif horizontal_order_tesu<a name='5687'>
<font color=#447700>! recompute : ktf<a name='5688'></font>
i_start = its<a name='5689'>
<font color=#447700>! recompute : i_start<a name='5690'></font>
i_end = min(ite,ide-1)<a name='5691'>
<font color=#447700>! recompute : i_end<a name='5692'></font>
j_start = jts<a name='5693'>
<font color=#447700>! recompute : j_start<a name='5694'></font>
j_end = min(jte,jde-1)<a name='5695'>
<font color=#447700>! recompute : j_end<a name='5696'></font>
a_vert_order_test: if (vert_order .eq. 6) then<a name='5697'>
  do j = j_end, j_start, -1<a name='5698'>
    k = ktf+1<a name='5699'>
<font color=#447700>! recompute : k<a name='5700'></font>
    do i = i_start, i_end<a name='5701'>
      a_vflux(i,k) = a_vflux(i,k)+2*a_tendency(i,k,j)*rdzu(k-1)<a name='5702'>
    end do<a name='5703'>
    do k = kts+1, ktf<a name='5704'>
      do i = i_start, i_end<a name='5705'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzu(k)<a name='5706'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzu(k)<a name='5707'>
      end do<a name='5708'>
    end do<a name='5709'>
    do i = i_start, i_end<a name='5710'>
      a_vel = 0.<a name='5711'>
      k = ktf<a name='5712'>
<font color=#447700>! recompute : k<a name='5713'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5714'>
<font color=#447700>! recompute : vel<a name='5715'></font>
      k = ktf+1<a name='5716'>
<font color=#447700>! recompute : k<a name='5717'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5718'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5719'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5720'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5721'>
      a_vflux(i,k) = 0.<a name='5722'>
<font color=#447700>! recdepend vars : ktf<a name='5723'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5204<a name='5724'></font>
<font color=#447700>! recompute vars : k<a name='5725'></font>
      k = ktf<a name='5726'>
<font color=#447700>! recompute vars : k<a name='5727'></font>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(w(i,k,j)+w(i,k-1,j))-0.083333333*(w(i,k+1,j)+w(i,k-2,j)))<a name='5728'>
      a_w(i,k-2,j) = a_w(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='5729'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='5730'>
      a_w(i,k+1,j) = a_w(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='5731'>
      a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='5732'>
      a_vflux(i,k) = 0.<a name='5733'>
<font color=#447700>! recdepend vars : ktf<a name='5734'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5204<a name='5735'></font>
<font color=#447700>! recompute vars : k<a name='5736'></font>
      k = ktf<a name='5737'>
<font color=#447700>! recompute vars : k<a name='5738'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5739'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5740'>
      a_vel = 0.<a name='5741'>
<font color=#447700>! recdepend vars : kts<a name='5742'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5198<a name='5743'></font>
<font color=#447700>! recompute vars : k<a name='5744'></font>
      k = kts+2<a name='5745'>
<font color=#447700>! recompute vars : k<a name='5746'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='5747'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5199<a name='5748'></font>
<font color=#447700>! recompute vars : vel<a name='5749'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5750'>
<font color=#447700>! recompute vars : vel<a name='5751'></font>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(w(i,k,j)+w(i,k-1,j))-0.083333333*(w(i,k+1,j)+w(i,k-2,j)))<a name='5752'>
      a_w(i,k-2,j) = a_w(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='5753'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='5754'>
      a_w(i,k+1,j) = a_w(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='5755'>
      a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='5756'>
      a_vflux(i,k) = 0.<a name='5757'>
<font color=#447700>! recdepend vars : kts<a name='5758'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5198<a name='5759'></font>
<font color=#447700>! recompute vars : k<a name='5760'></font>
      k = kts+2<a name='5761'>
<font color=#447700>! recompute vars : k<a name='5762'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5763'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5764'>
      a_vel = 0.<a name='5765'>
<font color=#447700>! recdepend vars : kts<a name='5766'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5195<a name='5767'></font>
<font color=#447700>! recompute vars : k<a name='5768'></font>
      k = kts+1<a name='5769'>
<font color=#447700>! recompute vars : k<a name='5770'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5771'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5772'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5773'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5774'>
      a_vflux(i,k) = 0.<a name='5775'>
    end do<a name='5776'>
    do k = kts+3, ktf-1<a name='5777'>
      a_vel = 0.<a name='5778'>
      do i = i_start, i_end<a name='5779'>
        a_vel = 0.<a name='5780'>
        vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5781'>
<font color=#447700>! recompute : vel<a name='5782'></font>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(w(i,k,j)+w(i,k-1,j))-0.13333333*(w(i,k+1,j)+w(i,k-2,j))+0.016666667*(w(i,k+2,j)+&amp;<a name='5783'>
&amp;w(i,k-3,j)))<a name='5784'>
        a_w(i,k-3,j) = a_w(i,k-3,j)+0.016666667*a_vflux(i,k)*vel<a name='5785'>
        a_w(i,k-2,j) = a_w(i,k-2,j)-0.13333333*a_vflux(i,k)*vel<a name='5786'>
        a_w(i,k-1,j) = a_w(i,k-1,j)+0.61666667*a_vflux(i,k)*vel<a name='5787'>
        a_w(i,k+2,j) = a_w(i,k+2,j)+0.016666667*a_vflux(i,k)*vel<a name='5788'>
        a_w(i,k+1,j) = a_w(i,k+1,j)-0.13333333*a_vflux(i,k)*vel<a name='5789'>
        a_w(i,k,j) = a_w(i,k,j)+0.61666667*a_vflux(i,k)*vel<a name='5790'>
        a_vflux(i,k) = 0.<a name='5791'>
        a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5792'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5793'>
        a_vel = 0.<a name='5794'>
      end do<a name='5795'>
    end do<a name='5796'>
  end do<a name='5797'>
else if (vert_order .eq. 5) then a_vert_order_test<a name='5798'>
  do j = j_end, j_start, -1<a name='5799'>
    k = ktf+1<a name='5800'>
<font color=#447700>! recompute : k<a name='5801'></font>
    do i = i_start, i_end<a name='5802'>
      a_vflux(i,k) = a_vflux(i,k)+2*a_tendency(i,k,j)*rdzu(k-1)<a name='5803'>
    end do<a name='5804'>
    do k = kts+1, ktf<a name='5805'>
      do i = i_start, i_end<a name='5806'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzu(k)<a name='5807'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzu(k)<a name='5808'>
      end do<a name='5809'>
    end do<a name='5810'>
    do i = i_start, i_end<a name='5811'>
      a_vel = 0.<a name='5812'>
      k = ktf<a name='5813'>
<font color=#447700>! recompute : k<a name='5814'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5815'>
<font color=#447700>! recompute : vel<a name='5816'></font>
      k = ktf+1<a name='5817'>
<font color=#447700>! recompute : k<a name='5818'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5819'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5820'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5821'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5822'>
      a_vflux(i,k) = 0.<a name='5823'>
<font color=#447700>! recdepend vars : ktf<a name='5824'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5252<a name='5825'></font>
<font color=#447700>! recompute vars : k<a name='5826'></font>
      k = ktf<a name='5827'>
<font color=#447700>! recompute vars : k<a name='5828'></font>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(w(i,k,j)+w(i,k-1,j))-0.083333333*(w(i,k+1,j)+w(i,k-2,j))+0.083333333*(w(i,k+1,j)-w(i,&amp;<a name='5829'>
&amp;k-2,j)-3.*(w(i,k,j)-w(i,k-1,j)))*sign(1.,-vel))<a name='5830'>
      a_w(i,k-2,j) = a_w(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='5831'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='5832'>
      a_w(i,k+1,j) = a_w(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='5833'>
      a_w(i,k,j) = a_w(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='5834'>
      a_vflux(i,k) = 0.<a name='5835'>
<font color=#447700>! recdepend vars : ktf<a name='5836'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5252<a name='5837'></font>
<font color=#447700>! recompute vars : k<a name='5838'></font>
      k = ktf<a name='5839'>
<font color=#447700>! recompute vars : k<a name='5840'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5841'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5842'>
      a_vel = 0.<a name='5843'>
<font color=#447700>! recdepend vars : kts<a name='5844'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5247<a name='5845'></font>
<font color=#447700>! recompute vars : k<a name='5846'></font>
      k = kts+2<a name='5847'>
<font color=#447700>! recompute vars : k<a name='5848'></font>
<font color=#447700>! recdepend vars : i,j,k,rom<a name='5849'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5248<a name='5850'></font>
<font color=#447700>! recompute vars : vel<a name='5851'></font>
      vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5852'>
<font color=#447700>! recompute vars : vel<a name='5853'></font>
      a_vel = a_vel+a_vflux(i,k)*(0.58333333*(w(i,k,j)+w(i,k-1,j))-0.083333333*(w(i,k+1,j)+w(i,k-2,j))+0.083333333*(w(i,k+1,j)-w(i,&amp;<a name='5854'>
&amp;k-2,j)-3.*(w(i,k,j)-w(i,k-1,j)))*sign(1.,-vel))<a name='5855'>
      a_w(i,k-2,j) = a_w(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='5856'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='5857'>
      a_w(i,k+1,j) = a_w(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='5858'>
      a_w(i,k,j) = a_w(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='5859'>
      a_vflux(i,k) = 0.<a name='5860'>
<font color=#447700>! recdepend vars : kts<a name='5861'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5247<a name='5862'></font>
<font color=#447700>! recompute vars : k<a name='5863'></font>
      k = kts+2<a name='5864'>
<font color=#447700>! recompute vars : k<a name='5865'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5866'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5867'>
      a_vel = 0.<a name='5868'>
<font color=#447700>! recdepend vars : kts<a name='5869'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5244<a name='5870'></font>
<font color=#447700>! recompute vars : k<a name='5871'></font>
      k = kts+1<a name='5872'>
<font color=#447700>! recompute vars : k<a name='5873'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5874'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5875'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5876'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5877'>
      a_vflux(i,k) = 0.<a name='5878'>
    end do<a name='5879'>
    do k = kts+3, ktf-1<a name='5880'>
      a_vel = 0.<a name='5881'>
      do i = i_start, i_end<a name='5882'>
        a_vel = 0.<a name='5883'>
        vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5884'>
<font color=#447700>! recompute : vel<a name='5885'></font>
        a_vel = a_vel+a_vflux(i,k)*(0.61666667*(w(i,k,j)+w(i,k-1,j))-0.13333333*(w(i,k+1,j)+w(i,k-2,j))+0.016666667*(w(i,k+2,j)+&amp;<a name='5886'>
&amp;w(i,k-3,j))-0.016666667*(w(i,k+2,j)-w(i,k-3,j)-5.*(w(i,k+1,j)-w(i,k-2,j))+10.*(w(i,k,j)-w(i,k-1,j)))*sign(1.,-vel))<a name='5887'>
        a_w(i,k-3,j) = a_w(i,k-3,j)+a_vflux(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,-vel))<a name='5888'>
        a_w(i,k-2,j) = a_w(i,k-2,j)+a_vflux(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,-vel))<a name='5889'>
        a_w(i,k-1,j) = a_w(i,k-1,j)+a_vflux(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,-vel))<a name='5890'>
        a_w(i,k+2,j) = a_w(i,k+2,j)+a_vflux(i,k)*vel*(0.016666667-0.016666667*sign(1.,-vel))<a name='5891'>
        a_w(i,k+1,j) = a_w(i,k+1,j)+a_vflux(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,-vel))<a name='5892'>
        a_w(i,k,j) = a_w(i,k,j)+a_vflux(i,k)*vel*(0.61666667-0.16666667*sign(1.,-vel))<a name='5893'>
        a_vflux(i,k) = 0.<a name='5894'>
        a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5895'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5896'>
        a_vel = 0.<a name='5897'>
      end do<a name='5898'>
    end do<a name='5899'>
  end do<a name='5900'>
else if (vert_order .eq. 4) then a_vert_order_test<a name='5901'>
  do j = j_end, j_start, -1<a name='5902'>
    k = ktf+1<a name='5903'>
<font color=#447700>! recompute : k<a name='5904'></font>
    do i = i_start, i_end<a name='5905'>
      a_vflux(i,k) = a_vflux(i,k)+2*a_tendency(i,k,j)*rdzu(k-1)<a name='5906'>
    end do<a name='5907'>
    do k = kts+1, ktf<a name='5908'>
      do i = i_start, i_end<a name='5909'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzu(k)<a name='5910'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzu(k)<a name='5911'>
      end do<a name='5912'>
    end do<a name='5913'>
    do i = i_start, i_end<a name='5914'>
      k = ktf+1<a name='5915'>
<font color=#447700>! recompute : k<a name='5916'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5917'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5918'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5919'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5920'>
      a_vflux(i,k) = 0.<a name='5921'>
<font color=#447700>! recdepend vars : kts<a name='5922'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5292<a name='5923'></font>
<font color=#447700>! recompute vars : k<a name='5924'></font>
      k = kts+1<a name='5925'>
<font color=#447700>! recompute vars : k<a name='5926'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5927'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5928'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5929'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5930'>
      a_vflux(i,k) = 0.<a name='5931'>
    end do<a name='5932'>
    do k = kts+2, ktf<a name='5933'>
      a_vel = 0.<a name='5934'>
      do i = i_start, i_end<a name='5935'>
        a_vel = 0.<a name='5936'>
        vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5937'>
<font color=#447700>! recompute : vel<a name='5938'></font>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(w(i,k,j)+w(i,k-1,j))-0.083333333*(w(i,k+1,j)+w(i,k-2,j)))<a name='5939'>
        a_w(i,k-2,j) = a_w(i,k-2,j)-0.083333333*a_vflux(i,k)*vel<a name='5940'>
        a_w(i,k-1,j) = a_w(i,k-1,j)+0.58333333*a_vflux(i,k)*vel<a name='5941'>
        a_w(i,k+1,j) = a_w(i,k+1,j)-0.083333333*a_vflux(i,k)*vel<a name='5942'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_vflux(i,k)*vel<a name='5943'>
        a_vflux(i,k) = 0.<a name='5944'>
        a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5945'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5946'>
        a_vel = 0.<a name='5947'>
      end do<a name='5948'>
    end do<a name='5949'>
  end do<a name='5950'>
else if (vert_order .eq. 3) then a_vert_order_test<a name='5951'>
  do j = j_end, j_start, -1<a name='5952'>
    k = ktf+1<a name='5953'>
<font color=#447700>! recompute : k<a name='5954'></font>
    do i = i_start, i_end<a name='5955'>
      a_vflux(i,k) = a_vflux(i,k)+2*a_tendency(i,k,j)*rdzu(k-1)<a name='5956'>
    end do<a name='5957'>
    do k = kts+1, ktf<a name='5958'>
      do i = i_start, i_end<a name='5959'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzu(k)<a name='5960'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzu(k)<a name='5961'>
      end do<a name='5962'>
    end do<a name='5963'>
    do i = i_start, i_end<a name='5964'>
      k = ktf+1<a name='5965'>
<font color=#447700>! recompute : k<a name='5966'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5967'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5968'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5969'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5970'>
      a_vflux(i,k) = 0.<a name='5971'>
<font color=#447700>! recdepend vars : kts<a name='5972'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5328<a name='5973'></font>
<font color=#447700>! recompute vars : k<a name='5974'></font>
      k = kts+1<a name='5975'>
<font color=#447700>! recompute vars : k<a name='5976'></font>
      a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5977'>
      a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='5978'>
      a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5979'>
      a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='5980'>
      a_vflux(i,k) = 0.<a name='5981'>
    end do<a name='5982'>
    do k = kts+2, ktf<a name='5983'>
      a_vel = 0.<a name='5984'>
      do i = i_start, i_end<a name='5985'>
        a_vel = 0.<a name='5986'>
        vel = 0.5*(rom(i,k,j)+rom(i,k-1,j))<a name='5987'>
<font color=#447700>! recompute : vel<a name='5988'></font>
        a_vel = a_vel+a_vflux(i,k)*(0.58333333*(w(i,k,j)+w(i,k-1,j))-0.083333333*(w(i,k+1,j)+w(i,k-2,j))+0.083333333*(w(i,k+1,j)-&amp;<a name='5989'>
&amp;w(i,k-2,j)-3.*(w(i,k,j)-w(i,k-1,j)))*sign(1.,-vel))<a name='5990'>
        a_w(i,k-2,j) = a_w(i,k-2,j)+a_vflux(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,-vel))<a name='5991'>
        a_w(i,k-1,j) = a_w(i,k-1,j)+a_vflux(i,k)*vel*(0.58333333+0.25*sign(1.,-vel))<a name='5992'>
        a_w(i,k+1,j) = a_w(i,k+1,j)+a_vflux(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,-vel))<a name='5993'>
        a_w(i,k,j) = a_w(i,k,j)+a_vflux(i,k)*vel*(0.58333333+(-0.25)*sign(1.,-vel))<a name='5994'>
        a_vflux(i,k) = 0.<a name='5995'>
        a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.5*a_vel<a name='5996'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.5*a_vel<a name='5997'>
        a_vel = 0.<a name='5998'>
      end do<a name='5999'>
    end do<a name='6000'>
  end do<a name='6001'>
else if (vert_order .eq. 2) then a_vert_order_test<a name='6002'>
  do j = j_end, j_start, -1<a name='6003'>
    k = ktf+1<a name='6004'>
<font color=#447700>! recompute : k<a name='6005'></font>
    do i = i_start, i_end<a name='6006'>
      a_vflux(i,k) = a_vflux(i,k)+2*a_tendency(i,k,j)*rdzu(k-1)<a name='6007'>
    end do<a name='6008'>
    do k = kts+1, ktf<a name='6009'>
      do i = i_start, i_end<a name='6010'>
        a_vflux(i,k+1) = a_vflux(i,k+1)-a_tendency(i,k,j)*rdzu(k)<a name='6011'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*rdzu(k)<a name='6012'>
      end do<a name='6013'>
    end do<a name='6014'>
    do k = kts+1, ktf+1<a name='6015'>
      do i = i_start, i_end<a name='6016'>
        a_rom(i,k-1,j) = a_rom(i,k-1,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='6017'>
        a_rom(i,k,j) = a_rom(i,k,j)+0.25*a_vflux(i,k)*(w(i,k,j)+w(i,k-1,j))<a name='6018'>
        a_w(i,k-1,j) = a_w(i,k-1,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='6019'>
        a_w(i,k,j) = a_w(i,k,j)+0.25*a_vflux(i,k)*(rom(i,k,j)+rom(i,k-1,j))<a name='6020'>
        a_vflux(i,k) = 0.<a name='6021'>
      end do<a name='6022'>
    end do<a name='6023'>
  end do<a name='6024'>
endif a_vert_order_test<a name='6025'>
<font color=#447700>! recdepend vars : its<a name='6026'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5015<a name='6027'></font>
<font color=#447700>! recompute vars : i_start<a name='6028'></font>
i_start = its<a name='6029'>
<font color=#447700>! recompute vars : i_start<a name='6030'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='6031'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5016<a name='6032'></font>
<font color=#447700>! recompute vars : i_end<a name='6033'></font>
i_end = min(ite,ide-1)<a name='6034'>
<font color=#447700>! recompute vars : i_end<a name='6035'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jde,jte<a name='6036'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5018<a name='6037'></font>
<font color=#447700>! recompute vars : j_end<a name='6038'></font>
j_end = min(jte,jde-1)<a name='6039'>
<font color=#447700>! recompute vars : j_end<a name='6040'></font>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='6041'>
  k = ktf+1<a name='6042'>
<font color=#447700>! recompute : k<a name='6043'></font>
  do i = i_start, i_end<a name='6044'>
    a_vb = 0.<a name='6045'>
    a_vw = 0.<a name='6046'>
    vw = 0.5*((2.-fzm(k-1))*(rv(i,k-1,jte-1)+rv(i,k-1,jte))-fzp(k-1)*(rv(i,k-2,jte-1)+rv(i,k-2,jte)))<a name='6047'>
<font color=#447700>! recompute : vw<a name='6048'></font>
    vb = max(vw,0.)<a name='6049'>
<font color=#447700>! recompute : vb<a name='6050'></font>
    a_rv(i,k-2,jte-1) = a_rv(i,k-2,jte-1)-a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*fzp(k-1)<a name='6051'>
    a_rv(i,k-2,jte) = a_rv(i,k-2,jte)+a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*fzp(k-1)<a name='6052'>
    a_rv(i,k-1,jte-1) = a_rv(i,k-1,jte-1)+a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*(2.-fzm(k-1))<a name='6053'>
    a_rv(i,k-1,jte) = a_rv(i,k-1,jte)-a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*(2-fzm(k-1))<a name='6054'>
    a_vb = a_vb-a_tendency(i,k,j_end)*rdy*(w_old(i,k,j_end)-w_old(i,k,j_end-1))<a name='6055'>
    a_w(i,k,j_end) = a_w(i,k,j_end)-a_tendency(i,k,j_end)*rdy*((2.-fzm(k-1))*(rv(i,k-1,jte)-rv(i,k-1,jte-1))-fzp(k-1)*(rv(i,k-2,&amp;<a name='6056'>
&amp;jte)-rv(i,k-2,jte-1)))<a name='6057'>
    a_w_old(i,k,j_end-1) = a_w_old(i,k,j_end-1)+a_tendency(i,k,j_end)*rdy*vb<a name='6058'>
    a_w_old(i,k,j_end) = a_w_old(i,k,j_end)-a_tendency(i,k,j_end)*rdy*vb<a name='6059'>
    a_vw = a_vw+a_vb*(0.5+sign(0.5,vw-0.))<a name='6060'>
    a_vb = 0.<a name='6061'>
    a_rv(i,k-2,jte-1) = a_rv(i,k-2,jte-1)-0.5*a_vw*fzp(k-1)<a name='6062'>
    a_rv(i,k-2,jte) = a_rv(i,k-2,jte)-0.5*a_vw*fzp(k-1)<a name='6063'>
    a_rv(i,k-1,jte-1) = a_rv(i,k-1,jte-1)+0.5*a_vw*(2-fzm(k-1))<a name='6064'>
    a_rv(i,k-1,jte) = a_rv(i,k-1,jte)+0.5*a_vw*(2-fzm(k-1))<a name='6065'>
    a_vw = 0.<a name='6066'>
  end do<a name='6067'>
  do i = i_start, i_end<a name='6068'>
    a_vb = 0.<a name='6069'>
    a_vw = 0.<a name='6070'>
    do k = kts+1, ktf<a name='6071'>
      a_vb = 0.<a name='6072'>
      a_vw = 0.<a name='6073'>
      vw = 0.5*(fzm(k)*(rv(i,k,jte-1)+rv(i,k,jte))+fzp(k)*(rv(i,k-1,jte-1)+rv(i,k-1,jte)))<a name='6074'>
<font color=#447700>! recompute : vw<a name='6075'></font>
      vb = max(vw,0.)<a name='6076'>
<font color=#447700>! recompute : vb<a name='6077'></font>
      a_rv(i,k-1,jte-1) = a_rv(i,k-1,jte-1)+a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*fzp(k)<a name='6078'>
      a_rv(i,k-1,jte) = a_rv(i,k-1,jte)-a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*fzp(k)<a name='6079'>
      a_rv(i,k,jte-1) = a_rv(i,k,jte-1)+a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*fzm(k)<a name='6080'>
      a_rv(i,k,jte) = a_rv(i,k,jte)-a_tendency(i,k,j_end)*rdy*w(i,k,j_end)*fzm(k)<a name='6081'>
      a_vb = a_vb-a_tendency(i,k,j_end)*rdy*(w_old(i,k,j_end)-w_old(i,k,j_end-1))<a name='6082'>
      a_w(i,k,j_end) = a_w(i,k,j_end)-a_tendency(i,k,j_end)*rdy*(fzm(k)*(rv(i,k,jte)-rv(i,k,jte-1))+fzp(k)*(rv(i,k-1,jte)-rv(i,k-1,&amp;<a name='6083'>
&amp;jte-1)))<a name='6084'>
      a_w_old(i,k,j_end-1) = a_w_old(i,k,j_end-1)+a_tendency(i,k,j_end)*rdy*vb<a name='6085'>
      a_w_old(i,k,j_end) = a_w_old(i,k,j_end)-a_tendency(i,k,j_end)*rdy*vb<a name='6086'>
      a_vw = a_vw+a_vb*(0.5+sign(0.5,vw-0.))<a name='6087'>
      a_vb = 0.<a name='6088'>
      a_rv(i,k-1,jte-1) = a_rv(i,k-1,jte-1)+0.5*a_vw*fzp(k)<a name='6089'>
      a_rv(i,k-1,jte) = a_rv(i,k-1,jte)+0.5*a_vw*fzp(k)<a name='6090'>
      a_rv(i,k,jte-1) = a_rv(i,k,jte-1)+0.5*a_vw*fzm(k)<a name='6091'>
      a_rv(i,k,jte) = a_rv(i,k,jte)+0.5*a_vw*fzm(k)<a name='6092'>
      a_vw = 0.<a name='6093'>
    end do<a name='6094'>
  end do<a name='6095'>
endif<a name='6096'>
<font color=#447700>! recdepend vars : its<a name='6097'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5015<a name='6098'></font>
<font color=#447700>! recompute vars : i_start<a name='6099'></font>
i_start = its<a name='6100'>
<font color=#447700>! recompute vars : i_start<a name='6101'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='6102'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5016<a name='6103'></font>
<font color=#447700>! recompute vars : i_end<a name='6104'></font>
i_end = min(ite,ide-1)<a name='6105'>
<font color=#447700>! recompute vars : i_end<a name='6106'></font>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='6107'>
  k = ktf+1<a name='6108'>
<font color=#447700>! recompute : k<a name='6109'></font>
  do i = i_start, i_end<a name='6110'>
    a_vb = 0.<a name='6111'>
    a_vw = 0.<a name='6112'>
    vw = 0.5*((2.-fzm(k-1))*(rv(i,k-1,jts)+rv(i,k-1,jts+1))-fzp(k-1)*(rv(i,k-2,jts)+rv(i,k-2,jts+1)))<a name='6113'>
<font color=#447700>! recompute : vw<a name='6114'></font>
    vb = min(vw,0.)<a name='6115'>
<font color=#447700>! recompute : vb<a name='6116'></font>
    a_rv(i,k-2,jts+1) = a_rv(i,k-2,jts+1)+a_tendency(i,k,jts)*rdy*w(i,k,jts)*fzp(k-1)<a name='6117'>
    a_rv(i,k-2,jts) = a_rv(i,k-2,jts)-a_tendency(i,k,jts)*rdy*w(i,k,jts)*fzp(k-1)<a name='6118'>
    a_rv(i,k-1,jts+1) = a_rv(i,k-1,jts+1)-a_tendency(i,k,jts)*rdy*w(i,k,jts)*(2-fzm(k-1))<a name='6119'>
    a_rv(i,k-1,jts) = a_rv(i,k-1,jts)+a_tendency(i,k,jts)*rdy*w(i,k,jts)*(2.-fzm(k-1))<a name='6120'>
    a_vb = a_vb-a_tendency(i,k,jts)*rdy*(w_old(i,k,jts+1)-w_old(i,k,jts))<a name='6121'>
    a_w(i,k,jts) = a_w(i,k,jts)-a_tendency(i,k,jts)*rdy*((2.-fzm(k-1))*(rv(i,k-1,jts+1)-rv(i,k-1,jts))-fzp(k-1)*(rv(i,k-2,jts+1)-&amp;<a name='6122'>
&amp;rv(i,k-2,jts)))<a name='6123'>
    a_w_old(i,k,jts+1) = a_w_old(i,k,jts+1)-a_tendency(i,k,jts)*rdy*vb<a name='6124'>
    a_w_old(i,k,jts) = a_w_old(i,k,jts)+a_tendency(i,k,jts)*rdy*vb<a name='6125'>
    a_vw = a_vw+a_vb*(0.5+sign(0.5,0.-vw))<a name='6126'>
    a_vb = 0.<a name='6127'>
    a_rv(i,k-2,jts+1) = a_rv(i,k-2,jts+1)-0.5*a_vw*fzp(k-1)<a name='6128'>
    a_rv(i,k-2,jts) = a_rv(i,k-2,jts)-0.5*a_vw*fzp(k-1)<a name='6129'>
    a_rv(i,k-1,jts+1) = a_rv(i,k-1,jts+1)+0.5*a_vw*(2-fzm(k-1))<a name='6130'>
    a_rv(i,k-1,jts) = a_rv(i,k-1,jts)+0.5*a_vw*(2-fzm(k-1))<a name='6131'>
    a_vw = 0.<a name='6132'>
  end do<a name='6133'>
  do i = i_start, i_end<a name='6134'>
    a_vb = 0.<a name='6135'>
    a_vw = 0.<a name='6136'>
    do k = kts+1, ktf<a name='6137'>
      a_vb = 0.<a name='6138'>
      a_vw = 0.<a name='6139'>
      vw = 0.5*(fzm(k)*(rv(i,k,jts)+rv(i,k,jts+1))+fzp(k)*(rv(i,k-1,jts)+rv(i,k-1,jts+1)))<a name='6140'>
<font color=#447700>! recompute : vw<a name='6141'></font>
      vb = min(vw,0.)<a name='6142'>
<font color=#447700>! recompute : vb<a name='6143'></font>
      a_rv(i,k-1,jts+1) = a_rv(i,k-1,jts+1)-a_tendency(i,k,jts)*rdy*w(i,k,jts)*fzp(k)<a name='6144'>
      a_rv(i,k-1,jts) = a_rv(i,k-1,jts)+a_tendency(i,k,jts)*rdy*w(i,k,jts)*fzp(k)<a name='6145'>
      a_rv(i,k,jts+1) = a_rv(i,k,jts+1)-a_tendency(i,k,jts)*rdy*w(i,k,jts)*fzm(k)<a name='6146'>
      a_rv(i,k,jts) = a_rv(i,k,jts)+a_tendency(i,k,jts)*rdy*w(i,k,jts)*fzm(k)<a name='6147'>
      a_vb = a_vb-a_tendency(i,k,jts)*rdy*(w_old(i,k,jts+1)-w_old(i,k,jts))<a name='6148'>
      a_w(i,k,jts) = a_w(i,k,jts)-a_tendency(i,k,jts)*rdy*(fzm(k)*(rv(i,k,jts+1)-rv(i,k,jts))+fzp(k)*(rv(i,k-1,jts+1)-rv(i,k-1,jts)&amp;<a name='6149'>
&amp;))<a name='6150'>
      a_w_old(i,k,jts+1) = a_w_old(i,k,jts+1)-a_tendency(i,k,jts)*rdy*vb<a name='6151'>
      a_w_old(i,k,jts) = a_w_old(i,k,jts)+a_tendency(i,k,jts)*rdy*vb<a name='6152'>
      a_vw = a_vw+a_vb*(0.5+sign(0.5,0.-vw))<a name='6153'>
      a_vb = 0.<a name='6154'>
      a_rv(i,k-1,jts+1) = a_rv(i,k-1,jts+1)+0.5*a_vw*fzp(k)<a name='6155'>
      a_rv(i,k-1,jts) = a_rv(i,k-1,jts)+0.5*a_vw*fzp(k)<a name='6156'>
      a_rv(i,k,jts+1) = a_rv(i,k,jts+1)+0.5*a_vw*fzm(k)<a name='6157'>
      a_rv(i,k,jts) = a_rv(i,k,jts)+0.5*a_vw*fzm(k)<a name='6158'>
      a_vw = 0.<a name='6159'>
    end do<a name='6160'>
  end do<a name='6161'>
endif<a name='6162'>
<font color=#447700>! recdepend vars : ide,ite<a name='6163'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5016<a name='6164'></font>
<font color=#447700>! recompute vars : i_end<a name='6165'></font>
i_end = min(ite,ide-1)<a name='6166'>
<font color=#447700>! recompute vars : i_end<a name='6167'></font>
<font color=#447700>! recdepend vars : i_end,jts<a name='6168'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5017<a name='6169'></font>
<font color=#447700>! recompute vars : j_start<a name='6170'></font>
j_start = jts<a name='6171'>
<font color=#447700>! recompute vars : j_start<a name='6172'></font>
<font color=#447700>! recdepend vars : i_end,j_start,jde,jte<a name='6173'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5018<a name='6174'></font>
<font color=#447700>! recompute vars : j_end<a name='6175'></font>
j_end = min(jte,jde-1)<a name='6176'>
<font color=#447700>! recompute vars : j_end<a name='6177'></font>
if (config_flags%open_xe .and. ite .eq. ide) then<a name='6178'>
  k = ktf+1<a name='6179'>
<font color=#447700>! recompute : k<a name='6180'></font>
  do j = j_start, j_end<a name='6181'>
    a_ub = 0.<a name='6182'>
    a_uw = 0.<a name='6183'>
    uw = 0.5*((2.-fzm(k-1))*(ru(ite-1,k-1,j)+ru(ite,k-1,j))-fzp(k-1)*(ru(ite-1,k-2,j)+ru(ite,k-2,j)))<a name='6184'>
<font color=#447700>! recompute : uw<a name='6185'></font>
    ub = max(uw,0.)<a name='6186'>
<font color=#447700>! recompute : ub<a name='6187'></font>
    a_ru(ite-1,k-2,j) = a_ru(ite-1,k-2,j)-a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*fzp(k-1)<a name='6188'>
    a_ru(ite,k-2,j) = a_ru(ite,k-2,j)+a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*fzp(k-1)<a name='6189'>
    a_ru(ite-1,k-1,j) = a_ru(ite-1,k-1,j)+a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*(2.-fzm(k-1))<a name='6190'>
    a_ru(ite,k-1,j) = a_ru(ite,k-1,j)-a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*(2-fzm(k-1))<a name='6191'>
    a_ub = a_ub-a_tendency(i_end,k,j)*rdx*(w_old(i_end,k,j)-w_old(i_end-1,k,j))<a name='6192'>
    a_w(i_end,k,j) = a_w(i_end,k,j)-a_tendency(i_end,k,j)*rdx*((2.-fzm(k-1))*(ru(ite,k-1,j)-ru(ite-1,k-1,j))-fzp(k-1)*(ru(ite,k-2,&amp;<a name='6193'>
&amp;j)-ru(ite-1,k-2,j)))<a name='6194'>
    a_w_old(i_end-1,k,j) = a_w_old(i_end-1,k,j)+a_tendency(i_end,k,j)*rdx*ub<a name='6195'>
    a_w_old(i_end,k,j) = a_w_old(i_end,k,j)-a_tendency(i_end,k,j)*rdx*ub<a name='6196'>
    a_uw = a_uw+a_ub*(0.5+sign(0.5,uw-0.))<a name='6197'>
    a_ub = 0.<a name='6198'>
    a_ru(ite-1,k-2,j) = a_ru(ite-1,k-2,j)-0.5*a_uw*fzp(k-1)<a name='6199'>
    a_ru(ite,k-2,j) = a_ru(ite,k-2,j)-0.5*a_uw*fzp(k-1)<a name='6200'>
    a_ru(ite-1,k-1,j) = a_ru(ite-1,k-1,j)+0.5*a_uw*(2-fzm(k-1))<a name='6201'>
    a_ru(ite,k-1,j) = a_ru(ite,k-1,j)+0.5*a_uw*(2-fzm(k-1))<a name='6202'>
    a_uw = 0.<a name='6203'>
  end do<a name='6204'>
  do j = j_start, j_end<a name='6205'>
    a_ub = 0.<a name='6206'>
    a_uw = 0.<a name='6207'>
    do k = kts+1, ktf<a name='6208'>
      a_ub = 0.<a name='6209'>
      a_uw = 0.<a name='6210'>
      uw = 0.5*(fzm(k)*(ru(ite-1,k,j)+ru(ite,k,j))+fzp(k)*(ru(ite-1,k-1,j)+ru(ite,k-1,j)))<a name='6211'>
<font color=#447700>! recompute : uw<a name='6212'></font>
      ub = max(uw,0.)<a name='6213'>
<font color=#447700>! recompute : ub<a name='6214'></font>
      a_ru(ite-1,k-1,j) = a_ru(ite-1,k-1,j)+a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*fzp(k)<a name='6215'>
      a_ru(ite,k-1,j) = a_ru(ite,k-1,j)-a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*fzp(k)<a name='6216'>
      a_ru(ite-1,k,j) = a_ru(ite-1,k,j)+a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*fzm(k)<a name='6217'>
      a_ru(ite,k,j) = a_ru(ite,k,j)-a_tendency(i_end,k,j)*rdx*w(i_end,k,j)*fzm(k)<a name='6218'>
      a_ub = a_ub-a_tendency(i_end,k,j)*rdx*(w_old(i_end,k,j)-w_old(i_end-1,k,j))<a name='6219'>
      a_w(i_end,k,j) = a_w(i_end,k,j)-a_tendency(i_end,k,j)*rdx*(fzm(k)*(ru(ite,k,j)-ru(ite-1,k,j))+fzp(k)*(ru(ite,k-1,j)-ru(ite-1,&amp;<a name='6220'>
&amp;k-1,j)))<a name='6221'>
      a_w_old(i_end-1,k,j) = a_w_old(i_end-1,k,j)+a_tendency(i_end,k,j)*rdx*ub<a name='6222'>
      a_w_old(i_end,k,j) = a_w_old(i_end,k,j)-a_tendency(i_end,k,j)*rdx*ub<a name='6223'>
      a_uw = a_uw+a_ub*(0.5+sign(0.5,uw-0.))<a name='6224'>
      a_ub = 0.<a name='6225'>
      a_ru(ite-1,k-1,j) = a_ru(ite-1,k-1,j)+0.5*a_uw*fzp(k)<a name='6226'>
      a_ru(ite,k-1,j) = a_ru(ite,k-1,j)+0.5*a_uw*fzp(k)<a name='6227'>
      a_ru(ite-1,k,j) = a_ru(ite-1,k,j)+0.5*a_uw*fzm(k)<a name='6228'>
      a_ru(ite,k,j) = a_ru(ite,k,j)+0.5*a_uw*fzm(k)<a name='6229'>
      a_uw = 0.<a name='6230'>
    end do<a name='6231'>
  end do<a name='6232'>
endif<a name='6233'>
<font color=#447700>! recdepend vars : jts<a name='6234'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5017<a name='6235'></font>
<font color=#447700>! recompute vars : j_start<a name='6236'></font>
j_start = jts<a name='6237'>
<font color=#447700>! recompute vars : j_start<a name='6238'></font>
<font color=#447700>! recdepend vars : j_start,jde,jte<a name='6239'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:5018<a name='6240'></font>
<font color=#447700>! recompute vars : j_end<a name='6241'></font>
j_end = min(jte,jde-1)<a name='6242'>
<font color=#447700>! recompute vars : j_end<a name='6243'></font>
if (config_flags%open_xs .and. its .eq. ids) then<a name='6244'>
  k = ktf+1<a name='6245'>
<font color=#447700>! recompute : k<a name='6246'></font>
  do j = j_start, j_end<a name='6247'>
    a_ub = 0.<a name='6248'>
    a_uw = 0.<a name='6249'>
    uw = 0.5*((2.-fzm(k-1))*(ru(its,k-1,j)+ru(its+1,k-1,j))-fzp(k-1)*(ru(its,k-2,j)+ru(its+1,k-2,j)))<a name='6250'>
<font color=#447700>! recompute : uw<a name='6251'></font>
    ub = min(uw,0.)<a name='6252'>
<font color=#447700>! recompute : ub<a name='6253'></font>
    a_ru(its+1,k-2,j) = a_ru(its+1,k-2,j)+a_tendency(its,k,j)*rdx*w(its,k,j)*fzp(k-1)<a name='6254'>
    a_ru(its,k-2,j) = a_ru(its,k-2,j)-a_tendency(its,k,j)*rdx*w(its,k,j)*fzp(k-1)<a name='6255'>
    a_ru(its+1,k-1,j) = a_ru(its+1,k-1,j)-a_tendency(its,k,j)*rdx*w(its,k,j)*(2-fzm(k-1))<a name='6256'>
    a_ru(its,k-1,j) = a_ru(its,k-1,j)+a_tendency(its,k,j)*rdx*w(its,k,j)*(2.-fzm(k-1))<a name='6257'>
    a_ub = a_ub-a_tendency(its,k,j)*rdx*(w_old(its+1,k,j)-w_old(its,k,j))<a name='6258'>
    a_w(its,k,j) = a_w(its,k,j)-a_tendency(its,k,j)*rdx*((2.-fzm(k-1))*(ru(its+1,k-1,j)-ru(its,k-1,j))-fzp(k-1)*(ru(its+1,k-2,j)-&amp;<a name='6259'>
&amp;ru(its,k-2,j)))<a name='6260'>
    a_w_old(its+1,k,j) = a_w_old(its+1,k,j)-a_tendency(its,k,j)*rdx*ub<a name='6261'>
    a_w_old(its,k,j) = a_w_old(its,k,j)+a_tendency(its,k,j)*rdx*ub<a name='6262'>
    a_uw = a_uw+a_ub*(0.5+sign(0.5,0.-uw))<a name='6263'>
    a_ub = 0.<a name='6264'>
    a_ru(its+1,k-2,j) = a_ru(its+1,k-2,j)-0.5*a_uw*fzp(k-1)<a name='6265'>
    a_ru(its,k-2,j) = a_ru(its,k-2,j)-0.5*a_uw*fzp(k-1)<a name='6266'>
    a_ru(its+1,k-1,j) = a_ru(its+1,k-1,j)+0.5*a_uw*(2-fzm(k-1))<a name='6267'>
    a_ru(its,k-1,j) = a_ru(its,k-1,j)+0.5*a_uw*(2-fzm(k-1))<a name='6268'>
    a_uw = 0.<a name='6269'>
  end do<a name='6270'>
  do j = j_start, j_end<a name='6271'>
    a_ub = 0.<a name='6272'>
    a_uw = 0.<a name='6273'>
    do k = kts+1, ktf<a name='6274'>
      a_ub = 0.<a name='6275'>
      a_uw = 0.<a name='6276'>
      uw = 0.5*(fzm(k)*(ru(its,k,j)+ru(its+1,k,j))+fzp(k)*(ru(its,k-1,j)+ru(its+1,k-1,j)))<a name='6277'>
<font color=#447700>! recompute : uw<a name='6278'></font>
      ub = min(uw,0.)<a name='6279'>
<font color=#447700>! recompute : ub<a name='6280'></font>
      a_ru(its+1,k-1,j) = a_ru(its+1,k-1,j)-a_tendency(its,k,j)*rdx*w(its,k,j)*fzp(k)<a name='6281'>
      a_ru(its,k-1,j) = a_ru(its,k-1,j)+a_tendency(its,k,j)*rdx*w(its,k,j)*fzp(k)<a name='6282'>
      a_ru(its+1,k,j) = a_ru(its+1,k,j)-a_tendency(its,k,j)*rdx*w(its,k,j)*fzm(k)<a name='6283'>
      a_ru(its,k,j) = a_ru(its,k,j)+a_tendency(its,k,j)*rdx*w(its,k,j)*fzm(k)<a name='6284'>
      a_ub = a_ub-a_tendency(its,k,j)*rdx*(w_old(its+1,k,j)-w_old(its,k,j))<a name='6285'>
      a_w(its,k,j) = a_w(its,k,j)-a_tendency(its,k,j)*rdx*(fzm(k)*(ru(its+1,k,j)-ru(its,k,j))+fzp(k)*(ru(its+1,k-1,j)-ru(its,k-1,j)&amp;<a name='6286'>
&amp;))<a name='6287'>
      a_w_old(its+1,k,j) = a_w_old(its+1,k,j)-a_tendency(its,k,j)*rdx*ub<a name='6288'>
      a_w_old(its,k,j) = a_w_old(its,k,j)+a_tendency(its,k,j)*rdx*ub<a name='6289'>
      a_uw = a_uw+a_ub*(0.5+sign(0.5,0.-uw))<a name='6290'>
      a_ub = 0.<a name='6291'>
      a_ru(its+1,k-1,j) = a_ru(its+1,k-1,j)+0.5*a_uw*fzp(k)<a name='6292'>
      a_ru(its,k-1,j) = a_ru(its,k-1,j)+0.5*a_uw*fzp(k)<a name='6293'>
      a_ru(its+1,k,j) = a_ru(its+1,k,j)+0.5*a_uw*fzm(k)<a name='6294'>
      a_ru(its,k,j) = a_ru(its,k,j)+0.5*a_uw*fzm(k)<a name='6295'>
      a_uw = 0.<a name='6296'>
    end do<a name='6297'>
  end do<a name='6298'>
endif<a name='6299'>
<font color=#447700>! recdepend vars : kde,kte<a name='6300'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:3963<a name='6301'></font>
<font color=#447700>! recompute vars : ktf<a name='6302'></font>
ktf = min(kte,kde-1)<a name='6303'>
<font color=#447700>! recompute vars : ktf<a name='6304'></font>
a_horizontal_order_test: if (horz_order .eq. 6) then<a name='6305'>
  degrade_xs =  .true. <a name='6306'>
<font color=#447700>! recompute : degrade_xs<a name='6307'></font>
  degrade_xe =  .true. <a name='6308'>
<font color=#447700>! recompute : degrade_xe<a name='6309'></font>
  degrade_ys =  .true. <a name='6310'>
<font color=#447700>! recompute : degrade_ys<a name='6311'></font>
  degrade_ye =  .true. <a name='6312'>
<font color=#447700>! recompute : degrade_ye<a name='6313'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='6314'>
    degrade_xs =  .false. <a name='6315'>
  endif<a name='6316'>
<font color=#447700>! recompute : degrade_xs<a name='6317'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-3) then<a name='6318'>
    degrade_xe =  .false. <a name='6319'>
  endif<a name='6320'>
<font color=#447700>! recompute : degrade_xe<a name='6321'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='6322'>
    degrade_ys =  .false. <a name='6323'>
  endif<a name='6324'>
<font color=#447700>! recompute : degrade_ys<a name='6325'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-3) then<a name='6326'>
    degrade_ye =  .false. <a name='6327'>
  endif<a name='6328'>
<font color=#447700>! recompute : degrade_ye<a name='6329'></font>
  j_start = jts<a name='6330'>
<font color=#447700>! recompute : j_start<a name='6331'></font>
  j_end = min(jte,jde-1)<a name='6332'>
<font color=#447700>! recompute : j_end<a name='6333'></font>
  j_start_f = j_start<a name='6334'>
<font color=#447700>! recompute : j_start_f<a name='6335'></font>
  j_end_f = j_end+1<a name='6336'>
<font color=#447700>! recompute : j_end_f<a name='6337'></font>
  if (degrade_ys) then<a name='6338'>
    j_start_f = jds+3<a name='6339'>
  endif<a name='6340'>
<font color=#447700>! recompute : j_start_f<a name='6341'></font>
  if (degrade_ye) then<a name='6342'>
    j_end_f = jde-3<a name='6343'>
  endif<a name='6344'>
<font color=#447700>! recompute : j_end_f<a name='6345'></font>
  i_start = its<a name='6346'>
<font color=#447700>! recompute : i_start<a name='6347'></font>
  i_end = min(ite,ide-1)<a name='6348'>
<font color=#447700>! recompute : i_end<a name='6349'></font>
  j_start = jts<a name='6350'>
<font color=#447700>! recompute : j_start<a name='6351'></font>
  j_end = min(jte,jde-1)<a name='6352'>
<font color=#447700>! recompute : j_end<a name='6353'></font>
  i_start_f = i_start<a name='6354'>
<font color=#447700>! recompute : i_start_f<a name='6355'></font>
  i_end_f = i_end+1<a name='6356'>
<font color=#447700>! recompute : i_end_f<a name='6357'></font>
  if (degrade_xs) then<a name='6358'>
    i_start = max(ids+1,its)<a name='6359'>
    i_start_f = i_start+2<a name='6360'>
  endif<a name='6361'>
<font color=#447700>! recompute : i_start,i_start_f<a name='6362'></font>
  if (degrade_xe) then<a name='6363'>
    i_end = min(ide-2,ite)<a name='6364'>
    i_end_f = ide-3<a name='6365'>
  endif<a name='6366'>
<font color=#447700>! recompute : i_end,i_end_f<a name='6367'></font>
  do j = j_end, j_start, -1<a name='6368'>
    do k = kts+1, ktf+1<a name='6369'>
      do i = i_start, i_end<a name='6370'>
        mrdx = msft(i,j)*rdx<a name='6371'>
<font color=#447700>! recompute : mrdx<a name='6372'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='6373'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='6374'>
      end do<a name='6375'>
    end do<a name='6376'>
    if (degrade_xe) then<a name='6377'>
      i = ide-2<a name='6378'>
<font color=#447700>! recompute : i<a name='6379'></font>
      k = ktf+1<a name='6380'>
<font color=#447700>! recompute : k<a name='6381'></font>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='6382'>
<font color=#447700>! recompute : vel<a name='6383'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='6384'>
      a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6385'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6386'>
      a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6387'>
      a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6388'>
      a_fqx(i,k) = 0.<a name='6389'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='6390'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6391'>
      a_vel = 0.<a name='6392'>
      do k = kts+1, ktf<a name='6393'>
        a_vel = 0.<a name='6394'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6395'>
<font color=#447700>! recompute : vel<a name='6396'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='6397'>
        a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6398'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6399'>
        a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6400'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6401'>
        a_fqx(i,k) = 0.<a name='6402'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6403'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6404'>
        a_vel = 0.<a name='6405'>
      end do<a name='6406'>
      if (i_end .eq. ide-2) then<a name='6407'>
        i = ide-1<a name='6408'>
<font color=#447700>! recompute : i<a name='6409'></font>
        k = ktf+1<a name='6410'>
<font color=#447700>! recompute : k<a name='6411'></font>
        a_ru(i,k-2,j) = a_ru(i,k-2,j)-0.5*a_fqx(i,k)*fzp(k-1)*(w(i,k,j)+w(i-1,k,j))<a name='6412'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*(2-fzm(k-1))*(w(i,k,j)+w(i-1,k,j))<a name='6413'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6414'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6415'>
        a_fqx(i,k) = 0.<a name='6416'>
        do k = kts+1, ktf<a name='6417'>
          a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*fzp(k)*(w(i,k,j)+w(i-1,k,j))<a name='6418'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*fzm(k)*(w(i,k,j)+w(i-1,k,j))<a name='6419'>
          a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6420'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6421'>
          a_fqx(i,k) = 0.<a name='6422'>
        end do<a name='6423'>
      endif<a name='6424'>
    endif<a name='6425'>
    if (degrade_xs) then<a name='6426'>
      do k = kts+1, ktf<a name='6427'>
        i = i_start+1<a name='6428'>
      end do<a name='6429'>
<font color=#447700>! recompute : i<a name='6430'></font>
      k = ktf+1<a name='6431'>
<font color=#447700>! recompute : k<a name='6432'></font>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='6433'>
<font color=#447700>! recompute : vel<a name='6434'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='6435'>
      a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6436'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6437'>
      a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6438'>
      a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6439'>
      a_fqx(i,k) = 0.<a name='6440'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='6441'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6442'>
      a_vel = 0.<a name='6443'>
      k = ktf<a name='6444'>
      i = i_start+1<a name='6445'>
<font color=#447700>! recompute : i<a name='6446'></font>
      vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6447'>
<font color=#447700>! recompute : vel<a name='6448'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='6449'>
      a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6450'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6451'>
      a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6452'>
      a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6453'>
      a_fqx(i,k) = 0.<a name='6454'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6455'>
      a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6456'>
      a_vel = 0.<a name='6457'>
      do k = kts+1, ktf-1<a name='6458'>
        a_vel = 0.<a name='6459'>
        i = i_start+1<a name='6460'>
<font color=#447700>! recompute : i<a name='6461'></font>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6462'>
<font color=#447700>! recompute : vel<a name='6463'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='6464'>
        a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6465'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6466'>
        a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='6467'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='6468'>
        a_fqx(i,k) = 0.<a name='6469'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6470'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6471'>
        a_vel = 0.<a name='6472'>
      end do<a name='6473'>
      if (i_start .eq. ids+1) then<a name='6474'>
        i = ids+1<a name='6475'>
<font color=#447700>! recompute : i<a name='6476'></font>
        k = ktf+1<a name='6477'>
<font color=#447700>! recompute : k<a name='6478'></font>
        a_ru(i,k-2,j) = a_ru(i,k-2,j)-0.5*a_fqx(i,k)*fzp(k-1)*(w(i,k,j)+w(i-1,k,j))<a name='6479'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*(2-fzm(k-1))*(w(i,k,j)+w(i-1,k,j))<a name='6480'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6481'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6482'>
        a_fqx(i,k) = 0.<a name='6483'>
        do k = kts+1, ktf<a name='6484'>
          a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*fzp(k)*(w(i,k,j)+w(i-1,k,j))<a name='6485'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*fzm(k)*(w(i,k,j)+w(i-1,k,j))<a name='6486'>
          a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6487'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6488'>
          a_fqx(i,k) = 0.<a name='6489'>
        end do<a name='6490'>
      endif<a name='6491'>
    endif<a name='6492'>
<font color=#447700>! recdepend vars : ktf<a name='6493'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4174<a name='6494'></font>
<font color=#447700>! recompute vars : k<a name='6495'></font>
    k = ktf+1<a name='6496'>
<font color=#447700>! recompute vars : k<a name='6497'></font>
    do i = i_start_f, i_end_f<a name='6498'>
      a_vel = 0.<a name='6499'>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='6500'>
<font color=#447700>! recompute : vel<a name='6501'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.61666667*(w(i,k,j)+w(i-1,k,j))-0.13333333*(w(i+1,k,j)+w(i-2,k,j))+0.016666667*(w(i+2,k,j)+w(i-3,&amp;<a name='6502'>
&amp;k,j)))<a name='6503'>
      a_w(i-3,k,j) = a_w(i-3,k,j)+0.016666667*a_fqx(i,k)*vel<a name='6504'>
      a_w(i-2,k,j) = a_w(i-2,k,j)-0.13333333*a_fqx(i,k)*vel<a name='6505'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+0.61666667*a_fqx(i,k)*vel<a name='6506'>
      a_w(i+2,k,j) = a_w(i+2,k,j)+0.016666667*a_fqx(i,k)*vel<a name='6507'>
      a_w(i+1,k,j) = a_w(i+1,k,j)-0.13333333*a_fqx(i,k)*vel<a name='6508'>
      a_w(i,k,j) = a_w(i,k,j)+0.61666667*a_fqx(i,k)*vel<a name='6509'>
      a_fqx(i,k) = 0.<a name='6510'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='6511'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6512'>
      a_vel = 0.<a name='6513'>
    end do<a name='6514'>
    do k = kts+1, ktf<a name='6515'>
      a_vel = 0.<a name='6516'>
      do i = i_start_f, i_end_f<a name='6517'>
        a_vel = 0.<a name='6518'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6519'>
<font color=#447700>! recompute : vel<a name='6520'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(w(i,k,j)+w(i-1,k,j))-0.13333333*(w(i+1,k,j)+w(i-2,k,j))+0.016666667*(w(i+2,k,j)+w(i-&amp;<a name='6521'>
&amp;3,k,j)))<a name='6522'>
        a_w(i-3,k,j) = a_w(i-3,k,j)+0.016666667*a_fqx(i,k)*vel<a name='6523'>
        a_w(i-2,k,j) = a_w(i-2,k,j)-0.13333333*a_fqx(i,k)*vel<a name='6524'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.61666667*a_fqx(i,k)*vel<a name='6525'>
        a_w(i+2,k,j) = a_w(i+2,k,j)+0.016666667*a_fqx(i,k)*vel<a name='6526'>
        a_w(i+1,k,j) = a_w(i+1,k,j)-0.13333333*a_fqx(i,k)*vel<a name='6527'>
        a_w(i,k,j) = a_w(i,k,j)+0.61666667*a_fqx(i,k)*vel<a name='6528'>
        a_fqx(i,k) = 0.<a name='6529'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6530'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6531'>
        a_vel = 0.<a name='6532'>
      end do<a name='6533'>
    end do<a name='6534'>
  end do<a name='6535'>
<font color=#447700>! recdepend vars : its<a name='6536'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4000<a name='6537'></font>
<font color=#447700>! recompute vars : i_start<a name='6538'></font>
  i_start = its<a name='6539'>
<font color=#447700>! recompute vars : i_start<a name='6540'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='6541'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4001<a name='6542'></font>
<font color=#447700>! recompute vars : i_end<a name='6543'></font>
  i_end = min(ite,ide-1)<a name='6544'>
<font color=#447700>! recompute vars : i_end<a name='6545'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='6546'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4002<a name='6547'></font>
<font color=#447700>! recompute vars : j_start<a name='6548'></font>
  j_start = jts<a name='6549'>
<font color=#447700>! recompute vars : j_start<a name='6550'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='6551'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4003<a name='6552'></font>
<font color=#447700>! recompute vars : j_end<a name='6553'></font>
  j_end = min(jte,jde-1)<a name='6554'>
<font color=#447700>! recompute vars : j_end<a name='6555'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='6556'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4011<a name='6557'></font>
<font color=#447700>! recompute vars : j_start<a name='6558'></font>
  if (degrade_ys) then<a name='6559'>
    j_start = max(jts,jds+1)<a name='6560'>
  endif<a name='6561'>
<font color=#447700>! recompute vars : j_start<a name='6562'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='6563'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4016<a name='6564'></font>
<font color=#447700>! recompute vars : j_end<a name='6565'></font>
  if (degrade_ye) then<a name='6566'>
    j_end = min(jte,jde-2)<a name='6567'>
  endif<a name='6568'>
<font color=#447700>! recompute vars : j_end<a name='6569'></font>
  a_j_loop_y_flux_6: do j = j_end+1, j_start, -1<a name='6570'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4023<a name='6571'></font>
<font color=#447700>! recompute vars : jp1<a name='6572'></font>
    jp1 = 2<a name='6573'>
<font color=#447700>! recompute vars : jp1<a name='6574'></font>
<font color=#447700>! recdepend vars : jp1<a name='6575'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4024<a name='6576'></font>
<font color=#447700>! recompute vars : jp0<a name='6577'></font>
    jp0 = 1<a name='6578'>
<font color=#447700>! recompute vars : jp0<a name='6579'></font>
    j_loop_y_flux_9c: do j4 = j_start, j-1<a name='6580'>
      jtmp = jp1<a name='6581'>
      jp1 = jp0<a name='6582'>
      jp0 = jtmp<a name='6583'>
    end do j_loop_y_flux_9c<a name='6584'>
<font color=#447700>!    if (j .gt. j_start) then<a name='6585'></font>
    if (j .gt. jds+1) then<a name='6586'>
      do k = kts+1, ktf+1<a name='6587'>
        do i = i_start, i_end<a name='6588'>
          mrdy = msft(i,j-1)*rdy<a name='6589'>
<font color=#447700>! recompute : mrdy<a name='6590'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='6591'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='6592'>
        end do<a name='6593'>
      end do<a name='6594'>
    endif<a name='6595'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='6596'>
      k = ktf+1<a name='6597'>
<font color=#447700>! recompute : k<a name='6598'></font>
      do i = i_start, i_end<a name='6599'>
        a_vel = 0.<a name='6600'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='6601'>
<font color=#447700>! recompute : vel<a name='6602'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(w(i,k,j)+w(i,k,j-1))-0.13333333*(w(i,k,j+1)+w(i,k,j-2))+0.016666667*(w(i,k,j+2)+&amp;<a name='6603'>
&amp;w(i,k,j-3)))<a name='6604'>
        a_w(i,k,j-3) = a_w(i,k,j-3)+0.016666667*a_fqy(i,k,jp1)*vel<a name='6605'>
        a_w(i,k,j-2) = a_w(i,k,j-2)-0.13333333*a_fqy(i,k,jp1)*vel<a name='6606'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.61666667*a_fqy(i,k,jp1)*vel<a name='6607'>
        a_w(i,k,j+2) = a_w(i,k,j+2)+0.016666667*a_fqy(i,k,jp1)*vel<a name='6608'>
        a_w(i,k,j+1) = a_w(i,k,j+1)-0.13333333*a_fqy(i,k,jp1)*vel<a name='6609'>
        a_w(i,k,j) = a_w(i,k,j)+0.61666667*a_fqy(i,k,jp1)*vel<a name='6610'>
        a_fqy(i,k,jp1) = 0.<a name='6611'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='6612'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6613'>
        a_vel = 0.<a name='6614'>
      end do<a name='6615'>
      do k = kts+1, ktf<a name='6616'>
        a_vel = 0.<a name='6617'>
        do i = i_start, i_end<a name='6618'>
          a_vel = 0.<a name='6619'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='6620'>
<font color=#447700>! recompute : vel<a name='6621'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(w(i,k,j)+w(i,k,j-1))-0.13333333*(w(i,k,j+1)+w(i,k,j-2))+0.016666667*(w(i,k,j+2)&amp;<a name='6622'>
&amp;+w(i,k,j-3)))<a name='6623'>
          a_w(i,k,j-3) = a_w(i,k,j-3)+0.016666667*a_fqy(i,k,jp1)*vel<a name='6624'>
          a_w(i,k,j-2) = a_w(i,k,j-2)-0.13333333*a_fqy(i,k,jp1)*vel<a name='6625'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.61666667*a_fqy(i,k,jp1)*vel<a name='6626'>
          a_w(i,k,j+2) = a_w(i,k,j+2)+0.016666667*a_fqy(i,k,jp1)*vel<a name='6627'>
          a_w(i,k,j+1) = a_w(i,k,j+1)-0.13333333*a_fqy(i,k,jp1)*vel<a name='6628'>
          a_w(i,k,j) = a_w(i,k,j)+0.61666667*a_fqy(i,k,jp1)*vel<a name='6629'>
          a_fqy(i,k,jp1) = 0.<a name='6630'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='6631'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='6632'>
          a_vel = 0.<a name='6633'>
        end do<a name='6634'>
      end do<a name='6635'>
    else if (j .eq. jds+1) then<a name='6636'>
      k = ktf+1<a name='6637'>
<font color=#447700>! recompute : k<a name='6638'></font>
      do i = i_start, i_end<a name='6639'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j)+w(i,k,j-1))<a name='6640'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j)+w(i,k,j-1))<a name='6641'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='6642'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='6643'>
        a_fqy(i,k,jp1) = 0.<a name='6644'>
      end do<a name='6645'>
      do k = kts+1, ktf<a name='6646'>
        do i = i_start, i_end<a name='6647'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j)+w(i,k,j-1))<a name='6648'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j)+w(i,k,j-1))<a name='6649'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='6650'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='6651'>
          a_fqy(i,k,jp1) = 0.<a name='6652'>
        end do<a name='6653'>
      end do<a name='6654'>
    else if (j .eq. jds+2) then<a name='6655'>
      k = ktf+1<a name='6656'>
<font color=#447700>! recompute : k<a name='6657'></font>
      do i = i_start, i_end<a name='6658'>
        a_vel = 0.<a name='6659'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='6660'>
<font color=#447700>! recompute : vel<a name='6661'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2)))<a name='6662'>
        a_w(i,k,j-2) = a_w(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6663'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6664'>
        a_w(i,k,j+1) = a_w(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6665'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6666'>
        a_fqy(i,k,jp1) = 0.<a name='6667'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='6668'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6669'>
        a_vel = 0.<a name='6670'>
      end do<a name='6671'>
      do k = kts+1, ktf<a name='6672'>
        a_vel = 0.<a name='6673'>
        do i = i_start, i_end<a name='6674'>
          a_vel = 0.<a name='6675'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='6676'>
<font color=#447700>! recompute : vel<a name='6677'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2)))<a name='6678'>
          a_w(i,k,j-2) = a_w(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6679'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6680'>
          a_w(i,k,j+1) = a_w(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6681'>
          a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6682'>
          a_fqy(i,k,jp1) = 0.<a name='6683'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='6684'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='6685'>
          a_vel = 0.<a name='6686'>
        end do<a name='6687'>
      end do<a name='6688'>
    else if (j .eq. jde-1) then<a name='6689'>
      k = ktf+1<a name='6690'>
<font color=#447700>! recompute : k<a name='6691'></font>
      do i = i_start, i_end<a name='6692'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j)+w(i,k,j-1))<a name='6693'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j)+w(i,k,j-1))<a name='6694'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='6695'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='6696'>
        a_fqy(i,k,jp1) = 0.<a name='6697'>
      end do<a name='6698'>
      do k = kts+1, ktf<a name='6699'>
        do i = i_start, i_end<a name='6700'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j)+w(i,k,j-1))<a name='6701'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j)+w(i,k,j-1))<a name='6702'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='6703'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='6704'>
          a_fqy(i,k,jp1) = 0.<a name='6705'>
        end do<a name='6706'>
      end do<a name='6707'>
    else if (j .eq. jde-2) then<a name='6708'>
      k = ktf+1<a name='6709'>
<font color=#447700>! recompute : k<a name='6710'></font>
      do i = i_start, i_end<a name='6711'>
        a_vel = 0.<a name='6712'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='6713'>
<font color=#447700>! recompute : vel<a name='6714'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2)))<a name='6715'>
        a_w(i,k,j-2) = a_w(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6716'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6717'>
        a_w(i,k,j+1) = a_w(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6718'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6719'>
        a_fqy(i,k,jp1) = 0.<a name='6720'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='6721'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6722'>
        a_vel = 0.<a name='6723'>
      end do<a name='6724'>
      do k = kts+1, ktf<a name='6725'>
        a_vel = 0.<a name='6726'>
        do i = i_start, i_end<a name='6727'>
          a_vel = 0.<a name='6728'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='6729'>
<font color=#447700>! recompute : vel<a name='6730'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2)))<a name='6731'>
          a_w(i,k,j-2) = a_w(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6732'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6733'>
          a_w(i,k,j+1) = a_w(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='6734'>
          a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='6735'>
          a_fqy(i,k,jp1) = 0.<a name='6736'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='6737'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='6738'>
          a_vel = 0.<a name='6739'>
        end do<a name='6740'>
      end do<a name='6741'>
    endif<a name='6742'>
  end do a_j_loop_y_flux_6<a name='6743'>
else if (horz_order .eq. 5) then a_horizontal_order_test<a name='6744'>
  degrade_xs =  .true. <a name='6745'>
<font color=#447700>! recompute : degrade_xs<a name='6746'></font>
  degrade_xe =  .true. <a name='6747'>
<font color=#447700>! recompute : degrade_xe<a name='6748'></font>
  degrade_ys =  .true. <a name='6749'>
<font color=#447700>! recompute : degrade_ys<a name='6750'></font>
  degrade_ye =  .true. <a name='6751'>
<font color=#447700>! recompute : degrade_ye<a name='6752'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+2) then<a name='6753'>
    degrade_xs =  .false. <a name='6754'>
  endif<a name='6755'>
<font color=#447700>! recompute : degrade_xs<a name='6756'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-3) then<a name='6757'>
    degrade_xe =  .false. <a name='6758'>
  endif<a name='6759'>
<font color=#447700>! recompute : degrade_xe<a name='6760'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+2) then<a name='6761'>
    degrade_ys =  .false. <a name='6762'>
  endif<a name='6763'>
<font color=#447700>! recompute : degrade_ys<a name='6764'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-3) then<a name='6765'>
    degrade_ye =  .false. <a name='6766'>
  endif<a name='6767'>
<font color=#447700>! recompute : degrade_ye<a name='6768'></font>
  j_start = jts<a name='6769'>
<font color=#447700>! recompute : j_start<a name='6770'></font>
  j_end = min(jte,jde-1)<a name='6771'>
<font color=#447700>! recompute : j_end<a name='6772'></font>
  j_start_f = j_start<a name='6773'>
<font color=#447700>! recompute : j_start_f<a name='6774'></font>
  j_end_f = j_end+1<a name='6775'>
<font color=#447700>! recompute : j_end_f<a name='6776'></font>
  if (degrade_ys) then<a name='6777'>
    j_start_f = jds+3<a name='6778'>
  endif<a name='6779'>
<font color=#447700>! recompute : j_start_f<a name='6780'></font>
  if (degrade_ye) then<a name='6781'>
    j_end_f = jde-3<a name='6782'>
  endif<a name='6783'>
<font color=#447700>! recompute : j_end_f<a name='6784'></font>
  i_start = its<a name='6785'>
<font color=#447700>! recompute : i_start<a name='6786'></font>
  i_end = min(ite,ide-1)<a name='6787'>
<font color=#447700>! recompute : i_end<a name='6788'></font>
  j_start = jts<a name='6789'>
<font color=#447700>! recompute : j_start<a name='6790'></font>
  j_end = min(jte,jde-1)<a name='6791'>
<font color=#447700>! recompute : j_end<a name='6792'></font>
  i_start_f = i_start<a name='6793'>
<font color=#447700>! recompute : i_start_f<a name='6794'></font>
  i_end_f = i_end+1<a name='6795'>
<font color=#447700>! recompute : i_end_f<a name='6796'></font>
  if (degrade_xs) then<a name='6797'>
    i_start = max(ids+1,its)<a name='6798'>
    i_start_f = i_start+2<a name='6799'>
  endif<a name='6800'>
<font color=#447700>! recompute : i_start,i_start_f<a name='6801'></font>
  if (degrade_xe) then<a name='6802'>
    i_end = min(ide-2,ite)<a name='6803'>
    i_end_f = ide-3<a name='6804'>
  endif<a name='6805'>
<font color=#447700>! recompute : i_end,i_end_f<a name='6806'></font>
  do j = j_end, j_start, -1<a name='6807'>
    do k = kts+1, ktf+1<a name='6808'>
      do i = i_start, i_end<a name='6809'>
        mrdx = msft(i,j)*rdx<a name='6810'>
<font color=#447700>! recompute : mrdx<a name='6811'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='6812'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='6813'>
      end do<a name='6814'>
    end do<a name='6815'>
    if (degrade_xe) then<a name='6816'>
      i = ide-2<a name='6817'>
<font color=#447700>! recompute : i<a name='6818'></font>
      k = ktf+1<a name='6819'>
<font color=#447700>! recompute : k<a name='6820'></font>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='6821'>
<font color=#447700>! recompute : vel<a name='6822'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j))+0.083333333*(w(i+1,k,j)-w(i-2,&amp;<a name='6823'>
&amp;k,j)-3.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='6824'>
      a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='6825'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='6826'>
      a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='6827'>
      a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='6828'>
      a_fqx(i,k) = 0.<a name='6829'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='6830'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6831'>
      a_vel = 0.<a name='6832'>
      do k = kts+1, ktf<a name='6833'>
        a_vel = 0.<a name='6834'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6835'>
<font color=#447700>! recompute : vel<a name='6836'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j))+0.083333333*(w(i+1,k,j)-w(i-&amp;<a name='6837'>
&amp;2,k,j)-3.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='6838'>
        a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='6839'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='6840'>
        a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='6841'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='6842'>
        a_fqx(i,k) = 0.<a name='6843'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6844'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6845'>
        a_vel = 0.<a name='6846'>
      end do<a name='6847'>
      if (i_end .eq. ide-2) then<a name='6848'>
        i = ide-1<a name='6849'>
<font color=#447700>! recompute : i<a name='6850'></font>
        k = ktf+1<a name='6851'>
<font color=#447700>! recompute : k<a name='6852'></font>
        a_ru(i,k-2,j) = a_ru(i,k-2,j)-0.5*a_fqx(i,k)*fzp(k-1)*(w(i,k,j)+w(i-1,k,j))<a name='6853'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*(2-fzm(k-1))*(w(i,k,j)+w(i-1,k,j))<a name='6854'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6855'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6856'>
        a_fqx(i,k) = 0.<a name='6857'>
        do k = kts+1, ktf<a name='6858'>
          a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*fzp(k)*(w(i,k,j)+w(i-1,k,j))<a name='6859'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*fzm(k)*(w(i,k,j)+w(i-1,k,j))<a name='6860'>
          a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6861'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6862'>
          a_fqx(i,k) = 0.<a name='6863'>
        end do<a name='6864'>
      endif<a name='6865'>
    endif<a name='6866'>
    if (degrade_xs) then<a name='6867'>
      i = i_start+1<a name='6868'>
<font color=#447700>! recompute : i<a name='6869'></font>
      k = ktf+1<a name='6870'>
<font color=#447700>! recompute : k<a name='6871'></font>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='6872'>
<font color=#447700>! recompute : vel<a name='6873'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j))+0.083333333*(w(i+1,k,j)-w(i-2,&amp;<a name='6874'>
&amp;k,j)-3.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='6875'>
      a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='6876'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='6877'>
      a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='6878'>
      a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='6879'>
      a_fqx(i,k) = 0.<a name='6880'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='6881'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6882'>
      a_vel = 0.<a name='6883'>
      do k = kts+1, ktf<a name='6884'>
        a_vel = 0.<a name='6885'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6886'>
<font color=#447700>! recompute : vel<a name='6887'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j))+0.083333333*(w(i+1,k,j)-w(i-&amp;<a name='6888'>
&amp;2,k,j)-3.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='6889'>
        a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='6890'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='6891'>
        a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='6892'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='6893'>
        a_fqx(i,k) = 0.<a name='6894'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6895'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6896'>
        a_vel = 0.<a name='6897'>
      end do<a name='6898'>
      if (i_start .eq. ids+1) then<a name='6899'>
        i = ids+1<a name='6900'>
<font color=#447700>! recompute : i<a name='6901'></font>
        k = ktf+1<a name='6902'>
<font color=#447700>! recompute : k<a name='6903'></font>
        a_ru(i,k-2,j) = a_ru(i,k-2,j)-0.5*a_fqx(i,k)*fzp(k-1)*(w(i,k,j)+w(i-1,k,j))<a name='6904'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*(2-fzm(k-1))*(w(i,k,j)+w(i-1,k,j))<a name='6905'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6906'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='6907'>
        a_fqx(i,k) = 0.<a name='6908'>
        do k = kts+1, ktf<a name='6909'>
          a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_fqx(i,k)*fzp(k)*(w(i,k,j)+w(i-1,k,j))<a name='6910'>
          a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_fqx(i,k)*fzm(k)*(w(i,k,j)+w(i-1,k,j))<a name='6911'>
          a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6912'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqx(i,k)*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='6913'>
          a_fqx(i,k) = 0.<a name='6914'>
        end do<a name='6915'>
      endif<a name='6916'>
    endif<a name='6917'>
<font color=#447700>! recdepend vars : ktf<a name='6918'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4456<a name='6919'></font>
<font color=#447700>! recompute vars : k<a name='6920'></font>
    k = ktf+1<a name='6921'>
<font color=#447700>! recompute vars : k<a name='6922'></font>
    do i = i_start_f, i_end_f<a name='6923'>
      a_vel = 0.<a name='6924'>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='6925'>
<font color=#447700>! recompute : vel<a name='6926'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.61666667*(w(i,k,j)+w(i-1,k,j))-0.13333333*(w(i+1,k,j)+w(i-2,k,j))+0.016666667*(w(i+2,k,j)+w(i-3,&amp;<a name='6927'>
&amp;k,j))-0.016666667*(w(i+2,k,j)-w(i-3,k,j)-5.*(w(i+1,k,j)-w(i-2,k,j))+10.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='6928'>
      a_w(i-3,k,j) = a_w(i-3,k,j)+a_fqx(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='6929'>
      a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='6930'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='6931'>
      a_w(i+2,k,j) = a_w(i+2,k,j)+a_fqx(i,k)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='6932'>
      a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='6933'>
      a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='6934'>
      a_fqx(i,k) = 0.<a name='6935'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='6936'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='6937'>
      a_vel = 0.<a name='6938'>
    end do<a name='6939'>
    do k = kts+1, ktf<a name='6940'>
      a_vel = 0.<a name='6941'>
      do i = i_start_f, i_end_f<a name='6942'>
        a_vel = 0.<a name='6943'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='6944'>
<font color=#447700>! recompute : vel<a name='6945'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.61666667*(w(i,k,j)+w(i-1,k,j))-0.13333333*(w(i+1,k,j)+w(i-2,k,j))+0.016666667*(w(i+2,k,j)+w(i-&amp;<a name='6946'>
&amp;3,k,j))-0.016666667*(w(i+2,k,j)-w(i-3,k,j)-5.*(w(i+1,k,j)-w(i-2,k,j))+10.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='6947'>
        a_w(i-3,k,j) = a_w(i-3,k,j)+a_fqx(i,k)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='6948'>
        a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='6949'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='6950'>
        a_w(i+2,k,j) = a_w(i+2,k,j)+a_fqx(i,k)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='6951'>
        a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='6952'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='6953'>
        a_fqx(i,k) = 0.<a name='6954'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='6955'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='6956'>
        a_vel = 0.<a name='6957'>
      end do<a name='6958'>
    end do<a name='6959'>
  end do<a name='6960'>
<font color=#447700>! recdepend vars : its<a name='6961'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4282<a name='6962'></font>
<font color=#447700>! recompute vars : i_start<a name='6963'></font>
  i_start = its<a name='6964'>
<font color=#447700>! recompute vars : i_start<a name='6965'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='6966'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4283<a name='6967'></font>
<font color=#447700>! recompute vars : i_end<a name='6968'></font>
  i_end = min(ite,ide-1)<a name='6969'>
<font color=#447700>! recompute vars : i_end<a name='6970'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='6971'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4284<a name='6972'></font>
<font color=#447700>! recompute vars : j_start<a name='6973'></font>
  j_start = jts<a name='6974'>
<font color=#447700>! recompute vars : j_start<a name='6975'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='6976'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4285<a name='6977'></font>
<font color=#447700>! recompute vars : j_end<a name='6978'></font>
  j_end = min(jte,jde-1)<a name='6979'>
<font color=#447700>! recompute vars : j_end<a name='6980'></font>
<font color=#447700>! recdepend vars : degrade_ys,i_end,i_start,j_end,j_start,jds,jts<a name='6981'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4293<a name='6982'></font>
<font color=#447700>! recompute vars : j_start<a name='6983'></font>
  if (degrade_ys) then<a name='6984'>
    j_start = max(jts,jds+1)<a name='6985'>
  endif<a name='6986'>
<font color=#447700>! recompute vars : j_start<a name='6987'></font>
<font color=#447700>! recdepend vars : degrade_ye,i_end,i_start,j_end,j_start,jde,jte<a name='6988'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4298<a name='6989'></font>
<font color=#447700>! recompute vars : j_end<a name='6990'></font>
  if (degrade_ye) then<a name='6991'>
    j_end = min(jte,jde-2)<a name='6992'>
  endif<a name='6993'>
<font color=#447700>! recompute vars : j_end<a name='6994'></font>
  a_j_loop_y_flux_5: do j = j_end+1, j_start, -1<a name='6995'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4305<a name='6996'></font>
<font color=#447700>! recompute vars : jp1<a name='6997'></font>
    jp1 = 2<a name='6998'>
<font color=#447700>! recompute vars : jp1<a name='6999'></font>
<font color=#447700>! recdepend vars : jp1<a name='7000'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4306<a name='7001'></font>
<font color=#447700>! recompute vars : jp0<a name='7002'></font>
    jp0 = 1<a name='7003'>
<font color=#447700>! recompute vars : jp0<a name='7004'></font>
    j_loop_y_flux_9a: do j1 = j_start, j-1<a name='7005'>
      jtmp = jp1<a name='7006'>
      jp1 = jp0<a name='7007'>
      jp0 = jtmp<a name='7008'>
    end do j_loop_y_flux_9a<a name='7009'>
<font color=#447700>!    if (j .gt. j_start) then<a name='7010'></font>
    if (j .gt. jds+1) then<a name='7011'>
      do k = kts+1, ktf+1<a name='7012'>
        do i = i_start, i_end<a name='7013'>
          mrdy = msft(i,j-1)*rdy<a name='7014'>
<font color=#447700>! recompute : mrdy<a name='7015'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='7016'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='7017'>
        end do<a name='7018'>
      end do<a name='7019'>
    endif<a name='7020'>
    if (j .ge. j_start_f .and. j .le. j_end_f) then<a name='7021'>
      k = ktf+1<a name='7022'>
<font color=#447700>! recompute : k<a name='7023'></font>
      do i = i_start, i_end<a name='7024'>
        a_vel = 0.<a name='7025'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='7026'>
<font color=#447700>! recompute : vel<a name='7027'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(w(i,k,j)+w(i,k,j-1))-0.13333333*(w(i,k,j+1)+w(i,k,j-2))+0.016666667*(w(i,k,j+2)+&amp;<a name='7028'>
&amp;w(i,k,j-3))-0.016666667*(w(i,k,j+2)-w(i,k,j-3)-5.*(w(i,k,j+1)-w(i,k,j-2))+10.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7029'>
        a_w(i,k,j-3) = a_w(i,k,j-3)+a_fqy(i,k,jp1)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='7030'>
        a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='7031'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='7032'>
        a_w(i,k,j+2) = a_w(i,k,j+2)+a_fqy(i,k,jp1)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='7033'>
        a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='7034'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='7035'>
        a_fqy(i,k,jp1) = 0.<a name='7036'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='7037'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7038'>
        a_vel = 0.<a name='7039'>
      end do<a name='7040'>
      do k = kts+1, ktf<a name='7041'>
        a_vel = 0.<a name='7042'>
        do i = i_start, i_end<a name='7043'>
          a_vel = 0.<a name='7044'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='7045'>
<font color=#447700>! recompute : vel<a name='7046'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.61666667*(w(i,k,j)+w(i,k,j-1))-0.13333333*(w(i,k,j+1)+w(i,k,j-2))+0.016666667*(w(i,k,j+2)&amp;<a name='7047'>
&amp;+w(i,k,j-3))-0.016666667*(w(i,k,j+2)-w(i,k,j-3)-5.*(w(i,k,j+1)-w(i,k,j-2))+10.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7048'>
          a_w(i,k,j-3) = a_w(i,k,j-3)+a_fqy(i,k,jp1)*vel*(0.016666667-(-0.016666667)*sign(1.,vel))<a name='7049'>
          a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.13333333)-0.083333333*sign(1.,vel))<a name='7050'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.61666667-(-0.16666667)*sign(1.,vel))<a name='7051'>
          a_w(i,k,j+2) = a_w(i,k,j+2)+a_fqy(i,k,jp1)*vel*(0.016666667-0.016666667*sign(1.,vel))<a name='7052'>
          a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.13333333)-(-0.083333333)*sign(1.,vel))<a name='7053'>
          a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.61666667-0.16666667*sign(1.,vel))<a name='7054'>
          a_fqy(i,k,jp1) = 0.<a name='7055'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='7056'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='7057'>
          a_vel = 0.<a name='7058'>
        end do<a name='7059'>
      end do<a name='7060'>
    else if (j .eq. jds+1) then<a name='7061'>
      k = ktf+1<a name='7062'>
<font color=#447700>! recompute : k<a name='7063'></font>
      do i = i_start, i_end<a name='7064'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j)+w(i,k,j-1))<a name='7065'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j)+w(i,k,j-1))<a name='7066'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='7067'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='7068'>
        a_fqy(i,k,jp1) = 0.<a name='7069'>
      end do<a name='7070'>
      do k = kts+1, ktf<a name='7071'>
        do i = i_start, i_end<a name='7072'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j)+w(i,k,j-1))<a name='7073'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j)+w(i,k,j-1))<a name='7074'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='7075'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='7076'>
          a_fqy(i,k,jp1) = 0.<a name='7077'>
        end do<a name='7078'>
      end do<a name='7079'>
    else if (j .eq. jds+2) then<a name='7080'>
      k = ktf+1<a name='7081'>
<font color=#447700>! recompute : k<a name='7082'></font>
      do i = i_start, i_end<a name='7083'>
        a_vel = 0.<a name='7084'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='7085'>
<font color=#447700>! recompute : vel<a name='7086'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2))+0.083333333*(w(i,k,j+1)-&amp;<a name='7087'>
&amp;w(i,k,j-2)-3.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7088'>
        a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7089'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7090'>
        a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7091'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7092'>
        a_fqy(i,k,jp1) = 0.<a name='7093'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='7094'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7095'>
        a_vel = 0.<a name='7096'>
      end do<a name='7097'>
      do k = kts+1, ktf<a name='7098'>
        a_vel = 0.<a name='7099'>
        do i = i_start, i_end<a name='7100'>
          a_vel = 0.<a name='7101'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='7102'>
<font color=#447700>! recompute : vel<a name='7103'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2))+0.083333333*(w(i,k,j+&amp;<a name='7104'>
&amp;1)-w(i,k,j-2)-3.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7105'>
          a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7106'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7107'>
          a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7108'>
          a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7109'>
          a_fqy(i,k,jp1) = 0.<a name='7110'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='7111'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='7112'>
          a_vel = 0.<a name='7113'>
        end do<a name='7114'>
      end do<a name='7115'>
    else if (j .eq. jde-1) then<a name='7116'>
      k = ktf+1<a name='7117'>
<font color=#447700>! recompute : k<a name='7118'></font>
      do i = i_start, i_end<a name='7119'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j)+w(i,k,j-1))<a name='7120'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j)+w(i,k,j-1))<a name='7121'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='7122'>
        a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='7123'>
        a_fqy(i,k,jp1) = 0.<a name='7124'>
      end do<a name='7125'>
      do k = kts+1, ktf<a name='7126'>
        do i = i_start, i_end<a name='7127'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j)+w(i,k,j-1))<a name='7128'>
          a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j)+w(i,k,j-1))<a name='7129'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='7130'>
          a_w(i,k,j) = a_w(i,k,j)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='7131'>
          a_fqy(i,k,jp1) = 0.<a name='7132'>
        end do<a name='7133'>
      end do<a name='7134'>
    else if (j .eq. jde-2) then<a name='7135'>
      k = ktf+1<a name='7136'>
<font color=#447700>! recompute : k<a name='7137'></font>
      do i = i_start, i_end<a name='7138'>
        a_vel = 0.<a name='7139'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='7140'>
<font color=#447700>! recompute : vel<a name='7141'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2))+0.083333333*(w(i,k,j+1)-&amp;<a name='7142'>
&amp;w(i,k,j-2)-3.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7143'>
        a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7144'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7145'>
        a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7146'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7147'>
        a_fqy(i,k,jp1) = 0.<a name='7148'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='7149'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7150'>
        a_vel = 0.<a name='7151'>
      end do<a name='7152'>
      do k = kts+1, ktf<a name='7153'>
        a_vel = 0.<a name='7154'>
        do i = i_start, i_end<a name='7155'>
          a_vel = 0.<a name='7156'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='7157'>
<font color=#447700>! recompute : vel<a name='7158'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2))+0.083333333*(w(i,k,j+&amp;<a name='7159'>
&amp;1)-w(i,k,j-2)-3.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7160'>
          a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7161'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7162'>
          a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7163'>
          a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7164'>
          a_fqy(i,k,jp1) = 0.<a name='7165'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='7166'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='7167'>
          a_vel = 0.<a name='7168'>
        end do<a name='7169'>
      end do<a name='7170'>
    endif<a name='7171'>
  end do a_j_loop_y_flux_5<a name='7172'>
else if (horz_order .eq. 4) then a_horizontal_order_test<a name='7173'>
  degrade_xs =  .true. <a name='7174'>
<font color=#447700>! recompute : degrade_xs<a name='7175'></font>
  degrade_xe =  .true. <a name='7176'>
<font color=#447700>! recompute : degrade_xe<a name='7177'></font>
  degrade_ys =  .true. <a name='7178'>
<font color=#447700>! recompute : degrade_ys<a name='7179'></font>
  degrade_ye =  .true. <a name='7180'>
<font color=#447700>! recompute : degrade_ye<a name='7181'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='7182'>
    degrade_xs =  .false. <a name='7183'>
  endif<a name='7184'>
<font color=#447700>! recompute : degrade_xs<a name='7185'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='7186'>
    degrade_xe =  .false. <a name='7187'>
  endif<a name='7188'>
<font color=#447700>! recompute : degrade_xe<a name='7189'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='7190'>
    degrade_ys =  .false. <a name='7191'>
  endif<a name='7192'>
<font color=#447700>! recompute : degrade_ys<a name='7193'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='7194'>
    degrade_ye =  .false. <a name='7195'>
  endif<a name='7196'>
<font color=#447700>! recompute : degrade_ye<a name='7197'></font>
<font color=#447700>! recompute : ktf<a name='7198'></font>
  i_start = its<a name='7199'>
<font color=#447700>! recompute : i_start<a name='7200'></font>
  i_end = min(ite,ide-1)<a name='7201'>
<font color=#447700>! recompute : i_end<a name='7202'></font>
  i_start_f = i_start<a name='7203'>
<font color=#447700>! recompute : i_start_f<a name='7204'></font>
  i_end_f = i_end+1<a name='7205'>
<font color=#447700>! recompute : i_end_f<a name='7206'></font>
  if (degrade_xs) then<a name='7207'>
    i_start = ids+1<a name='7208'>
    i_start_f = i_start+1<a name='7209'>
  endif<a name='7210'>
<font color=#447700>! recompute : i_start_f<a name='7211'></font>
  if (degrade_xe) then<a name='7212'>
    i_end_f = ide-2<a name='7213'>
  endif<a name='7214'>
<font color=#447700>! recompute : i_end_f<a name='7215'></font>
  i_start = its<a name='7216'>
<font color=#447700>! recompute : i_start<a name='7217'></font>
  i_end = min(ite,ide-1)<a name='7218'>
<font color=#447700>! recompute : i_end<a name='7219'></font>
  j_start = jts<a name='7220'>
<font color=#447700>! recompute : j_start<a name='7221'></font>
  j_end = min(jte,jde-1)<a name='7222'>
<font color=#447700>! recompute : j_end<a name='7223'></font>
  j_start_f = j_start<a name='7224'>
<font color=#447700>! recompute : j_start_f<a name='7225'></font>
  j_end_f = j_end+1<a name='7226'>
<font color=#447700>! recompute : j_end_f<a name='7227'></font>
  if (degrade_ys) then<a name='7228'>
    j_start = jds+1<a name='7229'>
    j_start_f = j_start+1<a name='7230'>
  endif<a name='7231'>
<font color=#447700>! recompute : j_start,j_start_f<a name='7232'></font>
  if (degrade_ye) then<a name='7233'>
    j_end = jde-2<a name='7234'>
    j_end_f = jde-2<a name='7235'>
  endif<a name='7236'>
<font color=#447700>! recompute : j_end,j_end_f<a name='7237'></font>
  do j = j_end+1, j_start, -1<a name='7238'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4662<a name='7239'></font>
<font color=#447700>! recompute vars : jp1<a name='7240'></font>
    jp1 = 2<a name='7241'>
<font color=#447700>! recompute vars : jp1<a name='7242'></font>
<font color=#447700>! recdepend vars : jp1<a name='7243'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4663<a name='7244'></font>
<font color=#447700>! recompute vars : jp0<a name='7245'></font>
    jp0 = 1<a name='7246'>
<font color=#447700>! recompute vars : jp0<a name='7247'></font>
    do j2 = j_start, j-1<a name='7248'>
      jtmp = jp1<a name='7249'>
      jp1 = jp0<a name='7250'>
      jp0 = jtmp<a name='7251'>
    end do<a name='7252'>
<font color=#447700>!    if (j .gt. j_start) then<a name='7253'></font>
    if (j .gt. jds+1) then<a name='7254'>
      do k = kts+1, ktf+1<a name='7255'>
        do i = i_start, i_end<a name='7256'>
          mrdy = msft(i,j-1)*rdy<a name='7257'>
<font color=#447700>! recompute : mrdy<a name='7258'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='7259'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='7260'>
        end do<a name='7261'>
      end do<a name='7262'>
    endif<a name='7263'>
    if (j .lt. j_start_f .and. degrade_ys) then<a name='7264'>
      k = ktf+1<a name='7265'>
<font color=#447700>! recompute : k<a name='7266'></font>
      do i = i_start, i_end<a name='7267'>
        a_rv(i,k-2,j_start) = a_rv(i,k-2,j_start)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7268'>
        a_rv(i,k-1,j_start) = a_rv(i,k-1,j_start)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7269'>
        a_w(i,k,j_start-1) = a_w(i,k,j_start-1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_start)-fzp(k-1)*rv(i,k-2,j_start))<a name='7270'>
        a_w(i,k,j_start) = a_w(i,k,j_start)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_start)-fzp(k-1)*rv(i,k-2,j_start))<a name='7271'>
        a_fqy(i,k,jp1) = 0.<a name='7272'>
      end do<a name='7273'>
      do k = kts+1, ktf<a name='7274'>
        do i = i_start, i_end<a name='7275'>
          a_rv(i,k-1,j_start) = a_rv(i,k-1,j_start)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7276'>
          a_rv(i,k,j_start) = a_rv(i,k,j_start)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7277'>
          a_w(i,k,j_start-1) = a_w(i,k,j_start-1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_start)+fzp(k)*rv(i,k-1,j_start))<a name='7278'>
          a_w(i,k,j_start) = a_w(i,k,j_start)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_start)+fzp(k)*rv(i,k-1,j_start))<a name='7279'>
          a_fqy(i,k,jp1) = 0.<a name='7280'>
        end do<a name='7281'>
      end do<a name='7282'>
    else if (j .gt. j_end_f .and. degrade_ye) then<a name='7283'>
      k = ktf+1<a name='7284'>
<font color=#447700>! recompute : k<a name='7285'></font>
      do i = i_start, i_end<a name='7286'>
        a_rv(i,k-2,j_end+1) = a_rv(i,k-2,j_end+1)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7287'>
        a_rv(i,k-1,j_end+1) = a_rv(i,k-1,j_end+1)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7288'>
        a_w(i,k,j_end+1) = a_w(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_end+1)-fzp(k-1)*rv(i,k-2,j_end+1))<a name='7289'>
        a_w(i,k,j_end) = a_w(i,k,j_end)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_end+1)-fzp(k-1)*rv(i,k-2,j_end+1))<a name='7290'>
        a_fqy(i,k,jp1) = 0.<a name='7291'>
      end do<a name='7292'>
      do k = kts+1, ktf<a name='7293'>
        do i = i_start, i_end<a name='7294'>
          a_rv(i,k-1,j_end+1) = a_rv(i,k-1,j_end+1)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7295'>
          a_rv(i,k,j_end+1) = a_rv(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7296'>
          a_w(i,k,j_end+1) = a_w(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_end+1)+fzp(k)*rv(i,k-1,j_end+1))<a name='7297'>
          a_w(i,k,j_end) = a_w(i,k,j_end)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_end+1)+fzp(k)*rv(i,k-1,j_end+1))<a name='7298'>
          a_fqy(i,k,jp1) = 0.<a name='7299'>
        end do<a name='7300'>
      end do<a name='7301'>
    else<a name='7302'>
      k = ktf+1<a name='7303'>
<font color=#447700>! recompute : k<a name='7304'></font>
      do i = i_start, i_end<a name='7305'>
        a_vel = 0.<a name='7306'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='7307'>
<font color=#447700>! recompute : vel<a name='7308'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2)))<a name='7309'>
        a_w(i,k,j-2) = a_w(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='7310'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='7311'>
        a_w(i,k,j+1) = a_w(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='7312'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='7313'>
        a_fqy(i,k,jp1) = 0.<a name='7314'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='7315'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7316'>
        a_vel = 0.<a name='7317'>
      end do<a name='7318'>
      do k = kts+1, ktf<a name='7319'>
        a_vel = 0.<a name='7320'>
        do i = i_start, i_end<a name='7321'>
          a_vel = 0.<a name='7322'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='7323'>
<font color=#447700>! recompute : vel<a name='7324'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2)))<a name='7325'>
          a_w(i,k,j-2) = a_w(i,k,j-2)-0.083333333*a_fqy(i,k,jp1)*vel<a name='7326'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+0.58333333*a_fqy(i,k,jp1)*vel<a name='7327'>
          a_w(i,k,j+1) = a_w(i,k,j+1)-0.083333333*a_fqy(i,k,jp1)*vel<a name='7328'>
          a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqy(i,k,jp1)*vel<a name='7329'>
          a_fqy(i,k,jp1) = 0.<a name='7330'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='7331'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='7332'>
          a_vel = 0.<a name='7333'>
        end do<a name='7334'>
      end do<a name='7335'>
    endif<a name='7336'>
  end do<a name='7337'>
<font color=#447700>! recdepend vars : its<a name='7338'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4560<a name='7339'></font>
<font color=#447700>! recompute vars : i_start<a name='7340'></font>
  i_start = its<a name='7341'>
<font color=#447700>! recompute vars : i_start<a name='7342'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='7343'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4561<a name='7344'></font>
<font color=#447700>! recompute vars : i_end<a name='7345'></font>
  i_end = min(ite,ide-1)<a name='7346'>
<font color=#447700>! recompute vars : i_end<a name='7347'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='7348'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4562<a name='7349'></font>
<font color=#447700>! recompute vars : j_start<a name='7350'></font>
  j_start = jts<a name='7351'>
<font color=#447700>! recompute vars : j_start<a name='7352'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='7353'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4563<a name='7354'></font>
<font color=#447700>! recompute vars : j_end<a name='7355'></font>
  j_end = min(jte,jde-1)<a name='7356'>
<font color=#447700>! recompute vars : j_end<a name='7357'></font>
<font color=#447700>! recdepend vars : degrade_xs,i_end,i_start,ids,j_end,j_start<a name='7358'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4571<a name='7359'></font>
<font color=#447700>! recompute vars : i_start<a name='7360'></font>
  if (degrade_xs) then<a name='7361'>
    i_start = ids+1<a name='7362'>
  endif<a name='7363'>
<font color=#447700>! recompute vars : i_start<a name='7364'></font>
<font color=#447700>! recdepend vars : degrade_xe,i_end,i_start,ide,j_end,j_start<a name='7365'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4576<a name='7366'></font>
<font color=#447700>! recompute vars : i_end<a name='7367'></font>
  if (degrade_xe) then<a name='7368'>
    i_end = ide-2<a name='7369'>
  endif<a name='7370'>
<font color=#447700>! recompute vars : i_end<a name='7371'></font>
  do j = j_end, j_start, -1<a name='7372'>
    do k = kts+1, ktf+1<a name='7373'>
      do i = i_start, i_end<a name='7374'>
        mrdx = msft(i,j)*rdx<a name='7375'>
<font color=#447700>! recompute : mrdx<a name='7376'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='7377'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='7378'>
      end do<a name='7379'>
    end do<a name='7380'>
    if (degrade_xe) then<a name='7381'>
      k = ktf+1<a name='7382'>
<font color=#447700>! recompute : k<a name='7383'></font>
      a_ru(i_end+1,k-2,j) = a_ru(i_end+1,k-2,j)-0.5*a_fqx(i_end+1,k)*fzp(k-1)*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7384'>
      a_ru(i_end+1,k-1,j) = a_ru(i_end+1,k-1,j)+0.5*a_fqx(i_end+1,k)*(2-fzm(k-1))*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7385'>
      a_w(i_end+1,k,j) = a_w(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*((2.-fzm(k-1))*ru(i_end+1,k-1,j)-fzp(k-1)*ru(i_end+1,k-2,j))<a name='7386'>
      a_w(i_end,k,j) = a_w(i_end,k,j)+0.5*a_fqx(i_end+1,k)*((2.-fzm(k-1))*ru(i_end+1,k-1,j)-fzp(k-1)*ru(i_end+1,k-2,j))<a name='7387'>
      a_fqx(i_end+1,k) = 0.<a name='7388'>
      do k = kts+1, ktf<a name='7389'>
        a_ru(i_end+1,k-1,j) = a_ru(i_end+1,k-1,j)+0.5*a_fqx(i_end+1,k)*fzp(k)*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7390'>
        a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*fzm(k)*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7391'>
        a_w(i_end+1,k,j) = a_w(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*(fzm(k)*ru(i_end+1,k,j)+fzp(k)*ru(i_end+1,k-1,j))<a name='7392'>
        a_w(i_end,k,j) = a_w(i_end,k,j)+0.5*a_fqx(i_end+1,k)*(fzm(k)*ru(i_end+1,k,j)+fzp(k)*ru(i_end+1,k-1,j))<a name='7393'>
        a_fqx(i_end+1,k) = 0.<a name='7394'>
      end do<a name='7395'>
    endif<a name='7396'>
    if (degrade_xs) then<a name='7397'>
      k = ktf+1<a name='7398'>
<font color=#447700>! recompute : k<a name='7399'></font>
      a_ru(i_start,k-2,j) = a_ru(i_start,k-2,j)-0.5*a_fqx(i_start,k)*fzp(k-1)*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7400'>
      a_ru(i_start,k-1,j) = a_ru(i_start,k-1,j)+0.5*a_fqx(i_start,k)*(2-fzm(k-1))*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7401'>
      a_w(i_start-1,k,j) = a_w(i_start-1,k,j)+0.5*a_fqx(i_start,k)*((2.-fzm(k-1))*ru(i_start,k-1,j)-fzp(k-1)*ru(i_start,k-2,j))<a name='7402'>
      a_w(i_start,k,j) = a_w(i_start,k,j)+0.5*a_fqx(i_start,k)*((2.-fzm(k-1))*ru(i_start,k-1,j)-fzp(k-1)*ru(i_start,k-2,j))<a name='7403'>
      a_fqx(i_start,k) = 0.<a name='7404'>
      do k = kts+1, ktf<a name='7405'>
        a_ru(i_start,k-1,j) = a_ru(i_start,k-1,j)+0.5*a_fqx(i_start,k)*fzp(k)*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7406'>
        a_ru(i_start,k,j) = a_ru(i_start,k,j)+0.5*a_fqx(i_start,k)*fzm(k)*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7407'>
        a_w(i_start-1,k,j) = a_w(i_start-1,k,j)+0.5*a_fqx(i_start,k)*(fzm(k)*ru(i_start,k,j)+fzp(k)*ru(i_start,k-1,j))<a name='7408'>
        a_w(i_start,k,j) = a_w(i_start,k,j)+0.5*a_fqx(i_start,k)*(fzm(k)*ru(i_start,k,j)+fzp(k)*ru(i_start,k-1,j))<a name='7409'>
        a_fqx(i_start,k) = 0.<a name='7410'>
      end do<a name='7411'>
    endif<a name='7412'>
<font color=#447700>! recdepend vars : ktf<a name='7413'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4594<a name='7414'></font>
<font color=#447700>! recompute vars : k<a name='7415'></font>
    k = ktf+1<a name='7416'>
<font color=#447700>! recompute vars : k<a name='7417'></font>
    do i = i_start_f, i_end_f<a name='7418'>
      a_vel = 0.<a name='7419'>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='7420'>
<font color=#447700>! recompute : vel<a name='7421'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='7422'>
      a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='7423'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='7424'>
      a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='7425'>
      a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='7426'>
      a_fqx(i,k) = 0.<a name='7427'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='7428'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7429'>
      a_vel = 0.<a name='7430'>
    end do<a name='7431'>
    do k = kts+1, ktf<a name='7432'>
      a_vel = 0.<a name='7433'>
      do i = i_start_f, i_end_f<a name='7434'>
        a_vel = 0.<a name='7435'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='7436'>
<font color=#447700>! recompute : vel<a name='7437'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j)))<a name='7438'>
        a_w(i-2,k,j) = a_w(i-2,k,j)-0.083333333*a_fqx(i,k)*vel<a name='7439'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.58333333*a_fqx(i,k)*vel<a name='7440'>
        a_w(i+1,k,j) = a_w(i+1,k,j)-0.083333333*a_fqx(i,k)*vel<a name='7441'>
        a_w(i,k,j) = a_w(i,k,j)+0.58333333*a_fqx(i,k)*vel<a name='7442'>
        a_fqx(i,k) = 0.<a name='7443'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='7444'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='7445'>
        a_vel = 0.<a name='7446'>
      end do<a name='7447'>
    end do<a name='7448'>
  end do<a name='7449'>
else if (horz_order .eq. 3) then a_horizontal_order_test<a name='7450'>
  degrade_xs =  .true. <a name='7451'>
<font color=#447700>! recompute : degrade_xs<a name='7452'></font>
  degrade_xe =  .true. <a name='7453'>
<font color=#447700>! recompute : degrade_xe<a name='7454'></font>
  degrade_ys =  .true. <a name='7455'>
<font color=#447700>! recompute : degrade_ys<a name='7456'></font>
  degrade_ye =  .true. <a name='7457'>
<font color=#447700>! recompute : degrade_ye<a name='7458'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xs .or. its .gt. ids+1) then<a name='7459'>
    degrade_xs =  .false. <a name='7460'>
  endif<a name='7461'>
<font color=#447700>! recompute : degrade_xs<a name='7462'></font>
  if (config_flags%periodic_x .or. config_flags%symmetric_xe .or. ite .lt. ide-2) then<a name='7463'>
    degrade_xe =  .false. <a name='7464'>
  endif<a name='7465'>
<font color=#447700>! recompute : degrade_xe<a name='7466'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ys .or. jts .gt. jds+1) then<a name='7467'>
    degrade_ys =  .false. <a name='7468'>
  endif<a name='7469'>
<font color=#447700>! recompute : degrade_ys<a name='7470'></font>
  if (config_flags%periodic_y .or. config_flags%symmetric_ye .or. jte .lt. jde-2) then<a name='7471'>
    degrade_ye =  .false. <a name='7472'>
  endif<a name='7473'>
<font color=#447700>! recompute : degrade_ye<a name='7474'></font>
<font color=#447700>! recompute : ktf<a name='7475'></font>
  i_start = its<a name='7476'>
<font color=#447700>! recompute : i_start<a name='7477'></font>
  i_end = min(ite,ide-1)<a name='7478'>
<font color=#447700>! recompute : i_end<a name='7479'></font>
  i_start_f = i_start<a name='7480'>
<font color=#447700>! recompute : i_start_f<a name='7481'></font>
  i_end_f = i_end+1<a name='7482'>
<font color=#447700>! recompute : i_end_f<a name='7483'></font>
  if (degrade_xs) then<a name='7484'>
    i_start = ids+1<a name='7485'>
    i_start_f = i_start+1<a name='7486'>
  endif<a name='7487'>
<font color=#447700>! recompute : i_start_f<a name='7488'></font>
  if (degrade_xe) then<a name='7489'>
    i_end_f = ide-2<a name='7490'>
  endif<a name='7491'>
<font color=#447700>! recompute : i_end_f<a name='7492'></font>
  i_start = its<a name='7493'>
<font color=#447700>! recompute : i_start<a name='7494'></font>
  i_end = min(ite,ide-1)<a name='7495'>
<font color=#447700>! recompute : i_end<a name='7496'></font>
  j_start = jts<a name='7497'>
<font color=#447700>! recompute : j_start<a name='7498'></font>
  j_end = min(jte,jde-1)<a name='7499'>
<font color=#447700>! recompute : j_end<a name='7500'></font>
  j_start_f = j_start<a name='7501'>
<font color=#447700>! recompute : j_start_f<a name='7502'></font>
  j_end_f = j_end+1<a name='7503'>
<font color=#447700>! recompute : j_end_f<a name='7504'></font>
  if (degrade_ys) then<a name='7505'>
    j_start = jds+1<a name='7506'>
    j_start_f = j_start+1<a name='7507'>
  endif<a name='7508'>
<font color=#447700>! recompute : j_start,j_start_f<a name='7509'></font>
  if (degrade_ye) then<a name='7510'>
    j_end = jde-2<a name='7511'>
    j_end_f = jde-2<a name='7512'>
  endif<a name='7513'>
<font color=#447700>! recompute : j_end,j_end_f<a name='7514'></font>
  do j = j_end+1, j_start, -1<a name='7515'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4859<a name='7516'></font>
<font color=#447700>! recompute vars : jp1<a name='7517'></font>
    jp1 = 2<a name='7518'>
<font color=#447700>! recompute vars : jp1<a name='7519'></font>
<font color=#447700>! recdepend vars : jp1<a name='7520'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4860<a name='7521'></font>
<font color=#447700>! recompute vars : jp0<a name='7522'></font>
    jp0 = 1<a name='7523'>
<font color=#447700>! recompute vars : jp0<a name='7524'></font>
    do j3 = j_start, j-1<a name='7525'>
      jtmp = jp1<a name='7526'>
      jp1 = jp0<a name='7527'>
      jp0 = jtmp<a name='7528'>
    end do<a name='7529'>
<font color=#447700>!    if (j .gt. j_start) then<a name='7530'></font>
    if (j .gt. jds+1) then<a name='7531'>
      do k = kts+1, ktf+1<a name='7532'>
        do i = i_start, i_end<a name='7533'>
          mrdy = msft(i,j-1)*rdy<a name='7534'>
<font color=#447700>! recompute : mrdy<a name='7535'></font>
          a_fqy(i,k,jp0) = a_fqy(i,k,jp0)+a_tendency(i,k,j-1)*mrdy<a name='7536'>
          a_fqy(i,k,jp1) = a_fqy(i,k,jp1)-a_tendency(i,k,j-1)*mrdy<a name='7537'>
        end do<a name='7538'>
      end do<a name='7539'>
    endif<a name='7540'>
    if (j .lt. j_start_f .and. degrade_ys) then<a name='7541'>
      k = ktf+1<a name='7542'>
<font color=#447700>! recompute : k<a name='7543'></font>
      do i = i_start, i_end<a name='7544'>
        a_rv(i,k-2,j_start) = a_rv(i,k-2,j_start)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7545'>
        a_rv(i,k-1,j_start) = a_rv(i,k-1,j_start)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7546'>
        a_w(i,k,j_start-1) = a_w(i,k,j_start-1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_start)-fzp(k-1)*rv(i,k-2,j_start))<a name='7547'>
        a_w(i,k,j_start) = a_w(i,k,j_start)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_start)-fzp(k-1)*rv(i,k-2,j_start))<a name='7548'>
        a_fqy(i,k,jp1) = 0.<a name='7549'>
      end do<a name='7550'>
      do k = kts+1, ktf<a name='7551'>
        do i = i_start, i_end<a name='7552'>
          a_rv(i,k-1,j_start) = a_rv(i,k-1,j_start)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7553'>
          a_rv(i,k,j_start) = a_rv(i,k,j_start)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j_start)+w(i,k,j_start-1))<a name='7554'>
          a_w(i,k,j_start-1) = a_w(i,k,j_start-1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_start)+fzp(k)*rv(i,k-1,j_start))<a name='7555'>
          a_w(i,k,j_start) = a_w(i,k,j_start)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_start)+fzp(k)*rv(i,k-1,j_start))<a name='7556'>
          a_fqy(i,k,jp1) = 0.<a name='7557'>
        end do<a name='7558'>
      end do<a name='7559'>
    else if (j .gt. j_end_f .and. degrade_ye) then<a name='7560'>
      k = ktf+1<a name='7561'>
<font color=#447700>! recompute : k<a name='7562'></font>
      do i = i_start, i_end<a name='7563'>
        a_rv(i,k-2,j_end+1) = a_rv(i,k-2,j_end+1)-0.5*a_fqy(i,k,jp1)*fzp(k-1)*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7564'>
        a_rv(i,k-1,j_end+1) = a_rv(i,k-1,j_end+1)+0.5*a_fqy(i,k,jp1)*(2-fzm(k-1))*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7565'>
        a_w(i,k,j_end+1) = a_w(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_end+1)-fzp(k-1)*rv(i,k-2,j_end+1))<a name='7566'>
        a_w(i,k,j_end) = a_w(i,k,j_end)+0.5*a_fqy(i,k,jp1)*((2.-fzm(k-1))*rv(i,k-1,j_end+1)-fzp(k-1)*rv(i,k-2,j_end+1))<a name='7567'>
        a_fqy(i,k,jp1) = 0.<a name='7568'>
      end do<a name='7569'>
      do k = kts+1, ktf<a name='7570'>
        do i = i_start, i_end<a name='7571'>
          a_rv(i,k-1,j_end+1) = a_rv(i,k-1,j_end+1)+0.5*a_fqy(i,k,jp1)*fzp(k)*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7572'>
          a_rv(i,k,j_end+1) = a_rv(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*fzm(k)*(w(i,k,j_end+1)+w(i,k,j_end))<a name='7573'>
          a_w(i,k,j_end+1) = a_w(i,k,j_end+1)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_end+1)+fzp(k)*rv(i,k-1,j_end+1))<a name='7574'>
          a_w(i,k,j_end) = a_w(i,k,j_end)+0.5*a_fqy(i,k,jp1)*(fzm(k)*rv(i,k,j_end+1)+fzp(k)*rv(i,k-1,j_end+1))<a name='7575'>
          a_fqy(i,k,jp1) = 0.<a name='7576'>
        end do<a name='7577'>
      end do<a name='7578'>
    else<a name='7579'>
      k = ktf+1<a name='7580'>
<font color=#447700>! recompute : k<a name='7581'></font>
      do i = i_start, i_end<a name='7582'>
        a_vel = 0.<a name='7583'>
        vel = (2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j)<a name='7584'>
<font color=#447700>! recompute : vel<a name='7585'></font>
        a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2))+0.083333333*(w(i,k,j+1)-&amp;<a name='7586'>
&amp;w(i,k,j-2)-3.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7587'>
        a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7588'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7589'>
        a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7590'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7591'>
        a_fqy(i,k,jp1) = 0.<a name='7592'>
        a_rv(i,k-2,j) = a_rv(i,k-2,j)-a_vel*fzp(k-1)<a name='7593'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7594'>
        a_vel = 0.<a name='7595'>
      end do<a name='7596'>
      do k = kts+1, ktf<a name='7597'>
        a_vel = 0.<a name='7598'>
        do i = i_start, i_end<a name='7599'>
          a_vel = 0.<a name='7600'>
          vel = fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j)<a name='7601'>
<font color=#447700>! recompute : vel<a name='7602'></font>
          a_vel = a_vel+a_fqy(i,k,jp1)*(0.58333333*(w(i,k,j)+w(i,k,j-1))-0.083333333*(w(i,k,j+1)+w(i,k,j-2))+0.083333333*(w(i,k,j+&amp;<a name='7603'>
&amp;1)-w(i,k,j-2)-3.*(w(i,k,j)-w(i,k,j-1)))*sign(1.,vel))<a name='7604'>
          a_w(i,k,j-2) = a_w(i,k,j-2)+a_fqy(i,k,jp1)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7605'>
          a_w(i,k,j-1) = a_w(i,k,j-1)+a_fqy(i,k,jp1)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7606'>
          a_w(i,k,j+1) = a_w(i,k,j+1)+a_fqy(i,k,jp1)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7607'>
          a_w(i,k,j) = a_w(i,k,j)+a_fqy(i,k,jp1)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7608'>
          a_fqy(i,k,jp1) = 0.<a name='7609'>
          a_rv(i,k-1,j) = a_rv(i,k-1,j)+a_vel*fzp(k)<a name='7610'>
          a_rv(i,k,j) = a_rv(i,k,j)+a_vel*fzm(k)<a name='7611'>
          a_vel = 0.<a name='7612'>
        end do<a name='7613'>
      end do<a name='7614'>
    endif<a name='7615'>
  end do<a name='7616'>
<font color=#447700>! recdepend vars : its<a name='7617'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4757<a name='7618'></font>
<font color=#447700>! recompute vars : i_start<a name='7619'></font>
  i_start = its<a name='7620'>
<font color=#447700>! recompute vars : i_start<a name='7621'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='7622'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4758<a name='7623'></font>
<font color=#447700>! recompute vars : i_end<a name='7624'></font>
  i_end = min(ite,ide-1)<a name='7625'>
<font color=#447700>! recompute vars : i_end<a name='7626'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='7627'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4759<a name='7628'></font>
<font color=#447700>! recompute vars : j_start<a name='7629'></font>
  j_start = jts<a name='7630'>
<font color=#447700>! recompute vars : j_start<a name='7631'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='7632'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4760<a name='7633'></font>
<font color=#447700>! recompute vars : j_end<a name='7634'></font>
  j_end = min(jte,jde-1)<a name='7635'>
<font color=#447700>! recompute vars : j_end<a name='7636'></font>
<font color=#447700>! recdepend vars : degrade_xs,i_end,i_start,ids,j_end,j_start<a name='7637'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4768<a name='7638'></font>
<font color=#447700>! recompute vars : i_start<a name='7639'></font>
  if (degrade_xs) then<a name='7640'>
    i_start = ids+1<a name='7641'>
  endif<a name='7642'>
<font color=#447700>! recompute vars : i_start<a name='7643'></font>
<font color=#447700>! recdepend vars : degrade_xe,i_end,i_start,ide,j_end,j_start<a name='7644'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4773<a name='7645'></font>
<font color=#447700>! recompute vars : i_end<a name='7646'></font>
  if (degrade_xe) then<a name='7647'>
    i_end = ide-2<a name='7648'>
  endif<a name='7649'>
<font color=#447700>! recompute vars : i_end<a name='7650'></font>
  do j = j_end, j_start, -1<a name='7651'>
    do k = kts+1, ktf+1<a name='7652'>
      do i = i_start, i_end<a name='7653'>
        mrdx = msft(i,j)*rdx<a name='7654'>
<font color=#447700>! recompute : mrdx<a name='7655'></font>
        a_fqx(i+1,k) = a_fqx(i+1,k)-a_tendency(i,k,j)*mrdx<a name='7656'>
        a_fqx(i,k) = a_fqx(i,k)+a_tendency(i,k,j)*mrdx<a name='7657'>
      end do<a name='7658'>
    end do<a name='7659'>
    if (degrade_xe) then<a name='7660'>
      k = ktf+1<a name='7661'>
<font color=#447700>! recompute : k<a name='7662'></font>
      a_ru(i_end+1,k-2,j) = a_ru(i_end+1,k-2,j)-0.5*a_fqx(i_end+1,k)*fzp(k-1)*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7663'>
      a_ru(i_end+1,k-1,j) = a_ru(i_end+1,k-1,j)+0.5*a_fqx(i_end+1,k)*(2-fzm(k-1))*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7664'>
      a_w(i_end+1,k,j) = a_w(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*((2.-fzm(k-1))*ru(i_end+1,k-1,j)-fzp(k-1)*ru(i_end+1,k-2,j))<a name='7665'>
      a_w(i_end,k,j) = a_w(i_end,k,j)+0.5*a_fqx(i_end+1,k)*((2.-fzm(k-1))*ru(i_end+1,k-1,j)-fzp(k-1)*ru(i_end+1,k-2,j))<a name='7666'>
      a_fqx(i_end+1,k) = 0.<a name='7667'>
      do k = kts+1, ktf<a name='7668'>
        a_ru(i_end+1,k-1,j) = a_ru(i_end+1,k-1,j)+0.5*a_fqx(i_end+1,k)*fzp(k)*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7669'>
        a_ru(i_end+1,k,j) = a_ru(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*fzm(k)*(w(i_end+1,k,j)+w(i_end,k,j))<a name='7670'>
        a_w(i_end+1,k,j) = a_w(i_end+1,k,j)+0.5*a_fqx(i_end+1,k)*(fzm(k)*ru(i_end+1,k,j)+fzp(k)*ru(i_end+1,k-1,j))<a name='7671'>
        a_w(i_end,k,j) = a_w(i_end,k,j)+0.5*a_fqx(i_end+1,k)*(fzm(k)*ru(i_end+1,k,j)+fzp(k)*ru(i_end+1,k-1,j))<a name='7672'>
        a_fqx(i_end+1,k) = 0.<a name='7673'>
      end do<a name='7674'>
    endif<a name='7675'>
    if (degrade_xs) then<a name='7676'>
      k = ktf+1<a name='7677'>
<font color=#447700>! recompute : k<a name='7678'></font>
      a_ru(i_start,k-2,j) = a_ru(i_start,k-2,j)-0.5*a_fqx(i_start,k)*fzp(k-1)*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7679'>
      a_ru(i_start,k-1,j) = a_ru(i_start,k-1,j)+0.5*a_fqx(i_start,k)*(2-fzm(k-1))*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7680'>
      a_w(i_start-1,k,j) = a_w(i_start-1,k,j)+0.5*a_fqx(i_start,k)*((2.-fzm(k-1))*ru(i_start,k-1,j)-fzp(k-1)*ru(i_start,k-2,j))<a name='7681'>
      a_w(i_start,k,j) = a_w(i_start,k,j)+0.5*a_fqx(i_start,k)*((2.-fzm(k-1))*ru(i_start,k-1,j)-fzp(k-1)*ru(i_start,k-2,j))<a name='7682'>
      a_fqx(i_start,k) = 0.<a name='7683'>
      do k = kts+1, ktf<a name='7684'>
        a_ru(i_start,k-1,j) = a_ru(i_start,k-1,j)+0.5*a_fqx(i_start,k)*fzp(k)*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7685'>
        a_ru(i_start,k,j) = a_ru(i_start,k,j)+0.5*a_fqx(i_start,k)*fzm(k)*(w(i_start,k,j)+w(i_start-1,k,j))<a name='7686'>
        a_w(i_start-1,k,j) = a_w(i_start-1,k,j)+0.5*a_fqx(i_start,k)*(fzm(k)*ru(i_start,k,j)+fzp(k)*ru(i_start,k-1,j))<a name='7687'>
        a_w(i_start,k,j) = a_w(i_start,k,j)+0.5*a_fqx(i_start,k)*(fzm(k)*ru(i_start,k,j)+fzp(k)*ru(i_start,k-1,j))<a name='7688'>
        a_fqx(i_start,k) = 0.<a name='7689'>
      end do<a name='7690'>
    endif<a name='7691'>
<font color=#447700>! recdepend vars : ktf<a name='7692'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4790<a name='7693'></font>
<font color=#447700>! recompute vars : k<a name='7694'></font>
    k = ktf+1<a name='7695'>
<font color=#447700>! recompute vars : k<a name='7696'></font>
    do i = i_start_f, i_end_f<a name='7697'>
      a_vel = 0.<a name='7698'>
      vel = (2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j)<a name='7699'>
<font color=#447700>! recompute : vel<a name='7700'></font>
      a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j))+0.083333333*(w(i+1,k,j)-w(i-2,&amp;<a name='7701'>
&amp;k,j)-3.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='7702'>
      a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7703'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7704'>
      a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7705'>
      a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7706'>
      a_fqx(i,k) = 0.<a name='7707'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-a_vel*fzp(k-1)<a name='7708'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*(2-fzm(k-1))<a name='7709'>
      a_vel = 0.<a name='7710'>
    end do<a name='7711'>
    do k = kts+1, ktf<a name='7712'>
      a_vel = 0.<a name='7713'>
      do i = i_start_f, i_end_f<a name='7714'>
        a_vel = 0.<a name='7715'>
        vel = fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j)<a name='7716'>
<font color=#447700>! recompute : vel<a name='7717'></font>
        a_vel = a_vel+a_fqx(i,k)*(0.58333333*(w(i,k,j)+w(i-1,k,j))-0.083333333*(w(i+1,k,j)+w(i-2,k,j))+0.083333333*(w(i+1,k,j)-w(i-&amp;<a name='7718'>
&amp;2,k,j)-3.*(w(i,k,j)-w(i-1,k,j)))*sign(1.,vel))<a name='7719'>
        a_w(i-2,k,j) = a_w(i-2,k,j)+a_fqx(i,k)*vel*((-0.083333333)+(-0.083333333)*sign(1.,vel))<a name='7720'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+a_fqx(i,k)*vel*(0.58333333+0.25*sign(1.,vel))<a name='7721'>
        a_w(i+1,k,j) = a_w(i+1,k,j)+a_fqx(i,k)*vel*((-0.083333333)+0.083333333*sign(1.,vel))<a name='7722'>
        a_w(i,k,j) = a_w(i,k,j)+a_fqx(i,k)*vel*(0.58333333+(-0.25)*sign(1.,vel))<a name='7723'>
        a_fqx(i,k) = 0.<a name='7724'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+a_vel*fzp(k)<a name='7725'>
        a_ru(i,k,j) = a_ru(i,k,j)+a_vel*fzm(k)<a name='7726'>
        a_vel = 0.<a name='7727'>
      end do<a name='7728'>
    end do<a name='7729'>
  end do<a name='7730'>
else if (horz_order .eq. 2) then a_horizontal_order_test<a name='7731'>
  j_start = jts<a name='7732'>
<font color=#447700>! recompute : j_start<a name='7733'></font>
  j_end = min(jte,jde-1)<a name='7734'>
<font color=#447700>! recompute : j_end<a name='7735'></font>
  i_start = its<a name='7736'>
<font color=#447700>! recompute : i_start<a name='7737'></font>
  i_end = min(ite,ide-1)<a name='7738'>
<font color=#447700>! recompute : i_end<a name='7739'></font>
  if (config_flags%open_ys .or. specified) then<a name='7740'>
    j_start = max(jds+1,jts)<a name='7741'>
  endif<a name='7742'>
<font color=#447700>! recompute : j_start<a name='7743'></font>
  if (config_flags%open_ye .or. specified) then<a name='7744'>
    j_end = min(jde-2,jte)<a name='7745'>
  endif<a name='7746'>
<font color=#447700>! recompute : j_end<a name='7747'></font>
  do j = j_end, j_start, -1<a name='7748'>
    k = ktf+1<a name='7749'>
<font color=#447700>! recompute : k<a name='7750'></font>
    do i = i_start, i_end<a name='7751'>
      mrdy = msft(i,j)*rdy<a name='7752'>
<font color=#447700>! recompute : mrdy<a name='7753'></font>
      a_rv(i,k-2,j+1) = a_rv(i,k-2,j+1)+0.5*a_tendency(i,k,j)*mrdy*fzp(k-1)*(w(i,k,j+1)+w(i,k,j))<a name='7754'>
      a_rv(i,k-2,j) = a_rv(i,k-2,j)-0.5*a_tendency(i,k,j)*mrdy*fzp(k-1)*(w(i,k,j)+w(i,k,j-1))<a name='7755'>
      a_rv(i,k-1,j+1) = a_rv(i,k-1,j+1)-0.5*a_tendency(i,k,j)*mrdy*(2-fzm(k-1))*(w(i,k,j+1)+w(i,k,j))<a name='7756'>
      a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_tendency(i,k,j)*mrdy*(2-fzm(k-1))*(w(i,k,j)+w(i,k,j-1))<a name='7757'>
      a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_tendency(i,k,j)*mrdy*((2.-fzm(k-1))*rv(i,k-1,j)-fzp(k-1)*rv(i,k-2,j))<a name='7758'>
      a_w(i,k,j+1) = a_w(i,k,j+1)-0.5*a_tendency(i,k,j)*mrdy*((2.-fzm(k-1))*rv(i,k-1,j+1)-fzp(k-1)*rv(i,k-2,j+1))<a name='7759'>
      a_w(i,k,j) = a_w(i,k,j)-0.5*a_tendency(i,k,j)*mrdy*((2.-fzm(k-1))*rv(i,k-1,j+1)-fzp(k-1)*rv(i,k-2,j+1)-((2.-fzm(k-1))*rv(i,k-&amp;<a name='7760'>
&amp;1,j)-fzp(k-1)*rv(i,k-2,j)))<a name='7761'>
    end do<a name='7762'>
    do k = kts+1, ktf<a name='7763'>
      do i = i_start, i_end<a name='7764'>
        mrdy = msft(i,j)*rdy<a name='7765'>
<font color=#447700>! recompute : mrdy<a name='7766'></font>
        a_rv(i,k-1,j+1) = a_rv(i,k-1,j+1)-0.5*a_tendency(i,k,j)*mrdy*fzp(k)*(w(i,k,j+1)+w(i,k,j))<a name='7767'>
        a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.5*a_tendency(i,k,j)*mrdy*fzp(k)*(w(i,k,j)+w(i,k,j-1))<a name='7768'>
        a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.5*a_tendency(i,k,j)*mrdy*fzm(k)*(w(i,k,j+1)+w(i,k,j))<a name='7769'>
        a_rv(i,k,j) = a_rv(i,k,j)+0.5*a_tendency(i,k,j)*mrdy*fzm(k)*(w(i,k,j)+w(i,k,j-1))<a name='7770'>
        a_w(i,k,j-1) = a_w(i,k,j-1)+0.5*a_tendency(i,k,j)*mrdy*(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,k-1,j))<a name='7771'>
        a_w(i,k,j+1) = a_w(i,k,j+1)-0.5*a_tendency(i,k,j)*mrdy*(fzm(k)*rv(i,k,j+1)+fzp(k)*rv(i,k-1,j+1))<a name='7772'>
        a_w(i,k,j) = a_w(i,k,j)-0.5*a_tendency(i,k,j)*mrdy*(fzm(k)*rv(i,k,j+1)+fzp(k)*rv(i,k-1,j+1)-(fzm(k)*rv(i,k,j)+fzp(k)*rv(i,&amp;<a name='7773'>
&amp;k-1,j)))<a name='7774'>
      end do<a name='7775'>
    end do<a name='7776'>
  end do<a name='7777'>
<font color=#447700>! recdepend vars : its<a name='7778'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4929<a name='7779'></font>
<font color=#447700>! recompute vars : i_start<a name='7780'></font>
  i_start = its<a name='7781'>
<font color=#447700>! recompute vars : i_start<a name='7782'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='7783'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4930<a name='7784'></font>
<font color=#447700>! recompute vars : i_end<a name='7785'></font>
  i_end = min(ite,ide-1)<a name='7786'>
<font color=#447700>! recompute vars : i_end<a name='7787'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='7788'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4931<a name='7789'></font>
<font color=#447700>! recompute vars : j_start<a name='7790'></font>
  j_start = jts<a name='7791'>
<font color=#447700>! recompute vars : j_start<a name='7792'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='7793'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_advect_em.f90:4932<a name='7794'></font>
<font color=#447700>! recompute vars : j_end<a name='7795'></font>
  j_end = min(jte,jde-1)<a name='7796'>
<font color=#447700>! recompute vars : j_end<a name='7797'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,ids,its,j_end,j_start,spe<a name='7798'></font>
<font color=#447700>! cified<a name='7799'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4934<a name='7800'></font>
<font color=#447700>! recompute vars : i_start<a name='7801'></font>
  if (config_flags%open_xs .or. specified) then<a name='7802'>
    i_start = max(ids+1,its)<a name='7803'>
  endif<a name='7804'>
<font color=#447700>! recompute vars : i_start<a name='7805'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,ide,ite,j_end,j_start,spe<a name='7806'></font>
<font color=#447700>! cified<a name='7807'></font>
<font color=#447700>! recompute pos : IF_STMT module_advect_em.f90:4935<a name='7808'></font>
<font color=#447700>! recompute vars : i_end<a name='7809'></font>
  if (config_flags%open_xe .or. specified) then<a name='7810'>
    i_end = min(ide-2,ite)<a name='7811'>
  endif<a name='7812'>
<font color=#447700>! recompute vars : i_end<a name='7813'></font>
  do j = j_end, j_start, -1<a name='7814'>
    k = ktf+1<a name='7815'>
<font color=#447700>! recompute : k<a name='7816'></font>
    do i = i_start, i_end<a name='7817'>
      mrdx = msft(i,j)*rdx<a name='7818'>
<font color=#447700>! recompute : mrdx<a name='7819'></font>
      a_ru(i+1,k-2,j) = a_ru(i+1,k-2,j)+0.5*a_tendency(i,k,j)*mrdx*fzp(k-1)*(w(i+1,k,j)+w(i,k,j))<a name='7820'>
      a_ru(i,k-2,j) = a_ru(i,k-2,j)-0.5*a_tendency(i,k,j)*mrdx*fzp(k-1)*(w(i,k,j)+w(i-1,k,j))<a name='7821'>
      a_ru(i+1,k-1,j) = a_ru(i+1,k-1,j)-0.5*a_tendency(i,k,j)*mrdx*(2-fzm(k-1))*(w(i+1,k,j)+w(i,k,j))<a name='7822'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_tendency(i,k,j)*mrdx*(2-fzm(k-1))*(w(i,k,j)+w(i-1,k,j))<a name='7823'>
      a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_tendency(i,k,j)*mrdx*((2.-fzm(k-1))*ru(i,k-1,j)-fzp(k-1)*ru(i,k-2,j))<a name='7824'>
      a_w(i+1,k,j) = a_w(i+1,k,j)-0.5*a_tendency(i,k,j)*mrdx*((2.-fzm(k-1))*ru(i+1,k-1,j)-fzp(k-1)*ru(i+1,k-2,j))<a name='7825'>
      a_w(i,k,j) = a_w(i,k,j)-0.5*a_tendency(i,k,j)*mrdx*((2.-fzm(k-1))*ru(i+1,k-1,j)-fzp(k-1)*ru(i+1,k-2,j)-((2.-fzm(k-1))*ru(i,k-&amp;<a name='7826'>
&amp;1,j)-fzp(k-1)*ru(i,k-2,j)))<a name='7827'>
    end do<a name='7828'>
    do k = kts+1, ktf<a name='7829'>
      do i = i_start, i_end<a name='7830'>
        mrdx = msft(i,j)*rdx<a name='7831'>
<font color=#447700>! recompute : mrdx<a name='7832'></font>
        a_ru(i+1,k-1,j) = a_ru(i+1,k-1,j)-0.5*a_tendency(i,k,j)*mrdx*fzp(k)*(w(i+1,k,j)+w(i,k,j))<a name='7833'>
        a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_tendency(i,k,j)*mrdx*fzp(k)*(w(i,k,j)+w(i-1,k,j))<a name='7834'>
        a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.5*a_tendency(i,k,j)*mrdx*fzm(k)*(w(i+1,k,j)+w(i,k,j))<a name='7835'>
        a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_tendency(i,k,j)*mrdx*fzm(k)*(w(i,k,j)+w(i-1,k,j))<a name='7836'>
        a_w(i-1,k,j) = a_w(i-1,k,j)+0.5*a_tendency(i,k,j)*mrdx*(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,k-1,j))<a name='7837'>
        a_w(i+1,k,j) = a_w(i+1,k,j)-0.5*a_tendency(i,k,j)*mrdx*(fzm(k)*ru(i+1,k,j)+fzp(k)*ru(i+1,k-1,j))<a name='7838'>
        a_w(i,k,j) = a_w(i,k,j)-0.5*a_tendency(i,k,j)*mrdx*(fzm(k)*ru(i+1,k,j)+fzp(k)*ru(i+1,k-1,j)-(fzm(k)*ru(i,k,j)+fzp(k)*ru(i,&amp;<a name='7839'>
&amp;k-1,j)))<a name='7840'>
      end do<a name='7841'>
    end do<a name='7842'>
  end do<a name='7843'>
endif a_horizontal_order_test<a name='7844'>
<a name='7845'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_advect_em_ad.F.html#A_ADVECT_W' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_5">("a_advect_w")<a name='7846'>
<a name='7847'>
end subroutine a_advect_w<a name='7848'>
<a name='7849'>
<a name='7850'>
end module     a_module_advect_em<a name='7851'>
<a name='7852'>
<a name='7853'>
</pre></body></html>