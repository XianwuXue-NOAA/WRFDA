<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.18<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='G_MODULE_BC_EM'><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_MODULE_BC_EM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module     </font><font color=#cc0000>g_module_bc_em</font> <A href='../../call_to/G_MODULE_BC_EM.html' TARGET='index'>3</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#module_bc_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_8"><a name='35'>
use <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_MODULE_BC'>g_module_bc</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#module_bc_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_MODULE_BC_2"><a name='36'>
use <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#module_bc_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_6"><a name='37'>
use <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#module_bc_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_7"><a name='38'>
use <A href='../../html_code/dyn_em/module_bc_em.F.html#MODULE_BC_EM'>module_bc_em</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#module_bc_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_EM_2"><a name='39'>
<a name='40'>
USE <A href='../../html_code/frame/module_trace.F.html#MODULE_TRACE'>module_trace</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#module_bc_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_TRACE_5">, only : trace_entry, trace_exit<a name='41'>
<a name='42'>
<font color=#447700>!==============================================<a name='43'></font>
<font color=#447700>! all entries are defined explicitly<a name='44'></font>
<font color=#447700>!==============================================<a name='45'></font>
implicit none<a name='46'>
<a name='47'>
contains<a name='48'>
<a name='49'>
<A NAME='G_RELAX_BDY_DRY'><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='50'>
<font color=#993300>subroutine </font><font color=#cc0000>g_relax_bdy_dry</font>( config_flags, ru_tendf, g_ru_tendf, rv_tendf, g_rv_tendf, ph_tendf, g_ph_tendf, t_tendf, g_t_tendf, &amp; <A href='../../call_to/G_RELAX_BDY_DRY.html' TARGET='index'>3</A>,<A href='../../call_from/G_RELAX_BDY_DRY.html' TARGET='index'>8</A><a name='51'>
&amp;rw_tendf, g_rw_tendf, mu_tend, g_mu_tend, ru, g_ru, rv, g_rv, ph, g_ph, t, g_t, w, g_w, mu, g_mu, mut, g_mut, u_b, g_u_b, v_b, &amp;<a name='52'>
&amp;g_v_b, ph_b, g_ph_b, t_b, g_t_b, w_b, g_w_b, mu_b, g_mu_b, u_bt, g_u_bt, v_bt, g_v_bt, ph_bt, g_ph_bt, t_bt, g_t_bt, w_bt, g_w_bt,&amp;<a name='53'>
&amp; mu_bt, g_mu_bt, spec_bdy_width, spec_zone, relax_zone, dtbc, fcx, gcx, ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, &amp;<a name='54'>
&amp;jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='55'>
<font color=#447700>!******************************************************************<a name='56'></font>
<font color=#447700>!******************************************************************<a name='57'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='58'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='59'></font>
<font color=#447700>!******************************************************************<a name='60'></font>
<font color=#447700>!******************************************************************<a name='61'></font>
<font color=#447700>!==============================================<a name='62'></font>
<font color=#447700>! all entries are defined explicitly<a name='63'></font>
<font color=#447700>!==============================================<a name='64'></font>
implicit none<a name='65'>
<a name='66'>
<font color=#447700>!==============================================<a name='67'></font>
<font color=#447700>! declare arguments<a name='68'></font>
<font color=#447700>!==============================================<a name='69'></font>
type (grid_config_rec_type) config_flags<a name='70'>
real, intent(in) :: dtbc<a name='71'>
integer, intent(in) :: spec_bdy_width<a name='72'>
real, intent(in) :: fcx(spec_bdy_width)<a name='73'>
integer, intent(in) :: ime<a name='74'>
integer, intent(in) :: ims<a name='75'>
integer, intent(in) :: jme<a name='76'>
integer, intent(in) :: jms<a name='77'>
real, intent(in) :: g_mu(ims:ime,jms:jme)<a name='78'>
integer, intent(in) :: ijde<a name='79'>
integer, intent(in) :: ijds<a name='80'>
real, intent(in) :: g_mu_b(ijds:ijde,1:1,spec_bdy_width,4)<a name='81'>
real, intent(in) :: g_mu_bt(ijds:ijde,1:1,spec_bdy_width,4)<a name='82'>
real, intent(inout) :: g_mu_tend(ims:ime,jms:jme)<a name='83'>
real, intent(in) :: g_mut(ims:ime,jms:jme)<a name='84'>
integer, intent(in) :: kme<a name='85'>
integer, intent(in) :: kms<a name='86'>
real, intent(in) :: g_ph(ims:ime,kms:kme,jms:jme)<a name='87'>
integer, intent(in) :: kde<a name='88'>
integer, intent(in) :: kds<a name='89'>
real, intent(in) :: g_ph_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='90'>
real, intent(in) :: g_ph_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='91'>
real, intent(inout) :: g_ph_tendf(ims:ime,kms:kme,jms:jme)<a name='92'>
real, intent(in) :: g_ru(ims:ime,kms:kme,jms:jme)<a name='93'>
real, intent(inout) :: g_ru_tendf(ims:ime,kms:kme,jms:jme)<a name='94'>
real, intent(in) :: g_rv(ims:ime,kms:kme,jms:jme)<a name='95'>
real, intent(inout) :: g_rv_tendf(ims:ime,kms:kme,jms:jme)<a name='96'>
real, intent(inout) :: g_rw_tendf(ims:ime,kms:kme,jms:jme)<a name='97'>
real, intent(in) :: g_t(ims:ime,kms:kme,jms:jme)<a name='98'>
real, intent(in) :: g_t_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='99'>
real, intent(in) :: g_t_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='100'>
real, intent(inout) :: g_t_tendf(ims:ime,kms:kme,jms:jme)<a name='101'>
real, intent(in) :: g_u_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='102'>
real, intent(in) :: g_u_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='103'>
real, intent(in) :: g_v_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='104'>
real, intent(in) :: g_v_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='105'>
real, intent(in) :: g_w(ims:ime,kms:kme,jms:jme)<a name='106'>
real, intent(in) :: g_w_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='107'>
real, intent(in) :: g_w_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='108'>
real, intent(in) :: gcx(spec_bdy_width)<a name='109'>
integer, intent(in) :: ide<a name='110'>
integer, intent(in) :: ids<a name='111'>
integer, intent(in) :: ite<a name='112'>
integer, intent(in) :: its<a name='113'>
integer, intent(in) :: jde<a name='114'>
integer, intent(in) :: jds<a name='115'>
integer, intent(in) :: jte<a name='116'>
integer, intent(in) :: jts<a name='117'>
integer, intent(in) :: kte<a name='118'>
integer, intent(in) :: kts<a name='119'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='120'>
real, intent(in) :: mu_b(ijds:ijde,1:1,spec_bdy_width,4)<a name='121'>
real, intent(in) :: mu_bt(ijds:ijde,1:1,spec_bdy_width,4)<a name='122'>
real, intent(inout) :: mu_tend(ims:ime,jms:jme)<a name='123'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='124'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='125'>
real, intent(in) :: ph_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='126'>
real, intent(in) :: ph_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='127'>
real, intent(inout) :: ph_tendf(ims:ime,kms:kme,jms:jme)<a name='128'>
integer, intent(in) :: relax_zone<a name='129'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='130'>
real, intent(inout) :: ru_tendf(ims:ime,kms:kme,jms:jme)<a name='131'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='132'>
real, intent(inout) :: rv_tendf(ims:ime,kms:kme,jms:jme)<a name='133'>
real, intent(inout) :: rw_tendf(ims:ime,kms:kme,jms:jme)<a name='134'>
integer, intent(in) :: spec_zone<a name='135'>
real, intent(in) :: t(ims:ime,kms:kme,jms:jme)<a name='136'>
real, intent(in) :: t_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='137'>
real, intent(in) :: t_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='138'>
real, intent(inout) :: t_tendf(ims:ime,kms:kme,jms:jme)<a name='139'>
real, intent(in) :: u_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='140'>
real, intent(in) :: u_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='141'>
real, intent(in) :: v_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='142'>
real, intent(in) :: v_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='143'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='144'>
real, intent(in) :: w_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='145'>
real, intent(in) :: w_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='146'>
<a name='147'>
<font color=#447700>!==============================================<a name='148'></font>
<font color=#447700>! declare local variables<a name='149'></font>
<font color=#447700>!==============================================<a name='150'></font>
real g_rfield(ims:ime,kms:kme,jms:jme)<a name='151'>
integer i<a name='152'>
integer i_end<a name='153'>
integer i_start<a name='154'>
integer j<a name='155'>
integer j_end<a name='156'>
integer j_start<a name='157'>
integer k<a name='158'>
real rfield(ims:ime,kms:kme,jms:jme)<a name='159'>
<a name='160'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_14">("g_relax_bdy_dry")<a name='161'>
<a name='162'>
<font color=#447700>!----------------------------------------------<a name='163'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='164'></font>
<font color=#447700>!----------------------------------------------<a name='165'></font>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND'>g_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RELAX_BDYTEND_1">( ru,g_ru,ru_tendf,g_ru_tendf,u_b,g_u_b,u_bt,g_u_bt,'u',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,&amp;<a name='166'>
&amp;ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='167'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND'>g_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RELAX_BDYTEND_2">( rv,g_rv,rv_tendf,g_rv_tendf,v_b,g_v_b,v_bt,g_v_bt,'v',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,&amp;<a name='168'>
&amp;ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='169'>
i_start = max(its-1,ids)<a name='170'>
i_end = min(ite+1,ide-1)<a name='171'>
j_start = max(jts-1,jds)<a name='172'>
j_end = min(jte+1,jde-1)<a name='173'>
do j = j_start, j_end<a name='174'>
  do k = kts, kte<a name='175'>
    do i = i_start, i_end<a name='176'>
      g_rfield(i,k,j) = g_mut(i,j)*ph(i,k,j)+g_ph(i,k,j)*mut(i,j)<a name='177'>
      rfield(i,k,j) = ph(i,k,j)*mut(i,j)<a name='178'>
    end do<a name='179'>
  end do<a name='180'>
end do<a name='181'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND'>g_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RELAX_BDYTEND_3">( rfield,g_rfield,ph_tendf,g_ph_tendf,ph_b,g_ph_b,ph_bt,g_ph_bt,'h',spec_bdy_width,spec_zone,relax_zone,dtbc,&amp;<a name='182'>
&amp;fcx,gcx,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='183'>
do j = j_start, j_end<a name='184'>
  do k = kts, kte-1<a name='185'>
    do i = i_start, i_end<a name='186'>
      g_rfield(i,k,j) = g_mut(i,j)*t(i,k,j)+g_t(i,k,j)*mut(i,j)<a name='187'>
      rfield(i,k,j) = t(i,k,j)*mut(i,j)<a name='188'>
    end do<a name='189'>
  end do<a name='190'>
end do<a name='191'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND'>g_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RELAX_BDYTEND_4">( rfield,g_rfield,t_tendf,g_t_tendf,t_b,g_t_b,t_bt,g_t_bt,'t',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,&amp;<a name='192'>
&amp;ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='193'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND'>g_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RELAX_BDYTEND_5">( mu,g_mu,mu_tend,g_mu_tend,mu_b,g_mu_b,mu_bt,g_mu_bt,'m',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,&amp;<a name='194'>
&amp;ijds,ijde,ids,ide,jds,jde,1,1,ims,ime,jms,jme,1,1,its,ite,jts,jte,1,1 )<a name='195'>
if (config_flags%nested) then<a name='196'>
  i_start = max(its-1,ids)<a name='197'>
  i_end = min(ite+1,ide-1)<a name='198'>
  j_start = max(jts-1,jds)<a name='199'>
  j_end = min(jte+1,jde-1)<a name='200'>
  do j = j_start, j_end<a name='201'>
    do k = kts, kte<a name='202'>
      do i = i_start, i_end<a name='203'>
        g_rfield(i,k,j) = g_mut(i,j)*w(i,k,j)+g_w(i,k,j)*mut(i,j)<a name='204'>
        rfield(i,k,j) = w(i,k,j)*mut(i,j)<a name='205'>
      end do<a name='206'>
    end do<a name='207'>
  end do<a name='208'>
  call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND'>g_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RELAX_BDYTEND_6">( rfield,g_rfield,rw_tendf,g_rw_tendf,w_b,g_w_b,w_bt,g_w_bt,'h',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,&amp;<a name='209'>
&amp;gcx,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='210'>
endif<a name='211'>
<a name='212'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_14">("g_relax_bdy_dry")<a name='213'>
<a name='214'>
end subroutine g_relax_bdy_dry<a name='215'>
<a name='216'>
<a name='217'>
<A NAME='G_SPEC_BDY_DRY'><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='218'>
<font color=#993300>subroutine </font><font color=#cc0000>g_spec_bdy_dry</font>( config_flags, ru_tend, g_ru_tend, rv_tend, g_rv_tend, ph_tend, g_ph_tend, t_tend, g_t_tend, rw_tend, &amp; <A href='../../call_to/G_SPEC_BDY_DRY.html' TARGET='index'>3</A>,<A href='../../call_from/G_SPEC_BDY_DRY.html' TARGET='index'>8</A><a name='219'>
&amp;g_rw_tend, mu_tend, g_mu_tend, u_bt, g_u_bt, v_bt, g_v_bt, ph_bt, g_ph_bt, t_bt, g_t_bt, w_bt, g_w_bt, mu_bt, g_mu_bt, &amp;<a name='220'>
&amp;spec_bdy_width, spec_zone, ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='221'>
<font color=#447700>!******************************************************************<a name='222'></font>
<font color=#447700>!******************************************************************<a name='223'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='224'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='225'></font>
<font color=#447700>!******************************************************************<a name='226'></font>
<font color=#447700>!******************************************************************<a name='227'></font>
<font color=#447700>!==============================================<a name='228'></font>
<font color=#447700>! all entries are defined explicitly<a name='229'></font>
<font color=#447700>!==============================================<a name='230'></font>
implicit none<a name='231'>
<a name='232'>
<font color=#447700>!==============================================<a name='233'></font>
<font color=#447700>! declare arguments<a name='234'></font>
<font color=#447700>!==============================================<a name='235'></font>
type (grid_config_rec_type) config_flags<a name='236'>
integer, intent(in) :: ijde<a name='237'>
integer, intent(in) :: ijds<a name='238'>
integer, intent(in) :: spec_bdy_width<a name='239'>
real, intent(in) :: g_mu_bt(ijds:ijde,1:1,spec_bdy_width,4)<a name='240'>
integer, intent(in) :: ime<a name='241'>
integer, intent(in) :: ims<a name='242'>
integer, intent(in) :: jme<a name='243'>
integer, intent(in) :: jms<a name='244'>
real, intent(out) :: g_mu_tend(ims:ime,jms:jme)<a name='245'>
integer, intent(in) :: kde<a name='246'>
integer, intent(in) :: kds<a name='247'>
real, intent(in) :: g_ph_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='248'>
integer, intent(in) :: kme<a name='249'>
integer, intent(in) :: kms<a name='250'>
real, intent(out) :: g_ph_tend(ims:ime,kms:kme,jms:jme)<a name='251'>
real, intent(out) :: g_ru_tend(ims:ime,kms:kme,jms:jme)<a name='252'>
real, intent(out) :: g_rv_tend(ims:ime,kms:kme,jms:jme)<a name='253'>
real, intent(out) :: g_rw_tend(ims:ime,kms:kme,jms:jme)<a name='254'>
real, intent(in) :: g_t_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='255'>
real, intent(out) :: g_t_tend(ims:ime,kms:kme,jms:jme)<a name='256'>
real, intent(in) :: g_u_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='257'>
real, intent(in) :: g_v_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='258'>
real, intent(in) :: g_w_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='259'>
integer, intent(in) :: ide<a name='260'>
integer, intent(in) :: ids<a name='261'>
integer, intent(in) :: ite<a name='262'>
integer, intent(in) :: its<a name='263'>
integer, intent(in) :: jde<a name='264'>
integer, intent(in) :: jds<a name='265'>
integer, intent(in) :: jte<a name='266'>
integer, intent(in) :: jts<a name='267'>
integer, intent(in) :: kte<a name='268'>
integer, intent(in) :: kts<a name='269'>
real, intent(in) :: mu_bt(ijds:ijde,1:1,spec_bdy_width,4)<a name='270'>
real, intent(out) :: mu_tend(ims:ime,jms:jme)<a name='271'>
real, intent(in) :: ph_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='272'>
real, intent(out) :: ph_tend(ims:ime,kms:kme,jms:jme)<a name='273'>
real, intent(out) :: ru_tend(ims:ime,kms:kme,jms:jme)<a name='274'>
real, intent(out) :: rv_tend(ims:ime,kms:kme,jms:jme)<a name='275'>
real, intent(out) :: rw_tend(ims:ime,kms:kme,jms:jme)<a name='276'>
integer, intent(in) :: spec_zone<a name='277'>
real, intent(in) :: t_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='278'>
real, intent(out) :: t_tend(ims:ime,kms:kme,jms:jme)<a name='279'>
real, intent(in) :: u_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='280'>
real, intent(in) :: v_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='281'>
real, intent(in) :: w_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='282'>
<a name='283'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_15">("g_spec_bdy_dry")<a name='284'>
<a name='285'>
<font color=#447700>!----------------------------------------------<a name='286'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='287'></font>
<font color=#447700>!----------------------------------------------<a name='288'></font>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_1">( ru_tend,g_ru_tend,u_bt,g_u_bt,'u',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,&amp;<a name='289'>
&amp;kms,kme,its,ite,jts,jte,kts,kte )<a name='290'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_2">( rv_tend,g_rv_tend,v_bt,g_v_bt,'v',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,&amp;<a name='291'>
&amp;kms,kme,its,ite,jts,jte,kts,kte )<a name='292'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_3">( ph_tend,g_ph_tend,ph_bt,g_ph_bt,'h',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,&amp;<a name='293'>
&amp;jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='294'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_4">( t_tend,g_t_tend,t_bt,g_t_bt,'t',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,&amp;<a name='295'>
&amp;kms,kme,its,ite,jts,jte,kts,kte )<a name='296'>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_5">( mu_tend,g_mu_tend,mu_bt,g_mu_bt,'m',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,1,1,ims,ime,jms,jme,1,&amp;<a name='297'>
&amp;1,its,ite,jts,jte,1,1 )<a name='298'>
if (config_flags%nested) then<a name='299'>
  call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_6">( rw_tend,g_rw_tend,w_bt,g_w_bt,'h',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,&amp;<a name='300'>
&amp;jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='301'>
endif<a name='302'>
<a name='303'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_15">("g_spec_bdy_dry")<a name='304'>
<a name='305'>
end subroutine g_spec_bdy_dry<a name='306'>
<a name='307'>
<a name='308'>
<A NAME='G_SPEC_BDY_SCALAR'><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_SCALAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='309'>
<font color=#993300>subroutine </font><font color=#cc0000>g_spec_bdy_scalar</font>( scalar_tend, g_scalar_tend, scalar_bt, g_scalar_bt, spec_bdy_width, spec_zone, ijds, ijde, ids, ide, &amp; <A href='../../call_to/G_SPEC_BDY_SCALAR.html' TARGET='index'>8</A>,<A href='../../call_from/G_SPEC_BDY_SCALAR.html' TARGET='index'>3</A><a name='310'>
&amp;jds, jde, kds, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='311'>
<font color=#447700>!******************************************************************<a name='312'></font>
<font color=#447700>!******************************************************************<a name='313'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='314'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='315'></font>
<font color=#447700>!******************************************************************<a name='316'></font>
<font color=#447700>!******************************************************************<a name='317'></font>
<font color=#447700>!==============================================<a name='318'></font>
<font color=#447700>! all entries are defined explicitly<a name='319'></font>
<font color=#447700>!==============================================<a name='320'></font>
implicit none<a name='321'>
<a name='322'>
<font color=#447700>!==============================================<a name='323'></font>
<font color=#447700>! declare arguments<a name='324'></font>
<font color=#447700>!==============================================<a name='325'></font>
integer, intent(in) :: ijde<a name='326'>
integer, intent(in) :: ijds<a name='327'>
integer, intent(in) :: kde<a name='328'>
integer, intent(in) :: kds<a name='329'>
integer, intent(in) :: spec_bdy_width<a name='330'>
real, intent(in) :: g_scalar_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='331'>
integer, intent(in) :: ime<a name='332'>
integer, intent(in) :: ims<a name='333'>
integer, intent(in) :: jme<a name='334'>
integer, intent(in) :: jms<a name='335'>
integer, intent(in) :: kme<a name='336'>
integer, intent(in) :: kms<a name='337'>
real, intent(out) :: g_scalar_tend(ims:ime,kms:kme,jms:jme)<a name='338'>
integer, intent(in) :: ide<a name='339'>
integer, intent(in) :: ids<a name='340'>
integer, intent(in) :: ite<a name='341'>
integer, intent(in) :: its<a name='342'>
integer, intent(in) :: jde<a name='343'>
integer, intent(in) :: jds<a name='344'>
integer, intent(in) :: jte<a name='345'>
integer, intent(in) :: jts<a name='346'>
integer, intent(in) :: kte<a name='347'>
integer, intent(in) :: kts<a name='348'>
real, intent(in) :: scalar_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='349'>
real, intent(out) :: scalar_tend(ims:ime,kms:kme,jms:jme)<a name='350'>
integer, intent(in) :: spec_zone<a name='351'>
<a name='352'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_16">("g_spec_bdy_scalar")<a name='353'>
<a name='354'>
<font color=#447700>!----------------------------------------------<a name='355'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='356'></font>
<font color=#447700>!----------------------------------------------<a name='357'></font>
call <A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND'>g_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_SPEC_BDYTEND_7">( scalar_tend,g_scalar_tend,scalar_bt,g_scalar_bt,'q',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,&amp;<a name='358'>
&amp;kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='359'>
<a name='360'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_16">("g_spec_bdy_scalar")<a name='361'>
<a name='362'>
end subroutine g_spec_bdy_scalar<a name='363'>
<a name='364'>
<a name='365'>
<A NAME='G_SPEC_BDYUPDATE_PH'><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDYUPDATE_PH' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='366'>
<font color=#993300>subroutine </font><font color=#cc0000>g_spec_bdyupdate_ph</font>( ph_save, g_ph_save, field, g_field, field_tend, g_field_tend, mu_tend, g_mu_tend, muts, g_muts, dt,&amp; <A href='../../call_to/G_SPEC_BDYUPDATE_PH.html' TARGET='index'>3</A>,<A href='../../call_from/G_SPEC_BDYUPDATE_PH.html' TARGET='index'>2</A><a name='367'>
&amp; variable_in, spec_zone, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='368'>
<font color=#447700>!******************************************************************<a name='369'></font>
<font color=#447700>!******************************************************************<a name='370'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='371'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='372'></font>
<font color=#447700>!******************************************************************<a name='373'></font>
<font color=#447700>!******************************************************************<a name='374'></font>
<font color=#447700>!==============================================<a name='375'></font>
<font color=#447700>! all entries are defined explicitly<a name='376'></font>
<font color=#447700>!==============================================<a name='377'></font>
implicit none<a name='378'>
<a name='379'>
<font color=#447700>!==============================================<a name='380'></font>
<font color=#447700>! declare arguments<a name='381'></font>
<font color=#447700>!==============================================<a name='382'></font>
real, intent(in) :: dt<a name='383'>
integer, intent(in) :: ime<a name='384'>
integer, intent(in) :: ims<a name='385'>
integer, intent(in) :: jme<a name='386'>
integer, intent(in) :: jms<a name='387'>
integer, intent(in) :: kme<a name='388'>
integer, intent(in) :: kms<a name='389'>
real, intent(inout) :: field(ims:ime,kms:kme,jms:jme)<a name='390'>
real, intent(in) :: field_tend(ims:ime,kms:kme,jms:jme)<a name='391'>
real, intent(inout) :: g_field(ims:ime,kms:kme,jms:jme)<a name='392'>
real, intent(in) :: g_field_tend(ims:ime,kms:kme,jms:jme)<a name='393'>
real, intent(in) :: g_mu_tend(ims:ime,jms:jme)<a name='394'>
real, intent(in) :: g_muts(ims:ime,jms:jme)<a name='395'>
real, intent(in) :: g_ph_save(ims:ime,kms:kme,jms:jme)<a name='396'>
integer, intent(in) :: ide<a name='397'>
integer, intent(in) :: ids<a name='398'>
integer, intent(in) :: ite<a name='399'>
integer, intent(in) :: its<a name='400'>
integer, intent(in) :: jde<a name='401'>
integer, intent(in) :: jds<a name='402'>
integer, intent(in) :: jte<a name='403'>
integer, intent(in) :: jts<a name='404'>
integer, intent(in) :: kde<a name='405'>
integer, intent(in) :: kte<a name='406'>
integer, intent(in) :: kts<a name='407'>
real, intent(in) :: mu_tend(ims:ime,jms:jme)<a name='408'>
real, intent(in) :: muts(ims:ime,jms:jme)<a name='409'>
real, intent(in) :: ph_save(ims:ime,kms:kme,jms:jme)<a name='410'>
integer, intent(in) :: spec_zone<a name='411'>
character, intent(in) :: variable_in<a name='412'>
<a name='413'>
<font color=#447700>!==============================================<a name='414'></font>
<font color=#447700>! declare local variables<a name='415'></font>
<font color=#447700>!==============================================<a name='416'></font>
integer b_dist<a name='417'>
real g_mu_old(its:ite,jts:jte)<a name='418'>
integer i<a name='419'>
integer ibe<a name='420'>
integer ibs<a name='421'>
integer itf<a name='422'>
integer j<a name='423'>
integer jbe<a name='424'>
integer jbs<a name='425'>
integer jtf<a name='426'>
integer k<a name='427'>
integer ktf<a name='428'>
real mu_old(its:ite,jts:jte)<a name='429'>
character variable<a name='430'>
<a name='431'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDYUPDATE_PH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_17">("g_spec_bdyupdate_ph")<a name='432'>
<a name='433'>
<font color=#447700>!----------------------------------------------<a name='434'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='435'></font>
<font color=#447700>!----------------------------------------------<a name='436'></font>
variable = variable_in<a name='437'>
if (variable .eq. 'U') then<a name='438'>
  variable = 'u'<a name='439'>
endif<a name='440'>
if (variable .eq. 'V') then<a name='441'>
  variable = 'v'<a name='442'>
endif<a name='443'>
if (variable .eq. 'M') then<a name='444'>
  variable = 'm'<a name='445'>
endif<a name='446'>
if (variable .eq. 'H') then<a name='447'>
  variable = 'h'<a name='448'>
endif<a name='449'>
ibs = ids<a name='450'>
ibe = ide-1<a name='451'>
itf = min(ite,ide-1)<a name='452'>
jbs = jds<a name='453'>
jbe = jde-1<a name='454'>
jtf = min(jte,jde-1)<a name='455'>
ktf = kde-1<a name='456'>
if (variable .eq. 'u') then<a name='457'>
  ibe = ide<a name='458'>
endif<a name='459'>
if (variable .eq. 'u') then<a name='460'>
  itf = min(ite,ide)<a name='461'>
endif<a name='462'>
if (variable .eq. 'v') then<a name='463'>
  jbe = jde<a name='464'>
endif<a name='465'>
if (variable .eq. 'v') then<a name='466'>
  jtf = min(jte,jde)<a name='467'>
endif<a name='468'>
if (variable .eq. 'm') then<a name='469'>
  ktf = kte<a name='470'>
endif<a name='471'>
if (variable .eq. 'h') then<a name='472'>
  ktf = kte<a name='473'>
endif<a name='474'>
if (jts-jbs .lt. spec_zone) then<a name='475'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='476'>
    b_dist = j-jbs<a name='477'>
    do k = kts, ktf<a name='478'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='479'>
        g_mu_old(i,j) = (-(g_mu_tend(i,j)*dt))+g_muts(i,j)<a name='480'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='481'>
        g_field(i,k,j) = g_field(i,k,j)*(mu_old(i,j)/muts(i,j))+g_field_tend(i,k,j)*(dt/muts(i,j))+g_mu_old(i,j)*(field(i,k,j)/&amp;<a name='482'>
&amp;muts(i,j)+ph_save(i,k,j)/muts(i,j))+g_muts(i,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/&amp;<a name='483'>
&amp;(muts(i,j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))+g_ph_save(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='484'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='485'>
      end do<a name='486'>
    end do<a name='487'>
  end do<a name='488'>
endif<a name='489'>
if (jbe-jtf .lt. spec_zone) then<a name='490'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='491'>
    b_dist = jbe-j<a name='492'>
    do k = kts, ktf<a name='493'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='494'>
        g_mu_old(i,j) = (-(g_mu_tend(i,j)*dt))+g_muts(i,j)<a name='495'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='496'>
        g_field(i,k,j) = g_field(i,k,j)*(mu_old(i,j)/muts(i,j))+g_field_tend(i,k,j)*(dt/muts(i,j))+g_mu_old(i,j)*(field(i,k,j)/&amp;<a name='497'>
&amp;muts(i,j)+ph_save(i,k,j)/muts(i,j))+g_muts(i,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/&amp;<a name='498'>
&amp;(muts(i,j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))+g_ph_save(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='499'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='500'>
      end do<a name='501'>
    end do<a name='502'>
  end do<a name='503'>
endif<a name='504'>
if (its-ibs .lt. spec_zone) then<a name='505'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='506'>
    b_dist = i-ibs<a name='507'>
    do k = kts, ktf<a name='508'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='509'>
        g_mu_old(i,j) = (-(g_mu_tend(i,j)*dt))+g_muts(i,j)<a name='510'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='511'>
        g_field(i,k,j) = g_field(i,k,j)*(mu_old(i,j)/muts(i,j))+g_field_tend(i,k,j)*(dt/muts(i,j))+g_mu_old(i,j)*(field(i,k,j)/&amp;<a name='512'>
&amp;muts(i,j)+ph_save(i,k,j)/muts(i,j))+g_muts(i,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/&amp;<a name='513'>
&amp;(muts(i,j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))+g_ph_save(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='514'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='515'>
      end do<a name='516'>
    end do<a name='517'>
  end do<a name='518'>
endif<a name='519'>
if (ibe-itf .lt. spec_zone) then<a name='520'>
  do i = max(its,ibe-spec_zone+1), itf<a name='521'>
    b_dist = ibe-i<a name='522'>
    do k = kts, ktf<a name='523'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='524'>
        g_mu_old(i,j) = (-(g_mu_tend(i,j)*dt))+g_muts(i,j)<a name='525'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='526'>
        g_field(i,k,j) = g_field(i,k,j)*(mu_old(i,j)/muts(i,j))+g_field_tend(i,k,j)*(dt/muts(i,j))+g_mu_old(i,j)*(field(i,k,j)/&amp;<a name='527'>
&amp;muts(i,j)+ph_save(i,k,j)/muts(i,j))+g_muts(i,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/&amp;<a name='528'>
&amp;(muts(i,j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))+g_ph_save(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='529'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='530'>
      end do<a name='531'>
    end do<a name='532'>
  end do<a name='533'>
endif<a name='534'>
<a name='535'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_tl.F.html#G_SPEC_BDYUPDATE_PH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_17">("g_spec_bdyupdate_ph")<a name='536'>
<a name='537'>
end subroutine g_spec_bdyupdate_ph<a name='538'>
<a name='539'>
<a name='540'>
end module     g_module_bc_em<a name='541'>
<a name='542'>
<a name='543'>
</pre></body></html>