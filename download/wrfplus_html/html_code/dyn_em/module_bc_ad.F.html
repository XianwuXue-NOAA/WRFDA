<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.22<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='A_MODULE_BC'><A href='../../html_code/dyn_em/module_bc_ad.F.html#A_MODULE_BC' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module     </font><font color=#cc0000>a_module_bc</font> <A href='../../call_to/A_MODULE_BC.html' TARGET='index'>4</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_bc_ad.F.html#module_bc_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_3"><a name='35'>
use <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/dyn_em/module_bc_ad.F.html#module_bc_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_4"><a name='36'>
use <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_bc_ad.F.html#module_bc_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_5"><a name='37'>
<a name='38'>
<font color=#447700>!==============================================<a name='39'></font>
<font color=#447700>! all entries are defined explicitly<a name='40'></font>
<font color=#447700>!==============================================<a name='41'></font>
implicit none<a name='42'>
<a name='43'>
contains<a name='44'>
<A NAME='A_RELAX_BDYTEND'><A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='45'>
<font color=#993300>subroutine </font><font color=#cc0000>a_relax_bdytend</font>( a_field, a_field_tend, a_field_bdy, a_field_bdy_tend, variable_in, spec_bdy_width, spec_zone, &amp; <A href='../../call_to/A_RELAX_BDYTEND.html' TARGET='index'>6</A><a name='46'>
&amp;relax_zone, dtbc, fcx, gcx, ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='47'>
<font color=#447700>!******************************************************************<a name='48'></font>
<font color=#447700>!******************************************************************<a name='49'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='50'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='51'></font>
<font color=#447700>!******************************************************************<a name='52'></font>
<font color=#447700>!******************************************************************<a name='53'></font>
<font color=#447700>!==============================================<a name='54'></font>
<font color=#447700>! all entries are defined explicitly<a name='55'></font>
<font color=#447700>!==============================================<a name='56'></font>
implicit none<a name='57'>
<a name='58'>
<font color=#447700>!==============================================<a name='59'></font>
<font color=#447700>! declare arguments<a name='60'></font>
<font color=#447700>!==============================================<a name='61'></font>
integer, intent(in) :: ime<a name='62'>
integer, intent(in) :: ims<a name='63'>
integer, intent(in) :: jme<a name='64'>
integer, intent(in) :: jms<a name='65'>
integer, intent(in) :: kme<a name='66'>
integer, intent(in) :: kms<a name='67'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='68'>
integer, intent(in) :: ijde<a name='69'>
integer, intent(in) :: ijds<a name='70'>
integer, intent(in) :: kde<a name='71'>
integer, intent(in) :: kds<a name='72'>
integer, intent(in) :: spec_bdy_width<a name='73'>
real, intent(inout) :: a_field_bdy(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='74'>
real, intent(inout) :: a_field_bdy_tend(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='75'>
real, intent(inout) :: a_field_tend(ims:ime,kms:kme,jms:jme)<a name='76'>
real, intent(in) :: dtbc<a name='77'>
real, intent(in) :: fcx(spec_bdy_width)<a name='78'>
real, intent(in) :: gcx(spec_bdy_width)<a name='79'>
integer, intent(in) :: ide<a name='80'>
integer, intent(in) :: ids<a name='81'>
integer, intent(in) :: ite<a name='82'>
integer, intent(in) :: its<a name='83'>
integer, intent(in) :: jde<a name='84'>
integer, intent(in) :: jds<a name='85'>
integer, intent(in) :: jte<a name='86'>
integer, intent(in) :: jts<a name='87'>
integer, intent(in) :: kte<a name='88'>
integer, intent(in) :: kts<a name='89'>
integer, intent(in) :: relax_zone<a name='90'>
integer, intent(in) :: spec_zone<a name='91'>
character, intent(in) :: variable_in<a name='92'>
<a name='93'>
<font color=#447700>!==============================================<a name='94'></font>
<font color=#447700>! declare local variables<a name='95'></font>
<font color=#447700>!==============================================<a name='96'></font>
real a_fls0<a name='97'>
real a_fls1<a name='98'>
real a_fls2<a name='99'>
real a_fls3<a name='100'>
real a_fls4<a name='101'>
integer b_dist<a name='102'>
integer i<a name='103'>
integer ibe<a name='104'>
integer ibs<a name='105'>
integer itf<a name='106'>
integer j<a name='107'>
integer jbe<a name='108'>
integer jbs<a name='109'>
integer jtf<a name='110'>
integer k<a name='111'>
integer ktf<a name='112'>
character variable<a name='113'>
<a name='114'>
<font color=#447700>!----------------------------------------------<a name='115'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='116'></font>
<font color=#447700>!----------------------------------------------<a name='117'></font>
a_fls0 = 0.<a name='118'>
a_fls1 = 0.<a name='119'>
a_fls2 = 0.<a name='120'>
a_fls3 = 0.<a name='121'>
a_fls4 = 0.<a name='122'>
<a name='123'>
<font color=#447700>!----------------------------------------------<a name='124'></font>
<font color=#447700>! ROUTINE BODY<a name='125'></font>
<font color=#447700>!----------------------------------------------<a name='126'></font>
variable = variable_in<a name='127'>
<font color=#447700>! recompute : variable<a name='128'></font>
if (variable .eq. 'U') then<a name='129'>
  variable = 'u'<a name='130'>
endif<a name='131'>
<font color=#447700>! recompute : variable<a name='132'></font>
if (variable .eq. 'V') then<a name='133'>
  variable = 'v'<a name='134'>
endif<a name='135'>
<font color=#447700>! recompute : variable<a name='136'></font>
if (variable .eq. 'M') then<a name='137'>
  variable = 'm'<a name='138'>
endif<a name='139'>
<font color=#447700>! recompute : variable<a name='140'></font>
if (variable .eq. 'H') then<a name='141'>
  variable = 'h'<a name='142'>
endif<a name='143'>
<font color=#447700>! recompute : variable<a name='144'></font>
ibs = ids<a name='145'>
<font color=#447700>! recompute : ibs<a name='146'></font>
ibe = ide-1<a name='147'>
<font color=#447700>! recompute : ibe<a name='148'></font>
itf = min(ite,ide-1)<a name='149'>
<font color=#447700>! recompute : itf<a name='150'></font>
jbs = jds<a name='151'>
<font color=#447700>! recompute : jbs<a name='152'></font>
jbe = jde-1<a name='153'>
<font color=#447700>! recompute : jbe<a name='154'></font>
jtf = min(jte,jde-1)<a name='155'>
<font color=#447700>! recompute : jtf<a name='156'></font>
ktf = kde-1<a name='157'>
<font color=#447700>! recompute : ktf<a name='158'></font>
if (variable .eq. 'u') then<a name='159'>
  ibe = ide<a name='160'>
endif<a name='161'>
<font color=#447700>! recompute : ibe<a name='162'></font>
if (variable .eq. 'u') then<a name='163'>
  itf = min(ite,ide)<a name='164'>
endif<a name='165'>
<font color=#447700>! recompute : itf<a name='166'></font>
if (variable .eq. 'v') then<a name='167'>
  jbe = jde<a name='168'>
endif<a name='169'>
<font color=#447700>! recompute : jbe<a name='170'></font>
if (variable .eq. 'v') then<a name='171'>
  jtf = min(jte,jde)<a name='172'>
endif<a name='173'>
<font color=#447700>! recompute : jtf<a name='174'></font>
if (variable .eq. 'm') then<a name='175'>
  ktf = kte<a name='176'>
endif<a name='177'>
<font color=#447700>! recompute : ktf<a name='178'></font>
if (variable .eq. 'h') then<a name='179'>
  ktf = kte<a name='180'>
endif<a name='181'>
<font color=#447700>! recompute : ktf<a name='182'></font>
if (ibe-itf .lt. relax_zone) then<a name='183'>
  do i = max(its,ibe-relax_zone+1), min(itf,ibe-spec_zone)<a name='184'>
    a_fls0 = 0.<a name='185'>
    a_fls1 = 0.<a name='186'>
    a_fls2 = 0.<a name='187'>
    a_fls3 = 0.<a name='188'>
    a_fls4 = 0.<a name='189'>
    b_dist = ibe-i<a name='190'>
<font color=#447700>! recompute : b_dist<a name='191'></font>
    do k = kts, ktf<a name='192'>
      a_fls0 = 0.<a name='193'>
      a_fls1 = 0.<a name='194'>
      a_fls2 = 0.<a name='195'>
      a_fls3 = 0.<a name='196'>
      a_fls4 = 0.<a name='197'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='198'>
        a_fls0 = 0.<a name='199'>
        a_fls1 = 0.<a name='200'>
        a_fls2 = 0.<a name='201'>
        a_fls3 = 0.<a name='202'>
        a_fls4 = 0.<a name='203'>
        a_fls0 = a_fls0+a_field_tend(i,k,j)*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))<a name='204'>
        a_fls1 = a_fls1-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='205'>
        a_fls2 = a_fls2-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='206'>
        a_fls3 = a_fls3-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='207'>
        a_fls4 = a_fls4-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='208'>
        a_field(i-1,k,j) = a_field(i-1,k,j)-a_fls4<a name='209'>
        a_field_bdy(j,k,b_dist+2,p_xeb) = a_field_bdy(j,k,b_dist+2,p_xeb)+a_fls4<a name='210'>
        a_field_bdy_tend(j,k,b_dist+2,p_xeb) = a_field_bdy_tend(j,k,b_dist+2,p_xeb)+a_fls4*dtbc<a name='211'>
        a_fls4 = 0.<a name='212'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-a_fls3<a name='213'>
        a_field_bdy(j,k,b_dist,p_xeb) = a_field_bdy(j,k,b_dist,p_xeb)+a_fls3<a name='214'>
        a_field_bdy_tend(j,k,b_dist,p_xeb) = a_field_bdy_tend(j,k,b_dist,p_xeb)+a_fls3*dtbc<a name='215'>
        a_fls3 = 0.<a name='216'>
        a_field(i,k,j+1) = a_field(i,k,j+1)-a_fls2<a name='217'>
        a_field_bdy(j+1,k,b_dist+1,p_xeb) = a_field_bdy(j+1,k,b_dist+1,p_xeb)+a_fls2<a name='218'>
        a_field_bdy_tend(j+1,k,b_dist+1,p_xeb) = a_field_bdy_tend(j+1,k,b_dist+1,p_xeb)+a_fls2*dtbc<a name='219'>
        a_fls2 = 0.<a name='220'>
        a_field(i,k,j-1) = a_field(i,k,j-1)-a_fls1<a name='221'>
        a_field_bdy(j-1,k,b_dist+1,p_xeb) = a_field_bdy(j-1,k,b_dist+1,p_xeb)+a_fls1<a name='222'>
        a_field_bdy_tend(j-1,k,b_dist+1,p_xeb) = a_field_bdy_tend(j-1,k,b_dist+1,p_xeb)+a_fls1*dtbc<a name='223'>
        a_fls1 = 0.<a name='224'>
        a_field(i,k,j) = a_field(i,k,j)-a_fls0<a name='225'>
        a_field_bdy(j,k,b_dist+1,p_xeb) = a_field_bdy(j,k,b_dist+1,p_xeb)+a_fls0<a name='226'>
        a_field_bdy_tend(j,k,b_dist+1,p_xeb) = a_field_bdy_tend(j,k,b_dist+1,p_xeb)+a_fls0*dtbc<a name='227'>
        a_fls0 = 0.<a name='228'>
      end do<a name='229'>
    end do<a name='230'>
  end do<a name='231'>
endif<a name='232'>
if (its-ibs .lt. relax_zone) then<a name='233'>
  do i = max(its,ibs+spec_zone), min(itf,ibs+relax_zone-1)<a name='234'>
    a_fls0 = 0.<a name='235'>
    a_fls1 = 0.<a name='236'>
    a_fls2 = 0.<a name='237'>
    a_fls3 = 0.<a name='238'>
    a_fls4 = 0.<a name='239'>
    b_dist = i-ibs<a name='240'>
<font color=#447700>! recompute : b_dist<a name='241'></font>
    do k = kts, ktf<a name='242'>
      a_fls0 = 0.<a name='243'>
      a_fls1 = 0.<a name='244'>
      a_fls2 = 0.<a name='245'>
      a_fls3 = 0.<a name='246'>
      a_fls4 = 0.<a name='247'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='248'>
        a_fls0 = 0.<a name='249'>
        a_fls1 = 0.<a name='250'>
        a_fls2 = 0.<a name='251'>
        a_fls3 = 0.<a name='252'>
        a_fls4 = 0.<a name='253'>
        a_fls0 = a_fls0+a_field_tend(i,k,j)*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))<a name='254'>
        a_fls1 = a_fls1-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='255'>
        a_fls2 = a_fls2-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='256'>
        a_fls3 = a_fls3-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='257'>
        a_fls4 = a_fls4-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='258'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-a_fls4<a name='259'>
        a_field_bdy(j,k,b_dist+2,p_xsb) = a_field_bdy(j,k,b_dist+2,p_xsb)+a_fls4<a name='260'>
        a_field_bdy_tend(j,k,b_dist+2,p_xsb) = a_field_bdy_tend(j,k,b_dist+2,p_xsb)+a_fls4*dtbc<a name='261'>
        a_fls4 = 0.<a name='262'>
        a_field(i-1,k,j) = a_field(i-1,k,j)-a_fls3<a name='263'>
        a_field_bdy(j,k,b_dist,p_xsb) = a_field_bdy(j,k,b_dist,p_xsb)+a_fls3<a name='264'>
        a_field_bdy_tend(j,k,b_dist,p_xsb) = a_field_bdy_tend(j,k,b_dist,p_xsb)+a_fls3*dtbc<a name='265'>
        a_fls3 = 0.<a name='266'>
        a_field(i,k,j+1) = a_field(i,k,j+1)-a_fls2<a name='267'>
        a_field_bdy(j+1,k,b_dist+1,p_xsb) = a_field_bdy(j+1,k,b_dist+1,p_xsb)+a_fls2<a name='268'>
        a_field_bdy_tend(j+1,k,b_dist+1,p_xsb) = a_field_bdy_tend(j+1,k,b_dist+1,p_xsb)+a_fls2*dtbc<a name='269'>
        a_fls2 = 0.<a name='270'>
        a_field(i,k,j-1) = a_field(i,k,j-1)-a_fls1<a name='271'>
        a_field_bdy(j-1,k,b_dist+1,p_xsb) = a_field_bdy(j-1,k,b_dist+1,p_xsb)+a_fls1<a name='272'>
        a_field_bdy_tend(j-1,k,b_dist+1,p_xsb) = a_field_bdy_tend(j-1,k,b_dist+1,p_xsb)+a_fls1*dtbc<a name='273'>
        a_fls1 = 0.<a name='274'>
        a_field(i,k,j) = a_field(i,k,j)-a_fls0<a name='275'>
        a_field_bdy(j,k,b_dist+1,p_xsb) = a_field_bdy(j,k,b_dist+1,p_xsb)+a_fls0<a name='276'>
        a_field_bdy_tend(j,k,b_dist+1,p_xsb) = a_field_bdy_tend(j,k,b_dist+1,p_xsb)+a_fls0*dtbc<a name='277'>
        a_fls0 = 0.<a name='278'>
      end do<a name='279'>
    end do<a name='280'>
  end do<a name='281'>
endif<a name='282'>
if (jbe-jtf .lt. relax_zone) then<a name='283'>
  do j = max(jts,jbe-relax_zone+1), min(jtf,jbe-spec_zone)<a name='284'>
    a_fls0 = 0.<a name='285'>
    a_fls1 = 0.<a name='286'>
    a_fls2 = 0.<a name='287'>
    a_fls3 = 0.<a name='288'>
    a_fls4 = 0.<a name='289'>
    b_dist = jbe-j<a name='290'>
<font color=#447700>! recompute : b_dist<a name='291'></font>
    do k = kts, ktf<a name='292'>
      a_fls0 = 0.<a name='293'>
      a_fls1 = 0.<a name='294'>
      a_fls2 = 0.<a name='295'>
      a_fls3 = 0.<a name='296'>
      a_fls4 = 0.<a name='297'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='298'>
        a_fls0 = 0.<a name='299'>
        a_fls1 = 0.<a name='300'>
        a_fls2 = 0.<a name='301'>
        a_fls3 = 0.<a name='302'>
        a_fls4 = 0.<a name='303'>
        a_fls0 = a_fls0+a_field_tend(i,k,j)*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))<a name='304'>
        a_fls1 = a_fls1-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='305'>
        a_fls2 = a_fls2-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='306'>
        a_fls3 = a_fls3-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='307'>
        a_fls4 = a_fls4-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='308'>
        a_field(i,k,j-1) = a_field(i,k,j-1)-a_fls4<a name='309'>
        a_field_bdy(i,k,b_dist+2,p_yeb) = a_field_bdy(i,k,b_dist+2,p_yeb)+a_fls4<a name='310'>
        a_field_bdy_tend(i,k,b_dist+2,p_yeb) = a_field_bdy_tend(i,k,b_dist+2,p_yeb)+a_fls4*dtbc<a name='311'>
        a_fls4 = 0.<a name='312'>
        a_field(i,k,j+1) = a_field(i,k,j+1)-a_fls3<a name='313'>
        a_field_bdy(i,k,b_dist,p_yeb) = a_field_bdy(i,k,b_dist,p_yeb)+a_fls3<a name='314'>
        a_field_bdy_tend(i,k,b_dist,p_yeb) = a_field_bdy_tend(i,k,b_dist,p_yeb)+a_fls3*dtbc<a name='315'>
        a_fls3 = 0.<a name='316'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-a_fls2<a name='317'>
        a_field_bdy(i+1,k,b_dist+1,p_yeb) = a_field_bdy(i+1,k,b_dist+1,p_yeb)+a_fls2<a name='318'>
        a_field_bdy_tend(i+1,k,b_dist+1,p_yeb) = a_field_bdy_tend(i+1,k,b_dist+1,p_yeb)+a_fls2*dtbc<a name='319'>
        a_fls2 = 0.<a name='320'>
        a_field(i-1,k,j) = a_field(i-1,k,j)-a_fls1<a name='321'>
        a_field_bdy(i-1,k,b_dist+1,p_yeb) = a_field_bdy(i-1,k,b_dist+1,p_yeb)+a_fls1<a name='322'>
        a_field_bdy_tend(i-1,k,b_dist+1,p_yeb) = a_field_bdy_tend(i-1,k,b_dist+1,p_yeb)+a_fls1*dtbc<a name='323'>
        a_fls1 = 0.<a name='324'>
        a_field(i,k,j) = a_field(i,k,j)-a_fls0<a name='325'>
        a_field_bdy(i,k,b_dist+1,p_yeb) = a_field_bdy(i,k,b_dist+1,p_yeb)+a_fls0<a name='326'>
        a_field_bdy_tend(i,k,b_dist+1,p_yeb) = a_field_bdy_tend(i,k,b_dist+1,p_yeb)+a_fls0*dtbc<a name='327'>
        a_fls0 = 0.<a name='328'>
      end do<a name='329'>
    end do<a name='330'>
  end do<a name='331'>
endif<a name='332'>
if (jts-jbs .lt. relax_zone) then<a name='333'>
  do j = max(jts,jbs+spec_zone), min(jtf,jbs+relax_zone-1)<a name='334'>
    a_fls0 = 0.<a name='335'>
    a_fls1 = 0.<a name='336'>
    a_fls2 = 0.<a name='337'>
    a_fls3 = 0.<a name='338'>
    a_fls4 = 0.<a name='339'>
    b_dist = j-jbs<a name='340'>
<font color=#447700>! recompute : b_dist<a name='341'></font>
    do k = kts, ktf<a name='342'>
      a_fls0 = 0.<a name='343'>
      a_fls1 = 0.<a name='344'>
      a_fls2 = 0.<a name='345'>
      a_fls3 = 0.<a name='346'>
      a_fls4 = 0.<a name='347'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='348'>
        a_fls0 = 0.<a name='349'>
        a_fls1 = 0.<a name='350'>
        a_fls2 = 0.<a name='351'>
        a_fls3 = 0.<a name='352'>
        a_fls4 = 0.<a name='353'>
        a_fls0 = a_fls0+a_field_tend(i,k,j)*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))<a name='354'>
        a_fls1 = a_fls1-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='355'>
        a_fls2 = a_fls2-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='356'>
        a_fls3 = a_fls3-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='357'>
        a_fls4 = a_fls4-a_field_tend(i,k,j)*gcx(b_dist+1)<a name='358'>
        a_field(i,k,j+1) = a_field(i,k,j+1)-a_fls4<a name='359'>
        a_field_bdy(i,k,b_dist+2,p_ysb) = a_field_bdy(i,k,b_dist+2,p_ysb)+a_fls4<a name='360'>
        a_field_bdy_tend(i,k,b_dist+2,p_ysb) = a_field_bdy_tend(i,k,b_dist+2,p_ysb)+a_fls4*dtbc<a name='361'>
        a_fls4 = 0.<a name='362'>
        a_field(i,k,j-1) = a_field(i,k,j-1)-a_fls3<a name='363'>
        a_field_bdy(i,k,b_dist,p_ysb) = a_field_bdy(i,k,b_dist,p_ysb)+a_fls3<a name='364'>
        a_field_bdy_tend(i,k,b_dist,p_ysb) = a_field_bdy_tend(i,k,b_dist,p_ysb)+a_fls3*dtbc<a name='365'>
        a_fls3 = 0.<a name='366'>
        a_field(i+1,k,j) = a_field(i+1,k,j)-a_fls2<a name='367'>
        a_field_bdy(i+1,k,b_dist+1,p_ysb) = a_field_bdy(i+1,k,b_dist+1,p_ysb)+a_fls2<a name='368'>
        a_field_bdy_tend(i+1,k,b_dist+1,p_ysb) = a_field_bdy_tend(i+1,k,b_dist+1,p_ysb)+a_fls2*dtbc<a name='369'>
        a_fls2 = 0.<a name='370'>
        a_field(i-1,k,j) = a_field(i-1,k,j)-a_fls1<a name='371'>
        a_field_bdy(i-1,k,b_dist+1,p_ysb) = a_field_bdy(i-1,k,b_dist+1,p_ysb)+a_fls1<a name='372'>
        a_field_bdy_tend(i-1,k,b_dist+1,p_ysb) = a_field_bdy_tend(i-1,k,b_dist+1,p_ysb)+a_fls1*dtbc<a name='373'>
        a_fls1 = 0.<a name='374'>
        a_field(i,k,j) = a_field(i,k,j)-a_fls0<a name='375'>
        a_field_bdy(i,k,b_dist+1,p_ysb) = a_field_bdy(i,k,b_dist+1,p_ysb)+a_fls0<a name='376'>
        a_field_bdy_tend(i,k,b_dist+1,p_ysb) = a_field_bdy_tend(i,k,b_dist+1,p_ysb)+a_fls0*dtbc<a name='377'>
        a_fls0 = 0.<a name='378'>
      end do<a name='379'>
    end do<a name='380'>
  end do<a name='381'>
endif<a name='382'>
<a name='383'>
end subroutine a_relax_bdytend<a name='384'>
<a name='385'>
<a name='386'>
<A NAME='A_SPEC_BDYTEND'><A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='387'>
<font color=#993300>subroutine </font><font color=#cc0000>a_spec_bdytend</font>( a_field_tend, a_field_bdy_tend, variable_in, spec_bdy_width, spec_zone, ijds, ijde, ids, ide, jds, jde, &amp; <A href='../../call_to/A_SPEC_BDYTEND.html' TARGET='index'>7</A><a name='388'>
&amp;kds, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='389'>
<font color=#447700>!******************************************************************<a name='390'></font>
<font color=#447700>!******************************************************************<a name='391'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='392'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='393'></font>
<font color=#447700>!******************************************************************<a name='394'></font>
<font color=#447700>!******************************************************************<a name='395'></font>
<font color=#447700>!==============================================<a name='396'></font>
<font color=#447700>! all entries are defined explicitly<a name='397'></font>
<font color=#447700>!==============================================<a name='398'></font>
implicit none<a name='399'>
<a name='400'>
<font color=#447700>!==============================================<a name='401'></font>
<font color=#447700>! declare arguments<a name='402'></font>
<font color=#447700>!==============================================<a name='403'></font>
integer, intent(in) :: ijde<a name='404'>
integer, intent(in) :: ijds<a name='405'>
integer, intent(in) :: kde<a name='406'>
integer, intent(in) :: kds<a name='407'>
integer, intent(in) :: spec_bdy_width<a name='408'>
real, intent(inout) :: a_field_bdy_tend(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='409'>
integer, intent(in) :: ime<a name='410'>
integer, intent(in) :: ims<a name='411'>
integer, intent(in) :: jme<a name='412'>
integer, intent(in) :: jms<a name='413'>
integer, intent(in) :: kme<a name='414'>
integer, intent(in) :: kms<a name='415'>
real, intent(inout) :: a_field_tend(ims:ime,kms:kme,jms:jme)<a name='416'>
integer, intent(in) :: ide<a name='417'>
integer, intent(in) :: ids<a name='418'>
integer, intent(in) :: ite<a name='419'>
integer, intent(in) :: its<a name='420'>
integer, intent(in) :: jde<a name='421'>
integer, intent(in) :: jds<a name='422'>
integer, intent(in) :: jte<a name='423'>
integer, intent(in) :: jts<a name='424'>
integer, intent(in) :: kte<a name='425'>
integer, intent(in) :: kts<a name='426'>
integer, intent(in) :: spec_zone<a name='427'>
character, intent(in) :: variable_in<a name='428'>
<a name='429'>
<font color=#447700>!==============================================<a name='430'></font>
<font color=#447700>! declare local variables<a name='431'></font>
<font color=#447700>!==============================================<a name='432'></font>
integer b_dist<a name='433'>
integer i<a name='434'>
integer ibe<a name='435'>
integer ibs<a name='436'>
integer itf<a name='437'>
integer j<a name='438'>
integer jbe<a name='439'>
integer jbs<a name='440'>
integer jtf<a name='441'>
integer k<a name='442'>
integer ktf<a name='443'>
character variable<a name='444'>
<a name='445'>
<font color=#447700>!----------------------------------------------<a name='446'></font>
<font color=#447700>! ROUTINE BODY<a name='447'></font>
<font color=#447700>!----------------------------------------------<a name='448'></font>
variable = variable_in<a name='449'>
<font color=#447700>! recompute : variable<a name='450'></font>
if (variable .eq. 'U') then<a name='451'>
  variable = 'u'<a name='452'>
endif<a name='453'>
<font color=#447700>! recompute : variable<a name='454'></font>
if (variable .eq. 'V') then<a name='455'>
  variable = 'v'<a name='456'>
endif<a name='457'>
<font color=#447700>! recompute : variable<a name='458'></font>
if (variable .eq. 'M') then<a name='459'>
  variable = 'm'<a name='460'>
endif<a name='461'>
<font color=#447700>! recompute : variable<a name='462'></font>
if (variable .eq. 'H') then<a name='463'>
  variable = 'h'<a name='464'>
endif<a name='465'>
<font color=#447700>! recompute : variable<a name='466'></font>
ibs = ids<a name='467'>
<font color=#447700>! recompute : ibs<a name='468'></font>
ibe = ide-1<a name='469'>
<font color=#447700>! recompute : ibe<a name='470'></font>
itf = min(ite,ide-1)<a name='471'>
<font color=#447700>! recompute : itf<a name='472'></font>
jbs = jds<a name='473'>
<font color=#447700>! recompute : jbs<a name='474'></font>
jbe = jde-1<a name='475'>
<font color=#447700>! recompute : jbe<a name='476'></font>
jtf = min(jte,jde-1)<a name='477'>
<font color=#447700>! recompute : jtf<a name='478'></font>
ktf = kde-1<a name='479'>
<font color=#447700>! recompute : ktf<a name='480'></font>
if (variable .eq. 'u') then<a name='481'>
  ibe = ide<a name='482'>
endif<a name='483'>
<font color=#447700>! recompute : ibe<a name='484'></font>
if (variable .eq. 'u') then<a name='485'>
  itf = min(ite,ide)<a name='486'>
endif<a name='487'>
<font color=#447700>! recompute : itf<a name='488'></font>
if (variable .eq. 'v') then<a name='489'>
  jbe = jde<a name='490'>
endif<a name='491'>
<font color=#447700>! recompute : jbe<a name='492'></font>
if (variable .eq. 'v') then<a name='493'>
  jtf = min(jte,jde)<a name='494'>
endif<a name='495'>
<font color=#447700>! recompute : jtf<a name='496'></font>
if (variable .eq. 'm') then<a name='497'>
  ktf = kte<a name='498'>
endif<a name='499'>
<font color=#447700>! recompute : ktf<a name='500'></font>
if (variable .eq. 'h') then<a name='501'>
  ktf = kte<a name='502'>
endif<a name='503'>
<font color=#447700>! recompute : ktf<a name='504'></font>
if (ibe-itf .lt. spec_zone) then<a name='505'>
  do i = max(its,ibe-spec_zone+1), itf<a name='506'>
    b_dist = ibe-i<a name='507'>
<font color=#447700>! recompute : b_dist<a name='508'></font>
    do k = kts, ktf<a name='509'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='510'>
        a_field_bdy_tend(j,k,b_dist+1,p_xeb) = a_field_bdy_tend(j,k,b_dist+1,p_xeb)+a_field_tend(i,k,j)<a name='511'>
        a_field_tend(i,k,j) = 0.<a name='512'>
      end do<a name='513'>
    end do<a name='514'>
  end do<a name='515'>
endif<a name='516'>
if (its-ibs .lt. spec_zone) then<a name='517'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='518'>
    b_dist = i-ibs<a name='519'>
<font color=#447700>! recompute : b_dist<a name='520'></font>
    do k = kts, ktf<a name='521'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='522'>
        a_field_bdy_tend(j,k,b_dist+1,p_xsb) = a_field_bdy_tend(j,k,b_dist+1,p_xsb)+a_field_tend(i,k,j)<a name='523'>
        a_field_tend(i,k,j) = 0.<a name='524'>
      end do<a name='525'>
    end do<a name='526'>
  end do<a name='527'>
endif<a name='528'>
if (jbe-jtf .lt. spec_zone) then<a name='529'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='530'>
    b_dist = jbe-j<a name='531'>
<font color=#447700>! recompute : b_dist<a name='532'></font>
    do k = kts, ktf<a name='533'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='534'>
        a_field_bdy_tend(i,k,b_dist+1,p_yeb) = a_field_bdy_tend(i,k,b_dist+1,p_yeb)+a_field_tend(i,k,j)<a name='535'>
        a_field_tend(i,k,j) = 0.<a name='536'>
      end do<a name='537'>
    end do<a name='538'>
  end do<a name='539'>
endif<a name='540'>
if (jts-jbs .lt. spec_zone) then<a name='541'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='542'>
    b_dist = j-jbs<a name='543'>
<font color=#447700>! recompute : b_dist<a name='544'></font>
    do k = kts, ktf<a name='545'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='546'>
        a_field_bdy_tend(i,k,b_dist+1,p_ysb) = a_field_bdy_tend(i,k,b_dist+1,p_ysb)+a_field_tend(i,k,j)<a name='547'>
        a_field_tend(i,k,j) = 0.<a name='548'>
      end do<a name='549'>
    end do<a name='550'>
  end do<a name='551'>
endif<a name='552'>
<a name='553'>
end subroutine a_spec_bdytend<a name='554'>
<a name='555'>
<a name='556'>
<A NAME='A_SPEC_BDYUPDATE'><A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYUPDATE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='557'>
<font color=#993300>subroutine </font><font color=#cc0000>a_spec_bdyupdate</font>( a_field, a_field_tend, dt, variable_in, spec_zone, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, &amp; <A href='../../call_to/A_SPEC_BDYUPDATE.html' TARGET='index'>7</A><a name='558'>
&amp;kme, its, ite, jts, jte, kts, kte )<a name='559'>
<font color=#447700>!******************************************************************<a name='560'></font>
<font color=#447700>!******************************************************************<a name='561'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='562'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='563'></font>
<font color=#447700>!******************************************************************<a name='564'></font>
<font color=#447700>!******************************************************************<a name='565'></font>
<font color=#447700>!==============================================<a name='566'></font>
<font color=#447700>! all entries are defined explicitly<a name='567'></font>
<font color=#447700>!==============================================<a name='568'></font>
implicit none<a name='569'>
<a name='570'>
<font color=#447700>!==============================================<a name='571'></font>
<font color=#447700>! declare arguments<a name='572'></font>
<font color=#447700>!==============================================<a name='573'></font>
integer, intent(in) :: ime<a name='574'>
integer, intent(in) :: ims<a name='575'>
integer, intent(in) :: jme<a name='576'>
integer, intent(in) :: jms<a name='577'>
integer, intent(in) :: kme<a name='578'>
integer, intent(in) :: kms<a name='579'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='580'>
real, intent(inout) :: a_field_tend(ims:ime,kms:kme,jms:jme)<a name='581'>
real, intent(in) :: dt<a name='582'>
integer, intent(in) :: ide<a name='583'>
integer, intent(in) :: ids<a name='584'>
integer, intent(in) :: ite<a name='585'>
integer, intent(in) :: its<a name='586'>
integer, intent(in) :: jde<a name='587'>
integer, intent(in) :: jds<a name='588'>
integer, intent(in) :: jte<a name='589'>
integer, intent(in) :: jts<a name='590'>
integer, intent(in) :: kde<a name='591'>
integer, intent(in) :: kte<a name='592'>
integer, intent(in) :: kts<a name='593'>
integer, intent(in) :: spec_zone<a name='594'>
character, intent(in) :: variable_in<a name='595'>
<a name='596'>
<font color=#447700>!==============================================<a name='597'></font>
<font color=#447700>! declare local variables<a name='598'></font>
<font color=#447700>!==============================================<a name='599'></font>
integer b_dist<a name='600'>
integer i<a name='601'>
integer ibe<a name='602'>
integer ibs<a name='603'>
integer itf<a name='604'>
integer j<a name='605'>
integer jbe<a name='606'>
integer jbs<a name='607'>
integer jtf<a name='608'>
integer k<a name='609'>
integer ktf<a name='610'>
character variable<a name='611'>
<a name='612'>
<font color=#447700>!----------------------------------------------<a name='613'></font>
<font color=#447700>! ROUTINE BODY<a name='614'></font>
<font color=#447700>!----------------------------------------------<a name='615'></font>
variable = variable_in<a name='616'>
<font color=#447700>! recompute : variable<a name='617'></font>
if (variable .eq. 'U') then<a name='618'>
  variable = 'u'<a name='619'>
endif<a name='620'>
<font color=#447700>! recompute : variable<a name='621'></font>
if (variable .eq. 'V') then<a name='622'>
  variable = 'v'<a name='623'>
endif<a name='624'>
<font color=#447700>! recompute : variable<a name='625'></font>
if (variable .eq. 'M') then<a name='626'>
  variable = 'm'<a name='627'>
endif<a name='628'>
<font color=#447700>! recompute : variable<a name='629'></font>
if (variable .eq. 'H') then<a name='630'>
  variable = 'h'<a name='631'>
endif<a name='632'>
<font color=#447700>! recompute : variable<a name='633'></font>
ibs = ids<a name='634'>
<font color=#447700>! recompute : ibs<a name='635'></font>
ibe = ide-1<a name='636'>
<font color=#447700>! recompute : ibe<a name='637'></font>
itf = min(ite,ide-1)<a name='638'>
<font color=#447700>! recompute : itf<a name='639'></font>
jbs = jds<a name='640'>
<font color=#447700>! recompute : jbs<a name='641'></font>
jbe = jde-1<a name='642'>
<font color=#447700>! recompute : jbe<a name='643'></font>
jtf = min(jte,jde-1)<a name='644'>
<font color=#447700>! recompute : jtf<a name='645'></font>
ktf = kde-1<a name='646'>
<font color=#447700>! recompute : ktf<a name='647'></font>
if (variable .eq. 'u') then<a name='648'>
  ibe = ide<a name='649'>
endif<a name='650'>
<font color=#447700>! recompute : ibe<a name='651'></font>
if (variable .eq. 'u') then<a name='652'>
  itf = min(ite,ide)<a name='653'>
endif<a name='654'>
<font color=#447700>! recompute : itf<a name='655'></font>
if (variable .eq. 'v') then<a name='656'>
  jbe = jde<a name='657'>
endif<a name='658'>
<font color=#447700>! recompute : jbe<a name='659'></font>
if (variable .eq. 'v') then<a name='660'>
  jtf = min(jte,jde)<a name='661'>
endif<a name='662'>
<font color=#447700>! recompute : jtf<a name='663'></font>
if (variable .eq. 'm') then<a name='664'>
  ktf = kte<a name='665'>
endif<a name='666'>
<font color=#447700>! recompute : ktf<a name='667'></font>
if (variable .eq. 'h') then<a name='668'>
  ktf = kte<a name='669'>
endif<a name='670'>
<font color=#447700>! recompute : ktf<a name='671'></font>
if (ibe-itf .lt. spec_zone) then<a name='672'>
  do i = max(its,ibe-spec_zone+1), itf<a name='673'>
    b_dist = ibe-i<a name='674'>
<font color=#447700>! recompute : b_dist<a name='675'></font>
    do k = kts, ktf<a name='676'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='677'>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*dt<a name='678'>
      end do<a name='679'>
    end do<a name='680'>
  end do<a name='681'>
endif<a name='682'>
if (its-ibs .lt. spec_zone) then<a name='683'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='684'>
    b_dist = i-ibs<a name='685'>
<font color=#447700>! recompute : b_dist<a name='686'></font>
    do k = kts, ktf<a name='687'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='688'>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*dt<a name='689'>
      end do<a name='690'>
    end do<a name='691'>
  end do<a name='692'>
endif<a name='693'>
if (jbe-jtf .lt. spec_zone) then<a name='694'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='695'>
    b_dist = jbe-j<a name='696'>
<font color=#447700>! recompute : b_dist<a name='697'></font>
    do k = kts, ktf<a name='698'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='699'>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*dt<a name='700'>
      end do<a name='701'>
    end do<a name='702'>
  end do<a name='703'>
endif<a name='704'>
if (jts-jbs .lt. spec_zone) then<a name='705'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='706'>
    b_dist = j-jbs<a name='707'>
<font color=#447700>! recompute : b_dist<a name='708'></font>
    do k = kts, ktf<a name='709'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='710'>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*dt<a name='711'>
      end do<a name='712'>
    end do<a name='713'>
  end do<a name='714'>
endif<a name='715'>
<a name='716'>
end subroutine a_spec_bdyupdate<a name='717'>
<a name='718'>
<a name='719'>
<A NAME='A_ZERO_GRAD_BDY'><A href='../../html_code/dyn_em/module_bc_ad.F.html#A_ZERO_GRAD_BDY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='720'>
<font color=#993300>subroutine </font><font color=#cc0000>a_zero_grad_bdy</font>( a_field, variable_in, spec_zone, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, &amp; <A href='../../call_to/A_ZERO_GRAD_BDY.html' TARGET='index'>1</A><a name='721'>
&amp;jte, kts )<a name='722'>
<font color=#447700>!******************************************************************<a name='723'></font>
<font color=#447700>!******************************************************************<a name='724'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='725'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='726'></font>
<font color=#447700>!******************************************************************<a name='727'></font>
<font color=#447700>!******************************************************************<a name='728'></font>
<font color=#447700>!==============================================<a name='729'></font>
<font color=#447700>! all entries are defined explicitly<a name='730'></font>
<font color=#447700>!==============================================<a name='731'></font>
implicit none<a name='732'>
<a name='733'>
<font color=#447700>!==============================================<a name='734'></font>
<font color=#447700>! declare arguments<a name='735'></font>
<font color=#447700>!==============================================<a name='736'></font>
integer, intent(in) :: ime<a name='737'>
integer, intent(in) :: ims<a name='738'>
integer, intent(in) :: jme<a name='739'>
integer, intent(in) :: jms<a name='740'>
integer, intent(in) :: kme<a name='741'>
integer, intent(in) :: kms<a name='742'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='743'>
integer, intent(in) :: ide<a name='744'>
integer, intent(in) :: ids<a name='745'>
integer, intent(in) :: ite<a name='746'>
integer, intent(in) :: its<a name='747'>
integer, intent(in) :: jde<a name='748'>
integer, intent(in) :: jds<a name='749'>
integer, intent(in) :: jte<a name='750'>
integer, intent(in) :: jts<a name='751'>
integer, intent(in) :: kde<a name='752'>
integer, intent(in) :: kts<a name='753'>
integer, intent(in) :: spec_zone<a name='754'>
character, intent(in) :: variable_in<a name='755'>
<a name='756'>
<font color=#447700>!==============================================<a name='757'></font>
<font color=#447700>! declare local variables<a name='758'></font>
<font color=#447700>!==============================================<a name='759'></font>
real a_fieldh<a name='760'>
real a_fieldi<a name='761'>
real a_fieldj<a name='762'>
real a_fieldk<a name='763'>
integer b_dist<a name='764'>
integer i<a name='765'>
integer i_inner<a name='766'>
integer ibe<a name='767'>
integer ibs<a name='768'>
integer itf<a name='769'>
integer j<a name='770'>
integer j_inner<a name='771'>
integer jbe<a name='772'>
integer jbs<a name='773'>
integer jtf<a name='774'>
integer k<a name='775'>
integer ktf<a name='776'>
character variable<a name='777'>
<a name='778'>
<font color=#447700>!----------------------------------------------<a name='779'></font>
<font color=#447700>! ROUTINE BODY<a name='780'></font>
<font color=#447700>!----------------------------------------------<a name='781'></font>
variable = variable_in<a name='782'>
<font color=#447700>! recompute : variable<a name='783'></font>
if (variable .eq. 'U') then<a name='784'>
  variable = 'u'<a name='785'>
endif<a name='786'>
<font color=#447700>! recompute : variable<a name='787'></font>
if (variable .eq. 'V') then<a name='788'>
  variable = 'v'<a name='789'>
endif<a name='790'>
<font color=#447700>! recompute : variable<a name='791'></font>
ibs = ids<a name='792'>
<font color=#447700>! recompute : ibs<a name='793'></font>
ibe = ide-1<a name='794'>
<font color=#447700>! recompute : ibe<a name='795'></font>
itf = min(ite,ide-1)<a name='796'>
<font color=#447700>! recompute : itf<a name='797'></font>
jbs = jds<a name='798'>
<font color=#447700>! recompute : jbs<a name='799'></font>
jbe = jde-1<a name='800'>
<font color=#447700>! recompute : jbe<a name='801'></font>
jtf = min(jte,jde-1)<a name='802'>
<font color=#447700>! recompute : jtf<a name='803'></font>
ktf = kde-1<a name='804'>
<font color=#447700>! recompute : ktf<a name='805'></font>
if (variable .eq. 'u') then<a name='806'>
  ibe = ide<a name='807'>
endif<a name='808'>
<font color=#447700>! recompute : ibe<a name='809'></font>
if (variable .eq. 'u') then<a name='810'>
  itf = min(ite,ide)<a name='811'>
endif<a name='812'>
<font color=#447700>! recompute : itf<a name='813'></font>
if (variable .eq. 'v') then<a name='814'>
  jbe = jde<a name='815'>
endif<a name='816'>
<font color=#447700>! recompute : jbe<a name='817'></font>
if (variable .eq. 'v') then<a name='818'>
  jtf = min(jte,jde)<a name='819'>
endif<a name='820'>
<font color=#447700>! recompute : jtf<a name='821'></font>
if (variable .eq. 'w') then<a name='822'>
  ktf = kde<a name='823'>
endif<a name='824'>
<font color=#447700>! recompute : ktf<a name='825'></font>
if (ibe-itf .lt. spec_zone) then<a name='826'>
  do i = itf, max(its,ibe-spec_zone+1), -1<a name='827'>
    b_dist = ibe-i<a name='828'>
<font color=#447700>! recompute : b_dist<a name='829'></font>
    do k = kts, ktf<a name='830'>
      do j = min(jtf,jbe-b_dist-1), max(jts,b_dist+jbs+1), -1<a name='831'>
        j_inner = max(j,jbs+spec_zone)<a name='832'>
<font color=#447700>! recompute : j_inner<a name='833'></font>
        j_inner = min(j_inner,jbe-spec_zone)<a name='834'>
<font color=#447700>! recompute : j_inner<a name='835'></font>
        a_fieldh = a_field(i,k,j)<a name='836'>
        a_field(i,k,j) = 0.<a name='837'>
        a_field(ibe-spec_zone,k,j_inner) = a_field(ibe-spec_zone,k,j_inner)+a_fieldh<a name='838'>
      end do<a name='839'>
    end do<a name='840'>
  end do<a name='841'>
endif<a name='842'>
if (its-ibs .lt. spec_zone) then<a name='843'>
  do i = min(itf,ibs+spec_zone-1), its, -1<a name='844'>
    b_dist = i-ibs<a name='845'>
<font color=#447700>! recompute : b_dist<a name='846'></font>
    do k = kts, ktf<a name='847'>
      do j = min(jtf,jbe-b_dist-1), max(jts,b_dist+jbs+1), -1<a name='848'>
        j_inner = max(j,jbs+spec_zone)<a name='849'>
<font color=#447700>! recompute : j_inner<a name='850'></font>
        j_inner = min(j_inner,jbe-spec_zone)<a name='851'>
<font color=#447700>! recompute : j_inner<a name='852'></font>
        a_fieldi = a_field(i,k,j)<a name='853'>
        a_field(i,k,j) = 0.<a name='854'>
        a_field(ibs+spec_zone,k,j_inner) = a_field(ibs+spec_zone,k,j_inner)+a_fieldi<a name='855'>
      end do<a name='856'>
    end do<a name='857'>
  end do<a name='858'>
endif<a name='859'>
if (jbe-jtf .lt. spec_zone) then<a name='860'>
  do j = jtf, max(jts,jbe-spec_zone+1), -1<a name='861'>
    b_dist = jbe-j<a name='862'>
<font color=#447700>! recompute : b_dist<a name='863'></font>
    do k = kts, ktf<a name='864'>
      do i = min(itf,ibe-b_dist), max(its,b_dist+ibs), -1<a name='865'>
        i_inner = max(i,ibs+spec_zone)<a name='866'>
<font color=#447700>! recompute : i_inner<a name='867'></font>
        i_inner = min(i_inner,ibe-spec_zone)<a name='868'>
<font color=#447700>! recompute : i_inner<a name='869'></font>
        a_fieldj = a_field(i,k,j)<a name='870'>
        a_field(i,k,j) = 0.<a name='871'>
        a_field(i_inner,k,jbe-spec_zone) = a_field(i_inner,k,jbe-spec_zone)+a_fieldj<a name='872'>
      end do<a name='873'>
    end do<a name='874'>
  end do<a name='875'>
endif<a name='876'>
if (jts-jbs .lt. spec_zone) then<a name='877'>
  do j = min(jtf,jbs+spec_zone-1), jts, -1<a name='878'>
    b_dist = j-jbs<a name='879'>
<font color=#447700>! recompute : b_dist<a name='880'></font>
    do k = kts, ktf<a name='881'>
      do i = min(itf,ibe-b_dist), max(its,b_dist+ibs), -1<a name='882'>
        i_inner = max(i,ibs+spec_zone)<a name='883'>
<font color=#447700>! recompute : i_inner<a name='884'></font>
        i_inner = min(i_inner,ibe-spec_zone)<a name='885'>
<font color=#447700>! recompute : i_inner<a name='886'></font>
        a_fieldk = a_field(i,k,j)<a name='887'>
        a_field(i,k,j) = 0.<a name='888'>
        a_field(i_inner,k,jbs+spec_zone) = a_field(i_inner,k,jbs+spec_zone)+a_fieldk<a name='889'>
      end do<a name='890'>
    end do<a name='891'>
  end do<a name='892'>
endif<a name='893'>
<a name='894'>
end subroutine a_zero_grad_bdy<a name='895'>
<a name='896'>
<a name='897'>
end module     a_module_bc<a name='898'>
<a name='899'>
<a name='900'>
</pre></body></html>