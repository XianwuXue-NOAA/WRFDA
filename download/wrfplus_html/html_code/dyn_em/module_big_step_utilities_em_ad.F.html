<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.18<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='A_MODULE_BIG_STEP_UTILITIES_EM'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MODULE_BIG_STEP_UTILITIES_EM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module     </font><font color=#cc0000>a_module_big_step_utilities_em</font> <A href='../../call_to/A_MODULE_BIG_STEP_UTILITIES_EM.html' TARGET='index'>4</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#module_big_step_utilities_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_4"><a name='35'>
use <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#module_big_step_utilities_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_5"><a name='36'>
use module_state_description<a name='37'>
use <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#module_big_step_utilities_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_9"><a name='38'>
use <A href='../../html_code/dyn_em/module_big_step_utilities_em.F.html#MODULE_BIG_STEP_UTILITIES_EM'>module_big_step_utilities_em</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#module_big_step_utilities_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BIG_STEP_UTILITIES_EM_2"><a name='39'>
<a name='40'>
USE <A href='../../html_code/frame/module_trace.F.html#MODULE_TRACE'>module_trace</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#module_big_step_utilities_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_TRACE_6">, only : trace_entry, trace_exit<a name='41'>
<a name='42'>
<font color=#447700>!==============================================<a name='43'></font>
<font color=#447700>! all entries are defined explicitly<a name='44'></font>
<font color=#447700>!==============================================<a name='45'></font>
implicit none<a name='46'>
<a name='47'>
contains<a name='48'>
<a name='49'>
<A NAME='A_CALC_ALT'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_ALT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='50'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_alt</font>( a_alt, a_al, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte ) <A href='../../call_to/A_CALC_ALT.html' TARGET='index'>1</A>,<A href='../../call_from/A_CALC_ALT.html' TARGET='index'>2</A><a name='51'>
<font color=#447700>!******************************************************************<a name='52'></font>
<font color=#447700>!******************************************************************<a name='53'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='54'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='55'></font>
<font color=#447700>!******************************************************************<a name='56'></font>
<font color=#447700>!******************************************************************<a name='57'></font>
<font color=#447700>!==============================================<a name='58'></font>
<font color=#447700>! all entries are defined explicitly<a name='59'></font>
<font color=#447700>!==============================================<a name='60'></font>
implicit none<a name='61'>
<a name='62'>
<font color=#447700>!==============================================<a name='63'></font>
<font color=#447700>! declare arguments<a name='64'></font>
<font color=#447700>!==============================================<a name='65'></font>
integer, intent(in) :: ime<a name='66'>
integer, intent(in) :: ims<a name='67'>
integer, intent(in) :: jme<a name='68'>
integer, intent(in) :: jms<a name='69'>
integer, intent(in) :: kme<a name='70'>
integer, intent(in) :: kms<a name='71'>
real, intent(inout) :: a_al(ims:ime,kms:kme,jms:jme)<a name='72'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='73'>
integer, intent(in) :: ide<a name='74'>
integer, intent(in) :: ite<a name='75'>
integer, intent(in) :: its<a name='76'>
integer, intent(in) :: jde<a name='77'>
integer, intent(in) :: jte<a name='78'>
integer, intent(in) :: jts<a name='79'>
integer, intent(in) :: kde<a name='80'>
integer, intent(in) :: kte<a name='81'>
integer, intent(in) :: kts<a name='82'>
<a name='83'>
<font color=#447700>!==============================================<a name='84'></font>
<font color=#447700>! declare local variables<a name='85'></font>
<font color=#447700>!==============================================<a name='86'></font>
integer i<a name='87'>
integer itf<a name='88'>
integer j<a name='89'>
integer jtf<a name='90'>
integer k<a name='91'>
integer ktf<a name='92'>
<a name='93'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_ALT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_18">("a_calc_alt")<a name='94'>
<a name='95'>
<font color=#447700>!----------------------------------------------<a name='96'></font>
<font color=#447700>! ROUTINE BODY<a name='97'></font>
<font color=#447700>!----------------------------------------------<a name='98'></font>
itf = min(ite,ide-1)<a name='99'>
<font color=#447700>! recompute : itf<a name='100'></font>
jtf = min(jte,jde-1)<a name='101'>
<font color=#447700>! recompute : jtf<a name='102'></font>
ktf = min(kte,kde-1)<a name='103'>
<font color=#447700>! recompute : ktf<a name='104'></font>
do j = jts, jtf<a name='105'>
  do k = kts, ktf<a name='106'>
    do i = its, itf<a name='107'>
      a_al(i,k,j) = a_al(i,k,j)+a_alt(i,k,j)<a name='108'>
      a_alt(i,k,j) = 0.<a name='109'>
    end do<a name='110'>
  end do<a name='111'>
end do<a name='112'>
<a name='113'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_ALT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_18">("a_calc_alt")<a name='114'>
<a name='115'>
end subroutine a_calc_alt<a name='116'>
<a name='117'>
<a name='118'>
<A NAME='A_CALC_CQ'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_CQ' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='119'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_cq</font>( moist, a_moist, a_cqu, a_cqv, a_cqw, n_moist, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, &amp; <A href='../../call_to/A_CALC_CQ.html' TARGET='index'>1</A>,<A href='../../call_from/A_CALC_CQ.html' TARGET='index'>2</A><a name='120'>
&amp;jte, kts, kte )<a name='121'>
<font color=#447700>!******************************************************************<a name='122'></font>
<font color=#447700>!******************************************************************<a name='123'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='124'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='125'></font>
<font color=#447700>!******************************************************************<a name='126'></font>
<font color=#447700>!******************************************************************<a name='127'></font>
<font color=#447700>!==============================================<a name='128'></font>
<font color=#447700>! all entries are defined explicitly<a name='129'></font>
<font color=#447700>!==============================================<a name='130'></font>
implicit none<a name='131'>
<a name='132'>
<font color=#447700>!==============================================<a name='133'></font>
<font color=#447700>! declare arguments<a name='134'></font>
<font color=#447700>!==============================================<a name='135'></font>
integer, intent(in) :: ime<a name='136'>
integer, intent(in) :: ims<a name='137'>
integer, intent(in) :: jme<a name='138'>
integer, intent(in) :: jms<a name='139'>
integer, intent(in) :: kme<a name='140'>
integer, intent(in) :: kms<a name='141'>
real, intent(inout) :: a_cqu(ims:ime,kms:kme,jms:jme)<a name='142'>
real, intent(inout) :: a_cqv(ims:ime,kms:kme,jms:jme)<a name='143'>
real, intent(inout) :: a_cqw(ims:ime,kms:kme,jms:jme)<a name='144'>
integer, intent(in) :: n_moist<a name='145'>
real, intent(inout) :: a_moist(ims:ime,kms:kme,jms:jme,n_moist)<a name='146'>
integer, intent(in) :: ide<a name='147'>
integer, intent(in) :: ite<a name='148'>
integer, intent(in) :: its<a name='149'>
integer, intent(in) :: jde<a name='150'>
integer, intent(in) :: jte<a name='151'>
integer, intent(in) :: jts<a name='152'>
integer, intent(in) :: kde<a name='153'>
integer, intent(in) :: kte<a name='154'>
integer, intent(in) :: kts<a name='155'>
real, intent(in) :: moist(ims:ime,kms:kme,jms:jme,n_moist)<a name='156'>
<a name='157'>
<font color=#447700>!==============================================<a name='158'></font>
<font color=#447700>! declare local variables<a name='159'></font>
<font color=#447700>!==============================================<a name='160'></font>
real a_qtot<a name='161'>
integer i<a name='162'>
integer ispe<a name='163'>
integer itf<a name='164'>
integer j<a name='165'>
integer jtf<a name='166'>
integer k<a name='167'>
integer ktf<a name='168'>
real qtot<a name='169'>
<a name='170'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_CQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_19">("a_calc_cq")<a name='171'>
<a name='172'>
<font color=#447700>!----------------------------------------------<a name='173'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='174'></font>
<font color=#447700>!----------------------------------------------<a name='175'></font>
a_qtot = 0.<a name='176'>
<a name='177'>
<font color=#447700>!----------------------------------------------<a name='178'></font>
<font color=#447700>! ROUTINE BODY<a name='179'></font>
<font color=#447700>!----------------------------------------------<a name='180'></font>
ktf = min(kte,kde-1)<a name='181'>
<font color=#447700>! recompute : ktf<a name='182'></font>
if (n_moist .ge. param_first_scalar) then<a name='183'>
  itf = min(ite,ide-1)<a name='184'>
<font color=#447700>! recompute : itf<a name='185'></font>
  jtf = min(jte,jde-1)<a name='186'>
<font color=#447700>! recompute : jtf<a name='187'></font>
  do j = jts, jtf<a name='188'>
    a_qtot = 0.<a name='189'>
    do k = kts+1, ktf<a name='190'>
      a_qtot = 0.<a name='191'>
      do i = its, itf<a name='192'>
        a_qtot = 0.<a name='193'>
        a_qtot = a_qtot+0.5*a_cqw(i,k,j)<a name='194'>
        a_cqw(i,k,j) = 0.<a name='195'>
        do ispe = param_first_scalar, n_moist<a name='196'>
          a_moist(i,k-1,j,ispe) = a_moist(i,k-1,j,ispe)+a_qtot<a name='197'>
          a_moist(i,k,j,ispe) = a_moist(i,k,j,ispe)+a_qtot<a name='198'>
        end do<a name='199'>
        a_qtot = 0.<a name='200'>
      end do<a name='201'>
    end do<a name='202'>
  end do<a name='203'>
<font color=#447700>! recdepend vars : ide,ite<a name='204'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:860<a name='205'></font>
<font color=#447700>! recompute vars : itf<a name='206'></font>
  itf = min(ite,ide-1)<a name='207'>
<font color=#447700>! recompute vars : itf<a name='208'></font>
<font color=#447700>! recdepend vars : itf,jte<a name='209'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:861<a name='210'></font>
<font color=#447700>! recompute vars : jtf<a name='211'></font>
  jtf = jte<a name='212'>
<font color=#447700>! recompute vars : jtf<a name='213'></font>
  do j = jts, jtf<a name='214'>
    a_qtot = 0.<a name='215'>
    do k = kts, ktf<a name='216'>
      a_qtot = 0.<a name='217'>
      do i = its, itf<a name='218'>
        a_qtot = 0.<a name='219'>
        qtot = 0.<a name='220'>
<font color=#447700>! recompute : qtot<a name='221'></font>
        do ispe = param_first_scalar, n_moist<a name='222'>
          qtot = qtot+moist(i,k,j,ispe)+moist(i,k,j-1,ispe)<a name='223'>
        end do<a name='224'>
<font color=#447700>! recompute : qtot<a name='225'></font>
        a_qtot = a_qtot-a_cqv(i,k,j)*(0.5/((1.+0.5*qtot)*(1.+0.5*qtot)))<a name='226'>
        a_cqv(i,k,j) = 0.<a name='227'>
        do ispe = param_first_scalar, n_moist<a name='228'>
          a_moist(i,k,j-1,ispe) = a_moist(i,k,j-1,ispe)+a_qtot<a name='229'>
          a_moist(i,k,j,ispe) = a_moist(i,k,j,ispe)+a_qtot<a name='230'>
        end do<a name='231'>
        a_qtot = 0.<a name='232'>
      end do<a name='233'>
    end do<a name='234'>
  end do<a name='235'>
<font color=#447700>! recdepend vars : ite<a name='236'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:839<a name='237'></font>
<font color=#447700>! recompute vars : itf<a name='238'></font>
  itf = ite<a name='239'>
<font color=#447700>! recompute vars : itf<a name='240'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='241'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:840<a name='242'></font>
<font color=#447700>! recompute vars : jtf<a name='243'></font>
  jtf = min(jte,jde-1)<a name='244'>
<font color=#447700>! recompute vars : jtf<a name='245'></font>
  do j = jts, jtf<a name='246'>
    a_qtot = 0.<a name='247'>
    do k = kts, ktf<a name='248'>
      a_qtot = 0.<a name='249'>
      do i = its, itf<a name='250'>
        a_qtot = 0.<a name='251'>
        qtot = 0.<a name='252'>
<font color=#447700>! recompute : qtot<a name='253'></font>
        do ispe = param_first_scalar, n_moist<a name='254'>
          qtot = qtot+moist(i,k,j,ispe)+moist(i-1,k,j,ispe)<a name='255'>
        end do<a name='256'>
<font color=#447700>! recompute : qtot<a name='257'></font>
        a_qtot = a_qtot-a_cqu(i,k,j)*(0.5/((1.+0.5*qtot)*(1.+0.5*qtot)))<a name='258'>
        a_cqu(i,k,j) = 0.<a name='259'>
        do ispe = param_first_scalar, n_moist<a name='260'>
          a_moist(i-1,k,j,ispe) = a_moist(i-1,k,j,ispe)+a_qtot<a name='261'>
          a_moist(i,k,j,ispe) = a_moist(i,k,j,ispe)+a_qtot<a name='262'>
        end do<a name='263'>
        a_qtot = 0.<a name='264'>
      end do<a name='265'>
    end do<a name='266'>
  end do<a name='267'>
else<a name='268'>
  itf = min(ite,ide-1)<a name='269'>
<font color=#447700>! recompute : itf<a name='270'></font>
  jtf = min(jte,jde-1)<a name='271'>
<font color=#447700>! recompute : jtf<a name='272'></font>
  do j = jts, jtf<a name='273'>
    do k = kts+1, ktf<a name='274'>
      do i = its, itf<a name='275'>
        a_cqw(i,k,j) = 0.<a name='276'>
      end do<a name='277'>
    end do<a name='278'>
  end do<a name='279'>
<font color=#447700>! recdepend vars : ide,ite<a name='280'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:905<a name='281'></font>
<font color=#447700>! recompute vars : itf<a name='282'></font>
  itf = min(ite,ide-1)<a name='283'>
<font color=#447700>! recompute vars : itf<a name='284'></font>
<font color=#447700>! recdepend vars : itf,jte<a name='285'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:906<a name='286'></font>
<font color=#447700>! recompute vars : jtf<a name='287'></font>
  jtf = jte<a name='288'>
<font color=#447700>! recompute vars : jtf<a name='289'></font>
  do j = jts, jtf<a name='290'>
    do k = kts, ktf<a name='291'>
      do i = its, itf<a name='292'>
        a_cqv(i,k,j) = 0.<a name='293'>
      end do<a name='294'>
    end do<a name='295'>
  end do<a name='296'>
<font color=#447700>! recdepend vars : ite<a name='297'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:839<a name='298'></font>
<font color=#447700>! recompute vars : itf<a name='299'></font>
  itf = ite<a name='300'>
<font color=#447700>! recompute vars : itf<a name='301'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='302'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:840<a name='303'></font>
<font color=#447700>! recompute vars : jtf<a name='304'></font>
  jtf = min(jte,jde-1)<a name='305'>
<font color=#447700>! recompute vars : jtf<a name='306'></font>
  do j = jts, jtf<a name='307'>
    do k = kts, ktf<a name='308'>
      do i = its, itf<a name='309'>
        a_cqu(i,k,j) = 0.<a name='310'>
      end do<a name='311'>
    end do<a name='312'>
  end do<a name='313'>
endif<a name='314'>
<a name='315'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_CQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_19">("a_calc_cq")<a name='316'>
<a name='317'>
end subroutine a_calc_cq<a name='318'>
<a name='319'>
<a name='320'>
<A NAME='A_CALC_MU_UV'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_MU_UV' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='321'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_mu_uv</font>( config_flags, a_mu, a_muu, a_muv, ids, ide, jds, jde, ims, ime, jms, jme, its, ite, jts, jte ) <A href='../../call_to/A_CALC_MU_UV.html' TARGET='index'>1</A>,<A href='../../call_from/A_CALC_MU_UV.html' TARGET='index'>2</A><a name='322'>
<font color=#447700>!******************************************************************<a name='323'></font>
<font color=#447700>!******************************************************************<a name='324'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='325'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='326'></font>
<font color=#447700>!******************************************************************<a name='327'></font>
<font color=#447700>!******************************************************************<a name='328'></font>
<font color=#447700>!==============================================<a name='329'></font>
<font color=#447700>! all entries are defined explicitly<a name='330'></font>
<font color=#447700>!==============================================<a name='331'></font>
implicit none<a name='332'>
<a name='333'>
<font color=#447700>!==============================================<a name='334'></font>
<font color=#447700>! declare arguments<a name='335'></font>
<font color=#447700>!==============================================<a name='336'></font>
integer, intent(in) :: ime<a name='337'>
integer, intent(in) :: ims<a name='338'>
integer, intent(in) :: jme<a name='339'>
integer, intent(in) :: jms<a name='340'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='341'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='342'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='343'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='344'>
integer, intent(in) :: ide<a name='345'>
integer, intent(in) :: ids<a name='346'>
integer, intent(in) :: ite<a name='347'>
integer, intent(in) :: its<a name='348'>
integer, intent(in) :: jde<a name='349'>
integer, intent(in) :: jds<a name='350'>
integer, intent(in) :: jte<a name='351'>
integer, intent(in) :: jts<a name='352'>
<a name='353'>
<font color=#447700>!==============================================<a name='354'></font>
<font color=#447700>! declare local variables<a name='355'></font>
<font color=#447700>!==============================================<a name='356'></font>
integer i<a name='357'>
integer im<a name='358'>
integer itf<a name='359'>
integer j<a name='360'>
integer jm<a name='361'>
integer jtf<a name='362'>
<a name='363'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_MU_UV' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_20">("a_calc_mu_uv")<a name='364'>
<a name='365'>
<font color=#447700>!----------------------------------------------<a name='366'></font>
<font color=#447700>! ROUTINE BODY<a name='367'></font>
<font color=#447700>!----------------------------------------------<a name='368'></font>
itf = min(ite,ide-1)<a name='369'>
<font color=#447700>! recompute : itf<a name='370'></font>
jtf = jte<a name='371'>
<font color=#447700>! recompute : jtf<a name='372'></font>
if (jts .ne. jds .and. jte .ne. jde) then<a name='373'>
  do j = jts, jtf<a name='374'>
    do i = its, itf<a name='375'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='376'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='377'>
      a_muv(i,j) = 0.<a name='378'>
    end do<a name='379'>
  end do<a name='380'>
else if (jts .eq. jds .and. jte .ne. jde) then<a name='381'>
  j = jts<a name='382'>
<font color=#447700>! recompute : j<a name='383'></font>
  jm = jts<a name='384'>
<font color=#447700>! recompute : jm<a name='385'></font>
  if (config_flags%periodic_y) then<a name='386'>
    jm = jts-1<a name='387'>
  endif<a name='388'>
<font color=#447700>! recompute : jm<a name='389'></font>
  do i = its, itf<a name='390'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='391'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='392'>
    a_muv(i,j) = 0.<a name='393'>
  end do<a name='394'>
  do j = jts+1, jtf<a name='395'>
    do i = its, itf<a name='396'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='397'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='398'>
      a_muv(i,j) = 0.<a name='399'>
    end do<a name='400'>
  end do<a name='401'>
else if (jts .ne. jds .and. jte .eq. jde) then<a name='402'>
  j = jte<a name='403'>
<font color=#447700>! recompute : j<a name='404'></font>
  jm = jte-1<a name='405'>
<font color=#447700>! recompute : jm<a name='406'></font>
  if (config_flags%periodic_y) then<a name='407'>
    jm = jte<a name='408'>
  endif<a name='409'>
<font color=#447700>! recompute : jm<a name='410'></font>
  do i = its, itf<a name='411'>
    a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='412'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='413'>
    a_muv(i,j) = 0.<a name='414'>
    a_mu(i,j-1) = a_mu(i,j-1)+a_muv(i,j)<a name='415'>
    a_muv(i,j) = 0.<a name='416'>
  end do<a name='417'>
  do j = jts, jtf-1<a name='418'>
    do i = its, itf<a name='419'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='420'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='421'>
      a_muv(i,j) = 0.<a name='422'>
    end do<a name='423'>
  end do<a name='424'>
else if (jts .eq. jds .and. jte .eq. jde) then<a name='425'>
  j = jte<a name='426'>
<font color=#447700>! recompute : j<a name='427'></font>
  jm = jte-1<a name='428'>
<font color=#447700>! recompute : jm<a name='429'></font>
  if (config_flags%periodic_y) then<a name='430'>
    jm = jte<a name='431'>
  endif<a name='432'>
<font color=#447700>! recompute : jm<a name='433'></font>
  do i = its, itf<a name='434'>
    a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='435'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='436'>
    a_muv(i,j) = 0.<a name='437'>
  end do<a name='438'>
<font color=#447700>! recdepend vars : jts<a name='439'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:150<a name='440'></font>
<font color=#447700>! recompute vars : j<a name='441'></font>
  j = jts<a name='442'>
<font color=#447700>! recompute vars : j<a name='443'></font>
<font color=#447700>! recdepend vars : j,jts<a name='444'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:151<a name='445'></font>
<font color=#447700>! recompute vars : jm<a name='446'></font>
  jm = jts<a name='447'>
<font color=#447700>! recompute vars : jm<a name='448'></font>
<font color=#447700>! recdepend vars : config_flags,j,jm,jts<a name='449'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:152<a name='450'></font>
<font color=#447700>! recompute vars : jm<a name='451'></font>
  if (config_flags%periodic_y) then<a name='452'>
    jm = jts-1<a name='453'>
  endif<a name='454'>
<font color=#447700>! recompute vars : jm<a name='455'></font>
  do i = its, itf<a name='456'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='457'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='458'>
    a_muv(i,j) = 0.<a name='459'>
  end do<a name='460'>
  do j = jts+1, jtf-1<a name='461'>
    do i = its, itf<a name='462'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='463'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='464'>
      a_muv(i,j) = 0.<a name='465'>
    end do<a name='466'>
  end do<a name='467'>
endif<a name='468'>
<font color=#447700>! recdepend vars : ite<a name='469'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:46<a name='470'></font>
<font color=#447700>! recompute vars : itf<a name='471'></font>
itf = ite<a name='472'>
<font color=#447700>! recompute vars : itf<a name='473'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='474'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:47<a name='475'></font>
<font color=#447700>! recompute vars : jtf<a name='476'></font>
jtf = min(jte,jde-1)<a name='477'>
<font color=#447700>! recompute vars : jtf<a name='478'></font>
if (its .ne. ids .and. ite .ne. ide) then<a name='479'>
  do j = jts, jtf<a name='480'>
    do i = its, itf<a name='481'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='482'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='483'>
      a_muu(i,j) = 0.<a name='484'>
    end do<a name='485'>
  end do<a name='486'>
else if (its .eq. ids .and. ite .ne. ide) then<a name='487'>
  i = its<a name='488'>
<font color=#447700>! recompute : i<a name='489'></font>
  im = its<a name='490'>
<font color=#447700>! recompute : im<a name='491'></font>
  if (config_flags%periodic_x) then<a name='492'>
    im = its-1<a name='493'>
  endif<a name='494'>
<font color=#447700>! recompute : im<a name='495'></font>
  do j = jts, jtf<a name='496'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='497'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='498'>
    a_muu(i,j) = 0.<a name='499'>
  end do<a name='500'>
  do j = jts, jtf<a name='501'>
    do i = its+1, itf<a name='502'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='503'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='504'>
      a_muu(i,j) = 0.<a name='505'>
    end do<a name='506'>
  end do<a name='507'>
else if (its .ne. ids .and. ite .eq. ide) then<a name='508'>
  i = ite<a name='509'>
<font color=#447700>! recompute : i<a name='510'></font>
  im = ite-1<a name='511'>
<font color=#447700>! recompute : im<a name='512'></font>
  if (config_flags%periodic_x) then<a name='513'>
    im = ite<a name='514'>
  endif<a name='515'>
<font color=#447700>! recompute : im<a name='516'></font>
  do j = jts, jtf<a name='517'>
    a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='518'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='519'>
    a_muu(i,j) = 0.<a name='520'>
  end do<a name='521'>
  do j = jts, jtf<a name='522'>
    do i = its, itf-1<a name='523'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='524'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='525'>
      a_muu(i,j) = 0.<a name='526'>
    end do<a name='527'>
  end do<a name='528'>
else if (its .eq. ids .and. ite .eq. ide) then<a name='529'>
  i = ite<a name='530'>
<font color=#447700>! recompute : i<a name='531'></font>
  im = ite-1<a name='532'>
<font color=#447700>! recompute : im<a name='533'></font>
  if (config_flags%periodic_x) then<a name='534'>
    im = ite<a name='535'>
  endif<a name='536'>
<font color=#447700>! recompute : im<a name='537'></font>
  do j = jts, jtf<a name='538'>
    a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='539'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='540'>
    a_muu(i,j) = 0.<a name='541'>
  end do<a name='542'>
<font color=#447700>! recdepend vars : its<a name='543'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:89<a name='544'></font>
<font color=#447700>! recompute vars : i<a name='545'></font>
  i = its<a name='546'>
<font color=#447700>! recompute vars : i<a name='547'></font>
<font color=#447700>! recdepend vars : i,its<a name='548'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:90<a name='549'></font>
<font color=#447700>! recompute vars : im<a name='550'></font>
  im = its<a name='551'>
<font color=#447700>! recompute vars : im<a name='552'></font>
<font color=#447700>! recdepend vars : config_flags,i,im,its<a name='553'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:91<a name='554'></font>
<font color=#447700>! recompute vars : im<a name='555'></font>
  if (config_flags%periodic_x) then<a name='556'>
    im = its-1<a name='557'>
  endif<a name='558'>
<font color=#447700>! recompute vars : im<a name='559'></font>
  do j = jts, jtf<a name='560'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='561'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='562'>
    a_muu(i,j) = 0.<a name='563'>
  end do<a name='564'>
  do j = jts, jtf<a name='565'>
    do i = its+1, itf-1<a name='566'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='567'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='568'>
      a_muu(i,j) = 0.<a name='569'>
    end do<a name='570'>
  end do<a name='571'>
endif<a name='572'>
<a name='573'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_MU_UV' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_20">("a_calc_mu_uv")<a name='574'>
<a name='575'>
end subroutine a_calc_mu_uv<a name='576'>
<a name='577'>
<a name='578'>
<A NAME='A_CALC_MU_UV_1'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_MU_UV_1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='579'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_mu_uv_1</font>( config_flags, a_mu, a_muu, a_muv, ids, ide, jds, jde, ims, ime, jms, jme, its, ite, jts, jte ) <A href='../../call_to/A_CALC_MU_UV_1.html' TARGET='index'>2</A>,<A href='../../call_from/A_CALC_MU_UV_1.html' TARGET='index'>2</A><a name='580'>
<font color=#447700>!******************************************************************<a name='581'></font>
<font color=#447700>!******************************************************************<a name='582'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='583'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='584'></font>
<font color=#447700>!******************************************************************<a name='585'></font>
<font color=#447700>!******************************************************************<a name='586'></font>
<font color=#447700>!==============================================<a name='587'></font>
<font color=#447700>! all entries are defined explicitly<a name='588'></font>
<font color=#447700>!==============================================<a name='589'></font>
implicit none<a name='590'>
<a name='591'>
<font color=#447700>!==============================================<a name='592'></font>
<font color=#447700>! declare arguments<a name='593'></font>
<font color=#447700>!==============================================<a name='594'></font>
integer, intent(in) :: ime<a name='595'>
integer, intent(in) :: ims<a name='596'>
integer, intent(in) :: jme<a name='597'>
integer, intent(in) :: jms<a name='598'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='599'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='600'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='601'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='602'>
integer, intent(in) :: ide<a name='603'>
integer, intent(in) :: ids<a name='604'>
integer, intent(in) :: ite<a name='605'>
integer, intent(in) :: its<a name='606'>
integer, intent(in) :: jde<a name='607'>
integer, intent(in) :: jds<a name='608'>
integer, intent(in) :: jte<a name='609'>
integer, intent(in) :: jts<a name='610'>
<a name='611'>
<font color=#447700>!==============================================<a name='612'></font>
<font color=#447700>! declare local variables<a name='613'></font>
<font color=#447700>!==============================================<a name='614'></font>
integer i<a name='615'>
integer im<a name='616'>
integer itf<a name='617'>
integer j<a name='618'>
integer jm<a name='619'>
integer jtf<a name='620'>
<a name='621'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_MU_UV_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_21">("a_calc_mu_uv_1")<a name='622'>
<a name='623'>
<font color=#447700>!----------------------------------------------<a name='624'></font>
<font color=#447700>! ROUTINE BODY<a name='625'></font>
<font color=#447700>!----------------------------------------------<a name='626'></font>
itf = min(ite,ide-1)<a name='627'>
<font color=#447700>! recompute : itf<a name='628'></font>
jtf = jte<a name='629'>
<font color=#447700>! recompute : jtf<a name='630'></font>
if (jts .ne. jds .and. jte .ne. jde) then<a name='631'>
  do j = jts, jtf<a name='632'>
    do i = its, itf<a name='633'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='634'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='635'>
      a_muv(i,j) = 0.<a name='636'>
    end do<a name='637'>
  end do<a name='638'>
else if (jts .eq. jds .and. jte .ne. jde) then<a name='639'>
  j = jts<a name='640'>
<font color=#447700>! recompute : j<a name='641'></font>
  jm = jts<a name='642'>
<font color=#447700>! recompute : jm<a name='643'></font>
  if (config_flags%periodic_y) then<a name='644'>
    jm = jts-1<a name='645'>
  endif<a name='646'>
<font color=#447700>! recompute : jm<a name='647'></font>
  do i = its, itf<a name='648'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='649'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='650'>
    a_muv(i,j) = 0.<a name='651'>
  end do<a name='652'>
  do j = jts+1, jtf<a name='653'>
    do i = its, itf<a name='654'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='655'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='656'>
      a_muv(i,j) = 0.<a name='657'>
    end do<a name='658'>
  end do<a name='659'>
else if (jts .ne. jds .and. jte .eq. jde) then<a name='660'>
  j = jte<a name='661'>
<font color=#447700>! recompute : j<a name='662'></font>
  jm = jte-1<a name='663'>
<font color=#447700>! recompute : jm<a name='664'></font>
  if (config_flags%periodic_y) then<a name='665'>
    jm = jte<a name='666'>
  endif<a name='667'>
<font color=#447700>! recompute : jm<a name='668'></font>
  do i = its, itf<a name='669'>
    a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='670'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='671'>
    a_muv(i,j) = 0.<a name='672'>
  end do<a name='673'>
  do j = jts, jtf-1<a name='674'>
    do i = its, itf<a name='675'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='676'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='677'>
      a_muv(i,j) = 0.<a name='678'>
    end do<a name='679'>
  end do<a name='680'>
else if (jts .eq. jds .and. jte .eq. jde) then<a name='681'>
  j = jte<a name='682'>
<font color=#447700>! recompute : j<a name='683'></font>
  jm = jte-1<a name='684'>
<font color=#447700>! recompute : jm<a name='685'></font>
  if (config_flags%periodic_y) then<a name='686'>
    jm = jte<a name='687'>
  endif<a name='688'>
<font color=#447700>! recompute : jm<a name='689'></font>
  do i = its, itf<a name='690'>
    a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='691'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='692'>
    a_muv(i,j) = 0.<a name='693'>
  end do<a name='694'>
<font color=#447700>! recdepend vars : jts<a name='695'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:295<a name='696'></font>
<font color=#447700>! recompute vars : j<a name='697'></font>
  j = jts<a name='698'>
<font color=#447700>! recompute vars : j<a name='699'></font>
<font color=#447700>! recdepend vars : j,jts<a name='700'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:296<a name='701'></font>
<font color=#447700>! recompute vars : jm<a name='702'></font>
  jm = jts<a name='703'>
<font color=#447700>! recompute vars : jm<a name='704'></font>
<font color=#447700>! recdepend vars : config_flags,j,jm,jts<a name='705'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:297<a name='706'></font>
<font color=#447700>! recompute vars : jm<a name='707'></font>
  if (config_flags%periodic_y) then<a name='708'>
    jm = jts-1<a name='709'>
  endif<a name='710'>
<font color=#447700>! recompute vars : jm<a name='711'></font>
  do i = its, itf<a name='712'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='713'>
    a_mu(i,jm) = a_mu(i,jm)+0.5*a_muv(i,j)<a name='714'>
    a_muv(i,j) = 0.<a name='715'>
  end do<a name='716'>
  do j = jts+1, jtf-1<a name='717'>
    do i = its, itf<a name='718'>
      a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_muv(i,j)<a name='719'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muv(i,j)<a name='720'>
      a_muv(i,j) = 0.<a name='721'>
    end do<a name='722'>
  end do<a name='723'>
endif<a name='724'>
<font color=#447700>! recdepend vars : ite<a name='725'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:203<a name='726'></font>
<font color=#447700>! recompute vars : itf<a name='727'></font>
itf = ite<a name='728'>
<font color=#447700>! recompute vars : itf<a name='729'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='730'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:204<a name='731'></font>
<font color=#447700>! recompute vars : jtf<a name='732'></font>
jtf = min(jte,jde-1)<a name='733'>
<font color=#447700>! recompute vars : jtf<a name='734'></font>
if (its .ne. ids .and. ite .ne. ide) then<a name='735'>
  do j = jts, jtf<a name='736'>
    do i = its, itf<a name='737'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='738'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='739'>
      a_muu(i,j) = 0.<a name='740'>
    end do<a name='741'>
  end do<a name='742'>
else if (its .eq. ids .and. ite .ne. ide) then<a name='743'>
  i = its<a name='744'>
<font color=#447700>! recompute : i<a name='745'></font>
  im = its<a name='746'>
<font color=#447700>! recompute : im<a name='747'></font>
  if (config_flags%periodic_x) then<a name='748'>
    im = its-1<a name='749'>
  endif<a name='750'>
<font color=#447700>! recompute : im<a name='751'></font>
  do j = jts, jtf<a name='752'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='753'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='754'>
    a_muu(i,j) = 0.<a name='755'>
  end do<a name='756'>
  do j = jts, jtf<a name='757'>
    do i = its+1, itf<a name='758'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='759'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='760'>
      a_muu(i,j) = 0.<a name='761'>
    end do<a name='762'>
  end do<a name='763'>
else if (its .ne. ids .and. ite .eq. ide) then<a name='764'>
  i = ite<a name='765'>
<font color=#447700>! recompute : i<a name='766'></font>
  im = ite-1<a name='767'>
<font color=#447700>! recompute : im<a name='768'></font>
  if (config_flags%periodic_x) then<a name='769'>
    im = ite<a name='770'>
  endif<a name='771'>
<font color=#447700>! recompute : im<a name='772'></font>
  do j = jts, jtf<a name='773'>
    a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='774'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='775'>
    a_muu(i,j) = 0.<a name='776'>
  end do<a name='777'>
  do j = jts, jtf<a name='778'>
    do i = its, itf-1<a name='779'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='780'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='781'>
      a_muu(i,j) = 0.<a name='782'>
    end do<a name='783'>
  end do<a name='784'>
else if (its .eq. ids .and. ite .eq. ide) then<a name='785'>
  i = ite<a name='786'>
<font color=#447700>! recompute : i<a name='787'></font>
  im = ite-1<a name='788'>
<font color=#447700>! recompute : im<a name='789'></font>
  if (config_flags%periodic_x) then<a name='790'>
    im = ite<a name='791'>
  endif<a name='792'>
<font color=#447700>! recompute : im<a name='793'></font>
  do j = jts, jtf<a name='794'>
    a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='795'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='796'>
    a_muu(i,j) = 0.<a name='797'>
  end do<a name='798'>
<font color=#447700>! recdepend vars : its<a name='799'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:242<a name='800'></font>
<font color=#447700>! recompute vars : i<a name='801'></font>
  i = its<a name='802'>
<font color=#447700>! recompute vars : i<a name='803'></font>
<font color=#447700>! recdepend vars : i,its<a name='804'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:243<a name='805'></font>
<font color=#447700>! recompute vars : im<a name='806'></font>
  im = its<a name='807'>
<font color=#447700>! recompute vars : im<a name='808'></font>
<font color=#447700>! recdepend vars : config_flags,i,im,its<a name='809'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:244<a name='810'></font>
<font color=#447700>! recompute vars : im<a name='811'></font>
  if (config_flags%periodic_x) then<a name='812'>
    im = its-1<a name='813'>
  endif<a name='814'>
<font color=#447700>! recompute vars : im<a name='815'></font>
  do j = jts, jtf<a name='816'>
    a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='817'>
    a_mu(im,j) = a_mu(im,j)+0.5*a_muu(i,j)<a name='818'>
    a_muu(i,j) = 0.<a name='819'>
  end do<a name='820'>
  do j = jts, jtf<a name='821'>
    do i = its+1, itf-1<a name='822'>
      a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_muu(i,j)<a name='823'>
      a_mu(i,j) = a_mu(i,j)+0.5*a_muu(i,j)<a name='824'>
      a_muu(i,j) = 0.<a name='825'>
    end do<a name='826'>
  end do<a name='827'>
endif<a name='828'>
<a name='829'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_MU_UV_1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_21">("a_calc_mu_uv_1")<a name='830'>
<a name='831'>
end subroutine a_calc_mu_uv_1<a name='832'>
<a name='833'>
<a name='834'>
<A NAME='A_CALC_P_RHO_PHI'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_P_RHO_PHI' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='835'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_p_rho_phi</font>( moist, a_moist, n_moist, al, a_al, alb, mu, a_mu, muts, a_muts, ph, a_ph, p, a_p, pb, t, a_t, p0, t0, &amp; <A href='../../call_to/A_CALC_P_RHO_PHI.html' TARGET='index'>3</A>,<A href='../../call_from/A_CALC_P_RHO_PHI.html' TARGET='index'>2</A><a name='836'>
&amp;dnw, rdnw, rdn, non_hydrostatic, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='837'>
<font color=#447700>!******************************************************************<a name='838'></font>
<font color=#447700>!******************************************************************<a name='839'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='840'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='841'></font>
<font color=#447700>!******************************************************************<a name='842'></font>
<font color=#447700>!******************************************************************<a name='843'></font>
<font color=#447700>!==============================================<a name='844'></font>
<font color=#447700>! all entries are defined explicitly<a name='845'></font>
<font color=#447700>!==============================================<a name='846'></font>
implicit none<a name='847'>
<a name='848'>
<font color=#447700>!==============================================<a name='849'></font>
<font color=#447700>! declare arguments<a name='850'></font>
<font color=#447700>!==============================================<a name='851'></font>
integer, intent(in) :: ime<a name='852'>
integer, intent(in) :: ims<a name='853'>
integer, intent(in) :: jme<a name='854'>
integer, intent(in) :: jms<a name='855'>
integer, intent(in) :: kme<a name='856'>
integer, intent(in) :: kms<a name='857'>
real, intent(inout) :: a_al(ims:ime,kms:kme,jms:jme)<a name='858'>
integer, intent(in) :: n_moist<a name='859'>
real, intent(inout) :: a_moist(ims:ime,kms:kme,jms:jme,n_moist)<a name='860'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='861'>
real, intent(inout) :: a_muts(ims:ime,jms:jme)<a name='862'>
real, intent(inout) :: a_p(ims:ime,kms:kme,jms:jme)<a name='863'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='864'>
real, intent(inout) :: a_t(ims:ime,kms:kme,jms:jme)<a name='865'>
real, intent(out) :: al(ims:ime,kms:kme,jms:jme)<a name='866'>
real, intent(in) :: alb(ims:ime,kms:kme,jms:jme)<a name='867'>
real, intent(in) :: dnw(kms:kme)<a name='868'>
integer, intent(in) :: ide<a name='869'>
integer, intent(in) :: ite<a name='870'>
integer, intent(in) :: its<a name='871'>
integer, intent(in) :: jde<a name='872'>
integer, intent(in) :: jte<a name='873'>
integer, intent(in) :: jts<a name='874'>
integer, intent(in) :: kde<a name='875'>
integer, intent(in) :: kte<a name='876'>
integer, intent(in) :: kts<a name='877'>
real, intent(in) :: moist(ims:ime,kms:kme,jms:jme,n_moist)<a name='878'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='879'>
real, intent(in) :: muts(ims:ime,jms:jme)<a name='880'>
logical, intent(in) :: non_hydrostatic<a name='881'>
real, intent(out) :: p(ims:ime,kms:kme,jms:jme)<a name='882'>
real, intent(in) :: p0<a name='883'>
real, intent(in) :: pb(ims:ime,kms:kme,jms:jme)<a name='884'>
real, intent(inout) :: ph(ims:ime,kms:kme,jms:jme)<a name='885'>
real, intent(in) :: rdn(kms:kme)<a name='886'>
real, intent(in) :: rdnw(kms:kme)<a name='887'>
real, intent(in) :: t(ims:ime,kms:kme,jms:jme)<a name='888'>
real, intent(in) :: t0<a name='889'>
<a name='890'>
<font color=#447700>!==============================================<a name='891'></font>
<font color=#447700>! declare local variables<a name='892'></font>
<font color=#447700>!==============================================<a name='893'></font>
real a_qf1<a name='894'>
real a_qf2<a name='895'>
real a_qtot<a name='896'>
real a_qvf<a name='897'>
integer i<a name='898'>
integer ispe<a name='899'>
integer itf<a name='900'>
integer j<a name='901'>
integer jtf<a name='902'>
integer k<a name='903'>
integer k1<a name='904'>
integer k2<a name='905'>
integer ka1<a name='906'>
integer ka2<a name='907'>
integer ktf<a name='908'>
real qf1<a name='909'>
real qf2<a name='910'>
real qtot<a name='911'>
real qvf<a name='912'>
<a name='913'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_P_RHO_PHI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_22">("a_calc_p_rho_phi")<a name='914'>
<a name='915'>
<font color=#447700>!----------------------------------------------<a name='916'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='917'></font>
<font color=#447700>!----------------------------------------------<a name='918'></font>
a_qf1 = 0.<a name='919'>
a_qf2 = 0.<a name='920'>
a_qtot = 0.<a name='921'>
a_qvf = 0.<a name='922'>
<a name='923'>
<font color=#447700>!----------------------------------------------<a name='924'></font>
<font color=#447700>! ROUTINE BODY<a name='925'></font>
<font color=#447700>!----------------------------------------------<a name='926'></font>
itf = min(ite,ide-1)<a name='927'>
<font color=#447700>! recompute : itf<a name='928'></font>
jtf = min(jte,jde-1)<a name='929'>
<font color=#447700>! recompute : jtf<a name='930'></font>
ktf = min(kte,kde-1)<a name='931'>
<font color=#447700>! recompute : ktf<a name='932'></font>
if (non_hydrostatic) then<a name='933'>
  if (n_moist .ge. param_first_scalar) then<a name='934'>
    do j = jts, jtf<a name='935'>
      do k = kts, ktf<a name='936'>
        do i = its, itf<a name='937'>
          a_qvf = 0.<a name='938'>
          qvf = 1.+rvovrd*moist(i,k,j,p_qv)<a name='939'>
<font color=#447700>! recompute : qvf<a name='940'></font>
          al(i,k,j) = -(1./muts(i,j)*(alb(i,k,j)*mu(i,j)+rdnw(k)*(ph(i,k+1,j)-ph(i,k,j))))<a name='941'>
<font color=#447700>! recompute : al<a name='942'></font>
<font color=#447700>!xyh          if(j.eq.60) write(100+k,*)'i,a_al,a_p=', i,a_al(i,k,j),a_p(i,k,j)<a name='943'></font>
          a_al(i,k,j) = a_al(i,k,j)-a_p(i,k,j)*r_d*(t0+t(i,k,j))*qvf*p0/(p0*(al(i,k,j)+alb(i,k,j))*p0*(al(i,k,j)+alb(i,k,j)))*&amp;<a name='944'>
&amp;cpovcv*(r_d*(t0+t(i,k,j))*qvf/(p0*(al(i,k,j)+alb(i,k,j))))**(cpovcv-1)*p0<a name='945'>
          a_qvf = a_qvf+a_p(i,k,j)*r_d*(t0+t(i,k,j))/(p0*(al(i,k,j)+alb(i,k,j)))*cpovcv*(r_d*(t0+t(i,k,j))*qvf/(p0*(al(i,k,j)+&amp;<a name='946'>
&amp;alb(i,k,j))))**(cpovcv-1)*p0<a name='947'>
          a_t(i,k,j) = a_t(i,k,j)+a_p(i,k,j)*r_d*qvf/(p0*(al(i,k,j)+alb(i,k,j)))*cpovcv*(r_d*(t0+t(i,k,j))*qvf/(p0*(al(i,k,j)+&amp;<a name='948'>
&amp;alb(i,k,j))))**(cpovcv-1)*p0<a name='949'>
          a_p(i,k,j) = 0.<a name='950'>
          a_mu(i,j) = a_mu(i,j)-a_al(i,k,j)*1./muts(i,j)*alb(i,k,j)<a name='951'>
          a_muts(i,j) = a_muts(i,j)+a_al(i,k,j)/(muts(i,j)*muts(i,j))*(alb(i,k,j)*mu(i,j)+rdnw(k)*(ph(i,k+1,j)-ph(i,k,j)))<a name='952'>
          a_ph(i,k+1,j) = a_ph(i,k+1,j)-a_al(i,k,j)*1./muts(i,j)*rdnw(k)<a name='953'>
          a_ph(i,k,j) = a_ph(i,k,j)+a_al(i,k,j)*1./muts(i,j)*rdnw(k)<a name='954'>
          a_al(i,k,j) = 0.<a name='955'>
          a_moist(i,k,j,p_qv) = a_moist(i,k,j,p_qv)+a_qvf*rvovrd<a name='956'>
          a_qvf = 0.<a name='957'>
        end do<a name='958'>
      end do<a name='959'>
    end do<a name='960'>
  else<a name='961'>
    do j = jts, jtf<a name='962'>
      do k = kts, ktf<a name='963'>
        do i = its, itf<a name='964'>
          al(i,k,j) = -(1./muts(i,j)*(alb(i,k,j)*mu(i,j)+rdnw(k)*(ph(i,k+1,j)-ph(i,k,j))))<a name='965'>
<font color=#447700>! recompute : al<a name='966'></font>
          a_al(i,k,j) = a_al(i,k,j)-a_p(i,k,j)*p0*r_d*(t0+t(i,k,j))*p0/(p0*(al(i,k,j)+alb(i,k,j))*p0*(al(i,k,j)+alb(i,k,j)))*&amp;<a name='967'>
&amp;cpovcv*(r_d*(t0+t(i,k,j))/(p0*(al(i,k,j)+alb(i,k,j))))**(cpovcv-1)<a name='968'>
          a_t(i,k,j) = a_t(i,k,j)+a_p(i,k,j)*p0*r_d/(p0*(al(i,k,j)+alb(i,k,j)))*cpovcv*(r_d*(t0+t(i,k,j))/(p0*(al(i,k,j)+alb(i,k,j)&amp;<a name='969'>
&amp;)))**(cpovcv-1)<a name='970'>
          a_p(i,k,j) = 0.<a name='971'>
          a_mu(i,j) = a_mu(i,j)-a_al(i,k,j)*1./muts(i,j)*alb(i,k,j)<a name='972'>
          a_muts(i,j) = a_muts(i,j)+a_al(i,k,j)/(muts(i,j)*muts(i,j))*(alb(i,k,j)*mu(i,j)+rdnw(k)*(ph(i,k+1,j)-ph(i,k,j)))<a name='973'>
          a_ph(i,k+1,j) = a_ph(i,k+1,j)-a_al(i,k,j)*1./muts(i,j)*rdnw(k)<a name='974'>
          a_ph(i,k,j) = a_ph(i,k,j)+a_al(i,k,j)*1./muts(i,j)*rdnw(k)<a name='975'>
          a_al(i,k,j) = 0.<a name='976'>
        end do<a name='977'>
      end do<a name='978'>
    end do<a name='979'>
  endif<a name='980'>
else<a name='981'>
  if (n_moist .ge. param_first_scalar) then<a name='982'>
    do j = jts, jtf<a name='983'>
      a_qf1 = 0.<a name='984'>
      a_qf2 = 0.<a name='985'>
      a_qtot = 0.<a name='986'>
      a_qvf = 0.<a name='987'>
      k = ktf<a name='988'>
<font color=#447700>! recompute : k<a name='989'></font>
      do i = its, itf<a name='990'>
        qtot = 0.<a name='991'>
        do ispe = param_first_scalar, n_moist<a name='992'>
          qtot = qtot+moist(i,k,j,ispe)<a name='993'>
        end do<a name='994'>
        qf2 = 1./(1.+qtot)<a name='995'>
        qf1 = qtot*qf2<a name='996'>
        p(i,k,j) = -(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(k)/qf2)<a name='997'>
        qvf = 1.+rvovrd*moist(i,k,j,p_qv)<a name='998'>
        al(i,k,j) = r_d/p1000mb*(t(i,k,j)+t0)*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm-alb(i,k,j)<a name='999'>
      end do<a name='1000'>
<font color=#447700>! recompute : p<a name='1001'></font>
      do k = ktf-1, kts, -1<a name='1002'>
        do i = its, itf<a name='1003'>
          qtot = 0.<a name='1004'>
          do ispe = param_first_scalar, n_moist<a name='1005'>
            qtot = qtot+0.5*(moist(i,k,j,ispe)+moist(i,k+1,j,ispe))<a name='1006'>
          end do<a name='1007'>
          qf2 = 1./(1.+qtot)<a name='1008'>
          qf1 = qtot*qf2<a name='1009'>
          p(i,k,j) = p(i,k+1,j)-(mu(i,j)+qf1*muts(i,j))/qf2/rdn(k+1)<a name='1010'>
          qvf = 1.+rvovrd*moist(i,k,j,p_qv)<a name='1011'>
          al(i,k,j) = r_d/p1000mb*(t(i,k,j)+t0)*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm-alb(i,k,j)<a name='1012'>
        end do<a name='1013'>
      end do<a name='1014'>
<font color=#447700>! recompute : al<a name='1015'></font>
      do k = ktf+1, 2, -1<a name='1016'>
        do i = its, itf<a name='1017'>
          a_al(i,k-1,j) = a_al(i,k-1,j)-a_ph(i,k,j)*dnw(k-1)*muts(i,j)<a name='1018'>
          a_mu(i,j) = a_mu(i,j)-a_ph(i,k,j)*dnw(k-1)*alb(i,k-1,j)<a name='1019'>
          a_muts(i,j) = a_muts(i,j)-a_ph(i,k,j)*dnw(k-1)*al(i,k-1,j)<a name='1020'>
          a_ph(i,k-1,j) = a_ph(i,k-1,j)+a_ph(i,k,j)<a name='1021'>
          a_ph(i,k,j) = 0.<a name='1022'>
        end do<a name='1023'>
      end do<a name='1024'>
      do k = kts, ktf-1<a name='1025'>
<font color=#447700>!  recdepend vars : alb,cvpm,itf,its,j,k,moist,mu,muts,n_moist,p1000mb,p<a name='1026'></font>
<font color=#447700>! _qv,param_first_scalar,pb,r_d,rdnw,rvovrd,t,t0<a name='1027'></font>
<font color=#447700>! recompute pos : DOLOOP_STMT module_big_step_utilities_em.f90:1077<a name='1028'></font>
<font color=#447700>! recompute vars : p<a name='1029'></font>
        do i = its, itf<a name='1030'>
          qtot = 0.<a name='1031'>
          do ispe = param_first_scalar, n_moist<a name='1032'>
            qtot = qtot+moist(i,ka1,j,ispe)<a name='1033'>
          end do<a name='1034'>
          qf2 = 1./(1.+qtot)<a name='1035'>
          qf1 = qtot*qf2<a name='1036'>
          p(i,ka1,j) = -(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(ka1)/qf2)<a name='1037'>
          qvf = 1.+rvovrd*moist(i,ka1,j,p_qv)<a name='1038'>
          al(i,ka1,j) = r_d/p1000mb*(t(i,ka1,j)+t0)*qvf*((p(i,ka1,j)+pb(i,ka1,j))/p1000mb)**cvpm-alb(i,ka1,j)<a name='1039'>
        end do<a name='1040'>
<font color=#447700>! recompute vars : p<a name='1041'></font>
        do k1 = ktf-1, k-(-1), -1<a name='1042'>
          do i = its, itf<a name='1043'>
            qtot = 0.<a name='1044'>
            do ispe = param_first_scalar, n_moist<a name='1045'>
              qtot = qtot+0.5*(moist(i,k1,j,ispe)+moist(i,k1+1,j,ispe))<a name='1046'>
            end do<a name='1047'>
            qf2 = 1./(1.+qtot)<a name='1048'>
            qf1 = qtot*qf2<a name='1049'>
            p(i,k1,j) = p(i,k1+1,j)-(mu(i,j)+qf1*muts(i,j))/qf2/rdn(k1+1)<a name='1050'>
          end do<a name='1051'>
        end do<a name='1052'>
        do i = its, itf<a name='1053'>
          a_qf1 = 0.<a name='1054'>
          a_qf2 = 0.<a name='1055'>
          a_qtot = 0.<a name='1056'>
          a_qvf = 0.<a name='1057'>
          qtot = 0.<a name='1058'>
<font color=#447700>! recompute : qtot<a name='1059'></font>
          do ispe = param_first_scalar, n_moist<a name='1060'>
            qtot = qtot+0.5*(moist(i,k,j,ispe)+moist(i,k+1,j,ispe))<a name='1061'>
          end do<a name='1062'>
<font color=#447700>! recompute : qtot<a name='1063'></font>
          qf2 = 1./(1.+qtot)<a name='1064'>
<font color=#447700>! recompute : qf2<a name='1065'></font>
          qf1 = qtot*qf2<a name='1066'>
<font color=#447700>! recompute : qf1<a name='1067'></font>
          p(i,k,j) = p(i,k+1,j)-(mu(i,j)+qf1*muts(i,j))/qf2/rdn(k+1)<a name='1068'>
<font color=#447700>! recompute : p<a name='1069'></font>
          qvf = 1.+rvovrd*moist(i,k,j,p_qv)<a name='1070'>
<font color=#447700>! recompute : qvf<a name='1071'></font>
          a_p(i,k,j) = a_p(i,k,j)+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*qvf/p1000mb*cvpm*((p(i,k,j)+pb(i,k,j))/p1000mb)**(cvpm-1)<a name='1072'>
          a_qvf = a_qvf+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1073'>
          a_t(i,k,j) = a_t(i,k,j)+a_al(i,k,j)*r_d/p1000mb*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1074'>
          a_al(i,k,j) = 0.<a name='1075'>
          a_moist(i,k,j,p_qv) = a_moist(i,k,j,p_qv)+a_qvf*rvovrd<a name='1076'>
          a_qvf = 0.<a name='1077'>
          a_mu(i,j) = a_mu(i,j)-a_p(i,k,j)*(1/qf2/rdn(k+1))<a name='1078'>
          a_muts(i,j) = a_muts(i,j)-a_p(i,k,j)*(qf1/qf2/rdn(k+1))<a name='1079'>
          a_p(i,k+1,j) = a_p(i,k+1,j)+a_p(i,k,j)<a name='1080'>
          a_qf1 = a_qf1-a_p(i,k,j)*(muts(i,j)/qf2/rdn(k+1))<a name='1081'>
          a_qf2 = a_qf2+a_p(i,k,j)*((mu(i,j)+qf1*muts(i,j))/(qf2*qf2)/rdn(k+1))<a name='1082'>
          a_p(i,k,j) = 0.<a name='1083'>
          a_qf2 = a_qf2+a_qf1*qtot<a name='1084'>
          a_qtot = a_qtot+a_qf1*qf2<a name='1085'>
          a_qf1 = 0.<a name='1086'>
          a_qtot = a_qtot-a_qf2/((1.+qtot)*(1.+qtot))<a name='1087'>
          a_qf2 = 0.<a name='1088'>
          do ispe = param_first_scalar, n_moist<a name='1089'>
            a_moist(i,k+1,j,ispe) = a_moist(i,k+1,j,ispe)+0.5*a_qtot<a name='1090'>
            a_moist(i,k,j,ispe) = a_moist(i,k,j,ispe)+0.5*a_qtot<a name='1091'>
          end do<a name='1092'>
          a_qtot = 0.<a name='1093'>
        end do<a name='1094'>
      end do<a name='1095'>
<font color=#447700>! recdepend vars : ktf<a name='1096'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1076<a name='1097'></font>
<font color=#447700>! recompute vars : k<a name='1098'></font>
      k = ktf<a name='1099'>
<font color=#447700>! recompute vars : k<a name='1100'></font>
      do i = its, itf<a name='1101'>
        a_qf1 = 0.<a name='1102'>
        a_qf2 = 0.<a name='1103'>
        a_qtot = 0.<a name='1104'>
        a_qvf = 0.<a name='1105'>
        qtot = 0.<a name='1106'>
<font color=#447700>! recompute : qtot<a name='1107'></font>
        do ispe = param_first_scalar, n_moist<a name='1108'>
          qtot = qtot+moist(i,k,j,ispe)<a name='1109'>
        end do<a name='1110'>
<font color=#447700>! recompute : qtot<a name='1111'></font>
        qf2 = 1./(1.+qtot)<a name='1112'>
<font color=#447700>! recompute : qf2<a name='1113'></font>
        qf1 = qtot*qf2<a name='1114'>
<font color=#447700>! recompute : qf1<a name='1115'></font>
        p(i,k,j) = -(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(k)/qf2)<a name='1116'>
<font color=#447700>! recompute : p<a name='1117'></font>
        qvf = 1.+rvovrd*moist(i,k,j,p_qv)<a name='1118'>
<font color=#447700>! recompute : qvf<a name='1119'></font>
        a_p(i,k,j) = a_p(i,k,j)+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*qvf/p1000mb*cvpm*((p(i,k,j)+pb(i,k,j))/p1000mb)**(cvpm-1)<a name='1120'>
        a_qvf = a_qvf+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1121'>
        a_t(i,k,j) = a_t(i,k,j)+a_al(i,k,j)*r_d/p1000mb*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1122'>
        a_al(i,k,j) = 0.<a name='1123'>
        a_moist(i,k,j,p_qv) = a_moist(i,k,j,p_qv)+a_qvf*rvovrd<a name='1124'>
        a_qvf = 0.<a name='1125'>
        a_mu(i,j) = a_mu(i,j)-a_p(i,k,j)*(0.5/rdnw(k)/qf2)<a name='1126'>
        a_muts(i,j) = a_muts(i,j)-a_p(i,k,j)*(0.5*qf1/rdnw(k)/qf2)<a name='1127'>
        a_qf1 = a_qf1-a_p(i,k,j)*(0.5*muts(i,j)/rdnw(k)/qf2)<a name='1128'>
        a_qf2 = a_qf2+a_p(i,k,j)*(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(k)/(qf2*qf2))<a name='1129'>
        a_p(i,k,j) = 0.<a name='1130'>
        a_qf2 = a_qf2+a_qf1*qtot<a name='1131'>
        a_qtot = a_qtot+a_qf1*qf2<a name='1132'>
        a_qf1 = 0.<a name='1133'>
        a_qtot = a_qtot-a_qf2/((1.+qtot)*(1.+qtot))<a name='1134'>
        a_qf2 = 0.<a name='1135'>
        do ispe = param_first_scalar, n_moist<a name='1136'>
          a_moist(i,k,j,ispe) = a_moist(i,k,j,ispe)+a_qtot<a name='1137'>
        end do<a name='1138'>
        a_qtot = 0.<a name='1139'>
      end do<a name='1140'>
    end do<a name='1141'>
  else<a name='1142'>
    do j = jts, jtf<a name='1143'>
      a_qf1 = 0.<a name='1144'>
      a_qf2 = 0.<a name='1145'>
      a_qtot = 0.<a name='1146'>
      a_qvf = 0.<a name='1147'>
      k = ktf<a name='1148'>
<font color=#447700>! recompute : k<a name='1149'></font>
      do i = its, itf<a name='1150'>
        qtot = 0.<a name='1151'>
        qf2 = 1./(1.+qtot)<a name='1152'>
        qf1 = qtot*qf2<a name='1153'>
        p(i,k,j) = -(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(k)/qf2)<a name='1154'>
        qvf = 1.<a name='1155'>
        al(i,k,j) = r_d/p1000mb*(t(i,k,j)+t0)*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm-alb(i,k,j)<a name='1156'>
      end do<a name='1157'>
<font color=#447700>! recompute : p<a name='1158'></font>
      do k = ktf-1, kts, -1<a name='1159'>
        do i = its, itf<a name='1160'>
          qtot = 0.<a name='1161'>
          qf2 = 1./(1.+qtot)<a name='1162'>
          qf1 = qtot*qf2<a name='1163'>
          p(i,k,j) = p(i,k+1,j)-(mu(i,j)+qf1*muts(i,j))/qf2/rdn(k+1)<a name='1164'>
          qvf = 1.<a name='1165'>
          al(i,k,j) = r_d/p1000mb*(t(i,k,j)+t0)*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm-alb(i,k,j)<a name='1166'>
        end do<a name='1167'>
      end do<a name='1168'>
<font color=#447700>! recompute : al<a name='1169'></font>
      do k = ktf+1, 2, -1<a name='1170'>
        do i = its, itf<a name='1171'>
          a_al(i,k-1,j) = a_al(i,k-1,j)-a_ph(i,k,j)*dnw(k-1)*muts(i,j)<a name='1172'>
          a_mu(i,j) = a_mu(i,j)-a_ph(i,k,j)*dnw(k-1)*alb(i,k-1,j)<a name='1173'>
          a_muts(i,j) = a_muts(i,j)-a_ph(i,k,j)*dnw(k-1)*al(i,k-1,j)<a name='1174'>
          a_ph(i,k-1,j) = a_ph(i,k-1,j)+a_ph(i,k,j)<a name='1175'>
          a_ph(i,k,j) = 0.<a name='1176'>
        end do<a name='1177'>
      end do<a name='1178'>
      do k = kts, ktf-1<a name='1179'>
<font color=#447700>!  recdepend vars : alb,cvpm,itf,its,j,k,mu,muts,p1000mb,pb,r_d,rdnw,t,t<a name='1180'></font>
<font color=#447700>! 0<a name='1181'></font>
<font color=#447700>! recompute pos : DOLOOP_STMT module_big_step_utilities_em.f90:1131<a name='1182'></font>
<font color=#447700>! recompute vars : p<a name='1183'></font>
        do i = its, itf<a name='1184'>
          qtot = 0.<a name='1185'>
          qf2 = 1./(1.+qtot)<a name='1186'>
          qf1 = qtot*qf2<a name='1187'>
          p(i,ka2,j) = -(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(ka2)/qf2)<a name='1188'>
          qvf = 1.<a name='1189'>
          al(i,ka2,j) = r_d/p1000mb*(t(i,ka2,j)+t0)*qvf*((p(i,ka2,j)+pb(i,ka2,j))/p1000mb)**cvpm-alb(i,ka2,j)<a name='1190'>
        end do<a name='1191'>
<font color=#447700>! recompute vars : p<a name='1192'></font>
        do k2 = ktf-1, k-(-1), -1<a name='1193'>
          do i = its, itf<a name='1194'>
            qtot = 0.<a name='1195'>
            qf2 = 1./(1.+qtot)<a name='1196'>
            qf1 = qtot*qf2<a name='1197'>
            p(i,k2,j) = p(i,k2+1,j)-(mu(i,j)+qf1*muts(i,j))/qf2/rdn(k2+1)<a name='1198'>
          end do<a name='1199'>
        end do<a name='1200'>
        do i = its, itf<a name='1201'>
          a_qf1 = 0.<a name='1202'>
          a_qf2 = 0.<a name='1203'>
          a_qtot = 0.<a name='1204'>
          a_qvf = 0.<a name='1205'>
          qtot = 0.<a name='1206'>
<font color=#447700>! recompute : qtot<a name='1207'></font>
          qf2 = 1./(1.+qtot)<a name='1208'>
<font color=#447700>! recompute : qf2<a name='1209'></font>
          qf1 = qtot*qf2<a name='1210'>
<font color=#447700>! recompute : qf1<a name='1211'></font>
          p(i,k,j) = p(i,k+1,j)-(mu(i,j)+qf1*muts(i,j))/qf2/rdn(k+1)<a name='1212'>
<font color=#447700>! recompute : p<a name='1213'></font>
          qvf = 1.<a name='1214'>
<font color=#447700>! recompute : qvf<a name='1215'></font>
          a_p(i,k,j) = a_p(i,k,j)+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*qvf/p1000mb*cvpm*((p(i,k,j)+pb(i,k,j))/p1000mb)**(cvpm-1)<a name='1216'>
          a_qvf = a_qvf+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1217'>
          a_t(i,k,j) = a_t(i,k,j)+a_al(i,k,j)*r_d/p1000mb*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1218'>
          a_al(i,k,j) = 0.<a name='1219'>
          a_mu(i,j) = a_mu(i,j)-a_p(i,k,j)*(1/qf2/rdn(k+1))<a name='1220'>
          a_muts(i,j) = a_muts(i,j)-a_p(i,k,j)*(qf1/qf2/rdn(k+1))<a name='1221'>
          a_p(i,k+1,j) = a_p(i,k+1,j)+a_p(i,k,j)<a name='1222'>
          a_qf1 = a_qf1-a_p(i,k,j)*(muts(i,j)/qf2/rdn(k+1))<a name='1223'>
          a_qf2 = a_qf2+a_p(i,k,j)*((mu(i,j)+qf1*muts(i,j))/(qf2*qf2)/rdn(k+1))<a name='1224'>
          a_p(i,k,j) = 0.<a name='1225'>
        end do<a name='1226'>
      end do<a name='1227'>
<font color=#447700>! recdepend vars : ktf<a name='1228'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1130<a name='1229'></font>
<font color=#447700>! recompute vars : k<a name='1230'></font>
      k = ktf<a name='1231'>
<font color=#447700>! recompute vars : k<a name='1232'></font>
      do i = its, itf<a name='1233'>
        a_qf1 = 0.<a name='1234'>
        a_qf2 = 0.<a name='1235'>
        a_qtot = 0.<a name='1236'>
        a_qvf = 0.<a name='1237'>
        qtot = 0.<a name='1238'>
<font color=#447700>! recompute : qtot<a name='1239'></font>
        qf2 = 1./(1.+qtot)<a name='1240'>
<font color=#447700>! recompute : qf2<a name='1241'></font>
        qf1 = qtot*qf2<a name='1242'>
<font color=#447700>! recompute : qf1<a name='1243'></font>
        p(i,k,j) = -(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(k)/qf2)<a name='1244'>
<font color=#447700>! recompute : p<a name='1245'></font>
        qvf = 1.<a name='1246'>
<font color=#447700>! recompute : qvf<a name='1247'></font>
        a_p(i,k,j) = a_p(i,k,j)+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*qvf/p1000mb*cvpm*((p(i,k,j)+pb(i,k,j))/p1000mb)**(cvpm-1)<a name='1248'>
        a_qvf = a_qvf+a_al(i,k,j)*r_d/p1000mb*(t(i,k,j)+t0)*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1249'>
        a_t(i,k,j) = a_t(i,k,j)+a_al(i,k,j)*r_d/p1000mb*qvf*((p(i,k,j)+pb(i,k,j))/p1000mb)**cvpm<a name='1250'>
        a_al(i,k,j) = 0.<a name='1251'>
        a_mu(i,j) = a_mu(i,j)-a_p(i,k,j)*(0.5/rdnw(k)/qf2)<a name='1252'>
        a_muts(i,j) = a_muts(i,j)-a_p(i,k,j)*(0.5*qf1/rdnw(k)/qf2)<a name='1253'>
        a_qf1 = a_qf1-a_p(i,k,j)*(0.5*muts(i,j)/rdnw(k)/qf2)<a name='1254'>
        a_qf2 = a_qf2+a_p(i,k,j)*(0.5*(mu(i,j)+qf1*muts(i,j))/rdnw(k)/(qf2*qf2))<a name='1255'>
        a_p(i,k,j) = 0.<a name='1256'>
      end do<a name='1257'>
    end do<a name='1258'>
  endif<a name='1259'>
endif<a name='1260'>
<a name='1261'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_P_RHO_PHI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_22">("a_calc_p_rho_phi")<a name='1262'>
<a name='1263'>
end subroutine a_calc_p_rho_phi<a name='1264'>
<a name='1265'>
<a name='1266'>
<A NAME='A_CALC_PHP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_PHP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1267'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_php</font>( a_php, a_ph, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte ) <A href='../../call_to/A_CALC_PHP.html' TARGET='index'>1</A>,<A href='../../call_from/A_CALC_PHP.html' TARGET='index'>2</A><a name='1268'>
<font color=#447700>!******************************************************************<a name='1269'></font>
<font color=#447700>!******************************************************************<a name='1270'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1271'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1272'></font>
<font color=#447700>!******************************************************************<a name='1273'></font>
<font color=#447700>!******************************************************************<a name='1274'></font>
<font color=#447700>!==============================================<a name='1275'></font>
<font color=#447700>! all entries are defined explicitly<a name='1276'></font>
<font color=#447700>!==============================================<a name='1277'></font>
implicit none<a name='1278'>
<a name='1279'>
<font color=#447700>!==============================================<a name='1280'></font>
<font color=#447700>! declare arguments<a name='1281'></font>
<font color=#447700>!==============================================<a name='1282'></font>
integer, intent(in) :: ime<a name='1283'>
integer, intent(in) :: ims<a name='1284'>
integer, intent(in) :: jme<a name='1285'>
integer, intent(in) :: jms<a name='1286'>
integer, intent(in) :: kme<a name='1287'>
integer, intent(in) :: kms<a name='1288'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='1289'>
real, intent(inout) :: a_php(ims:ime,kms:kme,jms:jme)<a name='1290'>
integer, intent(in) :: ide<a name='1291'>
integer, intent(in) :: ite<a name='1292'>
integer, intent(in) :: its<a name='1293'>
integer, intent(in) :: jde<a name='1294'>
integer, intent(in) :: jte<a name='1295'>
integer, intent(in) :: jts<a name='1296'>
integer, intent(in) :: kde<a name='1297'>
integer, intent(in) :: kte<a name='1298'>
integer, intent(in) :: kts<a name='1299'>
<a name='1300'>
<font color=#447700>!==============================================<a name='1301'></font>
<font color=#447700>! declare local variables<a name='1302'></font>
<font color=#447700>!==============================================<a name='1303'></font>
integer i<a name='1304'>
integer itf<a name='1305'>
integer j<a name='1306'>
integer jtf<a name='1307'>
integer k<a name='1308'>
integer ktf<a name='1309'>
<a name='1310'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_PHP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_23">("a_calc_php")<a name='1311'>
<a name='1312'>
<font color=#447700>!----------------------------------------------<a name='1313'></font>
<font color=#447700>! ROUTINE BODY<a name='1314'></font>
<font color=#447700>!----------------------------------------------<a name='1315'></font>
itf = min(ite,ide-1)<a name='1316'>
<font color=#447700>! recompute : itf<a name='1317'></font>
jtf = min(jte,jde-1)<a name='1318'>
<font color=#447700>! recompute : jtf<a name='1319'></font>
ktf = min(kte,kde-1)<a name='1320'>
<font color=#447700>! recompute : ktf<a name='1321'></font>
do j = jts, jtf<a name='1322'>
  do k = kts, ktf<a name='1323'>
    do i = its, itf<a name='1324'>
      a_ph(i,k+1,j) = a_ph(i,k+1,j)+0.5*a_php(i,k,j)<a name='1325'>
      a_ph(i,k,j) = a_ph(i,k,j)+0.5*a_php(i,k,j)<a name='1326'>
      a_php(i,k,j) = 0.<a name='1327'>
    end do<a name='1328'>
  end do<a name='1329'>
end do<a name='1330'>
<a name='1331'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_PHP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_23">("a_calc_php")<a name='1332'>
<a name='1333'>
end subroutine a_calc_php<a name='1334'>
<a name='1335'>
<a name='1336'>
<A NAME='A_CALC_WW_CP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_WW_CP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1337'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calc_ww_cp</font>( u, a_u, v, a_v, mup, a_mup, mub, a_ww, rdx, rdy, msft, msfu, msfv, dnw, ide, jde, kde, ims, ime, jms, jme,&amp; <A href='../../call_to/A_CALC_WW_CP.html' TARGET='index'>1</A>,<A href='../../call_from/A_CALC_WW_CP.html' TARGET='index'>2</A><a name='1338'>
&amp; kms, kme, its, ite, jts, jte, kts, kte )<a name='1339'>
<font color=#447700>!******************************************************************<a name='1340'></font>
<font color=#447700>!******************************************************************<a name='1341'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1342'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1343'></font>
<font color=#447700>!******************************************************************<a name='1344'></font>
<font color=#447700>!******************************************************************<a name='1345'></font>
<font color=#447700>!==============================================<a name='1346'></font>
<font color=#447700>! all entries are defined explicitly<a name='1347'></font>
<font color=#447700>!==============================================<a name='1348'></font>
implicit none<a name='1349'>
<a name='1350'>
<font color=#447700>!==============================================<a name='1351'></font>
<font color=#447700>! declare arguments<a name='1352'></font>
<font color=#447700>!==============================================<a name='1353'></font>
integer, intent(in) :: ime<a name='1354'>
integer, intent(in) :: ims<a name='1355'>
integer, intent(in) :: jme<a name='1356'>
integer, intent(in) :: jms<a name='1357'>
real, intent(inout) :: a_mup(ims:ime,jms:jme)<a name='1358'>
integer, intent(in) :: kme<a name='1359'>
integer, intent(in) :: kms<a name='1360'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='1361'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='1362'>
real, intent(inout) :: a_ww(ims:ime,kms:kme,jms:jme)<a name='1363'>
real, intent(in) :: dnw(kms:kme)<a name='1364'>
integer, intent(in) :: ide<a name='1365'>
integer, intent(in) :: ite<a name='1366'>
integer, intent(in) :: its<a name='1367'>
integer, intent(in) :: jde<a name='1368'>
integer, intent(in) :: jte<a name='1369'>
integer, intent(in) :: jts<a name='1370'>
integer, intent(in) :: kde<a name='1371'>
integer, intent(in) :: kte<a name='1372'>
integer, intent(in) :: kts<a name='1373'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='1374'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='1375'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='1376'>
real, intent(in) :: mub(ims:ime,jms:jme)<a name='1377'>
real, intent(in) :: mup(ims:ime,jms:jme)<a name='1378'>
real, intent(in) :: rdx<a name='1379'>
real, intent(in) :: rdy<a name='1380'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='1381'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='1382'>
<a name='1383'>
<font color=#447700>!==============================================<a name='1384'></font>
<font color=#447700>! declare local variables<a name='1385'></font>
<font color=#447700>!==============================================<a name='1386'></font>
real a_divv(its:ite,kts:kte)<a name='1387'>
real a_dmdt(its:ite)<a name='1388'>
real a_muu(its:ite+1,jts:jte+1)<a name='1389'>
real a_muv(its:ite+1,jts:jte+1)<a name='1390'>
integer i<a name='1391'>
integer itf<a name='1392'>
integer j<a name='1393'>
integer jtf<a name='1394'>
integer k<a name='1395'>
integer ktf<a name='1396'>
real muu(its:ite+1,jts:jte+1)<a name='1397'>
real muv(its:ite+1,jts:jte+1)<a name='1398'>
<a name='1399'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_WW_CP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_24">("a_calc_ww_cp")<a name='1400'>
<a name='1401'>
<font color=#447700>!----------------------------------------------<a name='1402'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='1403'></font>
<font color=#447700>!----------------------------------------------<a name='1404'></font>
a_divv(:,:) = 0.<a name='1405'>
a_dmdt(:) = 0.<a name='1406'>
a_muu(:,:) = 0.<a name='1407'>
a_muv(:,:) = 0.<a name='1408'>
<a name='1409'>
<font color=#447700>!----------------------------------------------<a name='1410'></font>
<font color=#447700>! ROUTINE BODY<a name='1411'></font>
<font color=#447700>!----------------------------------------------<a name='1412'></font>
jtf = min(jte,jde-1)<a name='1413'>
<font color=#447700>! recompute : jtf<a name='1414'></font>
ktf = min(kte,kde-1)<a name='1415'>
<font color=#447700>! recompute : ktf<a name='1416'></font>
itf = min(ite,ide-1)<a name='1417'>
<font color=#447700>! recompute : itf<a name='1418'></font>
do j = jts, jtf<a name='1419'>
  do i = its, min(ite+1,ide)<a name='1420'>
    muu(i,j) = 0.5*(mup(i,j)+mub(i,j)+mup(i-1,j)+mub(i-1,j))/msfu(i,j)<a name='1421'>
  end do<a name='1422'>
end do<a name='1423'>
<font color=#447700>! recompute : muu<a name='1424'></font>
do j = jts, min(jte+1,jde)<a name='1425'>
  do i = its, itf<a name='1426'>
    muv(i,j) = 0.5*(mup(i,j)+mub(i,j)+mup(i,j-1)+mub(i,j-1))/msfv(i,j)<a name='1427'>
  end do<a name='1428'>
end do<a name='1429'>
<font color=#447700>! recompute : muv<a name='1430'></font>
do j = jts, jtf<a name='1431'>
  do k = ktf, 2, -1<a name='1432'>
    do i = its, itf<a name='1433'>
      a_divv(i,k-1) = a_divv(i,k-1)-a_ww(i,k,j)<a name='1434'>
      a_dmdt(i) = a_dmdt(i)-a_ww(i,k,j)*dnw(k-1)<a name='1435'>
      a_ww(i,k-1,j) = a_ww(i,k-1,j)+a_ww(i,k,j)<a name='1436'>
      a_ww(i,k,j) = 0.<a name='1437'>
    end do<a name='1438'>
  end do<a name='1439'>
  do k = ktf, kts, -1<a name='1440'>
    do i = its, itf<a name='1441'>
      a_divv(i,k) = a_divv(i,k)+a_dmdt(i)<a name='1442'>
      a_muu(i+1,j) = a_muu(i+1,j)+a_divv(i,k)*msft(i,j)*dnw(k)*rdx*u(i+1,k,j)<a name='1443'>
      a_muu(i,j) = a_muu(i,j)-a_divv(i,k)*msft(i,j)*dnw(k)*rdx*u(i,k,j)<a name='1444'>
      a_muv(i,j+1) = a_muv(i,j+1)+a_divv(i,k)*msft(i,j)*dnw(k)*rdy*v(i,k,j+1)<a name='1445'>
      a_muv(i,j) = a_muv(i,j)-a_divv(i,k)*msft(i,j)*dnw(k)*rdy*v(i,k,j)<a name='1446'>
      a_u(i+1,k,j) = a_u(i+1,k,j)+a_divv(i,k)*msft(i,j)*dnw(k)*rdx*muu(i+1,j)<a name='1447'>
      a_u(i,k,j) = a_u(i,k,j)-a_divv(i,k)*msft(i,j)*dnw(k)*rdx*muu(i,j)<a name='1448'>
      a_v(i,k,j+1) = a_v(i,k,j+1)+a_divv(i,k)*msft(i,j)*dnw(k)*rdy*muv(i,j+1)<a name='1449'>
      a_v(i,k,j) = a_v(i,k,j)-a_divv(i,k)*msft(i,j)*dnw(k)*rdy*muv(i,j)<a name='1450'>
      a_divv(i,k) = 0.<a name='1451'>
    end do<a name='1452'>
  end do<a name='1453'>
  do i = its, ite<a name='1454'>
    a_ww(i,kte,j) = 0.<a name='1455'>
    a_ww(i,1,j) = 0.<a name='1456'>
    a_dmdt(i) = 0.<a name='1457'>
  end do<a name='1458'>
end do<a name='1459'>
do j = jts, min(jte+1,jde)<a name='1460'>
  do i = its, itf<a name='1461'>
    a_mup(i,j-1) = a_mup(i,j-1)+a_muv(i,j)*(0.5/msfv(i,j))<a name='1462'>
    a_mup(i,j) = a_mup(i,j)+a_muv(i,j)*(0.5/msfv(i,j))<a name='1463'>
    a_muv(i,j) = 0.<a name='1464'>
  end do<a name='1465'>
end do<a name='1466'>
do j = jts, jtf<a name='1467'>
  do i = its, min(ite+1,ide)<a name='1468'>
    a_mup(i-1,j) = a_mup(i-1,j)+a_muu(i,j)*(0.5/msfu(i,j))<a name='1469'>
    a_mup(i,j) = a_mup(i,j)+a_muu(i,j)*(0.5/msfu(i,j))<a name='1470'>
    a_muu(i,j) = 0.<a name='1471'>
  end do<a name='1472'>
end do<a name='1473'>
<a name='1474'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALC_WW_CP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_24">("a_calc_ww_cp")<a name='1475'>
<a name='1476'>
end subroutine a_calc_ww_cp<a name='1477'>
<a name='1478'>
<a name='1479'>
<A NAME='A_CALCULATE_FULL'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALCULATE_FULL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1480'>
<font color=#993300>subroutine </font><font color=#cc0000>a_calculate_full</font>( a_rfield, a_rfieldp, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte ) <A href='../../call_to/A_CALCULATE_FULL.html' TARGET='index'>1</A>,<A href='../../call_from/A_CALCULATE_FULL.html' TARGET='index'>2</A><a name='1481'>
<font color=#447700>!******************************************************************<a name='1482'></font>
<font color=#447700>!******************************************************************<a name='1483'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1484'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1485'></font>
<font color=#447700>!******************************************************************<a name='1486'></font>
<font color=#447700>!******************************************************************<a name='1487'></font>
<font color=#447700>!==============================================<a name='1488'></font>
<font color=#447700>! all entries are defined explicitly<a name='1489'></font>
<font color=#447700>!==============================================<a name='1490'></font>
implicit none<a name='1491'>
<a name='1492'>
<font color=#447700>!==============================================<a name='1493'></font>
<font color=#447700>! declare arguments<a name='1494'></font>
<font color=#447700>!==============================================<a name='1495'></font>
integer, intent(in) :: ime<a name='1496'>
integer, intent(in) :: ims<a name='1497'>
integer, intent(in) :: jme<a name='1498'>
integer, intent(in) :: jms<a name='1499'>
integer, intent(in) :: kme<a name='1500'>
integer, intent(in) :: kms<a name='1501'>
real, intent(inout) :: a_rfield(ims:ime,kms:kme,jms:jme)<a name='1502'>
real, intent(inout) :: a_rfieldp(ims:ime,kms:kme,jms:jme)<a name='1503'>
integer, intent(in) :: ide<a name='1504'>
integer, intent(in) :: ite<a name='1505'>
integer, intent(in) :: its<a name='1506'>
integer, intent(in) :: jde<a name='1507'>
integer, intent(in) :: jte<a name='1508'>
integer, intent(in) :: jts<a name='1509'>
integer, intent(in) :: kde<a name='1510'>
integer, intent(in) :: kte<a name='1511'>
integer, intent(in) :: kts<a name='1512'>
<a name='1513'>
<font color=#447700>!==============================================<a name='1514'></font>
<font color=#447700>! declare local variables<a name='1515'></font>
<font color=#447700>!==============================================<a name='1516'></font>
integer i<a name='1517'>
integer itf<a name='1518'>
integer j<a name='1519'>
integer jtf<a name='1520'>
integer k<a name='1521'>
integer ktf<a name='1522'>
<a name='1523'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALCULATE_FULL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_25">("a_calculate_full")<a name='1524'>
<a name='1525'>
<font color=#447700>!----------------------------------------------<a name='1526'></font>
<font color=#447700>! ROUTINE BODY<a name='1527'></font>
<font color=#447700>!----------------------------------------------<a name='1528'></font>
itf = min(ite,ide-1)<a name='1529'>
<font color=#447700>! recompute : itf<a name='1530'></font>
jtf = min(jte,jde-1)<a name='1531'>
<font color=#447700>! recompute : jtf<a name='1532'></font>
ktf = min(kte,kde-1)<a name='1533'>
<font color=#447700>! recompute : ktf<a name='1534'></font>
do j = jts, jtf<a name='1535'>
  do k = kts, ktf<a name='1536'>
    do i = its, itf<a name='1537'>
      a_rfieldp(i,k,j) = a_rfieldp(i,k,j)+a_rfield(i,k,j)<a name='1538'>
      a_rfield(i,k,j) = 0.<a name='1539'>
    end do<a name='1540'>
  end do<a name='1541'>
end do<a name='1542'>
<a name='1543'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CALCULATE_FULL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_25">("a_calculate_full")<a name='1544'>
<a name='1545'>
end subroutine a_calculate_full<a name='1546'>
<a name='1547'>
<a name='1548'>
<A NAME='A_CORIOLIS'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CORIOLIS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1549'>
<font color=#993300>subroutine </font><font color=#cc0000>a_coriolis</font>( a_ru, a_rv, a_rw, a_ru_tend, a_rv_tend, a_rw_tend, config_flags, f, e, sina, cosa, fzm, fzp, ids, ide, jds, &amp; <A href='../../call_to/A_CORIOLIS.html' TARGET='index'>1</A>,<A href='../../call_from/A_CORIOLIS.html' TARGET='index'>2</A><a name='1550'>
&amp;jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='1551'>
<font color=#447700>!******************************************************************<a name='1552'></font>
<font color=#447700>!******************************************************************<a name='1553'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1554'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1555'></font>
<font color=#447700>!******************************************************************<a name='1556'></font>
<font color=#447700>!******************************************************************<a name='1557'></font>
<font color=#447700>!==============================================<a name='1558'></font>
<font color=#447700>! all entries are defined explicitly<a name='1559'></font>
<font color=#447700>!==============================================<a name='1560'></font>
implicit none<a name='1561'>
<a name='1562'>
<font color=#447700>!==============================================<a name='1563'></font>
<font color=#447700>! declare arguments<a name='1564'></font>
<font color=#447700>!==============================================<a name='1565'></font>
integer, intent(in) :: ime<a name='1566'>
integer, intent(in) :: ims<a name='1567'>
integer, intent(in) :: jme<a name='1568'>
integer, intent(in) :: jms<a name='1569'>
integer, intent(in) :: kme<a name='1570'>
integer, intent(in) :: kms<a name='1571'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='1572'>
real, intent(inout) :: a_ru_tend(ims:ime,kms:kme,jms:jme)<a name='1573'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='1574'>
real, intent(inout) :: a_rv_tend(ims:ime,kms:kme,jms:jme)<a name='1575'>
real, intent(inout) :: a_rw(ims:ime,kms:kme,jms:jme)<a name='1576'>
real, intent(inout) :: a_rw_tend(ims:ime,kms:kme,jms:jme)<a name='1577'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='1578'>
real, intent(in) :: cosa(ims:ime,jms:jme)<a name='1579'>
real, intent(in) :: e(ims:ime,jms:jme)<a name='1580'>
real, intent(in) :: f(ims:ime,jms:jme)<a name='1581'>
real, intent(in) :: fzm(kms:kme)<a name='1582'>
real, intent(in) :: fzp(kms:kme)<a name='1583'>
integer, intent(in) :: ide<a name='1584'>
integer, intent(in) :: ids<a name='1585'>
integer, intent(in) :: ite<a name='1586'>
integer, intent(in) :: its<a name='1587'>
integer, intent(in) :: jde<a name='1588'>
integer, intent(in) :: jds<a name='1589'>
integer, intent(in) :: jte<a name='1590'>
integer, intent(in) :: jts<a name='1591'>
integer, intent(in) :: kde<a name='1592'>
integer, intent(in) :: kte<a name='1593'>
integer, intent(in) :: kts<a name='1594'>
real, intent(in) :: sina(ims:ime,jms:jme)<a name='1595'>
<a name='1596'>
<font color=#447700>!==============================================<a name='1597'></font>
<font color=#447700>! declare local variables<a name='1598'></font>
<font color=#447700>!==============================================<a name='1599'></font>
integer i<a name='1600'>
integer i_end<a name='1601'>
integer i_start<a name='1602'>
integer j<a name='1603'>
integer j_end<a name='1604'>
integer j_start<a name='1605'>
integer k<a name='1606'>
integer ktf<a name='1607'>
logical specified<a name='1608'>
<a name='1609'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CORIOLIS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_26">("a_coriolis")<a name='1610'>
<a name='1611'>
<font color=#447700>!----------------------------------------------<a name='1612'></font>
<font color=#447700>! ROUTINE BODY<a name='1613'></font>
<font color=#447700>!----------------------------------------------<a name='1614'></font>
specified =  .false. <a name='1615'>
<font color=#447700>! recompute : specified<a name='1616'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='1617'>
  specified =  .true. <a name='1618'>
endif<a name='1619'>
<font color=#447700>! recompute : specified<a name='1620'></font>
ktf = min(kte,kde-1)<a name='1621'>
<font color=#447700>! recompute : ktf<a name='1622'></font>
i_start = its<a name='1623'>
<font color=#447700>! recompute : i_start<a name='1624'></font>
i_end = ite<a name='1625'>
<font color=#447700>! recompute : i_end<a name='1626'></font>
if (config_flags%open_xs .or. specified .or. config_flags%nested) then<a name='1627'>
  i_start = max(ids+1,its)<a name='1628'>
endif<a name='1629'>
<font color=#447700>! recompute : i_start<a name='1630'></font>
if (config_flags%open_xe .or. specified .or. config_flags%nested) then<a name='1631'>
  i_end = min(ide-1,ite)<a name='1632'>
endif<a name='1633'>
<font color=#447700>! recompute : i_end<a name='1634'></font>
j_start = jts<a name='1635'>
<font color=#447700>! recompute : j_start<a name='1636'></font>
j_end = jte<a name='1637'>
<font color=#447700>! recompute : j_end<a name='1638'></font>
if (config_flags%open_ys .or. specified .or. config_flags%nested) then<a name='1639'>
  j_start = max(jds+1,jts)<a name='1640'>
endif<a name='1641'>
<font color=#447700>! recompute : j_start<a name='1642'></font>
if (config_flags%open_ye .or. specified .or. config_flags%nested) then<a name='1643'>
  j_end = min(jde-1,jte)<a name='1644'>
endif<a name='1645'>
<font color=#447700>! recompute : j_end<a name='1646'></font>
do j = jts, min(jte,jde-1)<a name='1647'>
  do k = kts+1, ktf<a name='1648'>
    do i = its, min(ite,ide-1)<a name='1649'>
      a_ru(i+1,k-1,j) = a_ru(i+1,k-1,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzp(k)<a name='1650'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzp(k)<a name='1651'>
      a_ru(i+1,k,j) = a_ru(i+1,k,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzm(k)<a name='1652'>
      a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzm(k)<a name='1653'>
      a_rv(i,k-1,j+1) = a_rv(i,k-1,j+1)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzp(k)<a name='1654'>
      a_rv(i,k-1,j) = a_rv(i,k-1,j)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzp(k)<a name='1655'>
      a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzm(k)<a name='1656'>
      a_rv(i,k,j) = a_rv(i,k,j)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzm(k)<a name='1657'>
    end do<a name='1658'>
  end do<a name='1659'>
end do<a name='1660'>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='1661'>
  do k = kts, ktf<a name='1662'>
    do i = its, min(ide-1,ite)<a name='1663'>
      a_ru(i+1,k,jte-1) = a_ru(i+1,k,jte-1)-0.5*a_rv_tend(i,k,jte)*f(i,jte-1)<a name='1664'>
      a_ru(i,k,jte-1) = a_ru(i,k,jte-1)-0.5*a_rv_tend(i,k,jte)*f(i,jte-1)<a name='1665'>
      a_rw(i,k+1,jte-1) = a_rw(i,k+1,jte-1)+0.5*a_rv_tend(i,k,jte)*e(i,jte-1)*sina(i,jte-1)<a name='1666'>
      a_rw(i,k,jte-1) = a_rw(i,k,jte-1)+0.5*a_rv_tend(i,k,jte)*e(i,jte-1)*sina(i,jte-1)<a name='1667'>
    end do<a name='1668'>
  end do<a name='1669'>
endif<a name='1670'>
do j = j_start, j_end<a name='1671'>
  do k = kts, ktf<a name='1672'>
    do i = its, min(ide-1,ite)<a name='1673'>
      a_ru(i+1,k,j-1) = a_ru(i+1,k,j-1)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='1674'>
      a_ru(i,k,j-1) = a_ru(i,k,j-1)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='1675'>
      a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='1676'>
      a_ru(i,k,j) = a_ru(i,k,j)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='1677'>
      a_rw(i,k+1,j-1) = a_rw(i,k+1,j-1)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='1678'>
      a_rw(i,k+1,j) = a_rw(i,k+1,j)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='1679'>
      a_rw(i,k,j-1) = a_rw(i,k,j-1)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='1680'>
      a_rw(i,k,j) = a_rw(i,k,j)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='1681'>
    end do<a name='1682'>
  end do<a name='1683'>
end do<a name='1684'>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='1685'>
  do k = kts, ktf<a name='1686'>
    do i = its, min(ide-1,ite)<a name='1687'>
      a_ru(i+1,k,jts) = a_ru(i+1,k,jts)-0.5*a_rv_tend(i,k,jts)*f(i,jts)<a name='1688'>
      a_ru(i,k,jts) = a_ru(i,k,jts)-0.5*a_rv_tend(i,k,jts)*f(i,jts)<a name='1689'>
      a_rw(i,k+1,jts) = a_rw(i,k+1,jts)+0.5*a_rv_tend(i,k,jts)*e(i,jts)*sina(i,jts)<a name='1690'>
      a_rw(i,k,jts) = a_rw(i,k,jts)+0.5*a_rv_tend(i,k,jts)*e(i,jts)*sina(i,jts)<a name='1691'>
    end do<a name='1692'>
  end do<a name='1693'>
endif<a name='1694'>
do j = jts, min(jte,jde-1)<a name='1695'>
  if (config_flags%open_xe .and. ite .eq. ide) then<a name='1696'>
    do k = kts, ktf<a name='1697'>
      a_rv(ite-1,k,j+1) = a_rv(ite-1,k,j+1)+0.5*a_ru_tend(ite,k,j)*f(ite-1,j)<a name='1698'>
      a_rv(ite-1,k,j) = a_rv(ite-1,k,j)+0.5*a_ru_tend(ite,k,j)*f(ite-1,j)<a name='1699'>
      a_rw(ite-1,k+1,j) = a_rw(ite-1,k+1,j)-0.5*a_ru_tend(ite,k,j)*e(ite-1,j)*cosa(ite-1,j)<a name='1700'>
      a_rw(ite-1,k,j) = a_rw(ite-1,k,j)-0.5*a_ru_tend(ite,k,j)*e(ite-1,j)*cosa(ite-1,j)<a name='1701'>
    end do<a name='1702'>
  endif<a name='1703'>
  if (config_flags%open_xs .and. its .eq. ids) then<a name='1704'>
    do k = kts, ktf<a name='1705'>
      a_rv(its,k,j+1) = a_rv(its,k,j+1)+0.5*a_ru_tend(its,k,j)*f(its,j)<a name='1706'>
      a_rv(its,k,j) = a_rv(its,k,j)+0.5*a_ru_tend(its,k,j)*f(its,j)<a name='1707'>
      a_rw(its,k+1,j) = a_rw(its,k+1,j)-0.5*a_ru_tend(its,k,j)*e(its,j)*cosa(its,j)<a name='1708'>
      a_rw(its,k,j) = a_rw(its,k,j)-0.5*a_ru_tend(its,k,j)*e(its,j)*cosa(its,j)<a name='1709'>
    end do<a name='1710'>
  endif<a name='1711'>
  do k = kts, ktf<a name='1712'>
    do i = i_start, i_end<a name='1713'>
      a_rv(i-1,k,j+1) = a_rv(i-1,k,j+1)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='1714'>
      a_rv(i,k,j+1) = a_rv(i,k,j+1)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='1715'>
      a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='1716'>
      a_rv(i,k,j) = a_rv(i,k,j)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='1717'>
      a_rw(i-1,k+1,j) = a_rw(i-1,k+1,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='1718'>
      a_rw(i,k+1,j) = a_rw(i,k+1,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='1719'>
      a_rw(i-1,k,j) = a_rw(i-1,k,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='1720'>
      a_rw(i,k,j) = a_rw(i,k,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='1721'>
    end do<a name='1722'>
  end do<a name='1723'>
end do<a name='1724'>
<a name='1725'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CORIOLIS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_26">("a_coriolis")<a name='1726'>
<a name='1727'>
end subroutine a_coriolis<a name='1728'>
<a name='1729'>
<a name='1730'>
<A NAME='A_COUPLE_MOMENTUM'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_COUPLE_MOMENTUM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1731'>
<font color=#993300>subroutine </font><font color=#cc0000>a_couple_momentum</font>( muu, a_muu, a_ru, u, a_u, msfu, muv, a_muv, a_rv, v, a_v, msfv, mut, a_mut, a_rw, w, a_w, msft, ide, &amp; <A href='../../call_to/A_COUPLE_MOMENTUM.html' TARGET='index'>1</A>,<A href='../../call_from/A_COUPLE_MOMENTUM.html' TARGET='index'>2</A><a name='1732'>
&amp;jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='1733'>
<font color=#447700>!******************************************************************<a name='1734'></font>
<font color=#447700>!******************************************************************<a name='1735'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1736'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1737'></font>
<font color=#447700>!******************************************************************<a name='1738'></font>
<font color=#447700>!******************************************************************<a name='1739'></font>
<font color=#447700>!==============================================<a name='1740'></font>
<font color=#447700>! all entries are defined explicitly<a name='1741'></font>
<font color=#447700>!==============================================<a name='1742'></font>
implicit none<a name='1743'>
<a name='1744'>
<font color=#447700>!==============================================<a name='1745'></font>
<font color=#447700>! declare arguments<a name='1746'></font>
<font color=#447700>!==============================================<a name='1747'></font>
integer, intent(in) :: ime<a name='1748'>
integer, intent(in) :: ims<a name='1749'>
integer, intent(in) :: jme<a name='1750'>
integer, intent(in) :: jms<a name='1751'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='1752'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='1753'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='1754'>
integer, intent(in) :: kme<a name='1755'>
integer, intent(in) :: kms<a name='1756'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='1757'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='1758'>
real, intent(inout) :: a_rw(ims:ime,kms:kme,jms:jme)<a name='1759'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='1760'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='1761'>
real, intent(inout) :: a_w(ims:ime,kms:kme,jms:jme)<a name='1762'>
integer, intent(in) :: ide<a name='1763'>
integer, intent(in) :: ite<a name='1764'>
integer, intent(in) :: its<a name='1765'>
integer, intent(in) :: jde<a name='1766'>
integer, intent(in) :: jte<a name='1767'>
integer, intent(in) :: jts<a name='1768'>
integer, intent(in) :: kde<a name='1769'>
integer, intent(in) :: kte<a name='1770'>
integer, intent(in) :: kts<a name='1771'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='1772'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='1773'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='1774'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='1775'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='1776'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='1777'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='1778'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='1779'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='1780'>
<a name='1781'>
<font color=#447700>!==============================================<a name='1782'></font>
<font color=#447700>! declare local variables<a name='1783'></font>
<font color=#447700>!==============================================<a name='1784'></font>
integer i<a name='1785'>
integer itf<a name='1786'>
integer j<a name='1787'>
integer jtf<a name='1788'>
integer k<a name='1789'>
integer ktf<a name='1790'>
<a name='1791'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_COUPLE_MOMENTUM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_27">("a_couple_momentum")<a name='1792'>
<a name='1793'>
<font color=#447700>!----------------------------------------------<a name='1794'></font>
<font color=#447700>! ROUTINE BODY<a name='1795'></font>
<font color=#447700>!----------------------------------------------<a name='1796'></font>
ktf = min(kte,kde-1)<a name='1797'>
<font color=#447700>! recompute : ktf<a name='1798'></font>
itf = min(ite,ide-1)<a name='1799'>
<font color=#447700>! recompute : itf<a name='1800'></font>
jtf = min(jte,jde-1)<a name='1801'>
<font color=#447700>! recompute : jtf<a name='1802'></font>
do j = jts, jtf<a name='1803'>
  do k = kts, kte<a name='1804'>
    do i = its, itf<a name='1805'>
      a_mut(i,j) = a_mut(i,j)+a_rw(i,k,j)*(w(i,k,j)/msft(i,j))<a name='1806'>
      a_w(i,k,j) = a_w(i,k,j)+a_rw(i,k,j)*(mut(i,j)/msft(i,j))<a name='1807'>
      a_rw(i,k,j) = 0.<a name='1808'>
    end do<a name='1809'>
  end do<a name='1810'>
end do<a name='1811'>
<font color=#447700>! recdepend vars : ide,ite<a name='1812'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:359<a name='1813'></font>
<font color=#447700>! recompute vars : itf<a name='1814'></font>
itf = min(ite,ide-1)<a name='1815'>
<font color=#447700>! recompute vars : itf<a name='1816'></font>
<font color=#447700>! recdepend vars : itf,jte<a name='1817'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:360<a name='1818'></font>
<font color=#447700>! recompute vars : jtf<a name='1819'></font>
jtf = jte<a name='1820'>
<font color=#447700>! recompute vars : jtf<a name='1821'></font>
do j = jts, jtf<a name='1822'>
  do k = kts, ktf<a name='1823'>
    do i = its, itf<a name='1824'>
      a_muv(i,j) = a_muv(i,j)+a_rv(i,k,j)*(v(i,k,j)/msfv(i,j))<a name='1825'>
      a_v(i,k,j) = a_v(i,k,j)+a_rv(i,k,j)*(muv(i,j)/msfv(i,j))<a name='1826'>
      a_rv(i,k,j) = 0.<a name='1827'>
    end do<a name='1828'>
  end do<a name='1829'>
end do<a name='1830'>
<font color=#447700>! recdepend vars : ite<a name='1831'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:348<a name='1832'></font>
<font color=#447700>! recompute vars : itf<a name='1833'></font>
itf = ite<a name='1834'>
<font color=#447700>! recompute vars : itf<a name='1835'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='1836'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:349<a name='1837'></font>
<font color=#447700>! recompute vars : jtf<a name='1838'></font>
jtf = min(jte,jde-1)<a name='1839'>
<font color=#447700>! recompute vars : jtf<a name='1840'></font>
do j = jts, jtf<a name='1841'>
  do k = kts, ktf<a name='1842'>
    do i = its, itf<a name='1843'>
      a_muu(i,j) = a_muu(i,j)+a_ru(i,k,j)*(u(i,k,j)/msfu(i,j))<a name='1844'>
      a_u(i,k,j) = a_u(i,k,j)+a_ru(i,k,j)*(muu(i,j)/msfu(i,j))<a name='1845'>
      a_ru(i,k,j) = 0.<a name='1846'>
    end do<a name='1847'>
  end do<a name='1848'>
end do<a name='1849'>
<a name='1850'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_COUPLE_MOMENTUM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_27">("a_couple_momentum")<a name='1851'>
<a name='1852'>
end subroutine a_couple_momentum<a name='1853'>
<a name='1854'>
<a name='1855'>
<A NAME='A_CURVATURE'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CURVATURE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1856'>
<font color=#993300>subroutine </font><font color=#cc0000>a_curvature</font>( ru, a_ru, rv, a_rv, rw, a_rw, u, a_u, v, a_v, a_ru_tend, a_rv_tend, a_rw_tend, config_flags, msfu, msfv, &amp; <A href='../../call_to/A_CURVATURE.html' TARGET='index'>1</A>,<A href='../../call_from/A_CURVATURE.html' TARGET='index'>2</A><a name='1857'>
&amp;fzm, fzp, rdx, rdy, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='1858'>
<font color=#447700>!******************************************************************<a name='1859'></font>
<font color=#447700>!******************************************************************<a name='1860'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='1861'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='1862'></font>
<font color=#447700>!******************************************************************<a name='1863'></font>
<font color=#447700>!******************************************************************<a name='1864'></font>
<font color=#447700>!==============================================<a name='1865'></font>
<font color=#447700>! all entries are defined explicitly<a name='1866'></font>
<font color=#447700>!==============================================<a name='1867'></font>
implicit none<a name='1868'>
<a name='1869'>
<font color=#447700>!==============================================<a name='1870'></font>
<font color=#447700>! declare arguments<a name='1871'></font>
<font color=#447700>!==============================================<a name='1872'></font>
integer, intent(in) :: ime<a name='1873'>
integer, intent(in) :: ims<a name='1874'>
integer, intent(in) :: jme<a name='1875'>
integer, intent(in) :: jms<a name='1876'>
integer, intent(in) :: kme<a name='1877'>
integer, intent(in) :: kms<a name='1878'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='1879'>
real, intent(inout) :: a_ru_tend(ims:ime,kms:kme,jms:jme)<a name='1880'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='1881'>
real, intent(inout) :: a_rv_tend(ims:ime,kms:kme,jms:jme)<a name='1882'>
real, intent(inout) :: a_rw(ims:ime,kms:kme,jms:jme)<a name='1883'>
real, intent(inout) :: a_rw_tend(ims:ime,kms:kme,jms:jme)<a name='1884'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='1885'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='1886'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='1887'>
real, intent(in) :: fzm(kms:kme)<a name='1888'>
real, intent(in) :: fzp(kms:kme)<a name='1889'>
integer, intent(in) :: ide<a name='1890'>
integer, intent(in) :: ids<a name='1891'>
integer, intent(in) :: ite<a name='1892'>
integer, intent(in) :: its<a name='1893'>
integer, intent(in) :: jde<a name='1894'>
integer, intent(in) :: jds<a name='1895'>
integer, intent(in) :: jte<a name='1896'>
integer, intent(in) :: jts<a name='1897'>
integer, intent(in) :: kde<a name='1898'>
integer, intent(in) :: kte<a name='1899'>
integer, intent(in) :: kts<a name='1900'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='1901'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='1902'>
real, intent(in) :: rdx<a name='1903'>
real, intent(in) :: rdy<a name='1904'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='1905'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='1906'>
real, intent(in) :: rw(ims:ime,kms:kme,jms:jme)<a name='1907'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='1908'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='1909'>
<a name='1910'>
<font color=#447700>!==============================================<a name='1911'></font>
<font color=#447700>! declare local variables<a name='1912'></font>
<font color=#447700>!==============================================<a name='1913'></font>
real a_vxgm(its-1:ite,kts:kte,jts-1:jte)<a name='1914'>
integer i<a name='1915'>
integer i_end<a name='1916'>
integer i_start<a name='1917'>
integer j<a name='1918'>
integer j_end<a name='1919'>
integer j_start<a name='1920'>
integer k<a name='1921'>
integer ktf<a name='1922'>
logical specified<a name='1923'>
real vxgm(its-1:ite,kts:kte,jts-1:jte)<a name='1924'>
<a name='1925'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CURVATURE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_28">("a_curvature")<a name='1926'>
<a name='1927'>
<font color=#447700>!----------------------------------------------<a name='1928'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='1929'></font>
<font color=#447700>!----------------------------------------------<a name='1930'></font>
a_vxgm(:,:,:) = 0.<a name='1931'>
<a name='1932'>
<font color=#447700>!----------------------------------------------<a name='1933'></font>
<font color=#447700>! ROUTINE BODY<a name='1934'></font>
<font color=#447700>!----------------------------------------------<a name='1935'></font>
specified =  .false. <a name='1936'>
<font color=#447700>! recompute : specified<a name='1937'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='1938'>
  specified =  .true. <a name='1939'>
endif<a name='1940'>
<font color=#447700>! recompute : specified<a name='1941'></font>
ktf = min(kte,kde-1)<a name='1942'>
<font color=#447700>! recompute : ktf<a name='1943'></font>
i_start = its-1<a name='1944'>
<font color=#447700>! recompute : i_start<a name='1945'></font>
i_end = ite<a name='1946'>
<font color=#447700>! recompute : i_end<a name='1947'></font>
j_start = jts-1<a name='1948'>
<font color=#447700>! recompute : j_start<a name='1949'></font>
j_end = jte<a name='1950'>
<font color=#447700>! recompute : j_end<a name='1951'></font>
if ((config_flags%open_xs .or. specified .or. config_flags%nested) .and. its .eq. ids) then<a name='1952'>
  i_start = its<a name='1953'>
endif<a name='1954'>
<font color=#447700>! recompute : i_start<a name='1955'></font>
if ((config_flags%open_xe .or. specified .or. config_flags%nested) .and. ite .eq. ide) then<a name='1956'>
  i_end = ite-1<a name='1957'>
endif<a name='1958'>
<font color=#447700>! recompute : i_end<a name='1959'></font>
if ((config_flags%open_ys .or. specified .or. config_flags%nested) .and. jts .eq. jds) then<a name='1960'>
  j_start = jts<a name='1961'>
endif<a name='1962'>
<font color=#447700>! recompute : j_start<a name='1963'></font>
if ((config_flags%open_ye .or. specified .or. config_flags%nested) .and. jte .eq. jde) then<a name='1964'>
  j_end = jte-1<a name='1965'>
endif<a name='1966'>
<font color=#447700>! recompute : j_end<a name='1967'></font>
do j = j_start, j_end<a name='1968'>
  do k = kts, ktf<a name='1969'>
    do i = i_start, i_end<a name='1970'>
      vxgm(i,k,j) = 0.5*(u(i,k,j)+u(i+1,k,j))*(msfv(i,j+1)-msfv(i,j))*rdy-0.5*(v(i,k,j)+v(i,k,j+1))*(msfu(i+1,j)-msfu(i,j))*rdx<a name='1971'>
    end do<a name='1972'>
  end do<a name='1973'>
end do<a name='1974'>
<font color=#447700>! recompute : vxgm<a name='1975'></font>
if ((config_flags%open_xs .or. specified .or. config_flags%nested) .and. its .eq. ids) then<a name='1976'>
  do j = jts-1, jte<a name='1977'>
    do k = kts, ktf<a name='1978'>
      vxgm(its-1,k,j) = vxgm(its,k,j)<a name='1979'>
    end do<a name='1980'>
  end do<a name='1981'>
endif<a name='1982'>
<font color=#447700>! recompute : vxgm<a name='1983'></font>
if ((config_flags%open_xe .or. specified .or. config_flags%nested) .and. ite .eq. ide) then<a name='1984'>
  do j = jts-1, jte<a name='1985'>
    do k = kts, ktf<a name='1986'>
      vxgm(ite,k,j) = vxgm(ite-1,k,j)<a name='1987'>
    end do<a name='1988'>
  end do<a name='1989'>
endif<a name='1990'>
<font color=#447700>! recompute : vxgm<a name='1991'></font>
if ((config_flags%open_ys .or. specified .or. config_flags%nested) .and. jts .eq. jds) then<a name='1992'>
  do k = kts, ktf<a name='1993'>
    do i = its-1, ite<a name='1994'>
      vxgm(i,k,jts-1) = vxgm(i,k,jts)<a name='1995'>
    end do<a name='1996'>
  end do<a name='1997'>
endif<a name='1998'>
<font color=#447700>! recompute : vxgm<a name='1999'></font>
if ((config_flags%open_ye .or. specified .or. config_flags%nested) .and. jte .eq. jde) then<a name='2000'>
  do k = kts, ktf<a name='2001'>
    do i = its-1, ite<a name='2002'>
      vxgm(i,k,jte) = vxgm(i,k,jte-1)<a name='2003'>
    end do<a name='2004'>
  end do<a name='2005'>
endif<a name='2006'>
<font color=#447700>! recompute : vxgm<a name='2007'></font>
i_start = its<a name='2008'>
<font color=#447700>! recompute : i_start<a name='2009'></font>
if (config_flags%open_xs .or. specified .or. config_flags%nested) then<a name='2010'>
  i_start = max(ids+1,its)<a name='2011'>
endif<a name='2012'>
<font color=#447700>! recompute : i_start<a name='2013'></font>
if (config_flags%open_xe .or. specified .or. config_flags%nested) then<a name='2014'>
  i_end = min(ide-1,ite)<a name='2015'>
endif<a name='2016'>
<font color=#447700>! recompute : i_end<a name='2017'></font>
j_start = jts<a name='2018'>
<font color=#447700>! recompute : j_start<a name='2019'></font>
if (config_flags%open_ys .or. specified .or. config_flags%nested) then<a name='2020'>
  j_start = max(jds+1,jts)<a name='2021'>
endif<a name='2022'>
<font color=#447700>! recompute : j_start<a name='2023'></font>
if (config_flags%open_ye .or. specified .or. config_flags%nested) then<a name='2024'>
  j_end = min(jde-1,jte)<a name='2025'>
endif<a name='2026'>
<font color=#447700>! recompute : j_end<a name='2027'></font>
do j = jts, min(jte,jde-1)<a name='2028'>
  do k = max(2,kts), ktf<a name='2029'>
    do i = its, min(ite,ide-1)<a name='2030'>
      a_ru(i+1,k-1,j) = a_ru(i+1,k-1,j)+0.25*a_rw_tend(i,k,j)*reradius*fzp(k)*(fzm(k)*(u(i,k,j)+u(i+1,k,j))+fzp(k)*(u(i,k-1,j)+u(i+&amp;<a name='2031'>
&amp;1,k-1,j)))<a name='2032'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.25*a_rw_tend(i,k,j)*reradius*fzp(k)*(fzm(k)*(u(i,k,j)+u(i+1,k,j))+fzp(k)*(u(i,k-1,j)+u(i+1,k-&amp;<a name='2033'>
&amp;1,j)))<a name='2034'>
      a_ru(i+1,k,j) = a_ru(i+1,k,j)+0.25*a_rw_tend(i,k,j)*reradius*fzm(k)*(fzm(k)*(u(i,k,j)+u(i+1,k,j))+fzp(k)*(u(i,k-1,j)+u(i+1,k-&amp;<a name='2035'>
&amp;1,j)))<a name='2036'>
      a_ru(i,k,j) = a_ru(i,k,j)+0.25*a_rw_tend(i,k,j)*reradius*fzm(k)*(fzm(k)*(u(i,k,j)+u(i+1,k,j))+fzp(k)*(u(i,k-1,j)+u(i+1,k-1,j)&amp;<a name='2037'>
&amp;))<a name='2038'>
      a_rv(i,k-1,j+1) = a_rv(i,k-1,j+1)+0.25*a_rw_tend(i,k,j)*reradius*fzp(k)*(fzm(k)*(v(i,k,j)+v(i,k,j+1))+fzp(k)*(v(i,k-1,j)+v(i,&amp;<a name='2039'>
&amp;k-1,j+1)))<a name='2040'>
      a_rv(i,k-1,j) = a_rv(i,k-1,j)+0.25*a_rw_tend(i,k,j)*reradius*fzp(k)*(fzm(k)*(v(i,k,j)+v(i,k,j+1))+fzp(k)*(v(i,k-1,j)+v(i,k-1,&amp;<a name='2041'>
&amp;j+1)))<a name='2042'>
      a_rv(i,k,j+1) = a_rv(i,k,j+1)+0.25*a_rw_tend(i,k,j)*reradius*fzm(k)*(fzm(k)*(v(i,k,j)+v(i,k,j+1))+fzp(k)*(v(i,k-1,j)+v(i,k-1,&amp;<a name='2043'>
&amp;j+1)))<a name='2044'>
      a_rv(i,k,j) = a_rv(i,k,j)+0.25*a_rw_tend(i,k,j)*reradius*fzm(k)*(fzm(k)*(v(i,k,j)+v(i,k,j+1))+fzp(k)*(v(i,k-1,j)+v(i,k-1,j+1)&amp;<a name='2045'>
&amp;))<a name='2046'>
      a_u(i+1,k-1,j) = a_u(i+1,k-1,j)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(ru(i,k,j)+ru(i+1,k,j))+fzp(k)*(ru(i,k-1,j)+ru(i+1,k-&amp;<a name='2047'>
&amp;1,j)))*fzp(k)<a name='2048'>
      a_u(i,k-1,j) = a_u(i,k-1,j)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(ru(i,k,j)+ru(i+1,k,j))+fzp(k)*(ru(i,k-1,j)+ru(i+1,k-1,j))&amp;<a name='2049'>
&amp;)*fzp(k)<a name='2050'>
      a_u(i+1,k,j) = a_u(i+1,k,j)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(ru(i,k,j)+ru(i+1,k,j))+fzp(k)*(ru(i,k-1,j)+ru(i+1,k-1,j))&amp;<a name='2051'>
&amp;)*fzm(k)<a name='2052'>
      a_u(i,k,j) = a_u(i,k,j)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(ru(i,k,j)+ru(i+1,k,j))+fzp(k)*(ru(i,k-1,j)+ru(i+1,k-1,j)))*&amp;<a name='2053'>
&amp;fzm(k)<a name='2054'>
      a_v(i,k-1,j+1) = a_v(i,k-1,j+1)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(rv(i,k,j)+rv(i,k,j+1))+fzp(k)*(rv(i,k-1,j)+rv(i,k-1,&amp;<a name='2055'>
&amp;j+1)))*fzp(k)<a name='2056'>
      a_v(i,k-1,j) = a_v(i,k-1,j)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(rv(i,k,j)+rv(i,k,j+1))+fzp(k)*(rv(i,k-1,j)+rv(i,k-1,j+1))&amp;<a name='2057'>
&amp;)*fzp(k)<a name='2058'>
      a_v(i,k,j+1) = a_v(i,k,j+1)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(rv(i,k,j)+rv(i,k,j+1))+fzp(k)*(rv(i,k-1,j)+rv(i,k-1,j+1))&amp;<a name='2059'>
&amp;)*fzm(k)<a name='2060'>
      a_v(i,k,j) = a_v(i,k,j)+0.25*a_rw_tend(i,k,j)*reradius*(fzm(k)*(rv(i,k,j)+rv(i,k,j+1))+fzp(k)*(rv(i,k-1,j)+rv(i,k-1,j+1)))*&amp;<a name='2061'>
&amp;fzm(k)<a name='2062'>
    end do<a name='2063'>
  end do<a name='2064'>
end do<a name='2065'>
do j = j_start, j_end<a name='2066'>
  do k = kts, ktf<a name='2067'>
    do i = its, min(ite,ide-1)<a name='2068'>
      a_ru(i+1,k,j-1) = a_ru(i+1,k,j-1)-0.125*a_rv_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i,k,j-1))<a name='2069'>
      a_ru(i,k,j-1) = a_ru(i,k,j-1)-0.125*a_rv_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i,k,j-1))<a name='2070'>
      a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.125*a_rv_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i,k,j-1))<a name='2071'>
      a_ru(i,k,j) = a_ru(i,k,j)-0.125*a_rv_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i,k,j-1))<a name='2072'>
      a_rw(i,k+1,j-1) = a_rw(i,k+1,j-1)+0.25*a_rv_tend(i,k,j)*v(i,k,j)*reradius<a name='2073'>
      a_rw(i,k+1,j) = a_rw(i,k+1,j)+0.25*a_rv_tend(i,k,j)*v(i,k,j)*reradius<a name='2074'>
      a_rw(i,k,j-1) = a_rw(i,k,j-1)+0.25*a_rv_tend(i,k,j)*v(i,k,j)*reradius<a name='2075'>
      a_rw(i,k,j) = a_rw(i,k,j)+0.25*a_rv_tend(i,k,j)*v(i,k,j)*reradius<a name='2076'>
      a_v(i,k,j) = a_v(i,k,j)+0.25*a_rv_tend(i,k,j)*reradius*(rw(i,k+1,j-1)+rw(i,k,j-1)+rw(i,k+1,j)+rw(i,k,j))<a name='2077'>
      a_vxgm(i,k,j-1) = a_vxgm(i,k,j-1)-0.125*a_rv_tend(i,k,j)*(ru(i,k,j)+ru(i+1,k,j)+ru(i,k,j-1)+ru(i+1,k,j-1))<a name='2078'>
      a_vxgm(i,k,j) = a_vxgm(i,k,j)-0.125*a_rv_tend(i,k,j)*(ru(i,k,j)+ru(i+1,k,j)+ru(i,k,j-1)+ru(i+1,k,j-1))<a name='2079'>
    end do<a name='2080'>
  end do<a name='2081'>
end do<a name='2082'>
do j = jts, min(jde-1,jte)<a name='2083'>
  do k = kts, ktf<a name='2084'>
    do i = i_start, i_end<a name='2085'>
      a_rv(i-1,k,j+1) = a_rv(i-1,k,j+1)+0.125*a_ru_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i-1,k,j))<a name='2086'>
      a_rv(i,k,j+1) = a_rv(i,k,j+1)+0.125*a_ru_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i-1,k,j))<a name='2087'>
      a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.125*a_ru_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i-1,k,j))<a name='2088'>
      a_rv(i,k,j) = a_rv(i,k,j)+0.125*a_ru_tend(i,k,j)*(vxgm(i,k,j)+vxgm(i-1,k,j))<a name='2089'>
      a_rw(i-1,k+1,j) = a_rw(i-1,k+1,j)-0.25*a_ru_tend(i,k,j)*u(i,k,j)*reradius<a name='2090'>
      a_rw(i,k+1,j) = a_rw(i,k+1,j)-0.25*a_ru_tend(i,k,j)*u(i,k,j)*reradius<a name='2091'>
      a_rw(i-1,k,j) = a_rw(i-1,k,j)-0.25*a_ru_tend(i,k,j)*u(i,k,j)*reradius<a name='2092'>
      a_rw(i,k,j) = a_rw(i,k,j)-0.25*a_ru_tend(i,k,j)*u(i,k,j)*reradius<a name='2093'>
      a_u(i,k,j) = a_u(i,k,j)-0.25*a_ru_tend(i,k,j)*reradius*(rw(i-1,k+1,j)+rw(i-1,k,j)+rw(i,k+1,j)+rw(i,k,j))<a name='2094'>
      a_vxgm(i-1,k,j) = a_vxgm(i-1,k,j)+0.125*a_ru_tend(i,k,j)*(rv(i-1,k,j+1)+rv(i,k,j+1)+rv(i-1,k,j)+rv(i,k,j))<a name='2095'>
      a_vxgm(i,k,j) = a_vxgm(i,k,j)+0.125*a_ru_tend(i,k,j)*(rv(i-1,k,j+1)+rv(i,k,j+1)+rv(i-1,k,j)+rv(i,k,j))<a name='2096'>
    end do<a name='2097'>
  end do<a name='2098'>
end do<a name='2099'>
if ((config_flags%open_ye .or. specified .or. config_flags%nested) .and. jte .eq. jde) then<a name='2100'>
  do k = kts, ktf<a name='2101'>
    do i = its-1, ite<a name='2102'>
      a_vxgm(i,k,jte-1) = a_vxgm(i,k,jte-1)+a_vxgm(i,k,jte)<a name='2103'>
      a_vxgm(i,k,jte) = 0.<a name='2104'>
    end do<a name='2105'>
  end do<a name='2106'>
endif<a name='2107'>
if ((config_flags%open_ys .or. specified .or. config_flags%nested) .and. jts .eq. jds) then<a name='2108'>
  do k = kts, ktf<a name='2109'>
    do i = its-1, ite<a name='2110'>
      a_vxgm(i,k,jts) = a_vxgm(i,k,jts)+a_vxgm(i,k,jts-1)<a name='2111'>
      a_vxgm(i,k,jts-1) = 0.<a name='2112'>
    end do<a name='2113'>
  end do<a name='2114'>
endif<a name='2115'>
if ((config_flags%open_xe .or. specified .or. config_flags%nested) .and. ite .eq. ide) then<a name='2116'>
  do j = jts-1, jte<a name='2117'>
    do k = kts, ktf<a name='2118'>
      a_vxgm(ite-1,k,j) = a_vxgm(ite-1,k,j)+a_vxgm(ite,k,j)<a name='2119'>
      a_vxgm(ite,k,j) = 0.<a name='2120'>
    end do<a name='2121'>
  end do<a name='2122'>
endif<a name='2123'>
if ((config_flags%open_xs .or. specified .or. config_flags%nested) .and. its .eq. ids) then<a name='2124'>
  do j = jts-1, jte<a name='2125'>
    do k = kts, ktf<a name='2126'>
      a_vxgm(its,k,j) = a_vxgm(its,k,j)+a_vxgm(its-1,k,j)<a name='2127'>
      a_vxgm(its-1,k,j) = 0.<a name='2128'>
    end do<a name='2129'>
  end do<a name='2130'>
endif<a name='2131'>
<font color=#447700>! recdepend vars : its<a name='2132'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3594<a name='2133'></font>
<font color=#447700>! recompute vars : i_start<a name='2134'></font>
i_start = its-1<a name='2135'>
<font color=#447700>! recompute vars : i_start<a name='2136'></font>
<font color=#447700>! recdepend vars : i_start,ite<a name='2137'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3595<a name='2138'></font>
<font color=#447700>! recompute vars : i_end<a name='2139'></font>
i_end = ite<a name='2140'>
<font color=#447700>! recompute vars : i_end<a name='2141'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jts<a name='2142'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3596<a name='2143'></font>
<font color=#447700>! recompute vars : j_start<a name='2144'></font>
j_start = jts-1<a name='2145'>
<font color=#447700>! recompute vars : j_start<a name='2146'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jte<a name='2147'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3597<a name='2148'></font>
<font color=#447700>! recompute vars : j_end<a name='2149'></font>
j_end = jte<a name='2150'>
<font color=#447700>! recompute vars : j_end<a name='2151'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,ids,its,j_end,j_start,spe<a name='2152'></font>
<font color=#447700>! cified<a name='2153'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:3599<a name='2154'></font>
<font color=#447700>! recompute vars : i_start<a name='2155'></font>
if ((config_flags%open_xs .or. specified .or. config_flags%nested) .and. its .eq. ids) then<a name='2156'>
  i_start = its<a name='2157'>
endif<a name='2158'>
<font color=#447700>! recompute vars : i_start<a name='2159'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,ide,ite,j_end,j_start,spe<a name='2160'></font>
<font color=#447700>! cified<a name='2161'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:3601<a name='2162'></font>
<font color=#447700>! recompute vars : i_end<a name='2163'></font>
if ((config_flags%open_xe .or. specified .or. config_flags%nested) .and. ite .eq. ide) then<a name='2164'>
  i_end = ite-1<a name='2165'>
endif<a name='2166'>
<font color=#447700>! recompute vars : i_end<a name='2167'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,j_end,j_start,jds,jts,spe<a name='2168'></font>
<font color=#447700>! cified<a name='2169'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:3603<a name='2170'></font>
<font color=#447700>! recompute vars : j_start<a name='2171'></font>
if ((config_flags%open_ys .or. specified .or. config_flags%nested) .and. jts .eq. jds) then<a name='2172'>
  j_start = jts<a name='2173'>
endif<a name='2174'>
<font color=#447700>! recompute vars : j_start<a name='2175'></font>
<font color=#447700>!  recdepend vars : config_flags,i_end,i_start,j_end,j_start,jde,jte,spe<a name='2176'></font>
<font color=#447700>! cified<a name='2177'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:3605<a name='2178'></font>
<font color=#447700>! recompute vars : j_end<a name='2179'></font>
if ((config_flags%open_ye .or. specified .or. config_flags%nested) .and. jte .eq. jde) then<a name='2180'>
  j_end = jte-1<a name='2181'>
endif<a name='2182'>
<font color=#447700>! recompute vars : j_end<a name='2183'></font>
do j = j_start, j_end<a name='2184'>
  do k = kts, ktf<a name='2185'>
    do i = i_start, i_end<a name='2186'>
      a_u(i+1,k,j) = a_u(i+1,k,j)+0.5*a_vxgm(i,k,j)*(msfv(i,j+1)-msfv(i,j))*rdy<a name='2187'>
      a_u(i,k,j) = a_u(i,k,j)+0.5*a_vxgm(i,k,j)*(msfv(i,j+1)-msfv(i,j))*rdy<a name='2188'>
      a_v(i,k,j+1) = a_v(i,k,j+1)-0.5*a_vxgm(i,k,j)*(msfu(i+1,j)-msfu(i,j))*rdx<a name='2189'>
      a_v(i,k,j) = a_v(i,k,j)-0.5*a_vxgm(i,k,j)*(msfu(i+1,j)-msfu(i,j))*rdx<a name='2190'>
      a_vxgm(i,k,j) = 0.<a name='2191'>
    end do<a name='2192'>
  end do<a name='2193'>
end do<a name='2194'>
<a name='2195'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_CURVATURE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_28">("a_curvature")<a name='2196'>
<a name='2197'>
end subroutine a_curvature<a name='2198'>
<a name='2199'>
<a name='2200'>
<A NAME='A_DIAGNOSE_W'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_DIAGNOSE_W' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2201'>
<font color=#993300>subroutine </font><font color=#cc0000>a_diagnose_w</font>( ph_tend, a_ph_tend, a_ph_new, a_ph_old, a_w, mu, a_mu, dt, a_u, a_v, ht, cf1, cf2, cf3, rdx, rdy, msft, &amp; <A href='../../call_to/A_DIAGNOSE_W.html' TARGET='index'>3</A>,<A href='../../call_from/A_DIAGNOSE_W.html' TARGET='index'>2</A><a name='2202'>
&amp;ide, jde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kte )<a name='2203'>
<font color=#447700>!******************************************************************<a name='2204'></font>
<font color=#447700>!******************************************************************<a name='2205'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='2206'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='2207'></font>
<font color=#447700>!******************************************************************<a name='2208'></font>
<font color=#447700>!******************************************************************<a name='2209'></font>
<font color=#447700>!==============================================<a name='2210'></font>
<font color=#447700>! all entries are defined explicitly<a name='2211'></font>
<font color=#447700>!==============================================<a name='2212'></font>
implicit none<a name='2213'>
<a name='2214'>
<font color=#447700>!==============================================<a name='2215'></font>
<font color=#447700>! declare arguments<a name='2216'></font>
<font color=#447700>!==============================================<a name='2217'></font>
integer, intent(in) :: ime<a name='2218'>
integer, intent(in) :: ims<a name='2219'>
integer, intent(in) :: jme<a name='2220'>
integer, intent(in) :: jms<a name='2221'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='2222'>
integer, intent(in) :: kme<a name='2223'>
integer, intent(in) :: kms<a name='2224'>
real, intent(inout) :: a_ph_new(ims:ime,kms:kme,jms:jme)<a name='2225'>
real, intent(inout) :: a_ph_old(ims:ime,kms:kme,jms:jme)<a name='2226'>
real, intent(inout) :: a_ph_tend(ims:ime,kms:kme,jms:jme)<a name='2227'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='2228'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='2229'>
real, intent(inout) :: a_w(ims:ime,kms:kme,jms:jme)<a name='2230'>
real, intent(in) :: cf1<a name='2231'>
real, intent(in) :: cf2<a name='2232'>
real, intent(in) :: cf3<a name='2233'>
real, intent(in) :: dt<a name='2234'>
real, intent(in) :: ht(ims:ime,jms:jme)<a name='2235'>
integer, intent(in) :: ide<a name='2236'>
integer, intent(in) :: ite<a name='2237'>
integer, intent(in) :: its<a name='2238'>
integer, intent(in) :: jde<a name='2239'>
integer, intent(in) :: jte<a name='2240'>
integer, intent(in) :: jts<a name='2241'>
integer, intent(in) :: kte<a name='2242'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='2243'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='2244'>
real, intent(in) :: ph_tend(ims:ime,kms:kme,jms:jme)<a name='2245'>
real, intent(in) :: rdx<a name='2246'>
real, intent(in) :: rdy<a name='2247'>
<a name='2248'>
<font color=#447700>!==============================================<a name='2249'></font>
<font color=#447700>! declare local variables<a name='2250'></font>
<font color=#447700>!==============================================<a name='2251'></font>
integer i<a name='2252'>
integer itf<a name='2253'>
integer j<a name='2254'>
integer jtf<a name='2255'>
integer k<a name='2256'>
<a name='2257'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_DIAGNOSE_W' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_29">("a_diagnose_w")<a name='2258'>
<a name='2259'>
<font color=#447700>!----------------------------------------------<a name='2260'></font>
<font color=#447700>! ROUTINE BODY<a name='2261'></font>
<font color=#447700>!----------------------------------------------<a name='2262'></font>
itf = min(ite,ide-1)<a name='2263'>
<font color=#447700>! recompute : itf<a name='2264'></font>
jtf = min(jte,jde-1)<a name='2265'>
<font color=#447700>! recompute : jtf<a name='2266'></font>
do j = jts, jtf<a name='2267'>
  do k = 2, kte<a name='2268'>
    do i = its, itf<a name='2269'>
      a_mu(i,j) = a_mu(i,j)+a_w(i,k,j)*(msft(i,j)*(ph_tend(i,k,j)/(mu(i,j)*mu(i,j)))/g)<a name='2270'>
      a_ph_new(i,k,j) = a_ph_new(i,k,j)+a_w(i,k,j)*(msft(i,j)/dt/g)<a name='2271'>
      a_ph_old(i,k,j) = a_ph_old(i,k,j)-a_w(i,k,j)*(msft(i,j)/dt/g)<a name='2272'>
      a_ph_tend(i,k,j) = a_ph_tend(i,k,j)-a_w(i,k,j)*(msft(i,j)/mu(i,j)/g)<a name='2273'>
      a_w(i,k,j) = 0.<a name='2274'>
    end do<a name='2275'>
  end do<a name='2276'>
  do i = its, itf<a name='2277'>
    a_u(i+1,3,j) = a_u(i+1,3,j)+0.5*a_w(i,1,j)*msft(i,j)*rdx*(ht(i+1,j)-ht(i,j))*cf3<a name='2278'>
    a_u(i,3,j) = a_u(i,3,j)+0.5*a_w(i,1,j)*msft(i,j)*rdx*(ht(i,j)-ht(i,j-1))*cf3<a name='2279'>
    a_u(i+1,2,j) = a_u(i+1,2,j)+0.5*a_w(i,1,j)*msft(i,j)*rdx*(ht(i+1,j)-ht(i,j))*cf2<a name='2280'>
    a_u(i,2,j) = a_u(i,2,j)+0.5*a_w(i,1,j)*msft(i,j)*rdx*(ht(i,j)-ht(i,j-1))*cf2<a name='2281'>
    a_u(i+1,1,j) = a_u(i+1,1,j)+0.5*a_w(i,1,j)*msft(i,j)*rdx*(ht(i+1,j)-ht(i,j))*cf1<a name='2282'>
    a_u(i,1,j) = a_u(i,1,j)+0.5*a_w(i,1,j)*msft(i,j)*rdx*(ht(i,j)-ht(i,j-1))*cf1<a name='2283'>
    a_v(i,3,j+1) = a_v(i,3,j+1)+0.5*a_w(i,1,j)*msft(i,j)*rdy*(ht(i,j+1)-ht(i,j))*cf3<a name='2284'>
    a_v(i,3,j) = a_v(i,3,j)+0.5*a_w(i,1,j)*msft(i,j)*rdy*(ht(i,j)-ht(i,j-1))*cf3<a name='2285'>
    a_v(i,2,j+1) = a_v(i,2,j+1)+0.5*a_w(i,1,j)*msft(i,j)*rdy*(ht(i,j+1)-ht(i,j))*cf2<a name='2286'>
    a_v(i,2,j) = a_v(i,2,j)+0.5*a_w(i,1,j)*msft(i,j)*rdy*(ht(i,j)-ht(i,j-1))*cf2<a name='2287'>
    a_v(i,1,j+1) = a_v(i,1,j+1)+0.5*a_w(i,1,j)*msft(i,j)*rdy*(ht(i,j+1)-ht(i,j))*cf1<a name='2288'>
    a_v(i,1,j) = a_v(i,1,j)+0.5*a_w(i,1,j)*msft(i,j)*rdy*(ht(i,j)-ht(i,j-1))*cf1<a name='2289'>
    a_w(i,1,j) = 0.<a name='2290'>
  end do<a name='2291'>
end do<a name='2292'>
<a name='2293'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_DIAGNOSE_W' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_29">("a_diagnose_w")<a name='2294'>
<a name='2295'>
end subroutine a_diagnose_w<a name='2296'>
<a name='2297'>
<a name='2298'>
<A NAME='A_HORIZONTAL_DIFFUSION'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_DIFFUSION' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2299'>
<font color=#993300>subroutine </font><font color=#cc0000>a_horizontal_diffusion</font>( name, field, a_field, a_tendency, mu, a_mu, config_flags, msfu, msfv, msft, xkmhd, a_xkmhd, rdx,&amp; <A href='../../call_to/A_HORIZONTAL_DIFFUSION.html' TARGET='index'>8</A>,<A href='../../call_from/A_HORIZONTAL_DIFFUSION.html' TARGET='index'>2</A><a name='2300'>
&amp; rdy, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='2301'>
<font color=#447700>!******************************************************************<a name='2302'></font>
<font color=#447700>!******************************************************************<a name='2303'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='2304'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='2305'></font>
<font color=#447700>!******************************************************************<a name='2306'></font>
<font color=#447700>!******************************************************************<a name='2307'></font>
<font color=#447700>!==============================================<a name='2308'></font>
<font color=#447700>! all entries are defined explicitly<a name='2309'></font>
<font color=#447700>!==============================================<a name='2310'></font>
implicit none<a name='2311'>
<a name='2312'>
<font color=#447700>!==============================================<a name='2313'></font>
<font color=#447700>! declare arguments<a name='2314'></font>
<font color=#447700>!==============================================<a name='2315'></font>
integer, intent(in) :: ime<a name='2316'>
integer, intent(in) :: ims<a name='2317'>
integer, intent(in) :: jme<a name='2318'>
integer, intent(in) :: jms<a name='2319'>
integer, intent(in) :: kme<a name='2320'>
integer, intent(in) :: kms<a name='2321'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='2322'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='2323'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='2324'>
real, intent(inout) :: a_xkmhd(ims:ime,kms:kme,jms:jme)<a name='2325'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='2326'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='2327'>
integer, intent(in) :: ide<a name='2328'>
integer, intent(in) :: ids<a name='2329'>
integer, intent(in) :: ite<a name='2330'>
integer, intent(in) :: its<a name='2331'>
integer, intent(in) :: jde<a name='2332'>
integer, intent(in) :: jds<a name='2333'>
integer, intent(in) :: jte<a name='2334'>
integer, intent(in) :: jts<a name='2335'>
integer, intent(in) :: kde<a name='2336'>
integer, intent(in) :: kte<a name='2337'>
integer, intent(in) :: kts<a name='2338'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='2339'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='2340'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='2341'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='2342'>
character*(1), intent(in) :: name<a name='2343'>
real, intent(in) :: rdx<a name='2344'>
real, intent(in) :: rdy<a name='2345'>
real, intent(in) :: xkmhd(ims:ime,kms:kme,jms:jme)<a name='2346'>
<a name='2347'>
<font color=#447700>!==============================================<a name='2348'></font>
<font color=#447700>! declare local variables<a name='2349'></font>
<font color=#447700>!==============================================<a name='2350'></font>
real a_mkrdxm<a name='2351'>
real a_mkrdxp<a name='2352'>
real a_mkrdym<a name='2353'>
real a_mkrdyp<a name='2354'>
real a_rcoup<a name='2355'>
integer i<a name='2356'>
integer i_end<a name='2357'>
integer i_start<a name='2358'>
integer j<a name='2359'>
integer j_end<a name='2360'>
integer j_start<a name='2361'>
integer k<a name='2362'>
integer ktf<a name='2363'>
real mkrdxm<a name='2364'>
real mkrdxp<a name='2365'>
real mkrdym<a name='2366'>
real mkrdyp<a name='2367'>
real mrdx<a name='2368'>
real mrdy<a name='2369'>
real :: pr = 3.<a name='2370'>
real rcoup<a name='2371'>
logical specified<a name='2372'>
<a name='2373'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_DIFFUSION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_30">("a_horizontal_diffusion")<a name='2374'>
<a name='2375'>
<font color=#447700>!----------------------------------------------<a name='2376'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='2377'></font>
<font color=#447700>!----------------------------------------------<a name='2378'></font>
a_mkrdxm = 0.<a name='2379'>
a_mkrdxp = 0.<a name='2380'>
a_mkrdym = 0.<a name='2381'>
a_mkrdyp = 0.<a name='2382'>
a_rcoup = 0.<a name='2383'>
<a name='2384'>
<font color=#447700>!----------------------------------------------<a name='2385'></font>
<font color=#447700>! ROUTINE BODY<a name='2386'></font>
<font color=#447700>!----------------------------------------------<a name='2387'></font>
specified =  .false. <a name='2388'>
<font color=#447700>! recompute : specified<a name='2389'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='2390'>
  specified =  .true. <a name='2391'>
endif<a name='2392'>
<font color=#447700>! recompute : specified<a name='2393'></font>
ktf = min(kte,kde-1)<a name='2394'>
<font color=#447700>! recompute : ktf<a name='2395'></font>
if (name .eq. 'u') then<a name='2396'>
  i_start = its<a name='2397'>
<font color=#447700>! recompute : i_start<a name='2398'></font>
  i_end = ite<a name='2399'>
<font color=#447700>! recompute : i_end<a name='2400'></font>
  j_start = jts<a name='2401'>
<font color=#447700>! recompute : j_start<a name='2402'></font>
  j_end = min(jte,jde-1)<a name='2403'>
<font color=#447700>! recompute : j_end<a name='2404'></font>
  if (config_flags%open_xs .or. specified) then<a name='2405'>
    i_start = max(ids+1,its)<a name='2406'>
  endif<a name='2407'>
<font color=#447700>! recompute : i_start<a name='2408'></font>
  if (config_flags%open_xe .or. specified) then<a name='2409'>
    i_end = min(ide-1,ite)<a name='2410'>
  endif<a name='2411'>
<font color=#447700>! recompute : i_end<a name='2412'></font>
  if (config_flags%open_ys .or. specified) then<a name='2413'>
    j_start = max(jds+1,jts)<a name='2414'>
  endif<a name='2415'>
<font color=#447700>! recompute : j_start<a name='2416'></font>
  if (config_flags%open_ye .or. specified) then<a name='2417'>
    j_end = min(jde-2,jte)<a name='2418'>
  endif<a name='2419'>
<font color=#447700>! recompute : j_end<a name='2420'></font>
  do j = j_start, j_end<a name='2421'>
    a_mkrdxm = 0.<a name='2422'>
    a_mkrdxp = 0.<a name='2423'>
    a_mkrdym = 0.<a name='2424'>
    a_mkrdyp = 0.<a name='2425'>
    a_rcoup = 0.<a name='2426'>
    do k = kts, ktf<a name='2427'>
      a_mkrdxm = 0.<a name='2428'>
      a_mkrdxp = 0.<a name='2429'>
      a_mkrdym = 0.<a name='2430'>
      a_mkrdyp = 0.<a name='2431'>
      a_rcoup = 0.<a name='2432'>
      do i = i_start, i_end<a name='2433'>
        a_mkrdxm = 0.<a name='2434'>
        a_mkrdxp = 0.<a name='2435'>
        a_mkrdym = 0.<a name='2436'>
        a_mkrdyp = 0.<a name='2437'>
        a_rcoup = 0.<a name='2438'>
        mkrdxm = msft(i-1,j)*xkmhd(i-1,k,j)*rdx<a name='2439'>
<font color=#447700>! recompute : mkrdxm<a name='2440'></font>
        mkrdxp = msft(i,j)*xkmhd(i,k,j)*rdx<a name='2441'>
<font color=#447700>! recompute : mkrdxp<a name='2442'></font>
        mrdx = msfu(i,j)*rdx<a name='2443'>
<font color=#447700>! recompute : mrdx<a name='2444'></font>
        mkrdym = 0.5*(msfu(i,j)+msfu(i,j-1))*0.25*(xkmhd(i,k,j)+xkmhd(i,k,j-1)+xkmhd(i-1,k,j-1)+xkmhd(i-1,k,j))*rdy<a name='2445'>
<font color=#447700>! recompute : mkrdym<a name='2446'></font>
        mkrdyp = 0.5*(msfu(i,j)+msfu(i,j+1))*0.25*(xkmhd(i,k,j)+xkmhd(i,k,j+1)+xkmhd(i-1,k,j+1)+xkmhd(i-1,k,j))*rdy<a name='2447'>
<font color=#447700>! recompute : mkrdyp<a name='2448'></font>
        mrdy = msfu(i,j)*rdy<a name='2449'>
<font color=#447700>! recompute : mrdy<a name='2450'></font>
        rcoup = 0.5*(mu(i,j)+mu(i-1,j))<a name='2451'>
<font color=#447700>! recompute : rcoup<a name='2452'></font>
        a_field(i,k,j-1) = a_field(i,k,j-1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdym<a name='2453'>
        a_field(i,k,j+1) = a_field(i,k,j+1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdyp<a name='2454'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxm<a name='2455'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxp<a name='2456'>
        a_field(i,k,j) = a_field(i,k,j)+a_tendency(i,k,j)*rcoup*((-(mrdx*(mkrdxp+mkrdxm)))-mrdy*(mkrdyp+mkrdym))<a name='2457'>
        a_mkrdxm = a_mkrdxm-a_tendency(i,k,j)*rcoup*mrdx*(field(i,k,j)-field(i-1,k,j))<a name='2458'>
        a_mkrdxp = a_mkrdxp+a_tendency(i,k,j)*rcoup*mrdx*(field(i+1,k,j)-field(i,k,j))<a name='2459'>
        a_mkrdym = a_mkrdym-a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j)-field(i,k,j-1))<a name='2460'>
        a_mkrdyp = a_mkrdyp+a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j+1)-field(i,k,j))<a name='2461'>
        a_rcoup = a_rcoup+a_tendency(i,k,j)*(mrdx*(mkrdxp*(field(i+1,k,j)-field(i,k,j))-mkrdxm*(field(i,k,j)-field(i-1,k,j)))+mrdy*&amp;<a name='2462'>
&amp;(mkrdyp*(field(i,k,j+1)-field(i,k,j))-mkrdym*(field(i,k,j)-field(i,k,j-1))))<a name='2463'>
        a_mu(i-1,j) = a_mu(i-1,j)+0.5*a_rcoup<a name='2464'>
        a_mu(i,j) = a_mu(i,j)+0.5*a_rcoup<a name='2465'>
        a_rcoup = 0.<a name='2466'>
        a_xkmhd(i-1,k,j+1) = a_xkmhd(i-1,k,j+1)+0.125*a_mkrdyp*(msfu(i,j)+msfu(i,j+1))*rdy<a name='2467'>
        a_xkmhd(i,k,j+1) = a_xkmhd(i,k,j+1)+0.125*a_mkrdyp*(msfu(i,j)+msfu(i,j+1))*rdy<a name='2468'>
        a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+0.125*a_mkrdyp*(msfu(i,j)+msfu(i,j+1))*rdy<a name='2469'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.125*a_mkrdyp*(msfu(i,j)+msfu(i,j+1))*rdy<a name='2470'>
        a_mkrdyp = 0.<a name='2471'>
        a_xkmhd(i-1,k,j-1) = a_xkmhd(i-1,k,j-1)+0.125*a_mkrdym*(msfu(i,j)+msfu(i,j-1))*rdy<a name='2472'>
        a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+0.125*a_mkrdym*(msfu(i,j)+msfu(i,j-1))*rdy<a name='2473'>
        a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+0.125*a_mkrdym*(msfu(i,j)+msfu(i,j-1))*rdy<a name='2474'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.125*a_mkrdym*(msfu(i,j)+msfu(i,j-1))*rdy<a name='2475'>
        a_mkrdym = 0.<a name='2476'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+a_mkrdxp*msft(i,j)*rdx<a name='2477'>
        a_mkrdxp = 0.<a name='2478'>
        a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+a_mkrdxm*msft(i-1,j)*rdx<a name='2479'>
        a_mkrdxm = 0.<a name='2480'>
      end do<a name='2481'>
    end do<a name='2482'>
  end do<a name='2483'>
else if (name .eq. 'v') then<a name='2484'>
  i_start = its<a name='2485'>
<font color=#447700>! recompute : i_start<a name='2486'></font>
  i_end = min(ite,ide-1)<a name='2487'>
<font color=#447700>! recompute : i_end<a name='2488'></font>
  j_start = jts<a name='2489'>
<font color=#447700>! recompute : j_start<a name='2490'></font>
  j_end = jte<a name='2491'>
<font color=#447700>! recompute : j_end<a name='2492'></font>
  if (config_flags%open_xs .or. specified) then<a name='2493'>
    i_start = max(ids+1,its)<a name='2494'>
  endif<a name='2495'>
<font color=#447700>! recompute : i_start<a name='2496'></font>
  if (config_flags%open_xe .or. specified) then<a name='2497'>
    i_end = min(ide-2,ite)<a name='2498'>
  endif<a name='2499'>
<font color=#447700>! recompute : i_end<a name='2500'></font>
  if (config_flags%open_ys .or. specified) then<a name='2501'>
    j_start = max(jds+1,jts)<a name='2502'>
  endif<a name='2503'>
<font color=#447700>! recompute : j_start<a name='2504'></font>
  if (config_flags%open_ye .or. specified) then<a name='2505'>
    j_end = min(jde-1,jte)<a name='2506'>
  endif<a name='2507'>
<font color=#447700>! recompute : j_end<a name='2508'></font>
  do j = j_start, j_end<a name='2509'>
    a_mkrdxm = 0.<a name='2510'>
    a_mkrdxp = 0.<a name='2511'>
    a_mkrdym = 0.<a name='2512'>
    a_mkrdyp = 0.<a name='2513'>
    a_rcoup = 0.<a name='2514'>
    do k = kts, ktf<a name='2515'>
      a_mkrdxm = 0.<a name='2516'>
      a_mkrdxp = 0.<a name='2517'>
      a_mkrdym = 0.<a name='2518'>
      a_mkrdyp = 0.<a name='2519'>
      a_rcoup = 0.<a name='2520'>
      do i = i_start, i_end<a name='2521'>
        a_mkrdxm = 0.<a name='2522'>
        a_mkrdxp = 0.<a name='2523'>
        a_mkrdym = 0.<a name='2524'>
        a_mkrdyp = 0.<a name='2525'>
        a_rcoup = 0.<a name='2526'>
        mkrdxm = 0.5*(msfv(i,j)+msfv(i-1,j))*0.25*(xkmhd(i,k,j)+xkmhd(i,k,j-1)+xkmhd(i-1,k,j-1)+xkmhd(i-1,k,j))*rdx<a name='2527'>
<font color=#447700>! recompute : mkrdxm<a name='2528'></font>
        mkrdxp = 0.5*(msfv(i,j)+msfv(i+1,j))*0.25*(xkmhd(i,k,j)+xkmhd(i,k,j-1)+xkmhd(i+1,k,j-1)+xkmhd(i+1,k,j))*rdx<a name='2529'>
<font color=#447700>! recompute : mkrdxp<a name='2530'></font>
        mrdx = msfv(i,j)*rdx<a name='2531'>
<font color=#447700>! recompute : mrdx<a name='2532'></font>
        mkrdym = msft(i,j-1)*xkmhd(i,k,j-1)*rdy<a name='2533'>
<font color=#447700>! recompute : mkrdym<a name='2534'></font>
        mkrdyp = msft(i,j)*xkmhd(i,k,j)*rdy<a name='2535'>
<font color=#447700>! recompute : mkrdyp<a name='2536'></font>
        mrdy = msfv(i,j)*rdy<a name='2537'>
<font color=#447700>! recompute : mrdy<a name='2538'></font>
        rcoup = 0.5*(mu(i,j)+mu(i,j-1))<a name='2539'>
<font color=#447700>! recompute : rcoup<a name='2540'></font>
        a_field(i,k,j-1) = a_field(i,k,j-1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdym<a name='2541'>
        a_field(i,k,j+1) = a_field(i,k,j+1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdyp<a name='2542'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxm<a name='2543'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxp<a name='2544'>
        a_field(i,k,j) = a_field(i,k,j)+a_tendency(i,k,j)*rcoup*((-(mrdx*(mkrdxp+mkrdxm)))-mrdy*(mkrdyp+mkrdym))<a name='2545'>
        a_mkrdxm = a_mkrdxm-a_tendency(i,k,j)*rcoup*mrdx*(field(i,k,j)-field(i-1,k,j))<a name='2546'>
        a_mkrdxp = a_mkrdxp+a_tendency(i,k,j)*rcoup*mrdx*(field(i+1,k,j)-field(i,k,j))<a name='2547'>
        a_mkrdym = a_mkrdym-a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j)-field(i,k,j-1))<a name='2548'>
        a_mkrdyp = a_mkrdyp+a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j+1)-field(i,k,j))<a name='2549'>
        a_rcoup = a_rcoup+a_tendency(i,k,j)*(mrdx*(mkrdxp*(field(i+1,k,j)-field(i,k,j))-mkrdxm*(field(i,k,j)-field(i-1,k,j)))+mrdy*&amp;<a name='2550'>
&amp;(mkrdyp*(field(i,k,j+1)-field(i,k,j))-mkrdym*(field(i,k,j)-field(i,k,j-1))))<a name='2551'>
        a_mu(i,j-1) = a_mu(i,j-1)+0.5*a_rcoup<a name='2552'>
        a_mu(i,j) = a_mu(i,j)+0.5*a_rcoup<a name='2553'>
        a_rcoup = 0.<a name='2554'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+a_mkrdyp*msft(i,j)*rdy<a name='2555'>
        a_mkrdyp = 0.<a name='2556'>
        a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+a_mkrdym*msft(i,j-1)*rdy<a name='2557'>
        a_mkrdym = 0.<a name='2558'>
        a_xkmhd(i+1,k,j-1) = a_xkmhd(i+1,k,j-1)+0.125*a_mkrdxp*(msfv(i,j)+msfv(i+1,j))*rdx<a name='2559'>
        a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+0.125*a_mkrdxp*(msfv(i,j)+msfv(i+1,j))*rdx<a name='2560'>
        a_xkmhd(i+1,k,j) = a_xkmhd(i+1,k,j)+0.125*a_mkrdxp*(msfv(i,j)+msfv(i+1,j))*rdx<a name='2561'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.125*a_mkrdxp*(msfv(i,j)+msfv(i+1,j))*rdx<a name='2562'>
        a_mkrdxp = 0.<a name='2563'>
        a_xkmhd(i-1,k,j-1) = a_xkmhd(i-1,k,j-1)+0.125*a_mkrdxm*(msfv(i,j)+msfv(i-1,j))*rdx<a name='2564'>
        a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+0.125*a_mkrdxm*(msfv(i,j)+msfv(i-1,j))*rdx<a name='2565'>
        a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+0.125*a_mkrdxm*(msfv(i,j)+msfv(i-1,j))*rdx<a name='2566'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.125*a_mkrdxm*(msfv(i,j)+msfv(i-1,j))*rdx<a name='2567'>
        a_mkrdxm = 0.<a name='2568'>
      end do<a name='2569'>
    end do<a name='2570'>
  end do<a name='2571'>
else if (name .eq. 'w') then<a name='2572'>
  i_start = its<a name='2573'>
<font color=#447700>! recompute : i_start<a name='2574'></font>
  i_end = min(ite,ide-1)<a name='2575'>
<font color=#447700>! recompute : i_end<a name='2576'></font>
  j_start = jts<a name='2577'>
<font color=#447700>! recompute : j_start<a name='2578'></font>
  j_end = min(jte,jde-1)<a name='2579'>
<font color=#447700>! recompute : j_end<a name='2580'></font>
  if (config_flags%open_xs .or. specified) then<a name='2581'>
    i_start = max(ids+1,its)<a name='2582'>
  endif<a name='2583'>
<font color=#447700>! recompute : i_start<a name='2584'></font>
  if (config_flags%open_xe .or. specified) then<a name='2585'>
    i_end = min(ide-2,ite)<a name='2586'>
  endif<a name='2587'>
<font color=#447700>! recompute : i_end<a name='2588'></font>
  if (config_flags%open_ys .or. specified) then<a name='2589'>
    j_start = max(jds+1,jts)<a name='2590'>
  endif<a name='2591'>
<font color=#447700>! recompute : j_start<a name='2592'></font>
  if (config_flags%open_ye .or. specified) then<a name='2593'>
    j_end = min(jde-2,jte)<a name='2594'>
  endif<a name='2595'>
<font color=#447700>! recompute : j_end<a name='2596'></font>
  do j = j_start, j_end<a name='2597'>
    a_mkrdxm = 0.<a name='2598'>
    a_mkrdxp = 0.<a name='2599'>
    a_mkrdym = 0.<a name='2600'>
    a_mkrdyp = 0.<a name='2601'>
    a_rcoup = 0.<a name='2602'>
    do k = kts+1, ktf<a name='2603'>
      a_mkrdxm = 0.<a name='2604'>
      a_mkrdxp = 0.<a name='2605'>
      a_mkrdym = 0.<a name='2606'>
      a_mkrdyp = 0.<a name='2607'>
      a_rcoup = 0.<a name='2608'>
      do i = i_start, i_end<a name='2609'>
        a_mkrdxm = 0.<a name='2610'>
        a_mkrdxp = 0.<a name='2611'>
        a_mkrdym = 0.<a name='2612'>
        a_mkrdyp = 0.<a name='2613'>
        a_rcoup = 0.<a name='2614'>
        mkrdxm = msfu(i,j)*0.25*(xkmhd(i,k,j)+xkmhd(i-1,k,j)+xkmhd(i,k-1,j)+xkmhd(i-1,k-1,j))*rdx<a name='2615'>
<font color=#447700>! recompute : mkrdxm<a name='2616'></font>
        mkrdxp = msfu(i+1,j)*0.25*(xkmhd(i+1,k,j)+xkmhd(i,k,j)+xkmhd(i+1,k-1,j)+xkmhd(i,k-1,j))*rdx<a name='2617'>
<font color=#447700>! recompute : mkrdxp<a name='2618'></font>
        mrdx = msft(i,j)*rdx<a name='2619'>
<font color=#447700>! recompute : mrdx<a name='2620'></font>
        mkrdym = msfv(i,j)*0.25*(xkmhd(i,k,j)+xkmhd(i,k,j-1)+xkmhd(i,k-1,j)+xkmhd(i,k-1,j-1))*rdy<a name='2621'>
<font color=#447700>! recompute : mkrdym<a name='2622'></font>
        mkrdyp = msfv(i,j+1)*0.25*(xkmhd(i,k,j+1)+xkmhd(i,k,j)+xkmhd(i,k-1,j+1)+xkmhd(i,k-1,j))*rdy<a name='2623'>
<font color=#447700>! recompute : mkrdyp<a name='2624'></font>
        mrdy = msft(i,j)*rdy<a name='2625'>
<font color=#447700>! recompute : mrdy<a name='2626'></font>
        rcoup = 0.5*(mu(i,j)+mu(i,j))<a name='2627'>
<font color=#447700>! recompute : rcoup<a name='2628'></font>
        a_field(i,k,j-1) = a_field(i,k,j-1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdym<a name='2629'>
        a_field(i,k,j+1) = a_field(i,k,j+1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdyp<a name='2630'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxm<a name='2631'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxp<a name='2632'>
        a_field(i,k,j) = a_field(i,k,j)+a_tendency(i,k,j)*rcoup*((-(mrdx*(mkrdxp+mkrdxm)))-mrdy*(mkrdyp+mkrdym))<a name='2633'>
        a_mkrdxm = a_mkrdxm-a_tendency(i,k,j)*rcoup*mrdx*(field(i,k,j)-field(i-1,k,j))<a name='2634'>
        a_mkrdxp = a_mkrdxp+a_tendency(i,k,j)*rcoup*mrdx*(field(i+1,k,j)-field(i,k,j))<a name='2635'>
        a_mkrdym = a_mkrdym-a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j)-field(i,k,j-1))<a name='2636'>
        a_mkrdyp = a_mkrdyp+a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j+1)-field(i,k,j))<a name='2637'>
        a_rcoup = a_rcoup+a_tendency(i,k,j)*(mrdx*(mkrdxp*(field(i+1,k,j)-field(i,k,j))-mkrdxm*(field(i,k,j)-field(i-1,k,j)))+mrdy*&amp;<a name='2638'>
&amp;(mkrdyp*(field(i,k,j+1)-field(i,k,j))-mkrdym*(field(i,k,j)-field(i,k,j-1))))<a name='2639'>
        a_mu(i,j) = a_mu(i,j)+a_rcoup<a name='2640'>
        a_rcoup = 0.<a name='2641'>
        a_xkmhd(i,k-1,j+1) = a_xkmhd(i,k-1,j+1)+0.25*a_mkrdyp*msfv(i,j+1)*rdy<a name='2642'>
        a_xkmhd(i,k-1,j) = a_xkmhd(i,k-1,j)+0.25*a_mkrdyp*msfv(i,j+1)*rdy<a name='2643'>
        a_xkmhd(i,k,j+1) = a_xkmhd(i,k,j+1)+0.25*a_mkrdyp*msfv(i,j+1)*rdy<a name='2644'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.25*a_mkrdyp*msfv(i,j+1)*rdy<a name='2645'>
        a_mkrdyp = 0.<a name='2646'>
        a_xkmhd(i,k-1,j-1) = a_xkmhd(i,k-1,j-1)+0.25*a_mkrdym*msfv(i,j)*rdy<a name='2647'>
        a_xkmhd(i,k-1,j) = a_xkmhd(i,k-1,j)+0.25*a_mkrdym*msfv(i,j)*rdy<a name='2648'>
        a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+0.25*a_mkrdym*msfv(i,j)*rdy<a name='2649'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.25*a_mkrdym*msfv(i,j)*rdy<a name='2650'>
        a_mkrdym = 0.<a name='2651'>
        a_xkmhd(i+1,k-1,j) = a_xkmhd(i+1,k-1,j)+0.25*a_mkrdxp*msfu(i+1,j)*rdx<a name='2652'>
        a_xkmhd(i,k-1,j) = a_xkmhd(i,k-1,j)+0.25*a_mkrdxp*msfu(i+1,j)*rdx<a name='2653'>
        a_xkmhd(i+1,k,j) = a_xkmhd(i+1,k,j)+0.25*a_mkrdxp*msfu(i+1,j)*rdx<a name='2654'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.25*a_mkrdxp*msfu(i+1,j)*rdx<a name='2655'>
        a_mkrdxp = 0.<a name='2656'>
        a_xkmhd(i-1,k-1,j) = a_xkmhd(i-1,k-1,j)+0.25*a_mkrdxm*msfu(i,j)*rdx<a name='2657'>
        a_xkmhd(i,k-1,j) = a_xkmhd(i,k-1,j)+0.25*a_mkrdxm*msfu(i,j)*rdx<a name='2658'>
        a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+0.25*a_mkrdxm*msfu(i,j)*rdx<a name='2659'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.25*a_mkrdxm*msfu(i,j)*rdx<a name='2660'>
        a_mkrdxm = 0.<a name='2661'>
      end do<a name='2662'>
    end do<a name='2663'>
  end do<a name='2664'>
else<a name='2665'>
  i_start = its<a name='2666'>
<font color=#447700>! recompute : i_start<a name='2667'></font>
  i_end = min(ite,ide-1)<a name='2668'>
<font color=#447700>! recompute : i_end<a name='2669'></font>
  j_start = jts<a name='2670'>
<font color=#447700>! recompute : j_start<a name='2671'></font>
  j_end = min(jte,jde-1)<a name='2672'>
<font color=#447700>! recompute : j_end<a name='2673'></font>
  if (config_flags%open_xs .or. specified) then<a name='2674'>
    i_start = max(ids+1,its)<a name='2675'>
  endif<a name='2676'>
<font color=#447700>! recompute : i_start<a name='2677'></font>
  if (config_flags%open_xe .or. specified) then<a name='2678'>
    i_end = min(ide-2,ite)<a name='2679'>
  endif<a name='2680'>
<font color=#447700>! recompute : i_end<a name='2681'></font>
  if (config_flags%open_ys .or. specified) then<a name='2682'>
    j_start = max(jds+1,jts)<a name='2683'>
  endif<a name='2684'>
<font color=#447700>! recompute : j_start<a name='2685'></font>
  if (config_flags%open_ye .or. specified) then<a name='2686'>
    j_end = min(jde-2,jte)<a name='2687'>
  endif<a name='2688'>
<font color=#447700>! recompute : j_end<a name='2689'></font>
  do j = j_start, j_end<a name='2690'>
    a_mkrdxm = 0.<a name='2691'>
    a_mkrdxp = 0.<a name='2692'>
    a_mkrdym = 0.<a name='2693'>
    a_mkrdyp = 0.<a name='2694'>
    a_rcoup = 0.<a name='2695'>
    do k = kts, ktf<a name='2696'>
      a_mkrdxm = 0.<a name='2697'>
      a_mkrdxp = 0.<a name='2698'>
      a_mkrdym = 0.<a name='2699'>
      a_mkrdyp = 0.<a name='2700'>
      a_rcoup = 0.<a name='2701'>
      do i = i_start, i_end<a name='2702'>
        a_mkrdxm = 0.<a name='2703'>
        a_mkrdxp = 0.<a name='2704'>
        a_mkrdym = 0.<a name='2705'>
        a_mkrdyp = 0.<a name='2706'>
        a_rcoup = 0.<a name='2707'>
        mkrdxm = msfu(i,j)*0.5*(xkmhd(i,k,j)+xkmhd(i-1,k,j))*rdx*pr<a name='2708'>
<font color=#447700>! recompute : mkrdxm<a name='2709'></font>
        mkrdxp = msfu(i+1,j)*0.5*(xkmhd(i+1,k,j)+xkmhd(i,k,j))*rdx*pr<a name='2710'>
<font color=#447700>! recompute : mkrdxp<a name='2711'></font>
        mrdx = msft(i,j)*rdx<a name='2712'>
<font color=#447700>! recompute : mrdx<a name='2713'></font>
        mkrdym = msfv(i,j)*0.5*(xkmhd(i,k,j)+xkmhd(i,k,j-1))*rdy*pr<a name='2714'>
<font color=#447700>! recompute : mkrdym<a name='2715'></font>
        mkrdyp = msfv(i,j+1)*0.5*(xkmhd(i,k,j+1)+xkmhd(i,k,j))*rdy*pr<a name='2716'>
<font color=#447700>! recompute : mkrdyp<a name='2717'></font>
        mrdy = msft(i,j)*rdy<a name='2718'>
<font color=#447700>! recompute : mrdy<a name='2719'></font>
        rcoup = mu(i,j)<a name='2720'>
<font color=#447700>! recompute : rcoup<a name='2721'></font>
        a_field(i,k,j-1) = a_field(i,k,j-1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdym<a name='2722'>
        a_field(i,k,j+1) = a_field(i,k,j+1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdyp<a name='2723'>
        a_field(i-1,k,j) = a_field(i-1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxm<a name='2724'>
        a_field(i+1,k,j) = a_field(i+1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxp<a name='2725'>
        a_field(i,k,j) = a_field(i,k,j)+a_tendency(i,k,j)*rcoup*((-(mrdx*(mkrdxp+mkrdxm)))-mrdy*(mkrdyp+mkrdym))<a name='2726'>
        a_mkrdxm = a_mkrdxm-a_tendency(i,k,j)*rcoup*mrdx*(field(i,k,j)-field(i-1,k,j))<a name='2727'>
        a_mkrdxp = a_mkrdxp+a_tendency(i,k,j)*rcoup*mrdx*(field(i+1,k,j)-field(i,k,j))<a name='2728'>
        a_mkrdym = a_mkrdym-a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j)-field(i,k,j-1))<a name='2729'>
        a_mkrdyp = a_mkrdyp+a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j+1)-field(i,k,j))<a name='2730'>
        a_rcoup = a_rcoup+a_tendency(i,k,j)*(mrdx*(mkrdxp*(field(i+1,k,j)-field(i,k,j))-mkrdxm*(field(i,k,j)-field(i-1,k,j)))+mrdy*&amp;<a name='2731'>
&amp;(mkrdyp*(field(i,k,j+1)-field(i,k,j))-mkrdym*(field(i,k,j)-field(i,k,j-1))))<a name='2732'>
        a_mu(i,j) = a_mu(i,j)+a_rcoup<a name='2733'>
        a_rcoup = 0.<a name='2734'>
        a_xkmhd(i,k,j+1) = a_xkmhd(i,k,j+1)+0.5*a_mkrdyp*msfv(i,j+1)*rdy*pr<a name='2735'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdyp*msfv(i,j+1)*rdy*pr<a name='2736'>
        a_mkrdyp = 0.<a name='2737'>
        a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+0.5*a_mkrdym*msfv(i,j)*rdy*pr<a name='2738'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdym*msfv(i,j)*rdy*pr<a name='2739'>
        a_mkrdym = 0.<a name='2740'>
        a_xkmhd(i+1,k,j) = a_xkmhd(i+1,k,j)+0.5*a_mkrdxp*msfu(i+1,j)*rdx*pr<a name='2741'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdxp*msfu(i+1,j)*rdx*pr<a name='2742'>
        a_mkrdxp = 0.<a name='2743'>
        a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+0.5*a_mkrdxm*msfu(i,j)*rdx*pr<a name='2744'>
        a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdxm*msfu(i,j)*rdx*pr<a name='2745'>
        a_mkrdxm = 0.<a name='2746'>
      end do<a name='2747'>
    end do<a name='2748'>
  end do<a name='2749'>
endif<a name='2750'>
<a name='2751'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_DIFFUSION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_30">("a_horizontal_diffusion")<a name='2752'>
<a name='2753'>
end subroutine a_horizontal_diffusion<a name='2754'>
<a name='2755'>
<a name='2756'>
<A NAME='A_HORIZONTAL_DIFFUSION_3DMP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_DIFFUSION_3DMP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2757'>
<font color=#993300>subroutine </font><font color=#cc0000>a_horizontal_diffusion_3dmp</font>( field, a_field, a_tendency, mu, a_mu, config_flags, base_3d, msfu, msfv, msft, xkmhd, &amp; <A href='../../call_to/A_HORIZONTAL_DIFFUSION_3DMP.html' TARGET='index'>2</A>,<A href='../../call_from/A_HORIZONTAL_DIFFUSION_3DMP.html' TARGET='index'>2</A><a name='2758'>
&amp;a_xkmhd, rdx, rdy, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='2759'>
<font color=#447700>!******************************************************************<a name='2760'></font>
<font color=#447700>!******************************************************************<a name='2761'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='2762'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='2763'></font>
<font color=#447700>!******************************************************************<a name='2764'></font>
<font color=#447700>!******************************************************************<a name='2765'></font>
<font color=#447700>!==============================================<a name='2766'></font>
<font color=#447700>! all entries are defined explicitly<a name='2767'></font>
<font color=#447700>!==============================================<a name='2768'></font>
implicit none<a name='2769'>
<a name='2770'>
<font color=#447700>!==============================================<a name='2771'></font>
<font color=#447700>! declare arguments<a name='2772'></font>
<font color=#447700>!==============================================<a name='2773'></font>
integer, intent(in) :: ime<a name='2774'>
integer, intent(in) :: ims<a name='2775'>
integer, intent(in) :: jme<a name='2776'>
integer, intent(in) :: jms<a name='2777'>
integer, intent(in) :: kme<a name='2778'>
integer, intent(in) :: kms<a name='2779'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='2780'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='2781'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='2782'>
real, intent(inout) :: a_xkmhd(ims:ime,kms:kme,jms:jme)<a name='2783'>
real, intent(in) :: base_3d(ims:ime,kms:kme,jms:jme)<a name='2784'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='2785'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='2786'>
integer, intent(in) :: ide<a name='2787'>
integer, intent(in) :: ids<a name='2788'>
integer, intent(in) :: ite<a name='2789'>
integer, intent(in) :: its<a name='2790'>
integer, intent(in) :: jde<a name='2791'>
integer, intent(in) :: jds<a name='2792'>
integer, intent(in) :: jte<a name='2793'>
integer, intent(in) :: jts<a name='2794'>
integer, intent(in) :: kde<a name='2795'>
integer, intent(in) :: kte<a name='2796'>
integer, intent(in) :: kts<a name='2797'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='2798'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='2799'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='2800'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='2801'>
real, intent(in) :: rdx<a name='2802'>
real, intent(in) :: rdy<a name='2803'>
real, intent(in) :: xkmhd(ims:ime,kms:kme,jms:jme)<a name='2804'>
<a name='2805'>
<font color=#447700>!==============================================<a name='2806'></font>
<font color=#447700>! declare local variables<a name='2807'></font>
<font color=#447700>!==============================================<a name='2808'></font>
real a_mkrdxm<a name='2809'>
real a_mkrdxp<a name='2810'>
real a_mkrdym<a name='2811'>
real a_mkrdyp<a name='2812'>
real a_rcoup<a name='2813'>
integer i<a name='2814'>
integer i_end<a name='2815'>
integer i_start<a name='2816'>
integer j<a name='2817'>
integer j_end<a name='2818'>
integer j_start<a name='2819'>
integer k<a name='2820'>
integer ktf<a name='2821'>
real mkrdxm<a name='2822'>
real mkrdxp<a name='2823'>
real mkrdym<a name='2824'>
real mkrdyp<a name='2825'>
real mrdx<a name='2826'>
real mrdy<a name='2827'>
real :: pr = 3.<a name='2828'>
real rcoup<a name='2829'>
logical specified<a name='2830'>
<a name='2831'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_DIFFUSION_3DMP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_31">("a_horizontal_diffusion_3dmp")<a name='2832'>
<a name='2833'>
<font color=#447700>!----------------------------------------------<a name='2834'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='2835'></font>
<font color=#447700>!----------------------------------------------<a name='2836'></font>
a_mkrdxm = 0.<a name='2837'>
a_mkrdxp = 0.<a name='2838'>
a_mkrdym = 0.<a name='2839'>
a_mkrdyp = 0.<a name='2840'>
a_rcoup = 0.<a name='2841'>
<a name='2842'>
<font color=#447700>!----------------------------------------------<a name='2843'></font>
<font color=#447700>! ROUTINE BODY<a name='2844'></font>
<font color=#447700>!----------------------------------------------<a name='2845'></font>
specified =  .false. <a name='2846'>
<font color=#447700>! recompute : specified<a name='2847'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='2848'>
  specified =  .true. <a name='2849'>
endif<a name='2850'>
<font color=#447700>! recompute : specified<a name='2851'></font>
ktf = min(kte,kde-1)<a name='2852'>
<font color=#447700>! recompute : ktf<a name='2853'></font>
i_start = its<a name='2854'>
<font color=#447700>! recompute : i_start<a name='2855'></font>
i_end = min(ite,ide-1)<a name='2856'>
<font color=#447700>! recompute : i_end<a name='2857'></font>
j_start = jts<a name='2858'>
<font color=#447700>! recompute : j_start<a name='2859'></font>
j_end = min(jte,jde-1)<a name='2860'>
<font color=#447700>! recompute : j_end<a name='2861'></font>
if (config_flags%open_xs .or. specified) then<a name='2862'>
  i_start = max(ids+1,its)<a name='2863'>
endif<a name='2864'>
<font color=#447700>! recompute : i_start<a name='2865'></font>
if (config_flags%open_xe .or. specified) then<a name='2866'>
  i_end = min(ide-2,ite)<a name='2867'>
endif<a name='2868'>
<font color=#447700>! recompute : i_end<a name='2869'></font>
if (config_flags%open_ys .or. specified) then<a name='2870'>
  j_start = max(jds+1,jts)<a name='2871'>
endif<a name='2872'>
<font color=#447700>! recompute : j_start<a name='2873'></font>
if (config_flags%open_ye .or. specified) then<a name='2874'>
  j_end = min(jde-2,jte)<a name='2875'>
endif<a name='2876'>
<font color=#447700>! recompute : j_end<a name='2877'></font>
do j = j_start, j_end<a name='2878'>
  a_mkrdxm = 0.<a name='2879'>
  a_mkrdxp = 0.<a name='2880'>
  a_mkrdym = 0.<a name='2881'>
  a_mkrdyp = 0.<a name='2882'>
  a_rcoup = 0.<a name='2883'>
  do k = kts, ktf<a name='2884'>
    a_mkrdxm = 0.<a name='2885'>
    a_mkrdxp = 0.<a name='2886'>
    a_mkrdym = 0.<a name='2887'>
    a_mkrdyp = 0.<a name='2888'>
    a_rcoup = 0.<a name='2889'>
    do i = i_start, i_end<a name='2890'>
      a_mkrdxm = 0.<a name='2891'>
      a_mkrdxp = 0.<a name='2892'>
      a_mkrdym = 0.<a name='2893'>
      a_mkrdyp = 0.<a name='2894'>
      a_rcoup = 0.<a name='2895'>
      mkrdxm = msfu(i,j)*0.5*(xkmhd(i,k,j)+xkmhd(i-1,k,j))*rdx*pr<a name='2896'>
<font color=#447700>! recompute : mkrdxm<a name='2897'></font>
      mkrdxp = msfu(i+1,j)*0.5*(xkmhd(i+1,k,j)+xkmhd(i,k,j))*rdx*pr<a name='2898'>
<font color=#447700>! recompute : mkrdxp<a name='2899'></font>
      mrdx = msft(i,j)*rdx<a name='2900'>
<font color=#447700>! recompute : mrdx<a name='2901'></font>
      mkrdym = msfv(i,j)*0.5*(xkmhd(i,k,j)+xkmhd(i,k,j-1))*rdy*pr<a name='2902'>
<font color=#447700>! recompute : mkrdym<a name='2903'></font>
      mkrdyp = msfv(i,j+1)*0.5*(xkmhd(i,k,j+1)+xkmhd(i,k,j))*rdy*pr<a name='2904'>
<font color=#447700>! recompute : mkrdyp<a name='2905'></font>
      mrdy = msft(i,j)*rdy<a name='2906'>
<font color=#447700>! recompute : mrdy<a name='2907'></font>
      rcoup = mu(i,j)<a name='2908'>
<font color=#447700>! recompute : rcoup<a name='2909'></font>
      a_field(i,k,j-1) = a_field(i,k,j-1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdym<a name='2910'>
      a_field(i,k,j+1) = a_field(i,k,j+1)+a_tendency(i,k,j)*rcoup*mrdy*mkrdyp<a name='2911'>
      a_field(i-1,k,j) = a_field(i-1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxm<a name='2912'>
      a_field(i+1,k,j) = a_field(i+1,k,j)+a_tendency(i,k,j)*rcoup*mrdx*mkrdxp<a name='2913'>
      a_field(i,k,j) = a_field(i,k,j)+a_tendency(i,k,j)*rcoup*((-(mrdx*(mkrdxp+mkrdxm)))-mrdy*(mkrdyp+mkrdym))<a name='2914'>
      a_mkrdxm = a_mkrdxm-a_tendency(i,k,j)*rcoup*mrdx*(field(i,k,j)-field(i-1,k,j)-base_3d(i,k,j)+base_3d(i-1,k,j))<a name='2915'>
      a_mkrdxp = a_mkrdxp+a_tendency(i,k,j)*rcoup*mrdx*(field(i+1,k,j)-field(i,k,j)-base_3d(i+1,k,j)+base_3d(i,k,j))<a name='2916'>
      a_mkrdym = a_mkrdym-a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j)-field(i,k,j-1)-base_3d(i,k,j)+base_3d(i,k,j-1))<a name='2917'>
      a_mkrdyp = a_mkrdyp+a_tendency(i,k,j)*rcoup*mrdy*(field(i,k,j+1)-field(i,k,j)-base_3d(i,k,j+1)+base_3d(i,k,j))<a name='2918'>
      a_rcoup = a_rcoup+a_tendency(i,k,j)*(mrdx*(mkrdxp*(field(i+1,k,j)-field(i,k,j)-base_3d(i+1,k,j)+base_3d(i,k,j))-mkrdxm*&amp;<a name='2919'>
&amp;(field(i,k,j)-field(i-1,k,j)-base_3d(i,k,j)+base_3d(i-1,k,j)))+mrdy*(mkrdyp*(field(i,k,j+1)-field(i,k,j)-base_3d(i,k,j+1)+&amp;<a name='2920'>
&amp;base_3d(i,k,j))-mkrdym*(field(i,k,j)-field(i,k,j-1)-base_3d(i,k,j)+base_3d(i,k,j-1))))<a name='2921'>
      a_mu(i,j) = a_mu(i,j)+a_rcoup<a name='2922'>
      a_rcoup = 0.<a name='2923'>
      a_xkmhd(i,k,j+1) = a_xkmhd(i,k,j+1)+0.5*a_mkrdyp*msfv(i,j+1)*rdy*pr<a name='2924'>
      a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdyp*msfv(i,j+1)*rdy*pr<a name='2925'>
      a_mkrdyp = 0.<a name='2926'>
      a_xkmhd(i,k,j-1) = a_xkmhd(i,k,j-1)+0.5*a_mkrdym*msfv(i,j)*rdy*pr<a name='2927'>
      a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdym*msfv(i,j)*rdy*pr<a name='2928'>
      a_mkrdym = 0.<a name='2929'>
      a_xkmhd(i+1,k,j) = a_xkmhd(i+1,k,j)+0.5*a_mkrdxp*msfu(i+1,j)*rdx*pr<a name='2930'>
      a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdxp*msfu(i+1,j)*rdx*pr<a name='2931'>
      a_mkrdxp = 0.<a name='2932'>
      a_xkmhd(i-1,k,j) = a_xkmhd(i-1,k,j)+0.5*a_mkrdxm*msfu(i,j)*rdx*pr<a name='2933'>
      a_xkmhd(i,k,j) = a_xkmhd(i,k,j)+0.5*a_mkrdxm*msfu(i,j)*rdx*pr<a name='2934'>
      a_mkrdxm = 0.<a name='2935'>
    end do<a name='2936'>
  end do<a name='2937'>
end do<a name='2938'>
<a name='2939'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_DIFFUSION_3DMP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_31">("a_horizontal_diffusion_3dmp")<a name='2940'>
<a name='2941'>
end subroutine a_horizontal_diffusion_3dmp<a name='2942'>
<a name='2943'>
<a name='2944'>
<A NAME='A_HORIZONTAL_PRESSURE_GRADIENT'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_PRESSURE_GRADIENT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2945'>
<font color=#993300>subroutine </font><font color=#cc0000>a_horizontal_pressure_gradient</font>( a_ru_tend, a_rv_tend, ph, a_ph, alt, a_alt, p, a_p, pb, al, a_al, php, a_php, cqu, &amp; <A href='../../call_to/A_HORIZONTAL_PRESSURE_GRADIENT.html' TARGET='index'>1</A>,<A href='../../call_from/A_HORIZONTAL_PRESSURE_GRADIENT.html' TARGET='index'>2</A><a name='2946'>
&amp;a_cqu, cqv, a_cqv, muu, a_muu, muv, a_muv, mu, a_mu, fnm, fnp, rdnw, cf1, cf2, cf3, rdx, rdy, config_flags, non_hydrostatic, ids, &amp;<a name='2947'>
&amp;ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kte )<a name='2948'>
<font color=#447700>!******************************************************************<a name='2949'></font>
<font color=#447700>!******************************************************************<a name='2950'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='2951'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='2952'></font>
<font color=#447700>!******************************************************************<a name='2953'></font>
<font color=#447700>!******************************************************************<a name='2954'></font>
<font color=#447700>!==============================================<a name='2955'></font>
<font color=#447700>! all entries are defined explicitly<a name='2956'></font>
<font color=#447700>!==============================================<a name='2957'></font>
implicit none<a name='2958'>
<a name='2959'>
<font color=#447700>!==============================================<a name='2960'></font>
<font color=#447700>! declare arguments<a name='2961'></font>
<font color=#447700>!==============================================<a name='2962'></font>
integer, intent(in) :: ime<a name='2963'>
integer, intent(in) :: ims<a name='2964'>
integer, intent(in) :: jme<a name='2965'>
integer, intent(in) :: jms<a name='2966'>
integer, intent(in) :: kme<a name='2967'>
integer, intent(in) :: kms<a name='2968'>
real, intent(inout) :: a_al(ims:ime,kms:kme,jms:jme)<a name='2969'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='2970'>
real, intent(inout) :: a_cqu(ims:ime,kms:kme,jms:jme)<a name='2971'>
real, intent(inout) :: a_cqv(ims:ime,kms:kme,jms:jme)<a name='2972'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='2973'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='2974'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='2975'>
real, intent(inout) :: a_p(ims:ime,kms:kme,jms:jme)<a name='2976'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='2977'>
real, intent(inout) :: a_php(ims:ime,kms:kme,jms:jme)<a name='2978'>
real, intent(inout) :: a_ru_tend(ims:ime,kms:kme,jms:jme)<a name='2979'>
real, intent(inout) :: a_rv_tend(ims:ime,kms:kme,jms:jme)<a name='2980'>
real, intent(in) :: al(ims:ime,kms:kme,jms:jme)<a name='2981'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='2982'>
real, intent(in) :: cf1<a name='2983'>
real, intent(in) :: cf2<a name='2984'>
real, intent(in) :: cf3<a name='2985'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='2986'>
real, intent(in) :: cqu(ims:ime,kms:kme,jms:jme)<a name='2987'>
real, intent(in) :: cqv(ims:ime,kms:kme,jms:jme)<a name='2988'>
real, intent(in) :: fnm(kms:kme)<a name='2989'>
real, intent(in) :: fnp(kms:kme)<a name='2990'>
integer, intent(in) :: ide<a name='2991'>
integer, intent(in) :: ids<a name='2992'>
integer, intent(in) :: ite<a name='2993'>
integer, intent(in) :: its<a name='2994'>
integer, intent(in) :: jde<a name='2995'>
integer, intent(in) :: jds<a name='2996'>
integer, intent(in) :: jte<a name='2997'>
integer, intent(in) :: jts<a name='2998'>
integer, intent(in) :: kde<a name='2999'>
integer, intent(in) :: kte<a name='3000'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='3001'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='3002'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='3003'>
logical, intent(in) :: non_hydrostatic<a name='3004'>
real, intent(in) :: p(ims:ime,kms:kme,jms:jme)<a name='3005'>
real, intent(in) :: pb(ims:ime,kms:kme,jms:jme)<a name='3006'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='3007'>
real, intent(in) :: php(ims:ime,kms:kme,jms:jme)<a name='3008'>
real, intent(in) :: rdnw(kms:kme)<a name='3009'>
real, intent(in) :: rdx<a name='3010'>
real, intent(in) :: rdy<a name='3011'>
<a name='3012'>
<font color=#447700>!==============================================<a name='3013'></font>
<font color=#447700>! declare local variables<a name='3014'></font>
<font color=#447700>!==============================================<a name='3015'></font>
real a_dpn(ims:ime,kms:kme)<a name='3016'>
real a_dpx<a name='3017'>
real a_dpy<a name='3018'>
real dpn(ims:ime,kms:kme)<a name='3019'>
real dpx<a name='3020'>
real dpy<a name='3021'>
integer i<a name='3022'>
integer i_start<a name='3023'>
integer itf<a name='3024'>
integer j<a name='3025'>
integer j_start<a name='3026'>
integer jtf<a name='3027'>
integer k<a name='3028'>
integer ktf<a name='3029'>
logical specified<a name='3030'>
<a name='3031'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_PRESSURE_GRADIENT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_32">("a_horizontal_pressure_gradient")<a name='3032'>
<a name='3033'>
<font color=#447700>!----------------------------------------------<a name='3034'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='3035'></font>
<font color=#447700>!----------------------------------------------<a name='3036'></font>
a_dpn(:,:) = 0.<a name='3037'>
a_dpx = 0.<a name='3038'>
a_dpy = 0.<a name='3039'>
<a name='3040'>
<font color=#447700>!----------------------------------------------<a name='3041'></font>
<font color=#447700>! ROUTINE BODY<a name='3042'></font>
<font color=#447700>!----------------------------------------------<a name='3043'></font>
specified =  .false. <a name='3044'>
<font color=#447700>! recompute : specified<a name='3045'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='3046'>
  specified =  .true. <a name='3047'>
endif<a name='3048'>
<font color=#447700>! recompute : specified<a name='3049'></font>
itf = ite<a name='3050'>
<font color=#447700>! recompute : itf<a name='3051'></font>
jtf = min(jte,jde-1)<a name='3052'>
<font color=#447700>! recompute : jtf<a name='3053'></font>
ktf = min(kte,kde-1)<a name='3054'>
<font color=#447700>! recompute : ktf<a name='3055'></font>
i_start = its<a name='3056'>
<font color=#447700>! recompute : i_start<a name='3057'></font>
j_start = jts<a name='3058'>
<font color=#447700>! recompute : j_start<a name='3059'></font>
if ((config_flags%open_xs .or. specified .or. config_flags%nested) .and. its .eq. ids) then<a name='3060'>
  i_start = its+1<a name='3061'>
endif<a name='3062'>
<font color=#447700>! recompute : i_start<a name='3063'></font>
if ((config_flags%open_xe .or. specified .or. config_flags%nested) .and. ite .eq. ide) then<a name='3064'>
  itf = itf-1<a name='3065'>
endif<a name='3066'>
<font color=#447700>! recompute : itf<a name='3067'></font>
do j = j_start, jtf<a name='3068'>
  a_dpx = 0.<a name='3069'>
  if (non_hydrostatic) then<a name='3070'>
    k = 1<a name='3071'>
<font color=#447700>! recompute : k<a name='3072'></font>
    do i = i_start, itf<a name='3073'>
      dpn(i,k) = 0.5*(cf1*(p(i-1,k,j)+p(i,k,j))+cf2*(p(i-1,k+1,j)+p(i,k+1,j))+cf3*(p(i-1,k+2,j)+p(i,k+2,j)))<a name='3074'>
      dpn(i,kde) = 0.<a name='3075'>
    end do<a name='3076'>
    do k = 2, ktf<a name='3077'>
      do i = i_start, itf<a name='3078'>
        dpn(i,k) = 0.5*(fnm(k)*(p(i-1,k,j)+p(i,k,j))+fnp(k)*(p(i-1,k-1,j)+p(i,k-1,j)))<a name='3079'>
      end do<a name='3080'>
    end do<a name='3081'>
<font color=#447700>! recompute : dpn<a name='3082'></font>
    do k = 1, ktf<a name='3083'>
      a_dpx = 0.<a name='3084'>
      do i = i_start, itf<a name='3085'>
        a_dpx = 0.<a name='3086'>
        dpx = 0.5*rdx*muu(i,j)*(ph(i,k+1,j)-ph(i-1,k+1,j)+ph(i,k,j)-ph(i-1,k,j)+(alt(i,k,j)+alt(i-1,k,j))*(p(i,k,j)-p(i-1,k,j))+&amp;<a name='3087'>
&amp;(al(i,k,j)+al(i-1,k,j))*(pb(i,k,j)-pb(i-1,k,j)))<a name='3088'>
<font color=#447700>! recompute : dpx<a name='3089'></font>
        dpx = dpx+rdx*(php(i,k,j)-php(i-1,k,j))*(rdnw(k)*(dpn(i,k+1)-dpn(i,k))-0.5*(mu(i-1,j)+mu(i,j)))<a name='3090'>
<font color=#447700>! recompute : dpx<a name='3091'></font>
        a_cqu(i,k,j) = a_cqu(i,k,j)-a_ru_tend(i,k,j)*dpx<a name='3092'>
        a_dpx = a_dpx-a_ru_tend(i,k,j)*cqu(i,k,j)<a name='3093'>
        a_dpn(i,k+1) = a_dpn(i,k+1)+a_dpx*rdx*(php(i,k,j)-php(i-1,k,j))*rdnw(k)<a name='3094'>
        a_dpn(i,k) = a_dpn(i,k)-a_dpx*rdx*(php(i,k,j)-php(i-1,k,j))*rdnw(k)<a name='3095'>
        a_mu(i-1,j) = a_mu(i-1,j)-0.5*a_dpx*rdx*(php(i,k,j)-php(i-1,k,j))<a name='3096'>
        a_mu(i,j) = a_mu(i,j)-0.5*a_dpx*rdx*(php(i,k,j)-php(i-1,k,j))<a name='3097'>
        a_php(i-1,k,j) = a_php(i-1,k,j)-a_dpx*rdx*(rdnw(k)*(dpn(i,k+1)-dpn(i,k))-0.5*(mu(i-1,j)+mu(i,j)))<a name='3098'>
        a_php(i,k,j) = a_php(i,k,j)+a_dpx*rdx*(rdnw(k)*(dpn(i,k+1)-dpn(i,k))-0.5*(mu(i-1,j)+mu(i,j)))<a name='3099'>
        a_al(i-1,k,j) = a_al(i-1,k,j)+0.5*a_dpx*rdx*muu(i,j)*(pb(i,k,j)-pb(i-1,k,j))<a name='3100'>
        a_al(i,k,j) = a_al(i,k,j)+0.5*a_dpx*rdx*muu(i,j)*(pb(i,k,j)-pb(i-1,k,j))<a name='3101'>
        a_alt(i-1,k,j) = a_alt(i-1,k,j)+0.5*a_dpx*rdx*muu(i,j)*(p(i,k,j)-p(i-1,k,j))<a name='3102'>
        a_alt(i,k,j) = a_alt(i,k,j)+0.5*a_dpx*rdx*muu(i,j)*(p(i,k,j)-p(i-1,k,j))<a name='3103'>
        a_muu(i,j) = a_muu(i,j)+0.5*a_dpx*rdx*(ph(i,k+1,j)-ph(i-1,k+1,j)+ph(i,k,j)-ph(i-1,k,j)+(alt(i,k,j)+alt(i-1,k,j))*(p(i,k,j)-&amp;<a name='3104'>
&amp;p(i-1,k,j))+(al(i,k,j)+al(i-1,k,j))*(pb(i,k,j)-pb(i-1,k,j)))<a name='3105'>
        a_p(i-1,k,j) = a_p(i-1,k,j)-0.5*a_dpx*rdx*muu(i,j)*(alt(i,k,j)+alt(i-1,k,j))<a name='3106'>
        a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpx*rdx*muu(i,j)*(alt(i,k,j)+alt(i-1,k,j))<a name='3107'>
        a_ph(i-1,k+1,j) = a_ph(i-1,k+1,j)-0.5*a_dpx*rdx*muu(i,j)<a name='3108'>
        a_ph(i,k+1,j) = a_ph(i,k+1,j)+0.5*a_dpx*rdx*muu(i,j)<a name='3109'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)-0.5*a_dpx*rdx*muu(i,j)<a name='3110'>
        a_ph(i,k,j) = a_ph(i,k,j)+0.5*a_dpx*rdx*muu(i,j)<a name='3111'>
        a_dpx = 0.<a name='3112'>
      end do<a name='3113'>
    end do<a name='3114'>
    do k = 2, ktf<a name='3115'>
      do i = i_start, itf<a name='3116'>
        a_p(i-1,k-1,j) = a_p(i-1,k-1,j)+0.5*a_dpn(i,k)*fnp(k)<a name='3117'>
        a_p(i,k-1,j) = a_p(i,k-1,j)+0.5*a_dpn(i,k)*fnp(k)<a name='3118'>
        a_p(i-1,k,j) = a_p(i-1,k,j)+0.5*a_dpn(i,k)*fnm(k)<a name='3119'>
        a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpn(i,k)*fnm(k)<a name='3120'>
        a_dpn(i,k) = 0.<a name='3121'>
      end do<a name='3122'>
    end do<a name='3123'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:2001<a name='3124'></font>
<font color=#447700>! recompute vars : k<a name='3125'></font>
    k = 1<a name='3126'>
<font color=#447700>! recompute vars : k<a name='3127'></font>
    do i = i_start, itf<a name='3128'>
      a_dpn(i,kde) = 0.<a name='3129'>
      a_p(i-1,k+2,j) = a_p(i-1,k+2,j)+0.5*a_dpn(i,k)*cf3<a name='3130'>
      a_p(i,k+2,j) = a_p(i,k+2,j)+0.5*a_dpn(i,k)*cf3<a name='3131'>
      a_p(i-1,k+1,j) = a_p(i-1,k+1,j)+0.5*a_dpn(i,k)*cf2<a name='3132'>
      a_p(i,k+1,j) = a_p(i,k+1,j)+0.5*a_dpn(i,k)*cf2<a name='3133'>
      a_p(i-1,k,j) = a_p(i-1,k,j)+0.5*a_dpn(i,k)*cf1<a name='3134'>
      a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpn(i,k)*cf1<a name='3135'>
      a_dpn(i,k) = 0.<a name='3136'>
    end do<a name='3137'>
  else<a name='3138'>
    do k = 1, ktf<a name='3139'>
      a_dpx = 0.<a name='3140'>
      do i = i_start, itf<a name='3141'>
        a_dpx = 0.<a name='3142'>
        dpx = 0.5*rdx*muu(i,j)*(ph(i,k+1,j)-ph(i-1,k+1,j)+ph(i,k,j)-ph(i-1,k,j)+(alt(i,k,j)+alt(i-1,k,j))*(p(i,k,j)-p(i-1,k,j))+&amp;<a name='3143'>
&amp;(al(i,k,j)+al(i-1,k,j))*(pb(i,k,j)-pb(i-1,k,j)))<a name='3144'>
<font color=#447700>! recompute : dpx<a name='3145'></font>
        a_cqu(i,k,j) = a_cqu(i,k,j)-a_ru_tend(i,k,j)*dpx<a name='3146'>
        a_dpx = a_dpx-a_ru_tend(i,k,j)*cqu(i,k,j)<a name='3147'>
        a_al(i-1,k,j) = a_al(i-1,k,j)+0.5*a_dpx*rdx*muu(i,j)*(pb(i,k,j)-pb(i-1,k,j))<a name='3148'>
        a_al(i,k,j) = a_al(i,k,j)+0.5*a_dpx*rdx*muu(i,j)*(pb(i,k,j)-pb(i-1,k,j))<a name='3149'>
        a_alt(i-1,k,j) = a_alt(i-1,k,j)+0.5*a_dpx*rdx*muu(i,j)*(p(i,k,j)-p(i-1,k,j))<a name='3150'>
        a_alt(i,k,j) = a_alt(i,k,j)+0.5*a_dpx*rdx*muu(i,j)*(p(i,k,j)-p(i-1,k,j))<a name='3151'>
        a_muu(i,j) = a_muu(i,j)+0.5*a_dpx*rdx*(ph(i,k+1,j)-ph(i-1,k+1,j)+ph(i,k,j)-ph(i-1,k,j)+(alt(i,k,j)+alt(i-1,k,j))*(p(i,k,j)-&amp;<a name='3152'>
&amp;p(i-1,k,j))+(al(i,k,j)+al(i-1,k,j))*(pb(i,k,j)-pb(i-1,k,j)))<a name='3153'>
        a_p(i-1,k,j) = a_p(i-1,k,j)-0.5*a_dpx*rdx*muu(i,j)*(alt(i,k,j)+alt(i-1,k,j))<a name='3154'>
        a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpx*rdx*muu(i,j)*(alt(i,k,j)+alt(i-1,k,j))<a name='3155'>
        a_ph(i-1,k+1,j) = a_ph(i-1,k+1,j)-0.5*a_dpx*rdx*muu(i,j)<a name='3156'>
        a_ph(i,k+1,j) = a_ph(i,k+1,j)+0.5*a_dpx*rdx*muu(i,j)<a name='3157'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)-0.5*a_dpx*rdx*muu(i,j)<a name='3158'>
        a_ph(i,k,j) = a_ph(i,k,j)+0.5*a_dpx*rdx*muu(i,j)<a name='3159'>
        a_dpx = 0.<a name='3160'>
      end do<a name='3161'>
    end do<a name='3162'>
  endif<a name='3163'>
end do<a name='3164'>
<font color=#447700>! recdepend vars : ide,ite<a name='3165'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1927<a name='3166'></font>
<font color=#447700>! recompute vars : itf<a name='3167'></font>
itf = min(ite,ide-1)<a name='3168'>
<font color=#447700>! recompute vars : itf<a name='3169'></font>
<font color=#447700>! recdepend vars : itf,jte<a name='3170'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1928<a name='3171'></font>
<font color=#447700>! recompute vars : jtf<a name='3172'></font>
jtf = jte<a name='3173'>
<font color=#447700>! recompute vars : jtf<a name='3174'></font>
<font color=#447700>! recdepend vars : itf,jtf,kde,kte<a name='3175'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1929<a name='3176'></font>
<font color=#447700>! recompute vars : ktf<a name='3177'></font>
ktf = min(kte,kde-1)<a name='3178'>
<font color=#447700>! recompute vars : ktf<a name='3179'></font>
<font color=#447700>! recdepend vars : itf,its,jtf,ktf<a name='3180'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1930<a name='3181'></font>
<font color=#447700>! recompute vars : i_start<a name='3182'></font>
i_start = its<a name='3183'>
<font color=#447700>! recompute vars : i_start<a name='3184'></font>
<font color=#447700>! recdepend vars : i_start,itf,jtf,jts,ktf<a name='3185'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1931<a name='3186'></font>
<font color=#447700>! recompute vars : j_start<a name='3187'></font>
j_start = jts<a name='3188'>
<font color=#447700>! recompute vars : j_start<a name='3189'></font>
<font color=#447700>!  recdepend vars : config_flags,i_start,itf,j_start,jds,jtf,jts,ktf,spe<a name='3190'></font>
<font color=#447700>! cified<a name='3191'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1932<a name='3192'></font>
<font color=#447700>! recompute vars : j_start<a name='3193'></font>
if ((config_flags%open_ys .or. specified .or. config_flags%nested) .and. jts .eq. jds) then<a name='3194'>
  j_start = jts+1<a name='3195'>
endif<a name='3196'>
<font color=#447700>! recompute vars : j_start<a name='3197'></font>
<font color=#447700>!  recdepend vars : config_flags,i_start,itf,j_start,jde,jte,jtf,ktf,spe<a name='3198'></font>
<font color=#447700>! cified<a name='3199'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1934<a name='3200'></font>
<font color=#447700>! recompute vars : jtf<a name='3201'></font>
if ((config_flags%open_ye .or. specified .or. config_flags%nested) .and. jte .eq. jde) then<a name='3202'>
  jtf = jtf-1<a name='3203'>
endif<a name='3204'>
<font color=#447700>! recompute vars : jtf<a name='3205'></font>
do j = j_start, jtf<a name='3206'>
  a_dpy = 0.<a name='3207'>
  if (non_hydrostatic) then<a name='3208'>
    k = 1<a name='3209'>
<font color=#447700>! recompute : k<a name='3210'></font>
    do i = i_start, itf<a name='3211'>
      dpn(i,k) = 0.5*(cf1*(p(i,k,j-1)+p(i,k,j))+cf2*(p(i,k+1,j-1)+p(i,k+1,j))+cf3*(p(i,k+2,j-1)+p(i,k+2,j)))<a name='3212'>
      dpn(i,kde) = 0.<a name='3213'>
    end do<a name='3214'>
    do k = 2, ktf<a name='3215'>
      do i = i_start, itf<a name='3216'>
        dpn(i,k) = 0.5*(fnm(k)*(p(i,k,j-1)+p(i,k,j))+fnp(k)*(p(i,k-1,j-1)+p(i,k-1,j)))<a name='3217'>
      end do<a name='3218'>
    end do<a name='3219'>
<font color=#447700>! recompute : dpn<a name='3220'></font>
    do k = 1, ktf<a name='3221'>
      a_dpy = 0.<a name='3222'>
      do i = i_start, itf<a name='3223'>
        a_dpy = 0.<a name='3224'>
        dpy = 0.5*rdy*muv(i,j)*(ph(i,k+1,j)-ph(i,k+1,j-1)+ph(i,k,j)-ph(i,k,j-1)+(alt(i,k,j)+alt(i,k,j-1))*(p(i,k,j)-p(i,k,j-1))+&amp;<a name='3225'>
&amp;(al(i,k,j)+al(i,k,j-1))*(pb(i,k,j)-pb(i,k,j-1)))<a name='3226'>
<font color=#447700>! recompute : dpy<a name='3227'></font>
        dpy = dpy+rdy*(php(i,k,j)-php(i,k,j-1))*(rdnw(k)*(dpn(i,k+1)-dpn(i,k))-0.5*(mu(i,j-1)+mu(i,j)))<a name='3228'>
<font color=#447700>! recompute : dpy<a name='3229'></font>
        a_cqv(i,k,j) = a_cqv(i,k,j)-a_rv_tend(i,k,j)*dpy<a name='3230'>
        a_dpy = a_dpy-a_rv_tend(i,k,j)*cqv(i,k,j)<a name='3231'>
        a_dpn(i,k+1) = a_dpn(i,k+1)+a_dpy*rdy*(php(i,k,j)-php(i,k,j-1))*rdnw(k)<a name='3232'>
        a_dpn(i,k) = a_dpn(i,k)-a_dpy*rdy*(php(i,k,j)-php(i,k,j-1))*rdnw(k)<a name='3233'>
        a_mu(i,j-1) = a_mu(i,j-1)-0.5*a_dpy*rdy*(php(i,k,j)-php(i,k,j-1))<a name='3234'>
        a_mu(i,j) = a_mu(i,j)-0.5*a_dpy*rdy*(php(i,k,j)-php(i,k,j-1))<a name='3235'>
        a_php(i,k,j-1) = a_php(i,k,j-1)-a_dpy*rdy*(rdnw(k)*(dpn(i,k+1)-dpn(i,k))-0.5*(mu(i,j-1)+mu(i,j)))<a name='3236'>
        a_php(i,k,j) = a_php(i,k,j)+a_dpy*rdy*(rdnw(k)*(dpn(i,k+1)-dpn(i,k))-0.5*(mu(i,j-1)+mu(i,j)))<a name='3237'>
        a_al(i,k,j-1) = a_al(i,k,j-1)+0.5*a_dpy*rdy*muv(i,j)*(pb(i,k,j)-pb(i,k,j-1))<a name='3238'>
        a_al(i,k,j) = a_al(i,k,j)+0.5*a_dpy*rdy*muv(i,j)*(pb(i,k,j)-pb(i,k,j-1))<a name='3239'>
        a_alt(i,k,j-1) = a_alt(i,k,j-1)+0.5*a_dpy*rdy*muv(i,j)*(p(i,k,j)-p(i,k,j-1))<a name='3240'>
        a_alt(i,k,j) = a_alt(i,k,j)+0.5*a_dpy*rdy*muv(i,j)*(p(i,k,j)-p(i,k,j-1))<a name='3241'>
        a_muv(i,j) = a_muv(i,j)+0.5*a_dpy*rdy*(ph(i,k+1,j)-ph(i,k+1,j-1)+ph(i,k,j)-ph(i,k,j-1)+(alt(i,k,j)+alt(i,k,j-1))*(p(i,k,j)-&amp;<a name='3242'>
&amp;p(i,k,j-1))+(al(i,k,j)+al(i,k,j-1))*(pb(i,k,j)-pb(i,k,j-1)))<a name='3243'>
        a_p(i,k,j-1) = a_p(i,k,j-1)-0.5*a_dpy*rdy*muv(i,j)*(alt(i,k,j)+alt(i,k,j-1))<a name='3244'>
        a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpy*rdy*muv(i,j)*(alt(i,k,j)+alt(i,k,j-1))<a name='3245'>
        a_ph(i,k+1,j-1) = a_ph(i,k+1,j-1)-0.5*a_dpy*rdy*muv(i,j)<a name='3246'>
        a_ph(i,k+1,j) = a_ph(i,k+1,j)+0.5*a_dpy*rdy*muv(i,j)<a name='3247'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)-0.5*a_dpy*rdy*muv(i,j)<a name='3248'>
        a_ph(i,k,j) = a_ph(i,k,j)+0.5*a_dpy*rdy*muv(i,j)<a name='3249'>
        a_dpy = 0.<a name='3250'>
      end do<a name='3251'>
    end do<a name='3252'>
    do k = 2, ktf<a name='3253'>
      do i = i_start, itf<a name='3254'>
        a_p(i,k-1,j-1) = a_p(i,k-1,j-1)+0.5*a_dpn(i,k)*fnp(k)<a name='3255'>
        a_p(i,k-1,j) = a_p(i,k-1,j)+0.5*a_dpn(i,k)*fnp(k)<a name='3256'>
        a_p(i,k,j-1) = a_p(i,k,j-1)+0.5*a_dpn(i,k)*fnm(k)<a name='3257'>
        a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpn(i,k)*fnm(k)<a name='3258'>
        a_dpn(i,k) = 0.<a name='3259'>
      end do<a name='3260'>
    end do<a name='3261'>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1941<a name='3262'></font>
<font color=#447700>! recompute vars : k<a name='3263'></font>
    k = 1<a name='3264'>
<font color=#447700>! recompute vars : k<a name='3265'></font>
    do i = i_start, itf<a name='3266'>
      a_dpn(i,kde) = 0.<a name='3267'>
      a_p(i,k+2,j-1) = a_p(i,k+2,j-1)+0.5*a_dpn(i,k)*cf3<a name='3268'>
      a_p(i,k+2,j) = a_p(i,k+2,j)+0.5*a_dpn(i,k)*cf3<a name='3269'>
      a_p(i,k+1,j-1) = a_p(i,k+1,j-1)+0.5*a_dpn(i,k)*cf2<a name='3270'>
      a_p(i,k+1,j) = a_p(i,k+1,j)+0.5*a_dpn(i,k)*cf2<a name='3271'>
      a_p(i,k,j-1) = a_p(i,k,j-1)+0.5*a_dpn(i,k)*cf1<a name='3272'>
      a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpn(i,k)*cf1<a name='3273'>
      a_dpn(i,k) = 0.<a name='3274'>
    end do<a name='3275'>
  else<a name='3276'>
    do k = 1, ktf<a name='3277'>
      a_dpy = 0.<a name='3278'>
      do i = i_start, itf<a name='3279'>
        a_dpy = 0.<a name='3280'>
        dpy = 0.5*rdy*muv(i,j)*(ph(i,k+1,j)-ph(i,k+1,j-1)+ph(i,k,j)-ph(i,k,j-1)+(alt(i,k,j)+alt(i,k,j-1))*(p(i,k,j)-p(i,k,j-1))+&amp;<a name='3281'>
&amp;(al(i,k,j)+al(i,k,j-1))*(pb(i,k,j)-pb(i,k,j-1)))<a name='3282'>
<font color=#447700>! recompute : dpy<a name='3283'></font>
        a_cqv(i,k,j) = a_cqv(i,k,j)-a_rv_tend(i,k,j)*dpy<a name='3284'>
        a_dpy = a_dpy-a_rv_tend(i,k,j)*cqv(i,k,j)<a name='3285'>
        a_al(i,k,j-1) = a_al(i,k,j-1)+0.5*a_dpy*rdy*muv(i,j)*(pb(i,k,j)-pb(i,k,j-1))<a name='3286'>
        a_al(i,k,j) = a_al(i,k,j)+0.5*a_dpy*rdy*muv(i,j)*(pb(i,k,j)-pb(i,k,j-1))<a name='3287'>
        a_alt(i,k,j-1) = a_alt(i,k,j-1)+0.5*a_dpy*rdy*muv(i,j)*(p(i,k,j)-p(i,k,j-1))<a name='3288'>
        a_alt(i,k,j) = a_alt(i,k,j)+0.5*a_dpy*rdy*muv(i,j)*(p(i,k,j)-p(i,k,j-1))<a name='3289'>
        a_muv(i,j) = a_muv(i,j)+0.5*a_dpy*rdy*(ph(i,k+1,j)-ph(i,k+1,j-1)+ph(i,k,j)-ph(i,k,j-1)+(alt(i,k,j)+alt(i,k,j-1))*(p(i,k,j)-&amp;<a name='3290'>
&amp;p(i,k,j-1))+(al(i,k,j)+al(i,k,j-1))*(pb(i,k,j)-pb(i,k,j-1)))<a name='3291'>
        a_p(i,k,j-1) = a_p(i,k,j-1)-0.5*a_dpy*rdy*muv(i,j)*(alt(i,k,j)+alt(i,k,j-1))<a name='3292'>
        a_p(i,k,j) = a_p(i,k,j)+0.5*a_dpy*rdy*muv(i,j)*(alt(i,k,j)+alt(i,k,j-1))<a name='3293'>
        a_ph(i,k+1,j-1) = a_ph(i,k+1,j-1)-0.5*a_dpy*rdy*muv(i,j)<a name='3294'>
        a_ph(i,k+1,j) = a_ph(i,k+1,j)+0.5*a_dpy*rdy*muv(i,j)<a name='3295'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)-0.5*a_dpy*rdy*muv(i,j)<a name='3296'>
        a_ph(i,k,j) = a_ph(i,k,j)+0.5*a_dpy*rdy*muv(i,j)<a name='3297'>
        a_dpy = 0.<a name='3298'>
      end do<a name='3299'>
    end do<a name='3300'>
  endif<a name='3301'>
end do<a name='3302'>
<a name='3303'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_HORIZONTAL_PRESSURE_GRADIENT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_32">("a_horizontal_pressure_gradient")<a name='3304'>
<a name='3305'>
end subroutine a_horizontal_pressure_gradient<a name='3306'>
<a name='3307'>
<a name='3308'>
<A NAME='A_PERTURBATION_CORIOLIS'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PERTURBATION_CORIOLIS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3309'>
<font color=#993300>subroutine </font><font color=#cc0000>a_perturbation_coriolis</font>( a_ru_in, a_rv_in, a_rw, a_ru_tend, a_rv_tend, a_rw_tend, config_flags, u_base, v_base, z_base, &amp; <A href='../../call_to/A_PERTURBATION_CORIOLIS.html' TARGET='index'>1</A>,<A href='../../call_from/A_PERTURBATION_CORIOLIS.html' TARGET='index'>2</A><a name='3310'>
&amp;muu, a_muu, muv, a_muv, phb, ph, a_ph, f, e, sina, cosa, fzm, fzp, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, &amp;<a name='3311'>
&amp;ite, jts, jte, kts, kte )<a name='3312'>
<font color=#447700>!******************************************************************<a name='3313'></font>
<font color=#447700>!******************************************************************<a name='3314'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='3315'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='3316'></font>
<font color=#447700>!******************************************************************<a name='3317'></font>
<font color=#447700>!******************************************************************<a name='3318'></font>
<font color=#447700>!==============================================<a name='3319'></font>
<font color=#447700>! all entries are defined explicitly<a name='3320'></font>
<font color=#447700>!==============================================<a name='3321'></font>
implicit none<a name='3322'>
<a name='3323'>
<font color=#447700>!==============================================<a name='3324'></font>
<font color=#447700>! declare arguments<a name='3325'></font>
<font color=#447700>!==============================================<a name='3326'></font>
integer, intent(in) :: ime<a name='3327'>
integer, intent(in) :: ims<a name='3328'>
integer, intent(in) :: jme<a name='3329'>
integer, intent(in) :: jms<a name='3330'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='3331'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='3332'>
integer, intent(in) :: kme<a name='3333'>
integer, intent(in) :: kms<a name='3334'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='3335'>
real, intent(inout) :: a_ru_in(ims:ime,kms:kme,jms:jme)<a name='3336'>
real, intent(inout) :: a_ru_tend(ims:ime,kms:kme,jms:jme)<a name='3337'>
real, intent(inout) :: a_rv_in(ims:ime,kms:kme,jms:jme)<a name='3338'>
real, intent(inout) :: a_rv_tend(ims:ime,kms:kme,jms:jme)<a name='3339'>
real, intent(inout) :: a_rw(ims:ime,kms:kme,jms:jme)<a name='3340'>
real, intent(inout) :: a_rw_tend(ims:ime,kms:kme,jms:jme)<a name='3341'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='3342'>
real, intent(in) :: cosa(ims:ime,jms:jme)<a name='3343'>
real, intent(in) :: e(ims:ime,jms:jme)<a name='3344'>
real, intent(in) :: f(ims:ime,jms:jme)<a name='3345'>
real, intent(in) :: fzm(kms:kme)<a name='3346'>
real, intent(in) :: fzp(kms:kme)<a name='3347'>
integer, intent(in) :: ide<a name='3348'>
integer, intent(in) :: ids<a name='3349'>
integer, intent(in) :: ite<a name='3350'>
integer, intent(in) :: its<a name='3351'>
integer, intent(in) :: jde<a name='3352'>
integer, intent(in) :: jds<a name='3353'>
integer, intent(in) :: jte<a name='3354'>
integer, intent(in) :: jts<a name='3355'>
integer, intent(in) :: kde<a name='3356'>
integer, intent(in) :: kte<a name='3357'>
integer, intent(in) :: kts<a name='3358'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='3359'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='3360'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='3361'>
real, intent(in) :: phb(ims:ime,kms:kme,jms:jme)<a name='3362'>
real, intent(in) :: sina(ims:ime,jms:jme)<a name='3363'>
real, intent(in) :: u_base(kms:kme)<a name='3364'>
real, intent(in) :: v_base(kms:kme)<a name='3365'>
real, intent(in) :: z_base(kms:kme)<a name='3366'>
<a name='3367'>
<font color=#447700>!==============================================<a name='3368'></font>
<font color=#447700>! declare local variables<a name='3369'></font>
<font color=#447700>!==============================================<a name='3370'></font>
real a_ru(ims:ime,kms:kme,jms:jme)<a name='3371'>
real a_rv(ims:ime,kms:kme,jms:jme)<a name='3372'>
real a_wk<a name='3373'>
real a_wkm1<a name='3374'>
real a_wkp1<a name='3375'>
real a_z_at_u<a name='3376'>
real a_z_at_v<a name='3377'>
integer i<a name='3378'>
integer i_end<a name='3379'>
integer i_start<a name='3380'>
integer j<a name='3381'>
integer j_end<a name='3382'>
integer j_start<a name='3383'>
integer k<a name='3384'>
integer ktf<a name='3385'>
logical specified<a name='3386'>
real wk<a name='3387'>
real wkm1<a name='3388'>
real wkp1<a name='3389'>
real z_at_u<a name='3390'>
real z_at_v<a name='3391'>
<a name='3392'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PERTURBATION_CORIOLIS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_33">("a_perturbation_coriolis")<a name='3393'>
<a name='3394'>
<font color=#447700>!----------------------------------------------<a name='3395'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='3396'></font>
<font color=#447700>!----------------------------------------------<a name='3397'></font>
a_ru(:,:,:) = 0.<a name='3398'>
a_rv(:,:,:) = 0.<a name='3399'>
a_wk = 0.<a name='3400'>
a_wkm1 = 0.<a name='3401'>
a_wkp1 = 0.<a name='3402'>
a_z_at_u = 0.<a name='3403'>
a_z_at_v = 0.<a name='3404'>
<a name='3405'>
<font color=#447700>!----------------------------------------------<a name='3406'></font>
<font color=#447700>! ROUTINE BODY<a name='3407'></font>
<font color=#447700>!----------------------------------------------<a name='3408'></font>
specified =  .false. <a name='3409'>
<font color=#447700>! recompute : specified<a name='3410'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='3411'>
  specified =  .true. <a name='3412'>
endif<a name='3413'>
<font color=#447700>! recompute : specified<a name='3414'></font>
ktf = min(kte,kde-1)<a name='3415'>
<font color=#447700>! recompute : ktf<a name='3416'></font>
i_start = its<a name='3417'>
<font color=#447700>! recompute : i_start<a name='3418'></font>
i_end = ite<a name='3419'>
<font color=#447700>! recompute : i_end<a name='3420'></font>
if (config_flags%open_xs .or. specified .or. config_flags%nested) then<a name='3421'>
  i_start = max(ids+1,its)<a name='3422'>
endif<a name='3423'>
<font color=#447700>! recompute : i_start<a name='3424'></font>
if (config_flags%open_xe .or. specified .or. config_flags%nested) then<a name='3425'>
  i_end = min(ide-1,ite)<a name='3426'>
endif<a name='3427'>
<font color=#447700>! recompute : i_end<a name='3428'></font>
j_start = jts<a name='3429'>
<font color=#447700>! recompute : j_start<a name='3430'></font>
j_end = jte<a name='3431'>
<font color=#447700>! recompute : j_end<a name='3432'></font>
if (config_flags%open_ys .or. specified .or. config_flags%nested) then<a name='3433'>
  j_start = max(jds+1,jts)<a name='3434'>
endif<a name='3435'>
<font color=#447700>! recompute : j_start<a name='3436'></font>
if (config_flags%open_ye .or. specified .or. config_flags%nested) then<a name='3437'>
  j_end = min(jde-1,jte)<a name='3438'>
endif<a name='3439'>
<font color=#447700>! recompute : j_end<a name='3440'></font>
do j = jts, min(jte,jde-1)<a name='3441'>
  do k = kts+1, ktf<a name='3442'>
    do i = its, min(ite,ide-1)<a name='3443'>
      a_ru(i+1,k-1,j) = a_ru(i+1,k-1,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzp(k)<a name='3444'>
      a_ru(i,k-1,j) = a_ru(i,k-1,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzp(k)<a name='3445'>
      a_ru(i+1,k,j) = a_ru(i+1,k,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzm(k)<a name='3446'>
      a_ru(i,k,j) = a_ru(i,k,j)+0.5*a_rw_tend(i,k,j)*e(i,j)*cosa(i,j)*fzm(k)<a name='3447'>
      a_rv(i,k-1,j+1) = a_rv(i,k-1,j+1)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzp(k)<a name='3448'>
      a_rv(i,k-1,j) = a_rv(i,k-1,j)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzp(k)<a name='3449'>
      a_rv(i,k,j+1) = a_rv(i,k,j+1)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzm(k)<a name='3450'>
      a_rv(i,k,j) = a_rv(i,k,j)-0.5*a_rw_tend(i,k,j)*e(i,j)*sina(i,j)*fzm(k)<a name='3451'>
    end do<a name='3452'>
  end do<a name='3453'>
end do<a name='3454'>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='3455'>
  do k = kts, ktf<a name='3456'>
    do i = its, min(ide-1,ite)<a name='3457'>
      a_ru(i+1,k,jte-1) = a_ru(i+1,k,jte-1)-0.5*a_rv_tend(i,k,jte)*f(i,jte-1)<a name='3458'>
      a_ru(i,k,jte-1) = a_ru(i,k,jte-1)-0.5*a_rv_tend(i,k,jte)*f(i,jte-1)<a name='3459'>
      a_rw(i,k+1,jte-1) = a_rw(i,k+1,jte-1)+0.5*a_rv_tend(i,k,jte)*e(i,jte-1)*sina(i,jte-1)<a name='3460'>
      a_rw(i,k,jte-1) = a_rw(i,k,jte-1)+0.5*a_rv_tend(i,k,jte)*e(i,jte-1)*sina(i,jte-1)<a name='3461'>
    end do<a name='3462'>
  end do<a name='3463'>
endif<a name='3464'>
do j = j_start, j_end<a name='3465'>
  do k = kts, ktf<a name='3466'>
    do i = its, min(ide-1,ite)<a name='3467'>
      a_ru(i+1,k,j-1) = a_ru(i+1,k,j-1)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='3468'>
      a_ru(i,k,j-1) = a_ru(i,k,j-1)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='3469'>
      a_ru(i+1,k,j) = a_ru(i+1,k,j)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='3470'>
      a_ru(i,k,j) = a_ru(i,k,j)-0.125*a_rv_tend(i,k,j)*(f(i,j)+f(i,j-1))<a name='3471'>
      a_rw(i,k+1,j-1) = a_rw(i,k+1,j-1)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='3472'>
      a_rw(i,k+1,j) = a_rw(i,k+1,j)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='3473'>
      a_rw(i,k,j-1) = a_rw(i,k,j-1)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='3474'>
      a_rw(i,k,j) = a_rw(i,k,j)+0.0625*a_rv_tend(i,k,j)*(e(i,j)+e(i,j-1))*(sina(i,j)+sina(i,j-1))<a name='3475'>
    end do<a name='3476'>
  end do<a name='3477'>
end do<a name='3478'>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='3479'>
  do k = kts, ktf<a name='3480'>
    do i = its, min(ide-1,ite)<a name='3481'>
      a_ru(i+1,k,jts) = a_ru(i+1,k,jts)-0.5*a_rv_tend(i,k,jts)*f(i,jts)<a name='3482'>
      a_ru(i,k,jts) = a_ru(i,k,jts)-0.5*a_rv_tend(i,k,jts)*f(i,jts)<a name='3483'>
      a_rw(i,k+1,jts) = a_rw(i,k+1,jts)+0.5*a_rv_tend(i,k,jts)*e(i,jts)*sina(i,jts)<a name='3484'>
      a_rw(i,k,jts) = a_rw(i,k,jts)+0.5*a_rv_tend(i,k,jts)*e(i,jts)*sina(i,jts)<a name='3485'>
    end do<a name='3486'>
  end do<a name='3487'>
endif<a name='3488'>
do j = j_start-1, j_end<a name='3489'>
  a_wk = 0.<a name='3490'>
  a_wkm1 = 0.<a name='3491'>
  a_wkp1 = 0.<a name='3492'>
  a_z_at_u = 0.<a name='3493'>
  do i = its, min(ite,ide-1)+1<a name='3494'>
    a_wk = 0.<a name='3495'>
    a_wkm1 = 0.<a name='3496'>
    a_wkp1 = 0.<a name='3497'>
    a_z_at_u = 0.<a name='3498'>
    k = kts<a name='3499'>
<font color=#447700>! recompute : k<a name='3500'></font>
    z_at_u = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i-1,k,j)+phb(i-1,k+1,j)+ph(i,k,j)+ph(i,k+1,j)+ph(i-1,k,j)+ph(i-1,k+1,j))/g<a name='3501'>
<font color=#447700>! recompute : z_at_u<a name='3502'></font>
    wkp1 = min(1.,max(0.,z_at_u-z_base(k))/(z_base(k+1)-z_base(k)))<a name='3503'>
<font color=#447700>! recompute : wkp1<a name='3504'></font>
    k = ktf<a name='3505'>
<font color=#447700>! recompute : k<a name='3506'></font>
    z_at_u = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i-1,k,j)+phb(i-1,k+1,j)+ph(i,k,j)+ph(i,k+1,j)+ph(i-1,k,j)+ph(i-1,k+1,j))/g<a name='3507'>
<font color=#447700>! recompute : z_at_u<a name='3508'></font>
    wkm1 = min(1.,max(0.,z_base(k)-z_at_u)/(z_base(k)-z_base(k-1)))<a name='3509'>
<font color=#447700>! recompute : wkm1<a name='3510'></font>
    wk = 1.-wkm1<a name='3511'>
<font color=#447700>! recompute : wk<a name='3512'></font>
    a_muu(i,j) = a_muu(i,j)-a_ru(i,k,j)*(wkm1*u_base(k-1)+wk*u_base(k))<a name='3513'>
    a_ru_in(i,k,j) = a_ru_in(i,k,j)+a_ru(i,k,j)<a name='3514'>
    a_wk = a_wk-a_ru(i,k,j)*muu(i,j)*u_base(k)<a name='3515'>
    a_wkm1 = a_wkm1-a_ru(i,k,j)*muu(i,j)*u_base(k-1)<a name='3516'>
    a_ru(i,k,j) = 0.<a name='3517'>
    a_wkm1 = a_wkm1-a_wk<a name='3518'>
    a_wk = 0.<a name='3519'>
    a_z_at_u = a_z_at_u-a_wkm1*(0.5-sign(0.5,max(0.,z_base(k)-z_at_u)/(z_base(k)-z_base(k-1))-1.))*((0.5-sign(0.5,0.-(z_base(k)-&amp;<a name='3520'>
&amp;z_at_u)))/(z_base(k)-z_base(k-1)))<a name='3521'>
    a_wkm1 = 0.<a name='3522'>
    a_ph(i-1,k+1,j) = a_ph(i-1,k+1,j)+a_z_at_u*(0.25/g)<a name='3523'>
    a_ph(i,k+1,j) = a_ph(i,k+1,j)+a_z_at_u*(0.25/g)<a name='3524'>
    a_ph(i-1,k,j) = a_ph(i-1,k,j)+a_z_at_u*(0.25/g)<a name='3525'>
    a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_u*(0.25/g)<a name='3526'>
    a_z_at_u = 0.<a name='3527'>
<font color=#447700>! recdepend vars : kts<a name='3528'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3426<a name='3529'></font>
<font color=#447700>! recompute vars : k<a name='3530'></font>
    k = kts<a name='3531'>
<font color=#447700>! recompute vars : k<a name='3532'></font>
<font color=#447700>! recdepend vars : k,wkp1<a name='3533'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3432<a name='3534'></font>
<font color=#447700>! recompute vars : wk<a name='3535'></font>
    wk = 1.-wkp1<a name='3536'>
<font color=#447700>! recompute vars : wk<a name='3537'></font>
    a_muu(i,j) = a_muu(i,j)-a_ru(i,k,j)*(wk*u_base(k)+wkp1*u_base(k+1))<a name='3538'>
    a_ru_in(i,k,j) = a_ru_in(i,k,j)+a_ru(i,k,j)<a name='3539'>
    a_wk = a_wk-a_ru(i,k,j)*muu(i,j)*u_base(k)<a name='3540'>
    a_wkp1 = a_wkp1-a_ru(i,k,j)*muu(i,j)*u_base(k+1)<a name='3541'>
    a_ru(i,k,j) = 0.<a name='3542'>
    a_wkp1 = a_wkp1-a_wk<a name='3543'>
    a_wk = 0.<a name='3544'>
<font color=#447700>! recdepend vars : kts<a name='3545'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3426<a name='3546'></font>
<font color=#447700>! recompute vars : k<a name='3547'></font>
    k = kts<a name='3548'>
<font color=#447700>! recompute vars : k<a name='3549'></font>
<font color=#447700>! recdepend vars : g,i,j,k,ph,phb<a name='3550'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3427<a name='3551'></font>
<font color=#447700>! recompute vars : z_at_u<a name='3552'></font>
    z_at_u = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i-1,k,j)+phb(i-1,k+1,j)+ph(i,k,j)+ph(i,k+1,j)+ph(i-1,k,j)+ph(i-1,k+1,j))/g<a name='3553'>
<font color=#447700>! recompute vars : z_at_u<a name='3554'></font>
    a_z_at_u = a_z_at_u+a_wkp1*(0.5-sign(0.5,max(0.,z_at_u-z_base(k))/(z_base(k+1)-z_base(k))-1.))*((0.5-sign(0.5,0.-(z_at_u-&amp;<a name='3555'>
&amp;z_base(k))))/(z_base(k+1)-z_base(k)))<a name='3556'>
    a_wkp1 = 0.<a name='3557'>
<font color=#447700>! recdepend vars : kts<a name='3558'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3426<a name='3559'></font>
<font color=#447700>! recompute vars : k<a name='3560'></font>
    k = kts<a name='3561'>
<font color=#447700>! recompute vars : k<a name='3562'></font>
    a_ph(i-1,k+1,j) = a_ph(i-1,k+1,j)+a_z_at_u*(0.25/g)<a name='3563'>
    a_ph(i,k+1,j) = a_ph(i,k+1,j)+a_z_at_u*(0.25/g)<a name='3564'>
    a_ph(i-1,k,j) = a_ph(i-1,k,j)+a_z_at_u*(0.25/g)<a name='3565'>
    a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_u*(0.25/g)<a name='3566'>
    a_z_at_u = 0.<a name='3567'>
  end do<a name='3568'>
end do<a name='3569'>
do j = j_start-1, j_end<a name='3570'>
  a_wk = 0.<a name='3571'>
  a_wkm1 = 0.<a name='3572'>
  a_wkp1 = 0.<a name='3573'>
  a_z_at_u = 0.<a name='3574'>
  do k = kts+1, ktf-1<a name='3575'>
    a_wk = 0.<a name='3576'>
    a_wkm1 = 0.<a name='3577'>
    a_wkp1 = 0.<a name='3578'>
    a_z_at_u = 0.<a name='3579'>
    do i = its, min(ite,ide-1)+1<a name='3580'>
      a_wk = 0.<a name='3581'>
      a_wkm1 = 0.<a name='3582'>
      a_wkp1 = 0.<a name='3583'>
      a_z_at_u = 0.<a name='3584'>
      z_at_u = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i-1,k,j)+phb(i-1,k+1,j)+ph(i,k,j)+ph(i,k+1,j)+ph(i-1,k,j)+ph(i-1,k+1,j))/g<a name='3585'>
<font color=#447700>! recompute : z_at_u<a name='3586'></font>
      wkp1 = min(1.,max(0.,z_at_u-z_base(k))/(z_base(k+1)-z_base(k)))<a name='3587'>
<font color=#447700>! recompute : wkp1<a name='3588'></font>
      wkm1 = min(1.,max(0.,z_base(k)-z_at_u)/(z_base(k)-z_base(k-1)))<a name='3589'>
<font color=#447700>! recompute : wkm1<a name='3590'></font>
      wk = 1.-wkp1-wkm1<a name='3591'>
<font color=#447700>! recompute : wk<a name='3592'></font>
      a_muu(i,j) = a_muu(i,j)-a_ru(i,k,j)*(wkm1*u_base(k-1)+wk*u_base(k)+wkp1*u_base(k+1))<a name='3593'>
      a_ru_in(i,k,j) = a_ru_in(i,k,j)+a_ru(i,k,j)<a name='3594'>
      a_wk = a_wk-a_ru(i,k,j)*muu(i,j)*u_base(k)<a name='3595'>
      a_wkm1 = a_wkm1-a_ru(i,k,j)*muu(i,j)*u_base(k-1)<a name='3596'>
      a_wkp1 = a_wkp1-a_ru(i,k,j)*muu(i,j)*u_base(k+1)<a name='3597'>
      a_ru(i,k,j) = 0.<a name='3598'>
      a_wkm1 = a_wkm1-a_wk<a name='3599'>
      a_wkp1 = a_wkp1-a_wk<a name='3600'>
      a_wk = 0.<a name='3601'>
      a_z_at_u = a_z_at_u-a_wkm1*(0.5-sign(0.5,max(0.,z_base(k)-z_at_u)/(z_base(k)-z_base(k-1))-1.))*((0.5-sign(0.5,0.-(z_base(k)-&amp;<a name='3602'>
&amp;z_at_u)))/(z_base(k)-z_base(k-1)))<a name='3603'>
      a_wkm1 = 0.<a name='3604'>
      a_z_at_u = a_z_at_u+a_wkp1*(0.5-sign(0.5,max(0.,z_at_u-z_base(k))/(z_base(k+1)-z_base(k))-1.))*((0.5-sign(0.5,0.-(z_at_u-&amp;<a name='3605'>
&amp;z_base(k))))/(z_base(k+1)-z_base(k)))<a name='3606'>
      a_wkp1 = 0.<a name='3607'>
      a_ph(i-1,k+1,j) = a_ph(i-1,k+1,j)+a_z_at_u*(0.25/g)<a name='3608'>
      a_ph(i,k+1,j) = a_ph(i,k+1,j)+a_z_at_u*(0.25/g)<a name='3609'>
      a_ph(i-1,k,j) = a_ph(i-1,k,j)+a_z_at_u*(0.25/g)<a name='3610'>
      a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_u*(0.25/g)<a name='3611'>
      a_z_at_u = 0.<a name='3612'>
    end do<a name='3613'>
  end do<a name='3614'>
end do<a name='3615'>
do j = jts, min(jte,jde-1)<a name='3616'>
  if (config_flags%open_xe .and. ite .eq. ide) then<a name='3617'>
    do k = kts, ktf<a name='3618'>
      a_rv(ite-1,k,j+1) = a_rv(ite-1,k,j+1)+0.5*a_ru_tend(ite,k,j)*f(ite-1,j)<a name='3619'>
      a_rv(ite-1,k,j) = a_rv(ite-1,k,j)+0.5*a_ru_tend(ite,k,j)*f(ite-1,j)<a name='3620'>
      a_rw(ite-1,k+1,j) = a_rw(ite-1,k+1,j)-0.5*a_ru_tend(ite,k,j)*e(ite-1,j)*cosa(ite-1,j)<a name='3621'>
      a_rw(ite-1,k,j) = a_rw(ite-1,k,j)-0.5*a_ru_tend(ite,k,j)*e(ite-1,j)*cosa(ite-1,j)<a name='3622'>
    end do<a name='3623'>
  endif<a name='3624'>
  if (config_flags%open_xs .and. its .eq. ids) then<a name='3625'>
    do k = kts, ktf<a name='3626'>
      a_rv(its,k,j+1) = a_rv(its,k,j+1)+0.5*a_ru_tend(its,k,j)*f(its,j)<a name='3627'>
      a_rv(its,k,j) = a_rv(its,k,j)+0.5*a_ru_tend(its,k,j)*f(its,j)<a name='3628'>
      a_rw(its,k+1,j) = a_rw(its,k+1,j)-0.5*a_ru_tend(its,k,j)*e(its,j)*cosa(its,j)<a name='3629'>
      a_rw(its,k,j) = a_rw(its,k,j)-0.5*a_ru_tend(its,k,j)*e(its,j)*cosa(its,j)<a name='3630'>
    end do<a name='3631'>
  endif<a name='3632'>
  do k = kts, ktf<a name='3633'>
    do i = i_start, i_end<a name='3634'>
      a_rv(i-1,k,j+1) = a_rv(i-1,k,j+1)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='3635'>
      a_rv(i,k,j+1) = a_rv(i,k,j+1)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='3636'>
      a_rv(i-1,k,j) = a_rv(i-1,k,j)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='3637'>
      a_rv(i,k,j) = a_rv(i,k,j)+0.125*a_ru_tend(i,k,j)*(f(i,j)+f(i-1,j))<a name='3638'>
      a_rw(i-1,k+1,j) = a_rw(i-1,k+1,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='3639'>
      a_rw(i,k+1,j) = a_rw(i,k+1,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='3640'>
      a_rw(i-1,k,j) = a_rw(i-1,k,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='3641'>
      a_rw(i,k,j) = a_rw(i,k,j)-0.0625*a_ru_tend(i,k,j)*(e(i,j)+e(i-1,j))*(cosa(i,j)+cosa(i-1,j))<a name='3642'>
    end do<a name='3643'>
  end do<a name='3644'>
end do<a name='3645'>
do j = jts, min(jte,jde-1)+1<a name='3646'>
  a_wk = 0.<a name='3647'>
  a_wkm1 = 0.<a name='3648'>
  a_wkp1 = 0.<a name='3649'>
  a_z_at_v = 0.<a name='3650'>
  do i = i_start-1, i_end<a name='3651'>
    a_wk = 0.<a name='3652'>
    a_wkm1 = 0.<a name='3653'>
    a_wkp1 = 0.<a name='3654'>
    a_z_at_v = 0.<a name='3655'>
    k = kts<a name='3656'>
<font color=#447700>! recompute : k<a name='3657'></font>
    z_at_v = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i,k,j-1)+phb(i,k+1,j-1)+ph(i,k,j)+ph(i,k+1,j)+ph(i,k,j-1)+ph(i,k+1,j-1))/g<a name='3658'>
<font color=#447700>! recompute : z_at_v<a name='3659'></font>
    wkp1 = min(1.,max(0.,z_at_v-z_base(k))/(z_base(k+1)-z_base(k)))<a name='3660'>
<font color=#447700>! recompute : wkp1<a name='3661'></font>
    k = ktf<a name='3662'>
<font color=#447700>! recompute : k<a name='3663'></font>
    z_at_v = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i,k,j-1)+phb(i,k+1,j-1)+ph(i,k,j)+ph(i,k+1,j)+ph(i,k,j-1)+ph(i,k+1,j-1))/g<a name='3664'>
<font color=#447700>! recompute : z_at_v<a name='3665'></font>
    wkm1 = min(1.,max(0.,z_base(k)-z_at_v)/(z_base(k)-z_base(k-1)))<a name='3666'>
<font color=#447700>! recompute : wkm1<a name='3667'></font>
    wk = 1.-wkm1<a name='3668'>
<font color=#447700>! recompute : wk<a name='3669'></font>
    a_muv(i,j) = a_muv(i,j)-a_rv(i,k,j)*(wkm1*v_base(k-1)+wk*v_base(k))<a name='3670'>
    a_rv_in(i,k,j) = a_rv_in(i,k,j)+a_rv(i,k,j)<a name='3671'>
    a_wk = a_wk-a_rv(i,k,j)*muv(i,j)*v_base(k)<a name='3672'>
    a_wkm1 = a_wkm1-a_rv(i,k,j)*muv(i,j)*v_base(k-1)<a name='3673'>
    a_rv(i,k,j) = 0.<a name='3674'>
    a_wkm1 = a_wkm1-a_wk<a name='3675'>
    a_wk = 0.<a name='3676'>
    a_z_at_v = a_z_at_v-a_wkm1*(0.5-sign(0.5,max(0.,z_base(k)-z_at_v)/(z_base(k)-z_base(k-1))-1.))*((0.5-sign(0.5,0.-(z_base(k)-&amp;<a name='3677'>
&amp;z_at_v)))/(z_base(k)-z_base(k-1)))<a name='3678'>
    a_wkm1 = 0.<a name='3679'>
    a_ph(i,k+1,j-1) = a_ph(i,k+1,j-1)+a_z_at_v*(0.25/g)<a name='3680'>
    a_ph(i,k+1,j) = a_ph(i,k+1,j)+a_z_at_v*(0.25/g)<a name='3681'>
    a_ph(i,k,j-1) = a_ph(i,k,j-1)+a_z_at_v*(0.25/g)<a name='3682'>
    a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_v*(0.25/g)<a name='3683'>
    a_z_at_v = 0.<a name='3684'>
<font color=#447700>! recdepend vars : kts<a name='3685'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3325<a name='3686'></font>
<font color=#447700>! recompute vars : k<a name='3687'></font>
    k = kts<a name='3688'>
<font color=#447700>! recompute vars : k<a name='3689'></font>
<font color=#447700>! recdepend vars : k,wkp1<a name='3690'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3331<a name='3691'></font>
<font color=#447700>! recompute vars : wk<a name='3692'></font>
    wk = 1.-wkp1<a name='3693'>
<font color=#447700>! recompute vars : wk<a name='3694'></font>
    a_muv(i,j) = a_muv(i,j)-a_rv(i,k,j)*(wk*v_base(k)+wkp1*v_base(k+1))<a name='3695'>
    a_rv_in(i,k,j) = a_rv_in(i,k,j)+a_rv(i,k,j)<a name='3696'>
    a_wk = a_wk-a_rv(i,k,j)*muv(i,j)*v_base(k)<a name='3697'>
    a_wkp1 = a_wkp1-a_rv(i,k,j)*muv(i,j)*v_base(k+1)<a name='3698'>
    a_rv(i,k,j) = 0.<a name='3699'>
    a_wkp1 = a_wkp1-a_wk<a name='3700'>
    a_wk = 0.<a name='3701'>
<font color=#447700>! recdepend vars : kts<a name='3702'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3325<a name='3703'></font>
<font color=#447700>! recompute vars : k<a name='3704'></font>
    k = kts<a name='3705'>
<font color=#447700>! recompute vars : k<a name='3706'></font>
<font color=#447700>! recdepend vars : g,i,j,k,ph,phb<a name='3707'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3326<a name='3708'></font>
<font color=#447700>! recompute vars : z_at_v<a name='3709'></font>
    z_at_v = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i,k,j-1)+phb(i,k+1,j-1)+ph(i,k,j)+ph(i,k+1,j)+ph(i,k,j-1)+ph(i,k+1,j-1))/g<a name='3710'>
<font color=#447700>! recompute vars : z_at_v<a name='3711'></font>
    a_z_at_v = a_z_at_v+a_wkp1*(0.5-sign(0.5,max(0.,z_at_v-z_base(k))/(z_base(k+1)-z_base(k))-1.))*((0.5-sign(0.5,0.-(z_at_v-&amp;<a name='3712'>
&amp;z_base(k))))/(z_base(k+1)-z_base(k)))<a name='3713'>
    a_wkp1 = 0.<a name='3714'>
<font color=#447700>! recdepend vars : kts<a name='3715'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:3325<a name='3716'></font>
<font color=#447700>! recompute vars : k<a name='3717'></font>
    k = kts<a name='3718'>
<font color=#447700>! recompute vars : k<a name='3719'></font>
    a_ph(i,k+1,j-1) = a_ph(i,k+1,j-1)+a_z_at_v*(0.25/g)<a name='3720'>
    a_ph(i,k+1,j) = a_ph(i,k+1,j)+a_z_at_v*(0.25/g)<a name='3721'>
    a_ph(i,k,j-1) = a_ph(i,k,j-1)+a_z_at_v*(0.25/g)<a name='3722'>
    a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_v*(0.25/g)<a name='3723'>
    a_z_at_v = 0.<a name='3724'>
  end do<a name='3725'>
end do<a name='3726'>
do j = jts, min(jte,jde-1)+1<a name='3727'>
  a_wk = 0.<a name='3728'>
  a_wkm1 = 0.<a name='3729'>
  a_wkp1 = 0.<a name='3730'>
  a_z_at_v = 0.<a name='3731'>
  do k = kts+1, ktf-1<a name='3732'>
    a_wk = 0.<a name='3733'>
    a_wkm1 = 0.<a name='3734'>
    a_wkp1 = 0.<a name='3735'>
    a_z_at_v = 0.<a name='3736'>
    do i = i_start-1, i_end<a name='3737'>
      a_wk = 0.<a name='3738'>
      a_wkm1 = 0.<a name='3739'>
      a_wkp1 = 0.<a name='3740'>
      a_z_at_v = 0.<a name='3741'>
      z_at_v = 0.25*(phb(i,k,j)+phb(i,k+1,j)+phb(i,k,j-1)+phb(i,k+1,j-1)+ph(i,k,j)+ph(i,k+1,j)+ph(i,k,j-1)+ph(i,k+1,j-1))/g<a name='3742'>
<font color=#447700>! recompute : z_at_v<a name='3743'></font>
      wkp1 = min(1.,max(0.,z_at_v-z_base(k))/(z_base(k+1)-z_base(k)))<a name='3744'>
<font color=#447700>! recompute : wkp1<a name='3745'></font>
      wkm1 = min(1.,max(0.,z_base(k)-z_at_v)/(z_base(k)-z_base(k-1)))<a name='3746'>
<font color=#447700>! recompute : wkm1<a name='3747'></font>
      wk = 1.-wkp1-wkm1<a name='3748'>
<font color=#447700>! recompute : wk<a name='3749'></font>
      a_muv(i,j) = a_muv(i,j)-a_rv(i,k,j)*(wkm1*v_base(k-1)+wk*v_base(k)+wkp1*v_base(k+1))<a name='3750'>
      a_rv_in(i,k,j) = a_rv_in(i,k,j)+a_rv(i,k,j)<a name='3751'>
      a_wk = a_wk-a_rv(i,k,j)*muv(i,j)*v_base(k)<a name='3752'>
      a_wkm1 = a_wkm1-a_rv(i,k,j)*muv(i,j)*v_base(k-1)<a name='3753'>
      a_wkp1 = a_wkp1-a_rv(i,k,j)*muv(i,j)*v_base(k+1)<a name='3754'>
      a_rv(i,k,j) = 0.<a name='3755'>
      a_wkm1 = a_wkm1-a_wk<a name='3756'>
      a_wkp1 = a_wkp1-a_wk<a name='3757'>
      a_wk = 0.<a name='3758'>
      a_z_at_v = a_z_at_v-a_wkm1*(0.5-sign(0.5,max(0.,z_base(k)-z_at_v)/(z_base(k)-z_base(k-1))-1.))*((0.5-sign(0.5,0.-(z_base(k)-&amp;<a name='3759'>
&amp;z_at_v)))/(z_base(k)-z_base(k-1)))<a name='3760'>
      a_wkm1 = 0.<a name='3761'>
      a_z_at_v = a_z_at_v+a_wkp1*(0.5-sign(0.5,max(0.,z_at_v-z_base(k))/(z_base(k+1)-z_base(k))-1.))*((0.5-sign(0.5,0.-(z_at_v-&amp;<a name='3762'>
&amp;z_base(k))))/(z_base(k+1)-z_base(k)))<a name='3763'>
      a_wkp1 = 0.<a name='3764'>
      a_ph(i,k+1,j-1) = a_ph(i,k+1,j-1)+a_z_at_v*(0.25/g)<a name='3765'>
      a_ph(i,k+1,j) = a_ph(i,k+1,j)+a_z_at_v*(0.25/g)<a name='3766'>
      a_ph(i,k,j-1) = a_ph(i,k,j-1)+a_z_at_v*(0.25/g)<a name='3767'>
      a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_v*(0.25/g)<a name='3768'>
      a_z_at_v = 0.<a name='3769'>
    end do<a name='3770'>
  end do<a name='3771'>
end do<a name='3772'>
<a name='3773'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PERTURBATION_CORIOLIS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_33">("a_perturbation_coriolis")<a name='3774'>
<a name='3775'>
end subroutine a_perturbation_coriolis<a name='3776'>
<a name='3777'>
<a name='3778'>
<A NAME='A_PG_BUOY_W'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PG_BUOY_W' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3779'>
<font color=#993300>subroutine </font><font color=#cc0000>a_pg_buoy_w</font>( a_rw_tend, p, a_p, cqw, a_cqw, a_mu, mub, rdnw, rdn, g, msft, ide, jde, kde, ims, ime, jms, jme, kms, kme, &amp; <A href='../../call_to/A_PG_BUOY_W.html' TARGET='index'>1</A>,<A href='../../call_from/A_PG_BUOY_W.html' TARGET='index'>2</A><a name='3780'>
&amp;its, ite, jts, jte )<a name='3781'>
<font color=#447700>!******************************************************************<a name='3782'></font>
<font color=#447700>!******************************************************************<a name='3783'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='3784'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='3785'></font>
<font color=#447700>!******************************************************************<a name='3786'></font>
<font color=#447700>!******************************************************************<a name='3787'></font>
<font color=#447700>!==============================================<a name='3788'></font>
<font color=#447700>! all entries are defined explicitly<a name='3789'></font>
<font color=#447700>!==============================================<a name='3790'></font>
implicit none<a name='3791'>
<a name='3792'>
<font color=#447700>!==============================================<a name='3793'></font>
<font color=#447700>! declare arguments<a name='3794'></font>
<font color=#447700>!==============================================<a name='3795'></font>
integer, intent(in) :: ime<a name='3796'>
integer, intent(in) :: ims<a name='3797'>
integer, intent(in) :: jme<a name='3798'>
integer, intent(in) :: jms<a name='3799'>
integer, intent(in) :: kme<a name='3800'>
integer, intent(in) :: kms<a name='3801'>
real, intent(inout) :: a_cqw(ims:ime,kms:kme,jms:jme)<a name='3802'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='3803'>
real, intent(inout) :: a_p(ims:ime,kms:kme,jms:jme)<a name='3804'>
real, intent(inout) :: a_rw_tend(ims:ime,kms:kme,jms:jme)<a name='3805'>
real, intent(inout) :: cqw(ims:ime,kms:kme,jms:jme)<a name='3806'>
real, intent(in) :: g<a name='3807'>
integer, intent(in) :: ide<a name='3808'>
integer, intent(in) :: ite<a name='3809'>
integer, intent(in) :: its<a name='3810'>
integer, intent(in) :: jde<a name='3811'>
integer, intent(in) :: jte<a name='3812'>
integer, intent(in) :: jts<a name='3813'>
integer, intent(in) :: kde<a name='3814'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='3815'>
real, intent(in) :: mub(ims:ime,jms:jme)<a name='3816'>
real, intent(in) :: p(ims:ime,kms:kme,jms:jme)<a name='3817'>
real, intent(in) :: rdn(kms:kme)<a name='3818'>
real, intent(in) :: rdnw(kms:kme)<a name='3819'>
<a name='3820'>
<font color=#447700>!==============================================<a name='3821'></font>
<font color=#447700>! declare local variables<a name='3822'></font>
<font color=#447700>!==============================================<a name='3823'></font>
real a_cq1<a name='3824'>
real a_cq2<a name='3825'>
real cq1<a name='3826'>
integer i<a name='3827'>
integer itf<a name='3828'>
integer j<a name='3829'>
integer jtf<a name='3830'>
integer k<a name='3831'>
<a name='3832'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PG_BUOY_W' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_34">("a_pg_buoy_w")<a name='3833'>
<a name='3834'>
<font color=#447700>!----------------------------------------------<a name='3835'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='3836'></font>
<font color=#447700>!----------------------------------------------<a name='3837'></font>
a_cq1 = 0.<a name='3838'>
a_cq2 = 0.<a name='3839'>
<a name='3840'>
<font color=#447700>!----------------------------------------------<a name='3841'></font>
<font color=#447700>! ROUTINE BODY<a name='3842'></font>
<font color=#447700>!----------------------------------------------<a name='3843'></font>
itf = min(ite,ide-1)<a name='3844'>
<font color=#447700>! recompute : itf<a name='3845'></font>
jtf = min(jte,jde-1)<a name='3846'>
<font color=#447700>! recompute : jtf<a name='3847'></font>
do j = jts, jtf<a name='3848'>
  a_cq1 = 0.<a name='3849'>
  a_cq2 = 0.<a name='3850'>
  do k = 2, kde-1<a name='3851'>
    a_cq1 = 0.<a name='3852'>
    a_cq2 = 0.<a name='3853'>
    do i = its, itf<a name='3854'>
      a_cq1 = 0.<a name='3855'>
      a_cq2 = 0.<a name='3856'>
      cq1 = 1./(1.+cqw(i,k,j))<a name='3857'>
<font color=#447700>! recompute : cq1<a name='3858'></font>
      a_cq1 = a_cq1+a_rw_tend(i,k,j)*1./msft(i,j)*g*rdn(k)*(p(i,k,j)-p(i,k-1,j))<a name='3859'>
      a_cq2 = a_cq2-a_rw_tend(i,k,j)*1./msft(i,j)*g*mub(i,j)<a name='3860'>
      a_mu(i,j) = a_mu(i,j)-a_rw_tend(i,k,j)*1./msft(i,j)*g<a name='3861'>
      a_p(i,k-1,j) = a_p(i,k-1,j)-a_rw_tend(i,k,j)*1./msft(i,j)*g*cq1*rdn(k)<a name='3862'>
      a_p(i,k,j) = a_p(i,k,j)+a_rw_tend(i,k,j)*1./msft(i,j)*g*cq1*rdn(k)<a name='3863'>
      a_cq1 = a_cq1+a_cqw(i,k,j)<a name='3864'>
      a_cqw(i,k,j) = 0.<a name='3865'>
      a_cq1 = a_cq1+a_cq2*cqw(i,k,j)<a name='3866'>
      a_cqw(i,k,j) = a_cqw(i,k,j)+a_cq2*cq1<a name='3867'>
      a_cq2 = 0.<a name='3868'>
      a_cqw(i,k,j) = a_cqw(i,k,j)-a_cq1/((1.+cqw(i,k,j))*(1.+cqw(i,k,j)))<a name='3869'>
      a_cq1 = 0.<a name='3870'>
    end do<a name='3871'>
  end do<a name='3872'>
<font color=#447700>! recdepend vars : kde<a name='3873'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:2094<a name='3874'></font>
<font color=#447700>! recompute vars : k<a name='3875'></font>
  k = kde<a name='3876'>
<font color=#447700>! recompute vars : k<a name='3877'></font>
  do i = its, itf<a name='3878'>
    a_cq1 = 0.<a name='3879'>
    a_cq2 = 0.<a name='3880'>
    cq1 = 1./(1.+cqw(i,k-1,j))<a name='3881'>
<font color=#447700>! recompute : cq1<a name='3882'></font>
    a_cq1 = a_cq1-2*a_rw_tend(i,k,j)*1./msft(i,j)*g*rdnw(k-1)*p(i,k-1,j)<a name='3883'>
    a_cq2 = a_cq2-a_rw_tend(i,k,j)*1./msft(i,j)*g*mub(i,j)<a name='3884'>
    a_mu(i,j) = a_mu(i,j)-a_rw_tend(i,k,j)*1./msft(i,j)*g<a name='3885'>
    a_p(i,k-1,j) = a_p(i,k-1,j)-2*a_rw_tend(i,k,j)*1./msft(i,j)*g*cq1*rdnw(k-1)<a name='3886'>
    a_cq1 = a_cq1+a_cq2*cqw(i,k-1,j)<a name='3887'>
    a_cqw(i,k-1,j) = a_cqw(i,k-1,j)+a_cq2*cq1<a name='3888'>
    a_cq2 = 0.<a name='3889'>
    a_cqw(i,k-1,j) = a_cqw(i,k-1,j)-a_cq1/((1.+cqw(i,k-1,j))*(1.+cqw(i,k-1,j)))<a name='3890'>
    a_cq1 = 0.<a name='3891'>
  end do<a name='3892'>
end do<a name='3893'>
<a name='3894'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PG_BUOY_W' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_34">("a_pg_buoy_w")<a name='3895'>
<a name='3896'>
end subroutine a_pg_buoy_w<a name='3897'>
<a name='3898'>
<a name='3899'>
<A NAME='A_PHY_PREP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PHY_PREP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3900'>
<font color=#993300>subroutine </font><font color=#cc0000>a_phy_prep</font>( p, a_p, pb, ph, a_ph, phb, t, a_t, th_phy, a_th_phy, p_phy, a_p_phy, pi_phy, a_pi_phy, a_p8w, t_phy, &amp; <A href='../../call_to/A_PHY_PREP.html' TARGET='index'>2</A>,<A href='../../call_from/A_PHY_PREP.html' TARGET='index'>2</A><a name='3901'>
&amp;a_t_phy, a_t8w, z, a_z, z_at_w, a_z_at_w, fzm, fzp, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='3902'>
<font color=#447700>!******************************************************************<a name='3903'></font>
<font color=#447700>!******************************************************************<a name='3904'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='3905'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='3906'></font>
<font color=#447700>!******************************************************************<a name='3907'></font>
<font color=#447700>!******************************************************************<a name='3908'></font>
<font color=#447700>!==============================================<a name='3909'></font>
<font color=#447700>! all entries are defined explicitly<a name='3910'></font>
<font color=#447700>!==============================================<a name='3911'></font>
implicit none<a name='3912'>
<a name='3913'>
<font color=#447700>!==============================================<a name='3914'></font>
<font color=#447700>! declare arguments<a name='3915'></font>
<font color=#447700>!==============================================<a name='3916'></font>
integer, intent(in) :: ime<a name='3917'>
integer, intent(in) :: ims<a name='3918'>
integer, intent(in) :: jme<a name='3919'>
integer, intent(in) :: jms<a name='3920'>
integer, intent(in) :: kme<a name='3921'>
integer, intent(in) :: kms<a name='3922'>
real, intent(inout) :: a_p(ims:ime,kms:kme,jms:jme)<a name='3923'>
real, intent(inout) :: a_p8w(ims:ime,kms:kme,jms:jme)<a name='3924'>
real, intent(inout) :: a_p_phy(ims:ime,kms:kme,jms:jme)<a name='3925'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='3926'>
real, intent(inout) :: a_pi_phy(ims:ime,kms:kme,jms:jme)<a name='3927'>
real, intent(inout) :: a_t(ims:ime,kms:kme,jms:jme)<a name='3928'>
real, intent(inout) :: a_t8w(ims:ime,kms:kme,jms:jme)<a name='3929'>
real, intent(inout) :: a_t_phy(ims:ime,kms:kme,jms:jme)<a name='3930'>
real, intent(inout) :: a_th_phy(ims:ime,kms:kme,jms:jme)<a name='3931'>
real, intent(inout) :: a_z(ims:ime,kms:kme,jms:jme)<a name='3932'>
real, intent(inout) :: a_z_at_w(ims:ime,kms:kme,jms:jme)<a name='3933'>
real, intent(in) :: fzm(kms:kme)<a name='3934'>
real, intent(in) :: fzp(kms:kme)<a name='3935'>
integer, intent(in) :: ide<a name='3936'>
integer, intent(in) :: ite<a name='3937'>
integer, intent(in) :: its<a name='3938'>
integer, intent(in) :: jde<a name='3939'>
integer, intent(in) :: jte<a name='3940'>
integer, intent(in) :: jts<a name='3941'>
integer, intent(in) :: kde<a name='3942'>
integer, intent(in) :: kte<a name='3943'>
integer, intent(in) :: kts<a name='3944'>
real, intent(in) :: p(ims:ime,kms:kme,jms:jme)<a name='3945'>
real, intent(out) :: p_phy(ims:ime,kms:kme,jms:jme)<a name='3946'>
real, intent(in) :: pb(ims:ime,kms:kme,jms:jme)<a name='3947'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='3948'>
real, intent(in) :: phb(ims:ime,kms:kme,jms:jme)<a name='3949'>
real, intent(out) :: pi_phy(ims:ime,kms:kme,jms:jme)<a name='3950'>
real, intent(in) :: t(ims:ime,kms:kme,jms:jme)<a name='3951'>
real, intent(out) :: t_phy(ims:ime,kms:kme,jms:jme)<a name='3952'>
real, intent(out) :: th_phy(ims:ime,kms:kme,jms:jme)<a name='3953'>
real, intent(out) :: z(ims:ime,kms:kme,jms:jme)<a name='3954'>
real, intent(out) :: z_at_w(ims:ime,kms:kme,jms:jme)<a name='3955'>
<a name='3956'>
<font color=#447700>!==============================================<a name='3957'></font>
<font color=#447700>! declare local variables<a name='3958'></font>
<font color=#447700>!==============================================<a name='3959'></font>
real a_w1<a name='3960'>
real a_w2<a name='3961'>
real a_z0<a name='3962'>
real a_z1<a name='3963'>
real a_z2<a name='3964'>
integer i<a name='3965'>
integer i_end<a name='3966'>
integer i_start<a name='3967'>
integer j<a name='3968'>
integer j_end<a name='3969'>
integer j_start<a name='3970'>
integer k<a name='3971'>
integer k_end<a name='3972'>
integer k_start<a name='3973'>
real w1<a name='3974'>
real w2<a name='3975'>
real z0<a name='3976'>
real z1<a name='3977'>
real z2<a name='3978'>
<a name='3979'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PHY_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_35">("a_phy_prep")<a name='3980'>
<a name='3981'>
<font color=#447700>!----------------------------------------------<a name='3982'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='3983'></font>
<font color=#447700>!----------------------------------------------<a name='3984'></font>
a_w1 = 0.<a name='3985'>
a_w2 = 0.<a name='3986'>
a_z0 = 0.<a name='3987'>
a_z1 = 0.<a name='3988'>
a_z2 = 0.<a name='3989'>
<a name='3990'>
<font color=#447700>!----------------------------------------------<a name='3991'></font>
<font color=#447700>! ROUTINE BODY<a name='3992'></font>
<font color=#447700>!----------------------------------------------<a name='3993'></font>
i_start = its<a name='3994'>
<font color=#447700>! recompute : i_start<a name='3995'></font>
i_end = min(ite,ide-1)<a name='3996'>
<font color=#447700>! recompute : i_end<a name='3997'></font>
j_start = jts<a name='3998'>
<font color=#447700>! recompute : j_start<a name='3999'></font>
j_end = min(jte,jde-1)<a name='4000'>
<font color=#447700>! recompute : j_end<a name='4001'></font>
k_start = kts<a name='4002'>
<font color=#447700>! recompute : k_start<a name='4003'></font>
k_end = min(kte,kde-1)<a name='4004'>
<font color=#447700>! recompute : k_end<a name='4005'></font>
do j = j_start, j_end<a name='4006'>
  do k = k_start, k_end<a name='4007'>
    do i = i_start, i_end<a name='4008'>
      th_phy(i,k,j) = t(i,k,j)+t0<a name='4009'>
      p_phy(i,k,j) = p(i,k,j)+pb(i,k,j)<a name='4010'>
      pi_phy(i,k,j) = (p_phy(i,k,j)/p1000mb)**rcp<a name='4011'>
      t_phy(i,k,j) = th_phy(i,k,j)*pi_phy(i,k,j)<a name='4012'>
    end do<a name='4013'>
  end do<a name='4014'>
end do<a name='4015'>
<font color=#447700>! recompute : p_phy,t_phy<a name='4016'></font>
do j = j_start, j_end<a name='4017'>
  do k = k_start, kte<a name='4018'>
    do i = i_start, i_end<a name='4019'>
      z_at_w(i,k,j) = (phb(i,k,j)+ph(i,k,j))/g<a name='4020'>
    end do<a name='4021'>
  end do<a name='4022'>
end do<a name='4023'>
<font color=#447700>! recompute : z_at_w<a name='4024'></font>
do j = j_start, j_end<a name='4025'>
  do k = k_start, k_end<a name='4026'>
    do i = i_start, i_end<a name='4027'>
      z(i,k,j) = 0.5*(z_at_w(i,k,j)+z_at_w(i,k+1,j))<a name='4028'>
    end do<a name='4029'>
  end do<a name='4030'>
end do<a name='4031'>
<font color=#447700>! recompute : z<a name='4032'></font>
do j = j_start, j_end<a name='4033'>
  a_w1 = 0.<a name='4034'>
  a_w2 = 0.<a name='4035'>
  a_z0 = 0.<a name='4036'>
  a_z1 = 0.<a name='4037'>
  a_z2 = 0.<a name='4038'>
  do i = i_start, i_end<a name='4039'>
    a_w1 = 0.<a name='4040'>
    a_w2 = 0.<a name='4041'>
    a_z0 = 0.<a name='4042'>
    a_z1 = 0.<a name='4043'>
    a_z2 = 0.<a name='4044'>
    z0 = z_at_w(i,kte,j)<a name='4045'>
<font color=#447700>! recompute : z0<a name='4046'></font>
    z1 = z(i,k_end,j)<a name='4047'>
<font color=#447700>! recompute : z1<a name='4048'></font>
    z2 = z(i,k_end-1,j)<a name='4049'>
<font color=#447700>! recompute : z2<a name='4050'></font>
    w1 = (z0-z2)/(z1-z2)<a name='4051'>
<font color=#447700>! recompute : w1<a name='4052'></font>
    w2 = 1.-w1<a name='4053'>
<font color=#447700>! recompute : w2<a name='4054'></font>
    a_t_phy(i,kde-2,j) = a_t_phy(i,kde-2,j)+a_t8w(i,kde,j)*w2<a name='4055'>
    a_t_phy(i,kde-1,j) = a_t_phy(i,kde-1,j)+a_t8w(i,kde,j)*w1<a name='4056'>
    a_w1 = a_w1+a_t8w(i,kde,j)*t_phy(i,kde-1,j)<a name='4057'>
    a_w2 = a_w2+a_t8w(i,kde,j)*t_phy(i,kde-2,j)<a name='4058'>
    a_t8w(i,kde,j) = 0.<a name='4059'>
    a_p_phy(i,kde-2,j) = a_p_phy(i,kde-2,j)+a_p8w(i,kde,j)*w2*(1./p_phy(i,kde-2,j))*exp(w1*log(p_phy(i,kde-1,j))+w2*log(p_phy(i,&amp;<a name='4060'>
&amp;kde-2,j)))<a name='4061'>
    a_p_phy(i,kde-1,j) = a_p_phy(i,kde-1,j)+a_p8w(i,kde,j)*w1*(1./p_phy(i,kde-1,j))*exp(w1*log(p_phy(i,kde-1,j))+w2*log(p_phy(i,&amp;<a name='4062'>
&amp;kde-2,j)))<a name='4063'>
    a_w1 = a_w1+a_p8w(i,kde,j)*exp(w1*log(p_phy(i,kde-1,j))+w2*log(p_phy(i,kde-2,j)))*log(p_phy(i,kde-1,j))<a name='4064'>
    a_w2 = a_w2+a_p8w(i,kde,j)*exp(w1*log(p_phy(i,kde-1,j))+w2*log(p_phy(i,kde-2,j)))*log(p_phy(i,kde-2,j))<a name='4065'>
    a_p8w(i,kde,j) = 0.<a name='4066'>
    a_w1 = a_w1-a_w2<a name='4067'>
    a_w2 = 0.<a name='4068'>
    a_z0 = a_z0+a_w1/(z1-z2)<a name='4069'>
    a_z1 = a_z1-a_w1*((z0-z2)/((z1-z2)*(z1-z2)))<a name='4070'>
    a_z2 = a_z2+a_w1*((-1)/(z1-z2)+(z0-z2)/((z1-z2)*(z1-z2)))<a name='4071'>
    a_w1 = 0.<a name='4072'>
    a_z(i,k_end-1,j) = a_z(i,k_end-1,j)+a_z2<a name='4073'>
    a_z2 = 0.<a name='4074'>
    a_z(i,k_end,j) = a_z(i,k_end,j)+a_z1<a name='4075'>
    a_z1 = 0.<a name='4076'>
    a_z_at_w(i,kte,j) = a_z_at_w(i,kte,j)+a_z0<a name='4077'>
    a_z0 = 0.<a name='4078'>
<font color=#447700>! recdepend vars : i,j,z_at_w<a name='4079'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4092<a name='4080'></font>
<font color=#447700>! recompute vars : z0<a name='4081'></font>
    z0 = z_at_w(i,1,j)<a name='4082'>
<font color=#447700>! recompute vars : z0<a name='4083'></font>
<font color=#447700>! recdepend vars : i,j,z,z0<a name='4084'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4093<a name='4085'></font>
<font color=#447700>! recompute vars : z1<a name='4086'></font>
    z1 = z(i,1,j)<a name='4087'>
<font color=#447700>! recompute vars : z1<a name='4088'></font>
<font color=#447700>! recdepend vars : i,j,z,z0,z1<a name='4089'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4094<a name='4090'></font>
<font color=#447700>! recompute vars : z2<a name='4091'></font>
    z2 = z(i,2,j)<a name='4092'>
<font color=#447700>! recompute vars : z2<a name='4093'></font>
<font color=#447700>! recdepend vars : z0,z1,z2<a name='4094'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4095<a name='4095'></font>
<font color=#447700>! recompute vars : w1<a name='4096'></font>
    w1 = (z0-z2)/(z1-z2)<a name='4097'>
<font color=#447700>! recompute vars : w1<a name='4098'></font>
<font color=#447700>! recdepend vars : w1<a name='4099'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4096<a name='4100'></font>
<font color=#447700>! recompute vars : w2<a name='4101'></font>
    w2 = 1.-w1<a name='4102'>
<font color=#447700>! recompute vars : w2<a name='4103'></font>
    a_t_phy(i,2,j) = a_t_phy(i,2,j)+a_t8w(i,1,j)*w2<a name='4104'>
    a_t_phy(i,1,j) = a_t_phy(i,1,j)+a_t8w(i,1,j)*w1<a name='4105'>
    a_w1 = a_w1+a_t8w(i,1,j)*t_phy(i,1,j)<a name='4106'>
    a_w2 = a_w2+a_t8w(i,1,j)*t_phy(i,2,j)<a name='4107'>
    a_t8w(i,1,j) = 0.<a name='4108'>
<font color=#447700>! recdepend vars : i,j,z_at_w<a name='4109'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4092<a name='4110'></font>
<font color=#447700>! recompute vars : z0<a name='4111'></font>
    z0 = z_at_w(i,1,j)<a name='4112'>
<font color=#447700>! recompute vars : z0<a name='4113'></font>
<font color=#447700>! recdepend vars : i,j,z,z0<a name='4114'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4093<a name='4115'></font>
<font color=#447700>! recompute vars : z1<a name='4116'></font>
    z1 = z(i,1,j)<a name='4117'>
<font color=#447700>! recompute vars : z1<a name='4118'></font>
<font color=#447700>! recdepend vars : i,j,z,z0,z1<a name='4119'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4094<a name='4120'></font>
<font color=#447700>! recompute vars : z2<a name='4121'></font>
    z2 = z(i,2,j)<a name='4122'>
<font color=#447700>! recompute vars : z2<a name='4123'></font>
<font color=#447700>! recdepend vars : z0,z1,z2<a name='4124'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4095<a name='4125'></font>
<font color=#447700>! recompute vars : w1<a name='4126'></font>
    w1 = (z0-z2)/(z1-z2)<a name='4127'>
<font color=#447700>! recompute vars : w1<a name='4128'></font>
<font color=#447700>! recdepend vars : w1<a name='4129'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4096<a name='4130'></font>
<font color=#447700>! recompute vars : w2<a name='4131'></font>
    w2 = 1.-w1<a name='4132'>
<font color=#447700>! recompute vars : w2<a name='4133'></font>
    a_p_phy(i,2,j) = a_p_phy(i,2,j)+a_p8w(i,1,j)*w2<a name='4134'>
    a_p_phy(i,1,j) = a_p_phy(i,1,j)+a_p8w(i,1,j)*w1<a name='4135'>
    a_w1 = a_w1+a_p8w(i,1,j)*p_phy(i,1,j)<a name='4136'>
    a_w2 = a_w2+a_p8w(i,1,j)*p_phy(i,2,j)<a name='4137'>
    a_p8w(i,1,j) = 0.<a name='4138'>
    a_w1 = a_w1-a_w2<a name='4139'>
    a_w2 = 0.<a name='4140'>
<font color=#447700>! recdepend vars : i,j,z_at_w<a name='4141'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4092<a name='4142'></font>
<font color=#447700>! recompute vars : z0<a name='4143'></font>
    z0 = z_at_w(i,1,j)<a name='4144'>
<font color=#447700>! recompute vars : z0<a name='4145'></font>
<font color=#447700>! recdepend vars : i,j,z,z0<a name='4146'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4093<a name='4147'></font>
<font color=#447700>! recompute vars : z1<a name='4148'></font>
    z1 = z(i,1,j)<a name='4149'>
<font color=#447700>! recompute vars : z1<a name='4150'></font>
<font color=#447700>! recdepend vars : i,j,z,z0,z1<a name='4151'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:4094<a name='4152'></font>
<font color=#447700>! recompute vars : z2<a name='4153'></font>
    z2 = z(i,2,j)<a name='4154'>
<font color=#447700>! recompute vars : z2<a name='4155'></font>
    a_z0 = a_z0+a_w1/(z1-z2)<a name='4156'>
    a_z1 = a_z1-a_w1*((z0-z2)/((z1-z2)*(z1-z2)))<a name='4157'>
    a_z2 = a_z2+a_w1*((-1)/(z1-z2)+(z0-z2)/((z1-z2)*(z1-z2)))<a name='4158'>
    a_w1 = 0.<a name='4159'>
    a_z(i,2,j) = a_z(i,2,j)+a_z2<a name='4160'>
    a_z2 = 0.<a name='4161'>
    a_z(i,1,j) = a_z(i,1,j)+a_z1<a name='4162'>
    a_z1 = 0.<a name='4163'>
    a_z_at_w(i,1,j) = a_z_at_w(i,1,j)+a_z0<a name='4164'>
    a_z0 = 0.<a name='4165'>
  end do<a name='4166'>
end do<a name='4167'>
do j = j_start, j_end<a name='4168'>
  do k = 2, k_end<a name='4169'>
    do i = i_start, i_end<a name='4170'>
      a_t_phy(i,k-1,j) = a_t_phy(i,k-1,j)+a_t8w(i,k,j)*fzp(k)<a name='4171'>
      a_t_phy(i,k,j) = a_t_phy(i,k,j)+a_t8w(i,k,j)*fzm(k)<a name='4172'>
      a_t8w(i,k,j) = 0.<a name='4173'>
      a_p_phy(i,k-1,j) = a_p_phy(i,k-1,j)+a_p8w(i,k,j)*fzp(k)<a name='4174'>
      a_p_phy(i,k,j) = a_p_phy(i,k,j)+a_p8w(i,k,j)*fzm(k)<a name='4175'>
      a_p8w(i,k,j) = 0.<a name='4176'>
    end do<a name='4177'>
  end do<a name='4178'>
end do<a name='4179'>
do j = j_start, j_end<a name='4180'>
  do k = k_start, k_end<a name='4181'>
    do i = i_start, i_end<a name='4182'>
      a_z_at_w(i,k+1,j) = a_z_at_w(i,k+1,j)+0.5*a_z(i,k,j)<a name='4183'>
      a_z_at_w(i,k,j) = a_z_at_w(i,k,j)+0.5*a_z(i,k,j)<a name='4184'>
      a_z(i,k,j) = 0.<a name='4185'>
    end do<a name='4186'>
  end do<a name='4187'>
end do<a name='4188'>
do j = j_start, j_end<a name='4189'>
  do k = k_start, kte<a name='4190'>
    do i = i_start, i_end<a name='4191'>
      a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_w(i,k,j)/g<a name='4192'>
      a_z_at_w(i,k,j) = 0.<a name='4193'>
    end do<a name='4194'>
  end do<a name='4195'>
end do<a name='4196'>
do j = j_start, j_end<a name='4197'>
  do k = k_start, k_end<a name='4198'>
    do i = i_start, i_end<a name='4199'>
      th_phy(i,k,j) = t(i,k,j)+t0<a name='4200'>
<font color=#447700>! recompute : th_phy<a name='4201'></font>
      p_phy(i,k,j) = p(i,k,j)+pb(i,k,j)<a name='4202'>
<font color=#447700>! recompute : p_phy<a name='4203'></font>
      pi_phy(i,k,j) = (p_phy(i,k,j)/p1000mb)**rcp<a name='4204'>
<font color=#447700>! recompute : pi_phy<a name='4205'></font>
      a_pi_phy(i,k,j) = a_pi_phy(i,k,j)+a_t_phy(i,k,j)*th_phy(i,k,j)<a name='4206'>
      a_th_phy(i,k,j) = a_th_phy(i,k,j)+a_t_phy(i,k,j)*pi_phy(i,k,j)<a name='4207'>
      a_t_phy(i,k,j) = 0.<a name='4208'>
      a_p_phy(i,k,j) = a_p_phy(i,k,j)+a_pi_phy(i,k,j)/p1000mb*rcp*(p_phy(i,k,j)/p1000mb)**(rcp-1)<a name='4209'>
      a_pi_phy(i,k,j) = 0.<a name='4210'>
      a_p(i,k,j) = a_p(i,k,j)+a_p_phy(i,k,j)<a name='4211'>
      a_p_phy(i,k,j) = 0.<a name='4212'>
      a_t(i,k,j) = a_t(i,k,j)+a_th_phy(i,k,j)<a name='4213'>
      a_th_phy(i,k,j) = 0.<a name='4214'>
    end do<a name='4215'>
  end do<a name='4216'>
end do<a name='4217'>
<a name='4218'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_PHY_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_35">("a_phy_prep")<a name='4219'>
<a name='4220'>
end subroutine a_phy_prep<a name='4221'>
<a name='4222'>
<a name='4223'>
<A NAME='A_RHS_PH'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_RHS_PH' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4224'>
<font color=#993300>subroutine </font><font color=#cc0000>a_rhs_ph</font>( a_ph_tend, u, a_u, v, a_v, ww, a_ww, ph, a_ph, ph_old, a_ph_old, phb, w, a_w, mut, a_mut, muu, a_muu, muv, &amp; <A href='../../call_to/A_RHS_PH.html' TARGET='index'>1</A>,<A href='../../call_from/A_RHS_PH.html' TARGET='index'>2</A><a name='4225'>
&amp;a_muv, fnm, fnp, rdnw, cfn, cfn1, rdx, rdy, msft, non_hydrostatic, config_flags, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms,&amp;<a name='4226'>
&amp; kme, its, ite, jts, jte, kts, kte )<a name='4227'>
<font color=#447700>!******************************************************************<a name='4228'></font>
<font color=#447700>!******************************************************************<a name='4229'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='4230'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='4231'></font>
<font color=#447700>!******************************************************************<a name='4232'></font>
<font color=#447700>!******************************************************************<a name='4233'></font>
<font color=#447700>!==============================================<a name='4234'></font>
<font color=#447700>! all entries are defined explicitly<a name='4235'></font>
<font color=#447700>!==============================================<a name='4236'></font>
implicit none<a name='4237'>
<a name='4238'>
<font color=#447700>!==============================================<a name='4239'></font>
<font color=#447700>! declare arguments<a name='4240'></font>
<font color=#447700>!==============================================<a name='4241'></font>
integer, intent(in) :: ime<a name='4242'>
integer, intent(in) :: ims<a name='4243'>
integer, intent(in) :: jme<a name='4244'>
integer, intent(in) :: jms<a name='4245'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='4246'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='4247'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='4248'>
integer, intent(in) :: kme<a name='4249'>
integer, intent(in) :: kms<a name='4250'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='4251'>
real, intent(inout) :: a_ph_old(ims:ime,kms:kme,jms:jme)<a name='4252'>
real, intent(inout) :: a_ph_tend(ims:ime,kms:kme,jms:jme)<a name='4253'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='4254'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='4255'>
real, intent(inout) :: a_w(ims:ime,kms:kme,jms:jme)<a name='4256'>
real, intent(inout) :: a_ww(ims:ime,kms:kme,jms:jme)<a name='4257'>
real, intent(in) :: cfn<a name='4258'>
real, intent(in) :: cfn1<a name='4259'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='4260'>
real, intent(in) :: fnm(kms:kme)<a name='4261'>
real, intent(in) :: fnp(kms:kme)<a name='4262'>
integer, intent(in) :: ide<a name='4263'>
integer, intent(in) :: ids<a name='4264'>
integer, intent(in) :: ite<a name='4265'>
integer, intent(in) :: its<a name='4266'>
integer, intent(in) :: jde<a name='4267'>
integer, intent(in) :: jds<a name='4268'>
integer, intent(in) :: jte<a name='4269'>
integer, intent(in) :: jts<a name='4270'>
integer, intent(in) :: kde<a name='4271'>
integer, intent(in) :: kte<a name='4272'>
integer, intent(in) :: kts<a name='4273'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='4274'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='4275'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='4276'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='4277'>
logical, intent(in) :: non_hydrostatic<a name='4278'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='4279'>
real, intent(in) :: ph_old(ims:ime,kms:kme,jms:jme)<a name='4280'>
real, intent(in) :: phb(ims:ime,kms:kme,jms:jme)<a name='4281'>
real, intent(in) :: rdnw(kms:kme)<a name='4282'>
real, intent(in) :: rdx<a name='4283'>
real, intent(in) :: rdy<a name='4284'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='4285'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='4286'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='4287'>
real, intent(in) :: ww(ims:ime,kms:kme,jms:jme)<a name='4288'>
<a name='4289'>
<font color=#447700>!==============================================<a name='4290'></font>
<font color=#447700>! declare local variables<a name='4291'></font>
<font color=#447700>!==============================================<a name='4292'></font>
real a_ub<a name='4293'>
real a_ul<a name='4294'>
real a_ur<a name='4295'>
real a_vb<a name='4296'>
real a_vl<a name='4297'>
real a_vr<a name='4298'>
real a_wdwn(its:ite,kts:kte)<a name='4299'>
integer advective_order<a name='4300'>
integer i<a name='4301'>
integer i_start<a name='4302'>
integer itf<a name='4303'>
integer j<a name='4304'>
integer j_start<a name='4305'>
integer jtf<a name='4306'>
integer k<a name='4307'>
integer kz<a name='4308'>
logical specified<a name='4309'>
real ub<a name='4310'>
real ul<a name='4311'>
real ur<a name='4312'>
real vb<a name='4313'>
real vl<a name='4314'>
real vr<a name='4315'>
<a name='4316'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_RHS_PH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_36">("a_rhs_ph")<a name='4317'>
<a name='4318'>
<font color=#447700>!----------------------------------------------<a name='4319'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='4320'></font>
<font color=#447700>!----------------------------------------------<a name='4321'></font>
a_ub = 0.<a name='4322'>
a_ul = 0.<a name='4323'>
a_ur = 0.<a name='4324'>
a_vb = 0.<a name='4325'>
a_vl = 0.<a name='4326'>
a_vr = 0.<a name='4327'>
a_wdwn(:,:) = 0.<a name='4328'>
<a name='4329'>
<font color=#447700>!----------------------------------------------<a name='4330'></font>
<font color=#447700>! ROUTINE BODY<a name='4331'></font>
<font color=#447700>!----------------------------------------------<a name='4332'></font>
specified =  .false. <a name='4333'>
<font color=#447700>! recompute : specified<a name='4334'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='4335'>
  specified =  .true. <a name='4336'>
endif<a name='4337'>
<font color=#447700>! recompute : specified<a name='4338'></font>
advective_order = config_flags%h_sca_adv_order<a name='4339'>
<font color=#447700>! recompute : advective_order<a name='4340'></font>
itf = min(ite,ide-1)<a name='4341'>
<font color=#447700>! recompute : itf<a name='4342'></font>
jtf = min(jte,jde-1)<a name='4343'>
<font color=#447700>! recompute : jtf<a name='4344'></font>
if (config_flags%open_xe .and. ite .eq. ide) then<a name='4345'>
  i = ite-1<a name='4346'>
<font color=#447700>! recompute : i<a name='4347'></font>
  do j = jtf, jts, -1<a name='4348'>
    k = kde<a name='4349'>
<font color=#447700>! recompute : k<a name='4350'></font>
    kz = k-1<a name='4351'>
<font color=#447700>! recompute : kz<a name='4352'></font>
    ub = 0.5*(fnm(kz)*(u(i+1,kz,j)+u(i,kz,j))+fnp(kz)*(u(i+1,kz-1,j)+u(i,kz-1,j)))<a name='4353'>
<font color=#447700>! recompute : ub<a name='4354'></font>
    ur = amax1(ub,0.)<a name='4355'>
<font color=#447700>! recompute : ur<a name='4356'></font>
    a_mut(i,j) = a_mut(i,j)-a_ph_tend(i,k,j)*rdx*ur*(ph_old(i,k,j)-ph_old(i-1,k,j))<a name='4357'>
    a_ph_old(i-1,k,j) = a_ph_old(i-1,k,j)+a_ph_tend(i,k,j)*rdx*mut(i,j)*ur<a name='4358'>
    a_ph_old(i,k,j) = a_ph_old(i,k,j)-a_ph_tend(i,k,j)*rdx*mut(i,j)*ur<a name='4359'>
    a_ur = a_ur-a_ph_tend(i,k,j)*rdx*mut(i,j)*(ph_old(i,k,j)-ph_old(i-1,k,j))<a name='4360'>
    a_ub = a_ub+a_ur*(0.5+sign(0.5,ub-0.))<a name='4361'>
    a_ur = 0.<a name='4362'>
    a_u(i+1,kz-1,j) = a_u(i+1,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4363'>
    a_u(i,kz-1,j) = a_u(i,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4364'>
    a_u(i+1,kz,j) = a_u(i+1,kz,j)+0.5*a_ub*fnm(kz)<a name='4365'>
    a_u(i,kz,j) = a_u(i,kz,j)+0.5*a_ub*fnm(kz)<a name='4366'>
    a_ub = 0.<a name='4367'>
    do k = 2, kde-1<a name='4368'>
      a_ub = 0.<a name='4369'>
      a_ur = 0.<a name='4370'>
      kz = k<a name='4371'>
<font color=#447700>! recompute : kz<a name='4372'></font>
      ub = 0.5*(fnm(kz)*(u(i+1,kz,j)+u(i,kz,j))+fnp(kz)*(u(i+1,kz-1,j)+u(i,kz-1,j)))<a name='4373'>
<font color=#447700>! recompute : ub<a name='4374'></font>
      ur = amax1(ub,0.)<a name='4375'>
<font color=#447700>! recompute : ur<a name='4376'></font>
      a_mut(i,j) = a_mut(i,j)-a_ph_tend(i,k,j)*rdx*ur*(ph_old(i,k,j)-ph_old(i-1,k,j))<a name='4377'>
      a_ph_old(i-1,k,j) = a_ph_old(i-1,k,j)+a_ph_tend(i,k,j)*rdx*mut(i,j)*ur<a name='4378'>
      a_ph_old(i,k,j) = a_ph_old(i,k,j)-a_ph_tend(i,k,j)*rdx*mut(i,j)*ur<a name='4379'>
      a_ur = a_ur-a_ph_tend(i,k,j)*rdx*mut(i,j)*(ph_old(i,k,j)-ph_old(i-1,k,j))<a name='4380'>
      a_ub = a_ub+a_ur*(0.5+sign(0.5,ub-0.))<a name='4381'>
      a_ur = 0.<a name='4382'>
      a_u(i+1,kz-1,j) = a_u(i+1,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4383'>
      a_u(i,kz-1,j) = a_u(i,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4384'>
      a_u(i+1,kz,j) = a_u(i+1,kz,j)+0.5*a_ub*fnm(kz)<a name='4385'>
      a_u(i,kz,j) = a_u(i,kz,j)+0.5*a_ub*fnm(kz)<a name='4386'>
      a_ub = 0.<a name='4387'>
    end do<a name='4388'>
  end do<a name='4389'>
endif<a name='4390'>
if (config_flags%open_xs .and. its .eq. ids) then<a name='4391'>
  i = its<a name='4392'>
<font color=#447700>! recompute : i<a name='4393'></font>
  do j = jtf, jts, -1<a name='4394'>
    k = kde<a name='4395'>
<font color=#447700>! recompute : k<a name='4396'></font>
    kz = k<a name='4397'>
<font color=#447700>! recompute : kz<a name='4398'></font>
    ub = 0.5*(fnm(kz)*(u(i+1,kz,j)+u(i,kz,j))+fnp(kz)*(u(i+1,kz-1,j)+u(i,kz-1,j)))<a name='4399'>
<font color=#447700>! recompute : ub<a name='4400'></font>
    ul = amin1(ub,0.)<a name='4401'>
<font color=#447700>! recompute : ul<a name='4402'></font>
    a_mut(i,j) = a_mut(i,j)-a_ph_tend(i,k,j)*rdx*ul*(ph_old(i+1,k,j)-ph_old(i,k,j))<a name='4403'>
    a_ph_old(i+1,k,j) = a_ph_old(i+1,k,j)-a_ph_tend(i,k,j)*rdx*mut(i,j)*ul<a name='4404'>
    a_ph_old(i,k,j) = a_ph_old(i,k,j)+a_ph_tend(i,k,j)*rdx*mut(i,j)*ul<a name='4405'>
    a_ul = a_ul-a_ph_tend(i,k,j)*rdx*mut(i,j)*(ph_old(i+1,k,j)-ph_old(i,k,j))<a name='4406'>
    a_ub = a_ub+a_ul*(0.5+sign(0.5,0.-ub))<a name='4407'>
    a_ul = 0.<a name='4408'>
    a_u(i+1,kz-1,j) = a_u(i+1,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4409'>
    a_u(i,kz-1,j) = a_u(i,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4410'>
    a_u(i+1,kz,j) = a_u(i+1,kz,j)+0.5*a_ub*fnm(kz)<a name='4411'>
    a_u(i,kz,j) = a_u(i,kz,j)+0.5*a_ub*fnm(kz)<a name='4412'>
    a_ub = 0.<a name='4413'>
    do k = 2, kde-1<a name='4414'>
      a_ub = 0.<a name='4415'>
      a_ul = 0.<a name='4416'>
      kz = k<a name='4417'>
<font color=#447700>! recompute : kz<a name='4418'></font>
      ub = 0.5*(fnm(kz)*(u(i+1,kz,j)+u(i,kz,j))+fnp(kz)*(u(i+1,kz-1,j)+u(i,kz-1,j)))<a name='4419'>
<font color=#447700>! recompute : ub<a name='4420'></font>
      ul = amin1(ub,0.)<a name='4421'>
<font color=#447700>! recompute : ul<a name='4422'></font>
      a_mut(i,j) = a_mut(i,j)-a_ph_tend(i,k,j)*rdx*ul*(ph_old(i+1,k,j)-ph_old(i,k,j))<a name='4423'>
      a_ph_old(i+1,k,j) = a_ph_old(i+1,k,j)-a_ph_tend(i,k,j)*rdx*mut(i,j)*ul<a name='4424'>
      a_ph_old(i,k,j) = a_ph_old(i,k,j)+a_ph_tend(i,k,j)*rdx*mut(i,j)*ul<a name='4425'>
      a_ul = a_ul-a_ph_tend(i,k,j)*rdx*mut(i,j)*(ph_old(i+1,k,j)-ph_old(i,k,j))<a name='4426'>
      a_ub = a_ub+a_ul*(0.5+sign(0.5,0.-ub))<a name='4427'>
      a_ul = 0.<a name='4428'>
      a_u(i+1,kz-1,j) = a_u(i+1,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4429'>
      a_u(i,kz-1,j) = a_u(i,kz-1,j)+0.5*a_ub*fnp(kz)<a name='4430'>
      a_u(i+1,kz,j) = a_u(i+1,kz,j)+0.5*a_ub*fnm(kz)<a name='4431'>
      a_u(i,kz,j) = a_u(i,kz,j)+0.5*a_ub*fnm(kz)<a name='4432'>
      a_ub = 0.<a name='4433'>
    end do<a name='4434'>
  end do<a name='4435'>
endif<a name='4436'>
if (config_flags%open_ye .and. jte .eq. jde) then<a name='4437'>
  j = jte-1<a name='4438'>
<font color=#447700>! recompute : j<a name='4439'></font>
  do k = 2, kde<a name='4440'>
    a_vb = 0.<a name='4441'>
    a_vr = 0.<a name='4442'>
    kz = min(k,kde-1)<a name='4443'>
<font color=#447700>! recompute : kz<a name='4444'></font>
    do i = its, itf<a name='4445'>
      a_vb = 0.<a name='4446'>
      a_vr = 0.<a name='4447'>
      vb = 0.5*(fnm(kz)*(v(i,kz,j+1)+v(i,kz,j))+fnp(kz)*(v(i,kz-1,j+1)+v(i,kz-1,j)))<a name='4448'>
<font color=#447700>! recompute : vb<a name='4449'></font>
      vr = amax1(vb,0.)<a name='4450'>
<font color=#447700>! recompute : vr<a name='4451'></font>
      a_mut(i,j) = a_mut(i,j)-a_ph_tend(i,k,j)*rdy*vr*(ph_old(i,k,j)-ph_old(i,k,j-1))<a name='4452'>
      a_ph_old(i,k,j-1) = a_ph_old(i,k,j-1)+a_ph_tend(i,k,j)*rdy*mut(i,j)*vr<a name='4453'>
      a_ph_old(i,k,j) = a_ph_old(i,k,j)-a_ph_tend(i,k,j)*rdy*mut(i,j)*vr<a name='4454'>
      a_vr = a_vr-a_ph_tend(i,k,j)*rdy*mut(i,j)*(ph_old(i,k,j)-ph_old(i,k,j-1))<a name='4455'>
      a_vb = a_vb+a_vr*(0.5+sign(0.5,vb-0.))<a name='4456'>
      a_vr = 0.<a name='4457'>
      a_v(i,kz-1,j+1) = a_v(i,kz-1,j+1)+0.5*a_vb*fnp(kz)<a name='4458'>
      a_v(i,kz-1,j) = a_v(i,kz-1,j)+0.5*a_vb*fnp(kz)<a name='4459'>
      a_v(i,kz,j+1) = a_v(i,kz,j+1)+0.5*a_vb*fnm(kz)<a name='4460'>
      a_v(i,kz,j) = a_v(i,kz,j)+0.5*a_vb*fnm(kz)<a name='4461'>
      a_vb = 0.<a name='4462'>
    end do<a name='4463'>
  end do<a name='4464'>
endif<a name='4465'>
if (config_flags%open_ys .and. jts .eq. jds) then<a name='4466'>
  j = jts<a name='4467'>
<font color=#447700>! recompute : j<a name='4468'></font>
  do k = 2, kde<a name='4469'>
    a_vb = 0.<a name='4470'>
    a_vl = 0.<a name='4471'>
    kz = min(k,kde-1)<a name='4472'>
<font color=#447700>! recompute : kz<a name='4473'></font>
    do i = its, itf<a name='4474'>
      a_vb = 0.<a name='4475'>
      a_vl = 0.<a name='4476'>
      vb = 0.5*(fnm(kz)*(v(i,kz,j+1)+v(i,kz,j))+fnp(kz)*(v(i,kz-1,j+1)+v(i,kz-1,j)))<a name='4477'>
<font color=#447700>! recompute : vb<a name='4478'></font>
      vl = amin1(vb,0.)<a name='4479'>
<font color=#447700>! recompute : vl<a name='4480'></font>
      a_mut(i,j) = a_mut(i,j)-a_ph_tend(i,k,j)*rdy*vl*(ph_old(i,k,j+1)-ph_old(i,k,j))<a name='4481'>
      a_ph_old(i,k,j+1) = a_ph_old(i,k,j+1)-a_ph_tend(i,k,j)*rdy*mut(i,j)*vl<a name='4482'>
      a_ph_old(i,k,j) = a_ph_old(i,k,j)+a_ph_tend(i,k,j)*rdy*mut(i,j)*vl<a name='4483'>
      a_vl = a_vl-a_ph_tend(i,k,j)*rdy*mut(i,j)*(ph_old(i,k,j+1)-ph_old(i,k,j))<a name='4484'>
      a_vb = a_vb+a_vl*(0.5+sign(0.5,0.-vb))<a name='4485'>
      a_vl = 0.<a name='4486'>
      a_v(i,kz-1,j+1) = a_v(i,kz-1,j+1)+0.5*a_vb*fnp(kz)<a name='4487'>
      a_v(i,kz-1,j) = a_v(i,kz-1,j)+0.5*a_vb*fnp(kz)<a name='4488'>
      a_v(i,kz,j+1) = a_v(i,kz,j+1)+0.5*a_vb*fnm(kz)<a name='4489'>
      a_v(i,kz,j) = a_v(i,kz,j)+0.5*a_vb*fnm(kz)<a name='4490'>
      a_vb = 0.<a name='4491'>
    end do<a name='4492'>
  end do<a name='4493'>
endif<a name='4494'>
if (advective_order .le. 2) then<a name='4495'>
  i_start = its<a name='4496'>
<font color=#447700>! recompute : i_start<a name='4497'></font>
  j_start = jts<a name='4498'>
<font color=#447700>! recompute : j_start<a name='4499'></font>
  itf = min(ite,ide-1)<a name='4500'>
<font color=#447700>! recompute : itf<a name='4501'></font>
  jtf = min(jte,jde-1)<a name='4502'>
<font color=#447700>! recompute : jtf<a name='4503'></font>
  if (config_flags%open_xs .and. its .eq. ids) then<a name='4504'>
    i_start = its+1<a name='4505'>
  endif<a name='4506'>
<font color=#447700>! recompute : i_start<a name='4507'></font>
  if (config_flags%open_xe .and. ite .eq. ide) then<a name='4508'>
    itf = itf-1<a name='4509'>
  endif<a name='4510'>
<font color=#447700>! recompute : itf<a name='4511'></font>
  do j = jtf, j_start, -1<a name='4512'>
    k = kte<a name='4513'>
<font color=#447700>! recompute : k<a name='4514'></font>
    do i = i_start, itf<a name='4515'>
      a_muu(i+1,j) = a_muu(i+1,j)-0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))*(phb(i+1,k,j)-phb(i,k,j)+ph(i+1,k,&amp;<a name='4516'>
&amp;j)-ph(i,k,j))<a name='4517'>
      a_muu(i,j) = a_muu(i,j)-0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j))*(phb(i,k,j)-phb(i-1,k,j)+ph(i,k,j)-ph(i-1,&amp;<a name='4518'>
&amp;k,j))<a name='4519'>
      a_ph(i-1,k,j) = a_ph(i-1,k,j)+0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j))<a name='4520'>
      a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))<a name='4521'>
      a_ph(i,k,j) = a_ph(i,k,j)-0.5*a_ph_tend(i,k,j)*rdx*((-(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))))+muu(i,j)*(cfn*u(i,k-&amp;<a name='4522'>
&amp;1,j)+cfn1*u(i,k-2,j)))<a name='4523'>
      a_u(i+1,k-2,j) = a_u(i+1,k-2,j)-0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn1*(phb(i+1,k,j)-phb(i,k,j)+ph(i+1,k,j)-ph(i,k,j))<a name='4524'>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn1*(phb(i,k,j)-phb(i-1,k,j)+ph(i,k,j)-ph(i-1,k,j))<a name='4525'>
      a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn*(phb(i+1,k,j)-phb(i,k,j)+ph(i+1,k,j)-ph(i,k,j))<a name='4526'>
      a_u(i,k-1,j) = a_u(i,k-1,j)-0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn*(phb(i,k,j)-phb(i-1,k,j)+ph(i,k,j)-ph(i-1,k,j))<a name='4527'>
    end do<a name='4528'>
    do k = 2, kte-1<a name='4529'>
      do i = i_start, itf<a name='4530'>
        a_muu(i+1,j) = a_muu(i+1,j)-0.25*a_ph_tend(i,k,j)*rdx*(u(i+1,k,j)+u(i+1,k-1,j))*(phb(i+1,k,j)-phb(i,k,j)+ph(i+1,k,j)-ph(i,&amp;<a name='4531'>
&amp;k,j))<a name='4532'>
        a_muu(i,j) = a_muu(i,j)-0.25*a_ph_tend(i,k,j)*rdx*(u(i,k,j)+u(i,k-1,j))*(phb(i,k,j)-phb(i-1,k,j)+ph(i,k,j)-ph(i-1,k,j))<a name='4533'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)+0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(u(i,k,j)+u(i,k-1,j))<a name='4534'>
        a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))<a name='4535'>
        a_ph(i,k,j) = a_ph(i,k,j)-0.25*a_ph_tend(i,k,j)*rdx*((-(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))))+muu(i,j)*(u(i,k,j)+u(i,k-1,&amp;<a name='4536'>
&amp;j)))<a name='4537'>
        a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(phb(i+1,k,j)-phb(i,k,j)+ph(i+1,k,j)-ph(i,k,j))<a name='4538'>
        a_u(i,k-1,j) = a_u(i,k-1,j)-0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(phb(i,k,j)-phb(i-1,k,j)+ph(i,k,j)-ph(i-1,k,j))<a name='4539'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(phb(i+1,k,j)-phb(i,k,j)+ph(i+1,k,j)-ph(i,k,j))<a name='4540'>
        a_u(i,k,j) = a_u(i,k,j)-0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(phb(i,k,j)-phb(i-1,k,j)+ph(i,k,j)-ph(i-1,k,j))<a name='4541'>
      end do<a name='4542'>
    end do<a name='4543'>
  end do<a name='4544'>
<font color=#447700>! recdepend vars : its<a name='4545'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1407<a name='4546'></font>
<font color=#447700>! recompute vars : i_start<a name='4547'></font>
  i_start = its<a name='4548'>
<font color=#447700>! recompute vars : i_start<a name='4549'></font>
<font color=#447700>! recdepend vars : i_start,jts<a name='4550'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1408<a name='4551'></font>
<font color=#447700>! recompute vars : j_start<a name='4552'></font>
  j_start = jts<a name='4553'>
<font color=#447700>! recompute vars : j_start<a name='4554'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite,j_start<a name='4555'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1409<a name='4556'></font>
<font color=#447700>! recompute vars : itf<a name='4557'></font>
  itf = min(ite,ide-1)<a name='4558'>
<font color=#447700>! recompute vars : itf<a name='4559'></font>
<font color=#447700>! recdepend vars : i_start,itf,j_start,jde,jte<a name='4560'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1410<a name='4561'></font>
<font color=#447700>! recompute vars : jtf<a name='4562'></font>
  jtf = min(jte,jde-1)<a name='4563'>
<font color=#447700>! recompute vars : jtf<a name='4564'></font>
<font color=#447700>! recdepend vars : config_flags,i_start,itf,j_start,jds,jtf,jts<a name='4565'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1412<a name='4566'></font>
<font color=#447700>! recompute vars : j_start<a name='4567'></font>
  if (config_flags%open_ys .and. jts .eq. jds) then<a name='4568'>
    j_start = jts+1<a name='4569'>
  endif<a name='4570'>
<font color=#447700>! recompute vars : j_start<a name='4571'></font>
<font color=#447700>! recdepend vars : config_flags,i_start,itf,j_start,jde,jte,jtf<a name='4572'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1413<a name='4573'></font>
<font color=#447700>! recompute vars : jtf<a name='4574'></font>
  if (config_flags%open_ye .and. jte .eq. jde) then<a name='4575'>
    jtf = jtf-1<a name='4576'>
  endif<a name='4577'>
<font color=#447700>! recompute vars : jtf<a name='4578'></font>
  do j = jtf, j_start, -1<a name='4579'>
    k = kte<a name='4580'>
<font color=#447700>! recompute : k<a name='4581'></font>
    do i = i_start, itf<a name='4582'>
      a_muv(i,j+1) = a_muv(i,j+1)-0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))*(phb(i,k,j+1)-phb(i,k,j)+ph(i,k,j+&amp;<a name='4583'>
&amp;1)-ph(i,k,j))<a name='4584'>
      a_muv(i,j) = a_muv(i,j)-0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j))*(phb(i,k,j)-phb(i,k,j-1)+ph(i,k,j)-ph(i,k,&amp;<a name='4585'>
&amp;j-1))<a name='4586'>
      a_ph(i,k,j-1) = a_ph(i,k,j-1)+0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j))<a name='4587'>
      a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))<a name='4588'>
      a_ph(i,k,j) = a_ph(i,k,j)-0.5*a_ph_tend(i,k,j)*rdy*((-(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))))+muv(i,j)*(cfn*v(i,k-&amp;<a name='4589'>
&amp;1,j)+cfn1*v(i,k-2,j)))<a name='4590'>
      a_v(i,k-2,j+1) = a_v(i,k-2,j+1)-0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn1*(phb(i,k,j+1)-phb(i,k,j)+ph(i,k,j+1)-ph(i,k,j))<a name='4591'>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn1*(phb(i,k,j)-phb(i,k,j-1)+ph(i,k,j)-ph(i,k,j-1))<a name='4592'>
      a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn*(phb(i,k,j+1)-phb(i,k,j)+ph(i,k,j+1)-ph(i,k,j))<a name='4593'>
      a_v(i,k-1,j) = a_v(i,k-1,j)-0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn*(phb(i,k,j)-phb(i,k,j-1)+ph(i,k,j)-ph(i,k,j-1))<a name='4594'>
    end do<a name='4595'>
    do k = 2, kte-1<a name='4596'>
      do i = i_start, itf<a name='4597'>
        a_muv(i,j+1) = a_muv(i,j+1)-0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j+1)+v(i,k-1,j+1))*(phb(i,k,j+1)-phb(i,k,j)+ph(i,k,j+1)-ph(i,&amp;<a name='4598'>
&amp;k,j))<a name='4599'>
        a_muv(i,j) = a_muv(i,j)-0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j)+v(i,k-1,j))*(phb(i,k,j)-phb(i,k,j-1)+ph(i,k,j)-ph(i,k,j-1))<a name='4600'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)+0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(v(i,k,j)+v(i,k-1,j))<a name='4601'>
        a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))<a name='4602'>
        a_ph(i,k,j) = a_ph(i,k,j)-0.25*a_ph_tend(i,k,j)*rdy*((-(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))))+muv(i,j)*(v(i,k,j)+v(i,k-1,&amp;<a name='4603'>
&amp;j)))<a name='4604'>
        a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(phb(i,k,j+1)-phb(i,k,j)+ph(i,k,j+1)-ph(i,k,j))<a name='4605'>
        a_v(i,k-1,j) = a_v(i,k-1,j)-0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(phb(i,k,j)-phb(i,k,j-1)+ph(i,k,j)-ph(i,k,j-1))<a name='4606'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(phb(i,k,j+1)-phb(i,k,j)+ph(i,k,j+1)-ph(i,k,j))<a name='4607'>
        a_v(i,k,j) = a_v(i,k,j)-0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(phb(i,k,j)-phb(i,k,j-1)+ph(i,k,j)-ph(i,k,j-1))<a name='4608'>
      end do<a name='4609'>
    end do<a name='4610'>
  end do<a name='4611'>
else if (advective_order .le. 4) then<a name='4612'>
  i_start = its<a name='4613'>
<font color=#447700>! recompute : i_start<a name='4614'></font>
  j_start = jts<a name='4615'>
<font color=#447700>! recompute : j_start<a name='4616'></font>
  itf = min(ite,ide-1)<a name='4617'>
<font color=#447700>! recompute : itf<a name='4618'></font>
  jtf = min(jte,jde-1)<a name='4619'>
<font color=#447700>! recompute : jtf<a name='4620'></font>
  if (config_flags%open_xs .and. its .eq. ids) then<a name='4621'>
    i_start = its+1<a name='4622'>
  endif<a name='4623'>
<font color=#447700>! recompute : i_start<a name='4624'></font>
  if (config_flags%open_xe .and. ite .eq. ide) then<a name='4625'>
    itf = itf-1<a name='4626'>
  endif<a name='4627'>
<font color=#447700>! recompute : itf<a name='4628'></font>
  do j = jtf, j_start, -1<a name='4629'>
    k = kte<a name='4630'>
<font color=#447700>! recompute : k<a name='4631'></font>
    do i = i_start, itf<a name='4632'>
      a_muu(i+1,j) = a_muu(i+1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))*(8.*(ph(i+1,k,j)-ph(i-&amp;<a name='4633'>
&amp;1,k,j))-(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4634'>
      a_muu(i,j) = a_muu(i,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4635'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4636'>
      a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4637'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4638'>
      a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.66666667)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4639'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4640'>
      a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.083333333)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4641'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4642'>
      a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.66666667*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4643'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4644'>
      a_u(i+1,k-2,j) = a_u(i+1,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn1*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,&amp;<a name='4645'>
&amp;j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4646'>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn1*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4647'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4648'>
      a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,&amp;<a name='4649'>
&amp;j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4650'>
      a_u(i,k-1,j) = a_u(i,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4651'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4652'>
    end do<a name='4653'>
    do k = 2, kte-1<a name='4654'>
      do i = i_start, itf<a name='4655'>
        a_muu(i+1,j) = a_muu(i+1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(u(i+1,k,j)+u(i+1,k-1,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4656'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4657'>
        a_muu(i,j) = a_muu(i,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(u(i,k,j)+u(i,k-1,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,&amp;<a name='4658'>
&amp;k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4659'>
        a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,&amp;<a name='4660'>
&amp;j)+u(i,k-1,j)))<a name='4661'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.66666667)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4662'>
&amp;k,j)+u(i,k-1,j)))<a name='4663'>
        a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.083333333)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4664'>
&amp;k,j)+u(i,k-1,j)))<a name='4665'>
        a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.66666667*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)&amp;<a name='4666'>
&amp;+u(i,k-1,j)))<a name='4667'>
        a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)&amp;<a name='4668'>
&amp;-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4669'>
        a_u(i,k-1,j) = a_u(i,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-ph(i-&amp;<a name='4670'>
&amp;2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4671'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4672'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4673'>
        a_u(i,k,j) = a_u(i,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-ph(i-2,k,&amp;<a name='4674'>
&amp;j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4675'>
      end do<a name='4676'>
    end do<a name='4677'>
  end do<a name='4678'>
<font color=#447700>! recdepend vars : its<a name='4679'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1475<a name='4680'></font>
<font color=#447700>! recompute vars : i_start<a name='4681'></font>
  i_start = its<a name='4682'>
<font color=#447700>! recompute vars : i_start<a name='4683'></font>
<font color=#447700>! recdepend vars : i_start,jts<a name='4684'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1476<a name='4685'></font>
<font color=#447700>! recompute vars : j_start<a name='4686'></font>
  j_start = jts<a name='4687'>
<font color=#447700>! recompute vars : j_start<a name='4688'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite,j_start<a name='4689'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1477<a name='4690'></font>
<font color=#447700>! recompute vars : itf<a name='4691'></font>
  itf = min(ite,ide-1)<a name='4692'>
<font color=#447700>! recompute vars : itf<a name='4693'></font>
<font color=#447700>! recdepend vars : i_start,itf,j_start,jde,jte<a name='4694'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1478<a name='4695'></font>
<font color=#447700>! recompute vars : jtf<a name='4696'></font>
  jtf = min(jte,jde-1)<a name='4697'>
<font color=#447700>! recompute vars : jtf<a name='4698'></font>
<font color=#447700>! recdepend vars : config_flags,i_start,itf,j_start,jds,jtf,jts<a name='4699'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1480<a name='4700'></font>
<font color=#447700>! recompute vars : j_start<a name='4701'></font>
  if (config_flags%open_ys .and. jts .eq. jds) then<a name='4702'>
    j_start = jts+1<a name='4703'>
  endif<a name='4704'>
<font color=#447700>! recompute vars : j_start<a name='4705'></font>
<font color=#447700>! recdepend vars : config_flags,i_start,itf,j_start,jde,jte,jtf<a name='4706'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1481<a name='4707'></font>
<font color=#447700>! recompute vars : jtf<a name='4708'></font>
  if (config_flags%open_ye .and. jte .eq. jde) then<a name='4709'>
    jtf = jtf-1<a name='4710'>
  endif<a name='4711'>
<font color=#447700>! recompute vars : jtf<a name='4712'></font>
  do j = jtf, j_start, -1<a name='4713'>
    k = kte<a name='4714'>
<font color=#447700>! recompute : k<a name='4715'></font>
    do i = i_start, itf<a name='4716'>
      a_muv(i,j+1) = a_muv(i,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))*(8.*(ph(i,k,j+1)-ph(i,&amp;<a name='4717'>
&amp;k,j-1))-(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4718'>
      a_muv(i,j) = a_muv(i,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='4719'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4720'>
      a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='4721'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4722'>
      a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.66666667)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='4723'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4724'>
      a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.083333333)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='4725'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4726'>
      a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.66666667*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='4727'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4728'>
      a_v(i,k-2,j+1) = a_v(i,k-2,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn1*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+&amp;<a name='4729'>
&amp;2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4730'>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn1*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='4731'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4732'>
      a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+&amp;<a name='4733'>
&amp;2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4734'>
      a_v(i,k-1,j) = a_v(i,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='4735'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4736'>
    end do<a name='4737'>
    do k = 2, kte-1<a name='4738'>
      do i = i_start, itf<a name='4739'>
        a_muv(i,j+1) = a_muv(i,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j+1)+v(i,k-1,j+1))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='4740'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4741'>
        a_muv(i,j) = a_muv(i,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j)+v(i,k-1,j))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,&amp;<a name='4742'>
&amp;j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4743'>
        a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,&amp;<a name='4744'>
&amp;j)+v(i,k-1,j)))<a name='4745'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.66666667)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='4746'>
&amp;k,j)+v(i,k-1,j)))<a name='4747'>
        a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.083333333)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='4748'>
&amp;k,j)+v(i,k-1,j)))<a name='4749'>
        a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.66666667*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)&amp;<a name='4750'>
&amp;+v(i,k-1,j)))<a name='4751'>
        a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)&amp;<a name='4752'>
&amp;-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4753'>
        a_v(i,k-1,j) = a_v(i,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-ph(i,&amp;<a name='4754'>
&amp;k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4755'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='4756'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4757'>
        a_v(i,k,j) = a_v(i,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-ph(i,k,j-&amp;<a name='4758'>
&amp;2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4759'>
      end do<a name='4760'>
    end do<a name='4761'>
  end do<a name='4762'>
else if (advective_order .le. 6) then<a name='4763'>
  i_start = its<a name='4764'>
<font color=#447700>! recompute : i_start<a name='4765'></font>
  j_start = jts<a name='4766'>
<font color=#447700>! recompute : j_start<a name='4767'></font>
  itf = min(ite,ide-1)<a name='4768'>
<font color=#447700>! recompute : itf<a name='4769'></font>
  jtf = min(jte,jde-1)<a name='4770'>
<font color=#447700>! recompute : jtf<a name='4771'></font>
  if (config_flags%open_xs .or. specified) then<a name='4772'>
    i_start = max(its,ids+2)<a name='4773'>
  endif<a name='4774'>
<font color=#447700>! recompute : i_start<a name='4775'></font>
  if (config_flags%open_xe .or. specified) then<a name='4776'>
    itf = min(itf,ide-3)<a name='4777'>
  endif<a name='4778'>
<font color=#447700>! recompute : itf<a name='4779'></font>
  if (config_flags%open_xe .and. ite .ge. ide-2) then<a name='4780'>
    i = ide-2<a name='4781'>
<font color=#447700>! recompute : i<a name='4782'></font>
    do j = jtf, j_start, -1<a name='4783'>
      k = kte<a name='4784'>
<font color=#447700>! recompute : k<a name='4785'></font>
      a_muu(i+1,j) = a_muu(i+1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))*(8.*(ph(i+1,k,j)-ph(i-&amp;<a name='4786'>
&amp;1,k,j))-(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4787'>
      a_muu(i,j) = a_muu(i,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4788'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4789'>
      a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4790'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4791'>
      a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.66666667)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4792'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4793'>
      a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.083333333)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4794'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4795'>
      a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.66666667*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4796'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4797'>
      a_u(i+1,k-2,j) = a_u(i+1,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn1*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,&amp;<a name='4798'>
&amp;j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4799'>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn1*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4800'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4801'>
      a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,&amp;<a name='4802'>
&amp;j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4803'>
      a_u(i,k-1,j) = a_u(i,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4804'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4805'>
      do k = 2, kte-1<a name='4806'>
        a_muu(i+1,j) = a_muu(i+1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(u(i+1,k,j)+u(i+1,k-1,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4807'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4808'>
        a_muu(i,j) = a_muu(i,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(u(i,k,j)+u(i,k-1,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,&amp;<a name='4809'>
&amp;k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4810'>
        a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,&amp;<a name='4811'>
&amp;j)+u(i,k-1,j)))<a name='4812'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.66666667)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4813'>
&amp;k,j)+u(i,k-1,j)))<a name='4814'>
        a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.083333333)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4815'>
&amp;k,j)+u(i,k-1,j)))<a name='4816'>
        a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.66666667*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)&amp;<a name='4817'>
&amp;+u(i,k-1,j)))<a name='4818'>
        a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)&amp;<a name='4819'>
&amp;-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4820'>
        a_u(i,k-1,j) = a_u(i,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-ph(i-&amp;<a name='4821'>
&amp;2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4822'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4823'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4824'>
        a_u(i,k,j) = a_u(i,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-ph(i-2,k,&amp;<a name='4825'>
&amp;j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4826'>
      end do<a name='4827'>
    end do<a name='4828'>
  endif<a name='4829'>
  if (config_flags%open_xs .and. its .le. ids+1) then<a name='4830'>
    i = ids+1<a name='4831'>
<font color=#447700>! recompute : i<a name='4832'></font>
    do j = jtf, j_start, -1<a name='4833'>
      k = kte<a name='4834'>
<font color=#447700>! recompute : k<a name='4835'></font>
      a_muu(i+1,j) = a_muu(i+1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))*(8.*(ph(i+1,k,j)-ph(i-&amp;<a name='4836'>
&amp;1,k,j))-(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4837'>
      a_muu(i,j) = a_muu(i,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4838'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4839'>
      a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4840'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4841'>
      a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.66666667)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4842'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4843'>
      a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.083333333)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4844'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4845'>
      a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.66666667*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4846'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4847'>
      a_u(i+1,k-2,j) = a_u(i+1,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn1*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,&amp;<a name='4848'>
&amp;j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4849'>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn1*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4850'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4851'>
      a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,&amp;<a name='4852'>
&amp;j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4853'>
      a_u(i,k-1,j) = a_u(i,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4854'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4855'>
      do k = 2, kte-1<a name='4856'>
        a_muu(i+1,j) = a_muu(i+1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(u(i+1,k,j)+u(i+1,k-1,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4857'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4858'>
        a_muu(i,j) = a_muu(i,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(u(i,k,j)+u(i,k-1,j))*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,&amp;<a name='4859'>
&amp;k,j)-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4860'>
        a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,&amp;<a name='4861'>
&amp;j)+u(i,k-1,j)))<a name='4862'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.66666667)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4863'>
&amp;k,j)+u(i,k-1,j)))<a name='4864'>
        a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.083333333)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4865'>
&amp;k,j)+u(i,k-1,j)))<a name='4866'>
        a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.66666667*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)&amp;<a name='4867'>
&amp;+u(i,k-1,j)))<a name='4868'>
        a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)&amp;<a name='4869'>
&amp;-ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4870'>
        a_u(i,k-1,j) = a_u(i,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-ph(i-&amp;<a name='4871'>
&amp;2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4872'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-&amp;<a name='4873'>
&amp;ph(i-2,k,j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4874'>
        a_u(i,k,j) = a_u(i,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(8.*(ph(i+1,k,j)-ph(i-1,k,j))-(ph(i+2,k,j)-ph(i-2,k,&amp;<a name='4875'>
&amp;j))+8.*(phb(i+1,k,j)-phb(i-1,k,j))-(phb(i+2,k,j)-phb(i-2,k,j)))<a name='4876'>
      end do<a name='4877'>
    end do<a name='4878'>
  endif<a name='4879'>
  do j = jtf, j_start, -1<a name='4880'>
    k = kte<a name='4881'>
<font color=#447700>! recompute : k<a name='4882'></font>
    do i = i_start, itf<a name='4883'>
      a_muu(i+1,j) = a_muu(i+1,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))*(45.*(ph(i+1,k,j)-ph(i-&amp;<a name='4884'>
&amp;1,k,j))-9.*(ph(i+2,k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+&amp;<a name='4885'>
&amp;phb(i+3,k,j)-phb(i-3,k,j))<a name='4886'>
      a_muu(i,j) = a_muu(i,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j))*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4887'>
&amp;9.*(ph(i+2,k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,&amp;<a name='4888'>
&amp;k,j)-phb(i-3,k,j))<a name='4889'>
      a_ph(i-3,k,j) = a_ph(i-3,k,j)-(-0.016666667)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,&amp;<a name='4890'>
&amp;j)*(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4891'>
      a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.15*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*(cfn*&amp;<a name='4892'>
&amp;u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4893'>
      a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.75)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4894'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4895'>
      a_ph(i+3,k,j) = a_ph(i+3,k,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4896'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4897'>
      a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.15)*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*&amp;<a name='4898'>
&amp;(cfn*u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4899'>
      a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.75*0.5*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(cfn*u(i+1,k-1,j)+cfn1*u(i+1,k-2,j))+muu(i,j)*(cfn*&amp;<a name='4900'>
&amp;u(i,k-1,j)+cfn1*u(i,k-2,j)))<a name='4901'>
      a_u(i+1,k-2,j) = a_u(i+1,k-2,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn1*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+&amp;<a name='4902'>
&amp;2,k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-&amp;<a name='4903'>
&amp;phb(i-3,k,j))<a name='4904'>
      a_u(i,k-2,j) = a_u(i,k-2,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn1*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+2,k,j)&amp;<a name='4905'>
&amp;-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-phb(i-3,k,j))<a name='4906'>
      a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*cfn*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+&amp;<a name='4907'>
&amp;2,k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-&amp;<a name='4908'>
&amp;phb(i-3,k,j))<a name='4909'>
      a_u(i,k-1,j) = a_u(i,k-1,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdx*muu(i,j)*cfn*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+2,k,j)-&amp;<a name='4910'>
&amp;ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-phb(i-3,k,j))<a name='4911'>
    end do<a name='4912'>
    do k = 2, kte-1<a name='4913'>
      do i = i_start, itf<a name='4914'>
        a_muu(i+1,j) = a_muu(i+1,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*(u(i+1,k,j)+u(i+1,k-1,j))*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-&amp;<a name='4915'>
&amp;9.*(ph(i+2,k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+&amp;<a name='4916'>
&amp;3,k,j)-phb(i-3,k,j))<a name='4917'>
        a_muu(i,j) = a_muu(i,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*(u(i,k,j)+u(i,k-1,j))*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*&amp;<a name='4918'>
&amp;(ph(i+2,k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,&amp;<a name='4919'>
&amp;k,j)-phb(i-3,k,j))<a name='4920'>
        a_ph(i-3,k,j) = a_ph(i-3,k,j)-(-0.016666667)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,&amp;<a name='4921'>
&amp;k,j)+u(i,k-1,j)))<a name='4922'>
        a_ph(i-2,k,j) = a_ph(i-2,k,j)-0.15*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)+u(i,&amp;<a name='4923'>
&amp;k-1,j)))<a name='4924'>
        a_ph(i-1,k,j) = a_ph(i-1,k,j)-(-0.75)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)+&amp;<a name='4925'>
&amp;u(i,k-1,j)))<a name='4926'>
        a_ph(i+3,k,j) = a_ph(i+3,k,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,&amp;<a name='4927'>
&amp;j)+u(i,k-1,j)))<a name='4928'>
        a_ph(i+2,k,j) = a_ph(i+2,k,j)-(-0.15)*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)+&amp;<a name='4929'>
&amp;u(i,k-1,j)))<a name='4930'>
        a_ph(i+1,k,j) = a_ph(i+1,k,j)-0.75*0.25*a_ph_tend(i,k,j)*rdx*(muu(i+1,j)*(u(i+1,k,j)+u(i+1,k-1,j))+muu(i,j)*(u(i,k,j)+u(i,&amp;<a name='4931'>
&amp;k-1,j)))<a name='4932'>
        a_u(i+1,k-1,j) = a_u(i+1,k-1,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+2,&amp;<a name='4933'>
&amp;k,j)-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-phb(i-3,k,j))<a name='4934'>
        a_u(i,k-1,j) = a_u(i,k-1,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+2,k,j)-&amp;<a name='4935'>
&amp;ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-phb(i-3,k,j))<a name='4936'>
        a_u(i+1,k,j) = a_u(i+1,k,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*muu(i+1,j)*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+2,k,j)&amp;<a name='4937'>
&amp;-ph(i-2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-phb(i-3,k,j))<a name='4938'>
        a_u(i,k,j) = a_u(i,k,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdx*muu(i,j)*(45.*(ph(i+1,k,j)-ph(i-1,k,j))-9.*(ph(i+2,k,j)-ph(i-&amp;<a name='4939'>
&amp;2,k,j))+ph(i+3,k,j)-ph(i-3,k,j)+45.*(phb(i+1,k,j)-phb(i-1,k,j))-9.*(phb(i+2,k,j)-phb(i-2,k,j))+phb(i+3,k,j)-phb(i-3,k,j))<a name='4940'>
      end do<a name='4941'>
    end do<a name='4942'>
  end do<a name='4943'>
<font color=#447700>! recdepend vars : its<a name='4944'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1555<a name='4945'></font>
<font color=#447700>! recompute vars : i_start<a name='4946'></font>
  i_start = its<a name='4947'>
<font color=#447700>! recompute vars : i_start<a name='4948'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='4949'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1557<a name='4950'></font>
<font color=#447700>! recompute vars : itf<a name='4951'></font>
  itf = min(ite,ide-1)<a name='4952'>
<font color=#447700>! recompute vars : itf<a name='4953'></font>
  if (config_flags%open_ye .and. jte .ge. jde-2) then<a name='4954'>
    j = jde-2<a name='4955'>
<font color=#447700>! recompute : j<a name='4956'></font>
    k = kte<a name='4957'>
<font color=#447700>! recompute : k<a name='4958'></font>
    do i = i_start, itf<a name='4959'>
      a_muv(i,j+1) = a_muv(i,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))*(8.*(ph(i,k,j+1)-ph(i,&amp;<a name='4960'>
&amp;k,j-1))-(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4961'>
      a_muv(i,j) = a_muv(i,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='4962'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4963'>
      a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='4964'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4965'>
      a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.66666667)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='4966'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4967'>
      a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.083333333)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='4968'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4969'>
      a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.66666667*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='4970'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='4971'>
      a_v(i,k-2,j+1) = a_v(i,k-2,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn1*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+&amp;<a name='4972'>
&amp;2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4973'>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn1*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='4974'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4975'>
      a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+&amp;<a name='4976'>
&amp;2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4977'>
      a_v(i,k-1,j) = a_v(i,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='4978'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4979'>
    end do<a name='4980'>
    do k = 2, kte-1<a name='4981'>
      do i = i_start, itf<a name='4982'>
        a_muv(i,j+1) = a_muv(i,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j+1)+v(i,k-1,j+1))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='4983'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4984'>
        a_muv(i,j) = a_muv(i,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j)+v(i,k-1,j))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,&amp;<a name='4985'>
&amp;j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4986'>
        a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,&amp;<a name='4987'>
&amp;j)+v(i,k-1,j)))<a name='4988'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.66666667)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='4989'>
&amp;k,j)+v(i,k-1,j)))<a name='4990'>
        a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.083333333)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='4991'>
&amp;k,j)+v(i,k-1,j)))<a name='4992'>
        a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.66666667*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)&amp;<a name='4993'>
&amp;+v(i,k-1,j)))<a name='4994'>
        a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)&amp;<a name='4995'>
&amp;-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4996'>
        a_v(i,k-1,j) = a_v(i,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-ph(i,&amp;<a name='4997'>
&amp;k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='4998'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='4999'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5000'>
        a_v(i,k,j) = a_v(i,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-ph(i,k,j-&amp;<a name='5001'>
&amp;2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5002'>
      end do<a name='5003'>
    end do<a name='5004'>
  endif<a name='5005'>
<font color=#447700>! recdepend vars : its<a name='5006'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1555<a name='5007'></font>
<font color=#447700>! recompute vars : i_start<a name='5008'></font>
  i_start = its<a name='5009'>
<font color=#447700>! recompute vars : i_start<a name='5010'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='5011'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1557<a name='5012'></font>
<font color=#447700>! recompute vars : itf<a name='5013'></font>
  itf = min(ite,ide-1)<a name='5014'>
<font color=#447700>! recompute vars : itf<a name='5015'></font>
  if (config_flags%open_ys .and. jts .le. jds+1) then<a name='5016'>
    j = jds+1<a name='5017'>
<font color=#447700>! recompute : j<a name='5018'></font>
    k = kte<a name='5019'>
<font color=#447700>! recompute : k<a name='5020'></font>
    do i = i_start, itf<a name='5021'>
      a_muv(i,j+1) = a_muv(i,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))*(8.*(ph(i,k,j+1)-ph(i,&amp;<a name='5022'>
&amp;k,j-1))-(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5023'>
      a_muv(i,j) = a_muv(i,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='5024'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5025'>
      a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='5026'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5027'>
      a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.66666667)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='5028'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5029'>
      a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.083333333)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='5030'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5031'>
      a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.66666667*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='5032'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5033'>
      a_v(i,k-2,j+1) = a_v(i,k-2,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn1*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+&amp;<a name='5034'>
&amp;2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5035'>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn1*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='5036'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5037'>
      a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+&amp;<a name='5038'>
&amp;2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5039'>
      a_v(i,k-1,j) = a_v(i,k-1,j)-0.083333333*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='5040'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5041'>
    end do<a name='5042'>
    do k = 2, kte-1<a name='5043'>
      do i = i_start, itf<a name='5044'>
        a_muv(i,j+1) = a_muv(i,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j+1)+v(i,k-1,j+1))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='5045'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5046'>
        a_muv(i,j) = a_muv(i,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j)+v(i,k-1,j))*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,&amp;<a name='5047'>
&amp;j+2)-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5048'>
        a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,&amp;<a name='5049'>
&amp;j)+v(i,k-1,j)))<a name='5050'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.66666667)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='5051'>
&amp;k,j)+v(i,k-1,j)))<a name='5052'>
        a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.083333333)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='5053'>
&amp;k,j)+v(i,k-1,j)))<a name='5054'>
        a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.66666667*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)&amp;<a name='5055'>
&amp;+v(i,k-1,j)))<a name='5056'>
        a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)&amp;<a name='5057'>
&amp;-ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5058'>
        a_v(i,k-1,j) = a_v(i,k-1,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-ph(i,&amp;<a name='5059'>
&amp;k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5060'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-&amp;<a name='5061'>
&amp;ph(i,k,j-2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5062'>
        a_v(i,k,j) = a_v(i,k,j)-0.083333333*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(8.*(ph(i,k,j+1)-ph(i,k,j-1))-(ph(i,k,j+2)-ph(i,k,j-&amp;<a name='5063'>
&amp;2))+8.*(phb(i,k,j+1)-phb(i,k,j-1))-(phb(i,k,j+2)-phb(i,k,j-2)))<a name='5064'>
      end do<a name='5065'>
    end do<a name='5066'>
  endif<a name='5067'>
<font color=#447700>! recdepend vars : its<a name='5068'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1555<a name='5069'></font>
<font color=#447700>! recompute vars : i_start<a name='5070'></font>
  i_start = its<a name='5071'>
<font color=#447700>! recompute vars : i_start<a name='5072'></font>
<font color=#447700>! recdepend vars : i_start,jts<a name='5073'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1556<a name='5074'></font>
<font color=#447700>! recompute vars : j_start<a name='5075'></font>
  j_start = jts<a name='5076'>
<font color=#447700>! recompute vars : j_start<a name='5077'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite,j_start<a name='5078'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1557<a name='5079'></font>
<font color=#447700>! recompute vars : itf<a name='5080'></font>
  itf = min(ite,ide-1)<a name='5081'>
<font color=#447700>! recompute vars : itf<a name='5082'></font>
<font color=#447700>! recdepend vars : i_start,itf,j_start,jde,jte<a name='5083'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1558<a name='5084'></font>
<font color=#447700>! recompute vars : jtf<a name='5085'></font>
  jtf = min(jte,jde-1)<a name='5086'>
<font color=#447700>! recompute vars : jtf<a name='5087'></font>
<font color=#447700>!  recdepend vars : config_flags,i_start,itf,j_start,jds,jtf,jts,specifi<a name='5088'></font>
<font color=#447700>! ed<a name='5089'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1563<a name='5090'></font>
<font color=#447700>! recompute vars : j_start<a name='5091'></font>
  if (config_flags%open_ys .or. specified) then<a name='5092'>
    j_start = max(jts,jds+2)<a name='5093'>
  endif<a name='5094'>
<font color=#447700>! recompute vars : j_start<a name='5095'></font>
<font color=#447700>! recdepend vars : config_flags,i_start,itf,j_start,jde,jtf,specified<a name='5096'></font>
<font color=#447700>! recompute pos : IF_STMT module_big_step_utilities_em.f90:1564<a name='5097'></font>
<font color=#447700>! recompute vars : jtf<a name='5098'></font>
  if (config_flags%open_ye .or. specified) then<a name='5099'>
    jtf = min(jtf,jde-3)<a name='5100'>
  endif<a name='5101'>
<font color=#447700>! recompute vars : jtf<a name='5102'></font>
  do j = jtf, j_start, -1<a name='5103'>
    k = kte<a name='5104'>
<font color=#447700>! recompute : k<a name='5105'></font>
    do i = i_start, itf<a name='5106'>
      a_muv(i,j+1) = a_muv(i,j+1)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))*(45.*(ph(i,k,j+1)-ph(i,&amp;<a name='5107'>
&amp;k,j-1))-9.*(ph(i,k,j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+&amp;<a name='5108'>
&amp;phb(i,k,j+3)-phb(i,k,j-3))<a name='5109'>
      a_muv(i,j) = a_muv(i,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j))*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='5110'>
&amp;9.*(ph(i,k,j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,&amp;<a name='5111'>
&amp;j+3)-phb(i,k,j-3))<a name='5112'>
      a_ph(i,k,j-3) = a_ph(i,k,j-3)-(-0.016666667)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,&amp;<a name='5113'>
&amp;j)*(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5114'>
      a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.15*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*(cfn*&amp;<a name='5115'>
&amp;v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5116'>
      a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.75)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='5117'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5118'>
      a_ph(i,k,j+3) = a_ph(i,k,j+3)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='5119'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5120'>
      a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.15)*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*&amp;<a name='5121'>
&amp;(cfn*v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5122'>
      a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.75*0.5*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(cfn*v(i,k-1,j+1)+cfn1*v(i,k-2,j+1))+muv(i,j)*(cfn*&amp;<a name='5123'>
&amp;v(i,k-1,j)+cfn1*v(i,k-2,j)))<a name='5124'>
      a_v(i,k-2,j+1) = a_v(i,k-2,j+1)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn1*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,&amp;<a name='5125'>
&amp;k,j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-&amp;<a name='5126'>
&amp;phb(i,k,j-3))<a name='5127'>
      a_v(i,k-2,j) = a_v(i,k-2,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn1*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,k,j+2)&amp;<a name='5128'>
&amp;-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-phb(i,k,j-3))<a name='5129'>
      a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*cfn*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,&amp;<a name='5130'>
&amp;k,j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-&amp;<a name='5131'>
&amp;phb(i,k,j-3))<a name='5132'>
      a_v(i,k-1,j) = a_v(i,k-1,j)-0.016666667*0.5*a_ph_tend(i,k,j)*rdy*muv(i,j)*cfn*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,k,j+2)-&amp;<a name='5133'>
&amp;ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-phb(i,k,j-3))<a name='5134'>
    end do<a name='5135'>
    do k = 2, kte-1<a name='5136'>
      do i = i_start, itf<a name='5137'>
        a_muv(i,j+1) = a_muv(i,j+1)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j+1)+v(i,k-1,j+1))*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-&amp;<a name='5138'>
&amp;9.*(ph(i,k,j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,&amp;<a name='5139'>
&amp;k,j+3)-phb(i,k,j-3))<a name='5140'>
        a_muv(i,j) = a_muv(i,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*(v(i,k,j)+v(i,k-1,j))*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*&amp;<a name='5141'>
&amp;(ph(i,k,j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,&amp;<a name='5142'>
&amp;j+3)-phb(i,k,j-3))<a name='5143'>
        a_ph(i,k,j-3) = a_ph(i,k,j-3)-(-0.016666667)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,&amp;<a name='5144'>
&amp;k,j)+v(i,k-1,j)))<a name='5145'>
        a_ph(i,k,j-2) = a_ph(i,k,j-2)-0.15*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)+v(i,&amp;<a name='5146'>
&amp;k-1,j)))<a name='5147'>
        a_ph(i,k,j-1) = a_ph(i,k,j-1)-(-0.75)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)+&amp;<a name='5148'>
&amp;v(i,k-1,j)))<a name='5149'>
        a_ph(i,k,j+3) = a_ph(i,k,j+3)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,&amp;<a name='5150'>
&amp;j)+v(i,k-1,j)))<a name='5151'>
        a_ph(i,k,j+2) = a_ph(i,k,j+2)-(-0.15)*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)+&amp;<a name='5152'>
&amp;v(i,k-1,j)))<a name='5153'>
        a_ph(i,k,j+1) = a_ph(i,k,j+1)-0.75*0.25*a_ph_tend(i,k,j)*rdy*(muv(i,j+1)*(v(i,k,j+1)+v(i,k-1,j+1))+muv(i,j)*(v(i,k,j)+v(i,&amp;<a name='5154'>
&amp;k-1,j)))<a name='5155'>
        a_v(i,k-1,j+1) = a_v(i,k-1,j+1)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,k,&amp;<a name='5156'>
&amp;j+2)-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-phb(i,k,j-3))<a name='5157'>
        a_v(i,k-1,j) = a_v(i,k-1,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,k,j+2)-&amp;<a name='5158'>
&amp;ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-phb(i,k,j-3))<a name='5159'>
        a_v(i,k,j+1) = a_v(i,k,j+1)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j+1)*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,k,j+2)&amp;<a name='5160'>
&amp;-ph(i,k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-phb(i,k,j-3))<a name='5161'>
        a_v(i,k,j) = a_v(i,k,j)-0.016666667*0.25*a_ph_tend(i,k,j)*rdy*muv(i,j)*(45.*(ph(i,k,j+1)-ph(i,k,j-1))-9.*(ph(i,k,j+2)-ph(i,&amp;<a name='5162'>
&amp;k,j-2))+ph(i,k,j+3)-ph(i,k,j-3)+45.*(phb(i,k,j+1)-phb(i,k,j-1))-9.*(phb(i,k,j+2)-phb(i,k,j-2))+phb(i,k,j+3)-phb(i,k,j-3))<a name='5163'>
      end do<a name='5164'>
    end do<a name='5165'>
  end do<a name='5166'>
endif<a name='5167'>
<font color=#447700>! recdepend vars : ide,ite<a name='5168'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1362<a name='5169'></font>
<font color=#447700>! recompute vars : itf<a name='5170'></font>
itf = min(ite,ide-1)<a name='5171'>
<font color=#447700>! recompute vars : itf<a name='5172'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='5173'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1363<a name='5174'></font>
<font color=#447700>! recompute vars : jtf<a name='5175'></font>
jtf = min(jte,jde-1)<a name='5176'>
<font color=#447700>! recompute vars : jtf<a name='5177'></font>
if (non_hydrostatic) then<a name='5178'>
  do j = jts, jtf<a name='5179'>
    do k = 2, kte<a name='5180'>
      do i = its, itf<a name='5181'>
        a_mut(i,j) = a_mut(i,j)+a_ph_tend(i,k,j)*(g*w(i,k,j)/msft(i,j))<a name='5182'>
        a_w(i,k,j) = a_w(i,k,j)+a_ph_tend(i,k,j)*(mut(i,j)*g/msft(i,j))<a name='5183'>
      end do<a name='5184'>
    end do<a name='5185'>
    do i = its, itf<a name='5186'>
      a_ph_tend(i,kde,j) = 0.<a name='5187'>
    end do<a name='5188'>
  end do<a name='5189'>
endif<a name='5190'>
<font color=#447700>! recdepend vars : ide,ite<a name='5191'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1362<a name='5192'></font>
<font color=#447700>! recompute vars : itf<a name='5193'></font>
itf = min(ite,ide-1)<a name='5194'>
<font color=#447700>! recompute vars : itf<a name='5195'></font>
<font color=#447700>! recdepend vars : itf,jde,jte<a name='5196'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_big_step_utilities_em.f90:1363<a name='5197'></font>
<font color=#447700>! recompute vars : jtf<a name='5198'></font>
jtf = min(jte,jde-1)<a name='5199'>
<font color=#447700>! recompute vars : jtf<a name='5200'></font>
do j = jts, jtf<a name='5201'>
  do k = 2, kte-1<a name='5202'>
    do i = its, itf<a name='5203'>
      a_wdwn(i,k+1) = a_wdwn(i,k+1)-a_ph_tend(i,k,j)*fnm(k)<a name='5204'>
      a_wdwn(i,k) = a_wdwn(i,k)-a_ph_tend(i,k,j)*fnp(k)<a name='5205'>
    end do<a name='5206'>
  end do<a name='5207'>
  do k = 2, kte<a name='5208'>
    do i = its, itf<a name='5209'>
      a_ph(i,k-1,j) = a_ph(i,k-1,j)-0.5*a_wdwn(i,k)*(ww(i,k,j)+ww(i,k-1,j))*rdnw(k-1)<a name='5210'>
      a_ph(i,k,j) = a_ph(i,k,j)+0.5*a_wdwn(i,k)*(ww(i,k,j)+ww(i,k-1,j))*rdnw(k-1)<a name='5211'>
      a_ww(i,k-1,j) = a_ww(i,k-1,j)+0.5*a_wdwn(i,k)*rdnw(k-1)*(ph(i,k,j)-ph(i,k-1,j)+phb(i,k,j)-phb(i,k-1,j))<a name='5212'>
      a_ww(i,k,j) = a_ww(i,k,j)+0.5*a_wdwn(i,k)*rdnw(k-1)*(ph(i,k,j)-ph(i,k-1,j)+phb(i,k,j)-phb(i,k-1,j))<a name='5213'>
      a_wdwn(i,k) = 0.<a name='5214'>
    end do<a name='5215'>
  end do<a name='5216'>
end do<a name='5217'>
<a name='5218'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_RHS_PH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_36">("a_rhs_ph")<a name='5219'>
<a name='5220'>
end subroutine a_rhs_ph<a name='5221'>
<a name='5222'>
<a name='5223'>
<A NAME='A_VERTICAL_DIFFUSION'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5224'>
<font color=#993300>subroutine </font><font color=#cc0000>a_vertical_diffusion</font>( name, field, a_field, a_tendency, alt, a_alt, mut, a_mut, rdn, rdnw, kvdif, ide, jde, kde, ims, &amp; <A href='../../call_to/A_VERTICAL_DIFFUSION.html' TARGET='index'>4</A>,<A href='../../call_from/A_VERTICAL_DIFFUSION.html' TARGET='index'>2</A><a name='5225'>
&amp;ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='5226'>
<font color=#447700>!******************************************************************<a name='5227'></font>
<font color=#447700>!******************************************************************<a name='5228'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5229'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5230'></font>
<font color=#447700>!******************************************************************<a name='5231'></font>
<font color=#447700>!******************************************************************<a name='5232'></font>
<font color=#447700>!==============================================<a name='5233'></font>
<font color=#447700>! all entries are defined explicitly<a name='5234'></font>
<font color=#447700>!==============================================<a name='5235'></font>
implicit none<a name='5236'>
<a name='5237'>
<font color=#447700>!==============================================<a name='5238'></font>
<font color=#447700>! declare arguments<a name='5239'></font>
<font color=#447700>!==============================================<a name='5240'></font>
integer, intent(in) :: ime<a name='5241'>
integer, intent(in) :: ims<a name='5242'>
integer, intent(in) :: jme<a name='5243'>
integer, intent(in) :: jms<a name='5244'>
integer, intent(in) :: kme<a name='5245'>
integer, intent(in) :: kms<a name='5246'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='5247'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='5248'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='5249'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='5250'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='5251'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='5252'>
integer, intent(in) :: ide<a name='5253'>
integer, intent(in) :: ite<a name='5254'>
integer, intent(in) :: its<a name='5255'>
integer, intent(in) :: jde<a name='5256'>
integer, intent(in) :: jte<a name='5257'>
integer, intent(in) :: jts<a name='5258'>
integer, intent(in) :: kde<a name='5259'>
integer, intent(in) :: kte<a name='5260'>
integer, intent(in) :: kts<a name='5261'>
real, intent(in) :: kvdif<a name='5262'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='5263'>
character*(1), intent(in) :: name<a name='5264'>
real, intent(in) :: rdn(kms:kme)<a name='5265'>
real, intent(in) :: rdnw(kms:kme)<a name='5266'>
<a name='5267'>
<font color=#447700>!==============================================<a name='5268'></font>
<font color=#447700>! declare local variables<a name='5269'></font>
<font color=#447700>!==============================================<a name='5270'></font>
real a_vflux(its:ite,0:kte+1)<a name='5271'>
integer i<a name='5272'>
integer i_end<a name='5273'>
integer i_start<a name='5274'>
integer j<a name='5275'>
integer j_end<a name='5276'>
integer j_start<a name='5277'>
integer k<a name='5278'>
integer ktf<a name='5279'>
real vflux(its:ite,0:kte+1)<a name='5280'>
<a name='5281'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_37">("a_vertical_diffusion")<a name='5282'>
<a name='5283'>
<font color=#447700>!----------------------------------------------<a name='5284'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='5285'></font>
<font color=#447700>!----------------------------------------------<a name='5286'></font>
a_vflux(:,:) = 0.<a name='5287'>
<a name='5288'>
<font color=#447700>!----------------------------------------------<a name='5289'></font>
<font color=#447700>! ROUTINE BODY<a name='5290'></font>
<font color=#447700>!----------------------------------------------<a name='5291'></font>
ktf = min(kte,kde-1)<a name='5292'>
<font color=#447700>! recompute : ktf<a name='5293'></font>
if (name .eq. 'w') then<a name='5294'>
  i_start = its<a name='5295'>
<font color=#447700>! recompute : i_start<a name='5296'></font>
  i_end = min(ite,ide-1)<a name='5297'>
<font color=#447700>! recompute : i_end<a name='5298'></font>
  j_start = jts<a name='5299'>
<font color=#447700>! recompute : j_start<a name='5300'></font>
  j_end = min(jte,jde-1)<a name='5301'>
<font color=#447700>! recompute : j_end<a name='5302'></font>
  do j = j_start, j_end<a name='5303'>
    do k = kts, ktf-1<a name='5304'>
      do i = i_start, i_end<a name='5305'>
        vflux(i,k) = kvdif/alt(i,k,j)*rdnw(k)*(field(i,k+1,j)-field(i,k,j))<a name='5306'>
      end do<a name='5307'>
    end do<a name='5308'>
    do i = i_start, i_end<a name='5309'>
      vflux(i,ktf) = 0.<a name='5310'>
    end do<a name='5311'>
<font color=#447700>! recompute : vflux<a name='5312'></font>
    do k = kts+1, ktf<a name='5313'>
      do i = i_start, i_end<a name='5314'>
        a_alt(i,k-1,j) = a_alt(i,k-1,j)-a_tendency(i,k,j)*0.5*(rdn(k)*g*g/mut(i,j))/(0.5*0.5*(alt(i,k,j)+alt(i,k-1,j))*(alt(i,k,j)+&amp;<a name='5315'>
&amp;alt(i,k-1,j)))*(vflux(i,k)-vflux(i,k-1))<a name='5316'>
        a_alt(i,k,j) = a_alt(i,k,j)-a_tendency(i,k,j)*0.5*(rdn(k)*g*g/mut(i,j))/(0.5*0.5*(alt(i,k,j)+alt(i,k-1,j))*(alt(i,k,j)+&amp;<a name='5317'>
&amp;alt(i,k-1,j)))*(vflux(i,k)-vflux(i,k-1))<a name='5318'>
        a_mut(i,j) = a_mut(i,j)-a_tendency(i,k,j)*rdn(k)*g*g/(mut(i,j)*mut(i,j))/(0.5*(alt(i,k,j)+alt(i,k-1,j)))*(vflux(i,k)-&amp;<a name='5319'>
&amp;vflux(i,k-1))<a name='5320'>
        a_vflux(i,k-1) = a_vflux(i,k-1)-a_tendency(i,k,j)*(rdn(k)*g*g/mut(i,j)/(0.5*(alt(i,k,j)+alt(i,k-1,j))))<a name='5321'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*(rdn(k)*g*g/mut(i,j)/(0.5*(alt(i,k,j)+alt(i,k-1,j))))<a name='5322'>
      end do<a name='5323'>
    end do<a name='5324'>
    do i = i_start, i_end<a name='5325'>
      a_vflux(i,ktf) = 0.<a name='5326'>
    end do<a name='5327'>
    do k = kts, ktf-1<a name='5328'>
      do i = i_start, i_end<a name='5329'>
        a_alt(i,k,j) = a_alt(i,k,j)-a_vflux(i,k)*kvdif/(alt(i,k,j)*alt(i,k,j))*rdnw(k)*(field(i,k+1,j)-field(i,k,j))<a name='5330'>
        a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*kvdif/alt(i,k,j)*rdnw(k)<a name='5331'>
        a_field(i,k,j) = a_field(i,k,j)-a_vflux(i,k)*kvdif/alt(i,k,j)*rdnw(k)<a name='5332'>
        a_vflux(i,k) = 0.<a name='5333'>
      end do<a name='5334'>
    end do<a name='5335'>
  end do<a name='5336'>
else if (name .eq. 'm') then<a name='5337'>
  i_start = its<a name='5338'>
<font color=#447700>! recompute : i_start<a name='5339'></font>
  i_end = min(ite,ide-1)<a name='5340'>
<font color=#447700>! recompute : i_end<a name='5341'></font>
  j_start = jts<a name='5342'>
<font color=#447700>! recompute : j_start<a name='5343'></font>
  j_end = min(jte,jde-1)<a name='5344'>
<font color=#447700>! recompute : j_end<a name='5345'></font>
  do j = j_start, j_end<a name='5346'>
    do k = kts, ktf-1<a name='5347'>
      do i = i_start, i_end<a name='5348'>
        vflux(i,k) = kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j)))*(field(i,k+1,j)-field(i,k,j))<a name='5349'>
      end do<a name='5350'>
    end do<a name='5351'>
<font color=#447700>! recompute : vflux<a name='5352'></font>
    do i = i_start, i_end<a name='5353'>
      vflux(i,0) = vflux(i,1)<a name='5354'>
    end do<a name='5355'>
    do i = i_start, i_end<a name='5356'>
      vflux(i,ktf) = 0.<a name='5357'>
    end do<a name='5358'>
<font color=#447700>! recompute : vflux<a name='5359'></font>
    do k = kts, ktf<a name='5360'>
      do i = i_start, i_end<a name='5361'>
        a_alt(i,k,j) = a_alt(i,k,j)-a_tendency(i,k,j)*g*g/mut(i,j)/(alt(i,k,j)*alt(i,k,j))*rdnw(k)*(vflux(i,k)-vflux(i,k-1))<a name='5362'>
        a_mut(i,j) = a_mut(i,j)-a_tendency(i,k,j)*g*g/(mut(i,j)*mut(i,j))/alt(i,k,j)*rdnw(k)*(vflux(i,k)-vflux(i,k-1))<a name='5363'>
        a_vflux(i,k-1) = a_vflux(i,k-1)-a_tendency(i,k,j)*g*g/mut(i,j)/alt(i,k,j)*rdnw(k)<a name='5364'>
        a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*g*g/mut(i,j)/alt(i,k,j)*rdnw(k)<a name='5365'>
      end do<a name='5366'>
    end do<a name='5367'>
    do i = i_start, i_end<a name='5368'>
      a_vflux(i,ktf) = 0.<a name='5369'>
    end do<a name='5370'>
    do i = i_start, i_end<a name='5371'>
      a_vflux(i,1) = a_vflux(i,1)+a_vflux(i,0)<a name='5372'>
      a_vflux(i,0) = 0.<a name='5373'>
    end do<a name='5374'>
    do k = kts, ktf-1<a name='5375'>
      do i = i_start, i_end<a name='5376'>
        a_alt(i,k+1,j) = a_alt(i,k+1,j)-a_vflux(i,k)*0.5*kvdif*rdn(k+1)/(0.5*0.5*(alt(i,k,j)+alt(i,k+1,j))*(alt(i,k,j)+alt(i,k+1,j)&amp;<a name='5377'>
&amp;))*(field(i,k+1,j)-field(i,k,j))<a name='5378'>
        a_alt(i,k,j) = a_alt(i,k,j)-a_vflux(i,k)*0.5*kvdif*rdn(k+1)/(0.5*0.5*(alt(i,k,j)+alt(i,k+1,j))*(alt(i,k,j)+alt(i,k+1,j)))*&amp;<a name='5379'>
&amp;(field(i,k+1,j)-field(i,k,j))<a name='5380'>
        a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*(kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j))))<a name='5381'>
        a_field(i,k,j) = a_field(i,k,j)-a_vflux(i,k)*(kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j))))<a name='5382'>
        a_vflux(i,k) = 0.<a name='5383'>
      end do<a name='5384'>
    end do<a name='5385'>
  end do<a name='5386'>
endif<a name='5387'>
<a name='5388'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_37">("a_vertical_diffusion")<a name='5389'>
<a name='5390'>
end subroutine a_vertical_diffusion<a name='5391'>
<a name='5392'>
<a name='5393'>
<A NAME='A_VERTICAL_DIFFUSION_3DMP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_3DMP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5394'>
<font color=#993300>subroutine </font><font color=#cc0000>a_vertical_diffusion_3dmp</font>( field, a_field, a_tendency, base_3d, alt, a_alt, mut, a_mut, rdn, rdnw, kvdif, ide, jde, kde,&amp; <A href='../../call_to/A_VERTICAL_DIFFUSION_3DMP.html' TARGET='index'>2</A>,<A href='../../call_from/A_VERTICAL_DIFFUSION_3DMP.html' TARGET='index'>2</A><a name='5395'>
&amp; ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='5396'>
<font color=#447700>!******************************************************************<a name='5397'></font>
<font color=#447700>!******************************************************************<a name='5398'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5399'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5400'></font>
<font color=#447700>!******************************************************************<a name='5401'></font>
<font color=#447700>!******************************************************************<a name='5402'></font>
<font color=#447700>!==============================================<a name='5403'></font>
<font color=#447700>! all entries are defined explicitly<a name='5404'></font>
<font color=#447700>!==============================================<a name='5405'></font>
implicit none<a name='5406'>
<a name='5407'>
<font color=#447700>!==============================================<a name='5408'></font>
<font color=#447700>! declare arguments<a name='5409'></font>
<font color=#447700>!==============================================<a name='5410'></font>
integer, intent(in) :: ime<a name='5411'>
integer, intent(in) :: ims<a name='5412'>
integer, intent(in) :: jme<a name='5413'>
integer, intent(in) :: jms<a name='5414'>
integer, intent(in) :: kme<a name='5415'>
integer, intent(in) :: kms<a name='5416'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='5417'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='5418'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='5419'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='5420'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='5421'>
real, intent(in) :: base_3d(ims:ime,kms:kme,jms:jme)<a name='5422'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='5423'>
integer, intent(in) :: ide<a name='5424'>
integer, intent(in) :: ite<a name='5425'>
integer, intent(in) :: its<a name='5426'>
integer, intent(in) :: jde<a name='5427'>
integer, intent(in) :: jte<a name='5428'>
integer, intent(in) :: jts<a name='5429'>
integer, intent(in) :: kde<a name='5430'>
integer, intent(in) :: kte<a name='5431'>
integer, intent(in) :: kts<a name='5432'>
real, intent(in) :: kvdif<a name='5433'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='5434'>
real, intent(in) :: rdn(kms:kme)<a name='5435'>
real, intent(in) :: rdnw(kms:kme)<a name='5436'>
<a name='5437'>
<font color=#447700>!==============================================<a name='5438'></font>
<font color=#447700>! declare local variables<a name='5439'></font>
<font color=#447700>!==============================================<a name='5440'></font>
real a_vflux(its:ite,0:kte+1)<a name='5441'>
integer i<a name='5442'>
integer i_end<a name='5443'>
integer i_start<a name='5444'>
integer j<a name='5445'>
integer j_end<a name='5446'>
integer j_start<a name='5447'>
integer k<a name='5448'>
integer ktf<a name='5449'>
real vflux(its:ite,0:kte+1)<a name='5450'>
<a name='5451'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_3DMP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_38">("a_vertical_diffusion_3dmp")<a name='5452'>
<a name='5453'>
<font color=#447700>!----------------------------------------------<a name='5454'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='5455'></font>
<font color=#447700>!----------------------------------------------<a name='5456'></font>
a_vflux(:,:) = 0.<a name='5457'>
<a name='5458'>
<font color=#447700>!----------------------------------------------<a name='5459'></font>
<font color=#447700>! ROUTINE BODY<a name='5460'></font>
<font color=#447700>!----------------------------------------------<a name='5461'></font>
ktf = min(kte,kde-1)<a name='5462'>
<font color=#447700>! recompute : ktf<a name='5463'></font>
i_start = its<a name='5464'>
<font color=#447700>! recompute : i_start<a name='5465'></font>
i_end = min(ite,ide-1)<a name='5466'>
<font color=#447700>! recompute : i_end<a name='5467'></font>
j_start = jts<a name='5468'>
<font color=#447700>! recompute : j_start<a name='5469'></font>
j_end = min(jte,jde-1)<a name='5470'>
<font color=#447700>! recompute : j_end<a name='5471'></font>
do j = j_start, j_end<a name='5472'>
  do k = kts, ktf-1<a name='5473'>
    do i = i_start, i_end<a name='5474'>
      vflux(i,k) = kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-base_3d(i,k+1,j)+base_3d(i,k,j))<a name='5475'>
    end do<a name='5476'>
  end do<a name='5477'>
<font color=#447700>! recompute : vflux<a name='5478'></font>
  do i = i_start, i_end<a name='5479'>
    vflux(i,0) = vflux(i,1)<a name='5480'>
  end do<a name='5481'>
  do i = i_start, i_end<a name='5482'>
    vflux(i,ktf) = 0.<a name='5483'>
  end do<a name='5484'>
<font color=#447700>! recompute : vflux<a name='5485'></font>
  do k = kts, ktf<a name='5486'>
    do i = i_start, i_end<a name='5487'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_tendency(i,k,j)*g*g/mut(i,j)/(alt(i,k,j)*alt(i,k,j))*rdnw(k)*(vflux(i,k)-vflux(i,k-1))<a name='5488'>
      a_mut(i,j) = a_mut(i,j)-a_tendency(i,k,j)*g*g/(mut(i,j)*mut(i,j))/alt(i,k,j)*rdnw(k)*(vflux(i,k)-vflux(i,k-1))<a name='5489'>
      a_vflux(i,k-1) = a_vflux(i,k-1)-a_tendency(i,k,j)*g*g/mut(i,j)/alt(i,k,j)*rdnw(k)<a name='5490'>
      a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*g*g/mut(i,j)/alt(i,k,j)*rdnw(k)<a name='5491'>
    end do<a name='5492'>
  end do<a name='5493'>
  do i = i_start, i_end<a name='5494'>
    a_vflux(i,ktf) = 0.<a name='5495'>
  end do<a name='5496'>
  do i = i_start, i_end<a name='5497'>
    a_vflux(i,1) = a_vflux(i,1)+a_vflux(i,0)<a name='5498'>
    a_vflux(i,0) = 0.<a name='5499'>
  end do<a name='5500'>
  do k = kts, ktf-1<a name='5501'>
    do i = i_start, i_end<a name='5502'>
      a_alt(i,k+1,j) = a_alt(i,k+1,j)-a_vflux(i,k)*0.5*kvdif*rdn(k+1)/(0.5*0.5*(alt(i,k,j)+alt(i,k+1,j))*(alt(i,k,j)+alt(i,k+1,j)))&amp;<a name='5503'>
&amp;*(field(i,k+1,j)-field(i,k,j)-base_3d(i,k+1,j)+base_3d(i,k,j))<a name='5504'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_vflux(i,k)*0.5*kvdif*rdn(k+1)/(0.5*0.5*(alt(i,k,j)+alt(i,k+1,j))*(alt(i,k,j)+alt(i,k+1,j)))*&amp;<a name='5505'>
&amp;(field(i,k+1,j)-field(i,k,j)-base_3d(i,k+1,j)+base_3d(i,k,j))<a name='5506'>
      a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*(kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j))))<a name='5507'>
      a_field(i,k,j) = a_field(i,k,j)-a_vflux(i,k)*(kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j))))<a name='5508'>
      a_vflux(i,k) = 0.<a name='5509'>
    end do<a name='5510'>
  end do<a name='5511'>
end do<a name='5512'>
<a name='5513'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_3DMP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_38">("a_vertical_diffusion_3dmp")<a name='5514'>
<a name='5515'>
end subroutine a_vertical_diffusion_3dmp<a name='5516'>
<a name='5517'>
<a name='5518'>
<A NAME='A_VERTICAL_DIFFUSION_MP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_MP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5519'>
<font color=#993300>subroutine </font><font color=#cc0000>a_vertical_diffusion_mp</font>( field, a_field, a_tendency, base, alt, a_alt, mut, a_mut, rdn, rdnw, kvdif, ide, jde, kde, ims,&amp; <A href='../../call_to/A_VERTICAL_DIFFUSION_MP.html' TARGET='index'>2</A>,<A href='../../call_from/A_VERTICAL_DIFFUSION_MP.html' TARGET='index'>2</A><a name='5520'>
&amp; ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='5521'>
<font color=#447700>!******************************************************************<a name='5522'></font>
<font color=#447700>!******************************************************************<a name='5523'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5524'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5525'></font>
<font color=#447700>!******************************************************************<a name='5526'></font>
<font color=#447700>!******************************************************************<a name='5527'></font>
<font color=#447700>!==============================================<a name='5528'></font>
<font color=#447700>! all entries are defined explicitly<a name='5529'></font>
<font color=#447700>!==============================================<a name='5530'></font>
implicit none<a name='5531'>
<a name='5532'>
<font color=#447700>!==============================================<a name='5533'></font>
<font color=#447700>! declare arguments<a name='5534'></font>
<font color=#447700>!==============================================<a name='5535'></font>
integer, intent(in) :: ime<a name='5536'>
integer, intent(in) :: ims<a name='5537'>
integer, intent(in) :: jme<a name='5538'>
integer, intent(in) :: jms<a name='5539'>
integer, intent(in) :: kme<a name='5540'>
integer, intent(in) :: kms<a name='5541'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='5542'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='5543'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='5544'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='5545'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='5546'>
real, intent(in) :: base(kms:kme)<a name='5547'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='5548'>
integer, intent(in) :: ide<a name='5549'>
integer, intent(in) :: ite<a name='5550'>
integer, intent(in) :: its<a name='5551'>
integer, intent(in) :: jde<a name='5552'>
integer, intent(in) :: jte<a name='5553'>
integer, intent(in) :: jts<a name='5554'>
integer, intent(in) :: kde<a name='5555'>
integer, intent(in) :: kte<a name='5556'>
integer, intent(in) :: kts<a name='5557'>
real, intent(in) :: kvdif<a name='5558'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='5559'>
real, intent(in) :: rdn(kms:kme)<a name='5560'>
real, intent(in) :: rdnw(kms:kme)<a name='5561'>
<a name='5562'>
<font color=#447700>!==============================================<a name='5563'></font>
<font color=#447700>! declare local variables<a name='5564'></font>
<font color=#447700>!==============================================<a name='5565'></font>
real a_vflux(its:ite,0:kte+1)<a name='5566'>
integer i<a name='5567'>
integer i_end<a name='5568'>
integer i_start<a name='5569'>
integer j<a name='5570'>
integer j_end<a name='5571'>
integer j_start<a name='5572'>
integer k<a name='5573'>
integer ktf<a name='5574'>
real vflux(its:ite,0:kte+1)<a name='5575'>
<a name='5576'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_MP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_39">("a_vertical_diffusion_mp")<a name='5577'>
<a name='5578'>
<font color=#447700>!----------------------------------------------<a name='5579'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='5580'></font>
<font color=#447700>!----------------------------------------------<a name='5581'></font>
a_vflux(:,:) = 0.<a name='5582'>
<a name='5583'>
<font color=#447700>!----------------------------------------------<a name='5584'></font>
<font color=#447700>! ROUTINE BODY<a name='5585'></font>
<font color=#447700>!----------------------------------------------<a name='5586'></font>
ktf = min(kte,kde-1)<a name='5587'>
<font color=#447700>! recompute : ktf<a name='5588'></font>
i_start = its<a name='5589'>
<font color=#447700>! recompute : i_start<a name='5590'></font>
i_end = min(ite,ide-1)<a name='5591'>
<font color=#447700>! recompute : i_end<a name='5592'></font>
j_start = jts<a name='5593'>
<font color=#447700>! recompute : j_start<a name='5594'></font>
j_end = min(jte,jde-1)<a name='5595'>
<font color=#447700>! recompute : j_end<a name='5596'></font>
do j = j_start, j_end<a name='5597'>
  do k = kts, ktf-1<a name='5598'>
    do i = i_start, i_end<a name='5599'>
      vflux(i,k) = kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-base(k+1)+base(k))<a name='5600'>
    end do<a name='5601'>
  end do<a name='5602'>
<font color=#447700>! recompute : vflux<a name='5603'></font>
  do i = i_start, i_end<a name='5604'>
    vflux(i,0) = vflux(i,1)<a name='5605'>
  end do<a name='5606'>
  do i = i_start, i_end<a name='5607'>
    vflux(i,ktf) = 0.<a name='5608'>
  end do<a name='5609'>
<font color=#447700>! recompute : vflux<a name='5610'></font>
  do k = kts, ktf<a name='5611'>
    do i = i_start, i_end<a name='5612'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_tendency(i,k,j)*g*g/mut(i,j)/(alt(i,k,j)*alt(i,k,j))*rdnw(k)*(vflux(i,k)-vflux(i,k-1))<a name='5613'>
      a_mut(i,j) = a_mut(i,j)-a_tendency(i,k,j)*g*g/(mut(i,j)*mut(i,j))/alt(i,k,j)*rdnw(k)*(vflux(i,k)-vflux(i,k-1))<a name='5614'>
      a_vflux(i,k-1) = a_vflux(i,k-1)-a_tendency(i,k,j)*g*g/mut(i,j)/alt(i,k,j)*rdnw(k)<a name='5615'>
      a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*g*g/mut(i,j)/alt(i,k,j)*rdnw(k)<a name='5616'>
    end do<a name='5617'>
  end do<a name='5618'>
  do i = i_start, i_end<a name='5619'>
    a_vflux(i,ktf) = 0.<a name='5620'>
  end do<a name='5621'>
  do i = i_start, i_end<a name='5622'>
    a_vflux(i,1) = a_vflux(i,1)+a_vflux(i,0)<a name='5623'>
    a_vflux(i,0) = 0.<a name='5624'>
  end do<a name='5625'>
  do k = kts, ktf-1<a name='5626'>
    do i = i_start, i_end<a name='5627'>
      a_alt(i,k+1,j) = a_alt(i,k+1,j)-a_vflux(i,k)*0.5*kvdif*rdn(k+1)/(0.5*0.5*(alt(i,k,j)+alt(i,k+1,j))*(alt(i,k,j)+alt(i,k+1,j)))&amp;<a name='5628'>
&amp;*(field(i,k+1,j)-field(i,k,j)-base(k+1)+base(k))<a name='5629'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_vflux(i,k)*0.5*kvdif*rdn(k+1)/(0.5*0.5*(alt(i,k,j)+alt(i,k+1,j))*(alt(i,k,j)+alt(i,k+1,j)))*&amp;<a name='5630'>
&amp;(field(i,k+1,j)-field(i,k,j)-base(k+1)+base(k))<a name='5631'>
      a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*(kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j))))<a name='5632'>
      a_field(i,k,j) = a_field(i,k,j)-a_vflux(i,k)*(kvdif*rdn(k+1)/(0.5*(alt(i,k,j)+alt(i,k+1,j))))<a name='5633'>
      a_vflux(i,k) = 0.<a name='5634'>
    end do<a name='5635'>
  end do<a name='5636'>
end do<a name='5637'>
<a name='5638'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_MP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_39">("a_vertical_diffusion_mp")<a name='5639'>
<a name='5640'>
end subroutine a_vertical_diffusion_mp<a name='5641'>
<a name='5642'>
<a name='5643'>
<A NAME='A_VERTICAL_DIFFUSION_U'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_U' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5644'>
<font color=#993300>subroutine </font><font color=#cc0000>a_vertical_diffusion_u</font>( field, a_field, a_tendency, config_flags, u_base, alt, a_alt, muu, a_muu, rdn, rdnw, kvdif, ids,&amp; <A href='../../call_to/A_VERTICAL_DIFFUSION_U.html' TARGET='index'>2</A>,<A href='../../call_from/A_VERTICAL_DIFFUSION_U.html' TARGET='index'>2</A><a name='5645'>
&amp; ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='5646'>
<font color=#447700>!******************************************************************<a name='5647'></font>
<font color=#447700>!******************************************************************<a name='5648'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5649'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5650'></font>
<font color=#447700>!******************************************************************<a name='5651'></font>
<font color=#447700>!******************************************************************<a name='5652'></font>
<font color=#447700>!==============================================<a name='5653'></font>
<font color=#447700>! all entries are defined explicitly<a name='5654'></font>
<font color=#447700>!==============================================<a name='5655'></font>
implicit none<a name='5656'>
<a name='5657'>
<font color=#447700>!==============================================<a name='5658'></font>
<font color=#447700>! declare arguments<a name='5659'></font>
<font color=#447700>!==============================================<a name='5660'></font>
integer, intent(in) :: ime<a name='5661'>
integer, intent(in) :: ims<a name='5662'>
integer, intent(in) :: jme<a name='5663'>
integer, intent(in) :: jms<a name='5664'>
integer, intent(in) :: kme<a name='5665'>
integer, intent(in) :: kms<a name='5666'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='5667'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='5668'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='5669'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='5670'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='5671'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='5672'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='5673'>
integer, intent(in) :: ide<a name='5674'>
integer, intent(in) :: ids<a name='5675'>
integer, intent(in) :: ite<a name='5676'>
integer, intent(in) :: its<a name='5677'>
integer, intent(in) :: jde<a name='5678'>
integer, intent(in) :: jte<a name='5679'>
integer, intent(in) :: jts<a name='5680'>
integer, intent(in) :: kde<a name='5681'>
integer, intent(in) :: kte<a name='5682'>
integer, intent(in) :: kts<a name='5683'>
real, intent(in) :: kvdif<a name='5684'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='5685'>
real, intent(in) :: rdn(kms:kme)<a name='5686'>
real, intent(in) :: rdnw(kms:kme)<a name='5687'>
real, intent(in) :: u_base(kms:kme)<a name='5688'>
<a name='5689'>
<font color=#447700>!==============================================<a name='5690'></font>
<font color=#447700>! declare local variables<a name='5691'></font>
<font color=#447700>!==============================================<a name='5692'></font>
real a_vflux(its:ite,0:kte+1)<a name='5693'>
integer i<a name='5694'>
integer i_end<a name='5695'>
integer i_start<a name='5696'>
integer j<a name='5697'>
integer j_end<a name='5698'>
integer j_start<a name='5699'>
integer k<a name='5700'>
integer ktf<a name='5701'>
logical specified<a name='5702'>
real vflux(its:ite,0:kte+1)<a name='5703'>
<a name='5704'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_U' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_40">("a_vertical_diffusion_u")<a name='5705'>
<a name='5706'>
<font color=#447700>!----------------------------------------------<a name='5707'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='5708'></font>
<font color=#447700>!----------------------------------------------<a name='5709'></font>
a_vflux(:,:) = 0.<a name='5710'>
<a name='5711'>
<font color=#447700>!----------------------------------------------<a name='5712'></font>
<font color=#447700>! ROUTINE BODY<a name='5713'></font>
<font color=#447700>!----------------------------------------------<a name='5714'></font>
specified =  .false. <a name='5715'>
<font color=#447700>! recompute : specified<a name='5716'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='5717'>
  specified =  .true. <a name='5718'>
endif<a name='5719'>
<font color=#447700>! recompute : specified<a name='5720'></font>
ktf = min(kte,kde-1)<a name='5721'>
<font color=#447700>! recompute : ktf<a name='5722'></font>
i_start = its<a name='5723'>
<font color=#447700>! recompute : i_start<a name='5724'></font>
i_end = ite<a name='5725'>
<font color=#447700>! recompute : i_end<a name='5726'></font>
j_start = jts<a name='5727'>
<font color=#447700>! recompute : j_start<a name='5728'></font>
j_end = min(jte,jde-1)<a name='5729'>
<font color=#447700>! recompute : j_end<a name='5730'></font>
if (config_flags%open_xs .or. specified) then<a name='5731'>
  i_start = max(ids+1,its)<a name='5732'>
endif<a name='5733'>
<font color=#447700>! recompute : i_start<a name='5734'></font>
if (config_flags%open_xe .or. specified) then<a name='5735'>
  i_end = min(ide-1,ite)<a name='5736'>
endif<a name='5737'>
<font color=#447700>! recompute : i_end<a name='5738'></font>
do j = j_start, j_end<a name='5739'>
  do k = kts, ktf-1<a name='5740'>
    do i = i_start, i_end<a name='5741'>
      vflux(i,k) = kvdif*rdn(k+1)/(0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-&amp;<a name='5742'>
&amp;u_base(k+1)+u_base(k))<a name='5743'>
    end do<a name='5744'>
  end do<a name='5745'>
<font color=#447700>! recompute : vflux<a name='5746'></font>
  do i = i_start, i_end<a name='5747'>
    vflux(i,0) = vflux(i,1)<a name='5748'>
  end do<a name='5749'>
  do i = i_start, i_end<a name='5750'>
    vflux(i,ktf) = 0.<a name='5751'>
  end do<a name='5752'>
<font color=#447700>! recompute : vflux<a name='5753'></font>
  do k = kts, ktf-1<a name='5754'>
    do i = i_start, i_end<a name='5755'>
      a_alt(i-1,k,j) = a_alt(i-1,k,j)-a_tendency(i,k,j)*0.5*(g*g*rdnw(k)/muu(i,j))/(0.5*0.5*(alt(i-1,k,j)+alt(i,k,j))*(alt(i-1,k,j)&amp;<a name='5756'>
&amp;+alt(i,k,j)))*(vflux(i,k)-vflux(i,k-1))<a name='5757'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_tendency(i,k,j)*0.5*(g*g*rdnw(k)/muu(i,j))/(0.5*0.5*(alt(i-1,k,j)+alt(i,k,j))*(alt(i-1,k,j)+&amp;<a name='5758'>
&amp;alt(i,k,j)))*(vflux(i,k)-vflux(i,k-1))<a name='5759'>
      a_muu(i,j) = a_muu(i,j)-a_tendency(i,k,j)*g*g*rdnw(k)/(muu(i,j)*muu(i,j))/(0.5*(alt(i-1,k,j)+alt(i,k,j)))*(vflux(i,k)-&amp;<a name='5760'>
&amp;vflux(i,k-1))<a name='5761'>
      a_vflux(i,k-1) = a_vflux(i,k-1)-a_tendency(i,k,j)*(g*g*rdnw(k)/muu(i,j)/(0.5*(alt(i-1,k,j)+alt(i,k,j))))<a name='5762'>
      a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*(g*g*rdnw(k)/muu(i,j)/(0.5*(alt(i-1,k,j)+alt(i,k,j))))<a name='5763'>
    end do<a name='5764'>
  end do<a name='5765'>
  do i = i_start, i_end<a name='5766'>
    a_vflux(i,ktf) = 0.<a name='5767'>
  end do<a name='5768'>
  do i = i_start, i_end<a name='5769'>
    a_vflux(i,1) = a_vflux(i,1)+a_vflux(i,0)<a name='5770'>
    a_vflux(i,0) = 0.<a name='5771'>
  end do<a name='5772'>
  do k = kts, ktf-1<a name='5773'>
    do i = i_start, i_end<a name='5774'>
      a_alt(i-1,k+1,j) = a_alt(i-1,k+1,j)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-&amp;<a name='5775'>
&amp;1,k+1,j))*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-u_base(k+1)+u_base(k))<a name='5776'>
      a_alt(i,k+1,j) = a_alt(i,k+1,j)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+&amp;<a name='5777'>
&amp;1,j))*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-u_base(k+1)+u_base(k))<a name='5778'>
      a_alt(i-1,k,j) = a_alt(i-1,k,j)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+&amp;<a name='5779'>
&amp;1,j))*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-u_base(k+1)+u_base(k))<a name='5780'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j))&amp;<a name='5781'>
&amp;*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j)))*(field(i,k+1,j)-field(i,k,j)-u_base(k+1)+u_base(k))<a name='5782'>
      a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*(kvdif*rdn(k+1)/(0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j))))<a name='5783'>
      a_field(i,k,j) = a_field(i,k,j)-a_vflux(i,k)*(kvdif*rdn(k+1)/(0.25*(alt(i,k,j)+alt(i-1,k,j)+alt(i,k+1,j)+alt(i-1,k+1,j))))<a name='5784'>
      a_vflux(i,k) = 0.<a name='5785'>
    end do<a name='5786'>
  end do<a name='5787'>
end do<a name='5788'>
<a name='5789'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_U' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_40">("a_vertical_diffusion_u")<a name='5790'>
<a name='5791'>
end subroutine a_vertical_diffusion_u<a name='5792'>
<a name='5793'>
<a name='5794'>
<A NAME='A_VERTICAL_DIFFUSION_V'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_V' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5795'>
<font color=#993300>subroutine </font><font color=#cc0000>a_vertical_diffusion_v</font>( field, a_field, a_tendency, config_flags, v_base, alt, a_alt, muv, a_muv, rdn, rdnw, kvdif, ide,&amp; <A href='../../call_to/A_VERTICAL_DIFFUSION_V.html' TARGET='index'>2</A>,<A href='../../call_from/A_VERTICAL_DIFFUSION_V.html' TARGET='index'>2</A><a name='5796'>
&amp; jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='5797'>
<font color=#447700>!******************************************************************<a name='5798'></font>
<font color=#447700>!******************************************************************<a name='5799'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5800'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5801'></font>
<font color=#447700>!******************************************************************<a name='5802'></font>
<font color=#447700>!******************************************************************<a name='5803'></font>
<font color=#447700>!==============================================<a name='5804'></font>
<font color=#447700>! all entries are defined explicitly<a name='5805'></font>
<font color=#447700>!==============================================<a name='5806'></font>
implicit none<a name='5807'>
<a name='5808'>
<font color=#447700>!==============================================<a name='5809'></font>
<font color=#447700>! declare arguments<a name='5810'></font>
<font color=#447700>!==============================================<a name='5811'></font>
integer, intent(in) :: ime<a name='5812'>
integer, intent(in) :: ims<a name='5813'>
integer, intent(in) :: jme<a name='5814'>
integer, intent(in) :: jms<a name='5815'>
integer, intent(in) :: kme<a name='5816'>
integer, intent(in) :: kms<a name='5817'>
real, intent(inout) :: a_alt(ims:ime,kms:kme,jms:jme)<a name='5818'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='5819'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='5820'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='5821'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='5822'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='5823'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='5824'>
integer, intent(in) :: ide<a name='5825'>
integer, intent(in) :: ite<a name='5826'>
integer, intent(in) :: its<a name='5827'>
integer, intent(in) :: jde<a name='5828'>
integer, intent(in) :: jds<a name='5829'>
integer, intent(in) :: jte<a name='5830'>
integer, intent(in) :: jts<a name='5831'>
integer, intent(in) :: kde<a name='5832'>
integer, intent(in) :: kte<a name='5833'>
integer, intent(in) :: kts<a name='5834'>
real, intent(in) :: kvdif<a name='5835'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='5836'>
real, intent(in) :: rdn(kms:kme)<a name='5837'>
real, intent(in) :: rdnw(kms:kme)<a name='5838'>
real, intent(in) :: v_base(kms:kme)<a name='5839'>
<a name='5840'>
<font color=#447700>!==============================================<a name='5841'></font>
<font color=#447700>! declare local variables<a name='5842'></font>
<font color=#447700>!==============================================<a name='5843'></font>
real a_vflux(its:ite,0:kte+1)<a name='5844'>
integer i<a name='5845'>
integer i_end<a name='5846'>
integer i_start<a name='5847'>
integer j<a name='5848'>
integer j_end<a name='5849'>
integer j_start<a name='5850'>
integer jm1<a name='5851'>
integer k<a name='5852'>
integer ktf<a name='5853'>
logical specified<a name='5854'>
real vflux(its:ite,0:kte+1)<a name='5855'>
<a name='5856'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_V' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_41">("a_vertical_diffusion_v")<a name='5857'>
<a name='5858'>
<font color=#447700>!----------------------------------------------<a name='5859'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='5860'></font>
<font color=#447700>!----------------------------------------------<a name='5861'></font>
a_vflux(:,:) = 0.<a name='5862'>
<a name='5863'>
<font color=#447700>!----------------------------------------------<a name='5864'></font>
<font color=#447700>! ROUTINE BODY<a name='5865'></font>
<font color=#447700>!----------------------------------------------<a name='5866'></font>
specified =  .false. <a name='5867'>
<font color=#447700>! recompute : specified<a name='5868'></font>
if (config_flags%specified .or. config_flags%nested) then<a name='5869'>
  specified =  .true. <a name='5870'>
endif<a name='5871'>
<font color=#447700>! recompute : specified<a name='5872'></font>
ktf = min(kte,kde-1)<a name='5873'>
<font color=#447700>! recompute : ktf<a name='5874'></font>
i_start = its<a name='5875'>
<font color=#447700>! recompute : i_start<a name='5876'></font>
i_end = min(ite,ide-1)<a name='5877'>
<font color=#447700>! recompute : i_end<a name='5878'></font>
j_start = jts<a name='5879'>
<font color=#447700>! recompute : j_start<a name='5880'></font>
j_end = min(jte,jde-1)<a name='5881'>
<font color=#447700>! recompute : j_end<a name='5882'></font>
if (config_flags%open_ys .or. specified) then<a name='5883'>
  j_start = max(jds+1,jts)<a name='5884'>
endif<a name='5885'>
<font color=#447700>! recompute : j_start<a name='5886'></font>
if (config_flags%open_ye .or. specified) then<a name='5887'>
  j_end = min(jde-1,jte)<a name='5888'>
endif<a name='5889'>
<font color=#447700>! recompute : j_end<a name='5890'></font>
do j = j_start, j_end<a name='5891'>
  jm1 = j-1<a name='5892'>
<font color=#447700>! recompute : jm1<a name='5893'></font>
  do k = kts, ktf-1<a name='5894'>
    do i = i_start, i_end<a name='5895'>
      vflux(i,k) = kvdif*rdn(k+1)/(0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1)))*(field(i,k+1,j)-field(i,k,j)-&amp;<a name='5896'>
&amp;v_base(k+1)+v_base(k))<a name='5897'>
    end do<a name='5898'>
  end do<a name='5899'>
<font color=#447700>! recompute : vflux<a name='5900'></font>
  do i = i_start, i_end<a name='5901'>
    vflux(i,0) = vflux(i,1)<a name='5902'>
  end do<a name='5903'>
  do i = i_start, i_end<a name='5904'>
    vflux(i,ktf) = 0.<a name='5905'>
  end do<a name='5906'>
<font color=#447700>! recompute : vflux<a name='5907'></font>
  do k = kts, ktf-1<a name='5908'>
    do i = i_start, i_end<a name='5909'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_tendency(i,k,j)*0.5*(g*g*rdnw(k)/muv(i,j))/(0.5*0.5*(alt(i,k,jm1)+alt(i,k,j))*(alt(i,k,jm1)+&amp;<a name='5910'>
&amp;alt(i,k,j)))*(vflux(i,k)-vflux(i,k-1))<a name='5911'>
      a_alt(i,k,jm1) = a_alt(i,k,jm1)-a_tendency(i,k,j)*0.5*(g*g*rdnw(k)/muv(i,j))/(0.5*0.5*(alt(i,k,jm1)+alt(i,k,j))*(alt(i,k,jm1)&amp;<a name='5912'>
&amp;+alt(i,k,j)))*(vflux(i,k)-vflux(i,k-1))<a name='5913'>
      a_muv(i,j) = a_muv(i,j)-a_tendency(i,k,j)*g*g*rdnw(k)/(muv(i,j)*muv(i,j))/(0.5*(alt(i,k,jm1)+alt(i,k,j)))*(vflux(i,k)-&amp;<a name='5914'>
&amp;vflux(i,k-1))<a name='5915'>
      a_vflux(i,k-1) = a_vflux(i,k-1)-a_tendency(i,k,j)*(g*g*rdnw(k)/muv(i,j)/(0.5*(alt(i,k,jm1)+alt(i,k,j))))<a name='5916'>
      a_vflux(i,k) = a_vflux(i,k)+a_tendency(i,k,j)*(g*g*rdnw(k)/muv(i,j)/(0.5*(alt(i,k,jm1)+alt(i,k,j))))<a name='5917'>
    end do<a name='5918'>
  end do<a name='5919'>
  do i = i_start, i_end<a name='5920'>
    a_vflux(i,ktf) = 0.<a name='5921'>
  end do<a name='5922'>
  do i = i_start, i_end<a name='5923'>
    a_vflux(i,1) = a_vflux(i,1)+a_vflux(i,0)<a name='5924'>
    a_vflux(i,0) = 0.<a name='5925'>
  end do<a name='5926'>
  do k = kts, ktf-1<a name='5927'>
    do i = i_start, i_end<a name='5928'>
      a_alt(i,k+1,j) = a_alt(i,k+1,j)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,&amp;<a name='5929'>
&amp;jm1))*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1)))*(field(i,k+1,j)-field(i,k,j)-v_base(k+1)+v_base(k))<a name='5930'>
      a_alt(i,k+1,jm1) = a_alt(i,k+1,jm1)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,&amp;<a name='5931'>
&amp;k+1,jm1))*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1)))*(field(i,k+1,j)-field(i,k,j)-v_base(k+1)+v_base(k))<a name='5932'>
      a_alt(i,k,j) = a_alt(i,k,j)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1))&amp;<a name='5933'>
&amp;*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1)))*(field(i,k+1,j)-field(i,k,j)-v_base(k+1)+v_base(k))<a name='5934'>
      a_alt(i,k,jm1) = a_alt(i,k,jm1)-a_vflux(i,k)*0.25*kvdif*rdn(k+1)/(0.25*0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,&amp;<a name='5935'>
&amp;jm1))*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1)))*(field(i,k+1,j)-field(i,k,j)-v_base(k+1)+v_base(k))<a name='5936'>
      a_field(i,k+1,j) = a_field(i,k+1,j)+a_vflux(i,k)*(kvdif*rdn(k+1)/(0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1))))<a name='5937'>
      a_field(i,k,j) = a_field(i,k,j)-a_vflux(i,k)*(kvdif*rdn(k+1)/(0.25*(alt(i,k,j)+alt(i,k,jm1)+alt(i,k+1,j)+alt(i,k+1,jm1))))<a name='5938'>
      a_vflux(i,k) = 0.<a name='5939'>
    end do<a name='5940'>
  end do<a name='5941'>
end do<a name='5942'>
<a name='5943'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_VERTICAL_DIFFUSION_V' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_41">("a_vertical_diffusion_v")<a name='5944'>
<a name='5945'>
end subroutine a_vertical_diffusion_v<a name='5946'>
<a name='5947'>
<a name='5948'>
<A NAME='A_W_DAMP'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_W_DAMP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5949'>
<font color=#993300>subroutine </font><font color=#cc0000>a_w_damp</font>( a_rw_tend, ww, a_ww, w, a_w, mut, a_mut, rdnw, dt, ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts,&amp; <A href='../../call_to/A_W_DAMP.html' TARGET='index'>1</A>,<A href='../../call_from/A_W_DAMP.html' TARGET='index'>2</A><a name='5950'>
&amp; jte )<a name='5951'>
<font color=#447700>!******************************************************************<a name='5952'></font>
<font color=#447700>!******************************************************************<a name='5953'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='5954'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='5955'></font>
<font color=#447700>!******************************************************************<a name='5956'></font>
<font color=#447700>!******************************************************************<a name='5957'></font>
<font color=#447700>!==============================================<a name='5958'></font>
<font color=#447700>! all entries are defined explicitly<a name='5959'></font>
<font color=#447700>!==============================================<a name='5960'></font>
implicit none<a name='5961'>
<a name='5962'>
<font color=#447700>!==============================================<a name='5963'></font>
<font color=#447700>! declare arguments<a name='5964'></font>
<font color=#447700>!==============================================<a name='5965'></font>
integer, intent(in) :: ime<a name='5966'>
integer, intent(in) :: ims<a name='5967'>
integer, intent(in) :: jme<a name='5968'>
integer, intent(in) :: jms<a name='5969'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='5970'>
integer, intent(in) :: kme<a name='5971'>
integer, intent(in) :: kms<a name='5972'>
real, intent(inout) :: a_rw_tend(ims:ime,kms:kme,jms:jme)<a name='5973'>
real, intent(inout) :: a_w(ims:ime,kms:kme,jms:jme)<a name='5974'>
real, intent(inout) :: a_ww(ims:ime,kms:kme,jms:jme)<a name='5975'>
real, intent(in) :: dt<a name='5976'>
integer, intent(in) :: ide<a name='5977'>
integer, intent(in) :: ite<a name='5978'>
integer, intent(in) :: its<a name='5979'>
integer, intent(in) :: jde<a name='5980'>
integer, intent(in) :: jte<a name='5981'>
integer, intent(in) :: jts<a name='5982'>
integer, intent(in) :: kde<a name='5983'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='5984'>
real, intent(in) :: rdnw(kms:kme)<a name='5985'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='5986'>
real, intent(in) :: ww(ims:ime,kms:kme,jms:jme)<a name='5987'>
<a name='5988'>
<font color=#447700>!==============================================<a name='5989'></font>
<font color=#447700>! declare local variables<a name='5990'></font>
<font color=#447700>!==============================================<a name='5991'></font>
real a_cf_d<a name='5992'>
real a_cf_n<a name='5993'>
real cf_d<a name='5994'>
real cf_n<a name='5995'>
real cfl<a name='5996'>
integer i<a name='5997'>
integer itf<a name='5998'>
integer j<a name='5999'>
integer jtf<a name='6000'>
integer k<a name='6001'>
<a name='6002'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_W_DAMP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_42">("a_w_damp")<a name='6003'>
<a name='6004'>
<font color=#447700>!----------------------------------------------<a name='6005'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='6006'></font>
<font color=#447700>!----------------------------------------------<a name='6007'></font>
a_cf_d = 0.<a name='6008'>
a_cf_n = 0.<a name='6009'>
<a name='6010'>
<font color=#447700>!----------------------------------------------<a name='6011'></font>
<font color=#447700>! ROUTINE BODY<a name='6012'></font>
<font color=#447700>!----------------------------------------------<a name='6013'></font>
itf = min(ite,ide-1)<a name='6014'>
<font color=#447700>! recompute : itf<a name='6015'></font>
jtf = min(jte,jde-1)<a name='6016'>
<font color=#447700>! recompute : jtf<a name='6017'></font>
do j = jts, jtf<a name='6018'>
  a_cf_d = 0.<a name='6019'>
  a_cf_n = 0.<a name='6020'>
  do k = 2, kde-1<a name='6021'>
    a_cf_d = 0.<a name='6022'>
    a_cf_n = 0.<a name='6023'>
    do i = its, itf<a name='6024'>
      a_cf_d = 0.<a name='6025'>
      a_cf_n = 0.<a name='6026'>
      cf_n = abs(ww(i,k,j))<a name='6027'>
<font color=#447700>! recompute : cf_n<a name='6028'></font>
      cf_d = abs(mut(i,j)*rdnw(k)*dt)<a name='6029'>
<font color=#447700>! recompute : cf_d<a name='6030'></font>
      if (cf_n .gt. cf_d*w_beta) then<a name='6031'>
        a_mut(i,j) = a_mut(i,j)-a_rw_tend(i,k,j)*w_alpha*(cfl-w_beta)*sign(1.,w(i,k,j))<a name='6032'>
      endif<a name='6033'>
      a_mut(i,j) = a_mut(i,j)+a_cf_d*rdnw(k)*dt*sign(1.,mut(i,j)*rdnw(k)*dt)<a name='6034'>
      a_cf_d = 0.<a name='6035'>
      a_ww(i,k,j) = a_ww(i,k,j)+a_cf_n*sign(1.,ww(i,k,j))<a name='6036'>
      a_cf_n = 0.<a name='6037'>
    end do<a name='6038'>
  end do<a name='6039'>
end do<a name='6040'>
<a name='6041'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_W_DAMP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_42">("a_w_damp")<a name='6042'>
<a name='6043'>
end subroutine a_w_damp<a name='6044'>
<a name='6045'>
<a name='6046'>
<A NAME='A_ZERO_TEND'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_ZERO_TEND' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6047'>
<font color=#993300>subroutine </font><font color=#cc0000>a_zero_tend</font>( a_tendency, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte ) <A href='../../call_to/A_ZERO_TEND.html' TARGET='index'>18</A><a name='6048'>
<font color=#447700>!******************************************************************<a name='6049'></font>
<font color=#447700>!******************************************************************<a name='6050'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='6051'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='6052'></font>
<font color=#447700>!******************************************************************<a name='6053'></font>
<font color=#447700>!******************************************************************<a name='6054'></font>
<font color=#447700>!==============================================<a name='6055'></font>
<font color=#447700>! all entries are defined explicitly<a name='6056'></font>
<font color=#447700>!==============================================<a name='6057'></font>
implicit none<a name='6058'>
<a name='6059'>
<font color=#447700>!==============================================<a name='6060'></font>
<font color=#447700>! declare arguments<a name='6061'></font>
<font color=#447700>!==============================================<a name='6062'></font>
integer, intent(in) :: ime<a name='6063'>
integer, intent(in) :: ims<a name='6064'>
integer, intent(in) :: jme<a name='6065'>
integer, intent(in) :: jms<a name='6066'>
integer, intent(in) :: kme<a name='6067'>
integer, intent(in) :: kms<a name='6068'>
real, intent(inout) :: a_tendency(ims:ime,kms:kme,jms:jme)<a name='6069'>
integer, intent(in) :: ite<a name='6070'>
integer, intent(in) :: its<a name='6071'>
integer, intent(in) :: jte<a name='6072'>
integer, intent(in) :: jts<a name='6073'>
integer, intent(in) :: kte<a name='6074'>
integer, intent(in) :: kts<a name='6075'>
<a name='6076'>
<font color=#447700>!==============================================<a name='6077'></font>
<font color=#447700>! declare local variables<a name='6078'></font>
<font color=#447700>!==============================================<a name='6079'></font>
integer i<a name='6080'>
integer j<a name='6081'>
integer k<a name='6082'>
<a name='6083'>
<font color=#447700>!----------------------------------------------<a name='6084'></font>
<font color=#447700>! ROUTINE BODY<a name='6085'></font>
<font color=#447700>!----------------------------------------------<a name='6086'></font>
<font color=#447700>! TBH:  Fill in halos since we know what they must be to avoid <a name='6087'></font>
<font color=#447700>! TBH:  halo updates.  <a name='6088'></font>
do j = jms, jme<a name='6089'>
  do k = kms, kme<a name='6090'>
    do i = ims, ime<a name='6091'>
      a_tendency(i,k,j) = 0.<a name='6092'>
    end do<a name='6093'>
  end do<a name='6094'>
end do<a name='6095'>
<a name='6096'>
end subroutine a_zero_tend<a name='6097'>
<a name='6098'>
<font color=#447700>!Zhang Xiaoyan 11/02/2006<a name='6099'></font>
<a name='6100'>
<font color=#447700>!*************************************************************<a name='6101'></font>
<A NAME='A_SURFACE_DRAG'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_SURFACE_DRAG' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6102'>
<font color=#993300>subroutine </font><font color=#cc0000>a_surface_drag</font>(ru_tendf, a_ru_tendf, rv_tendf, a_rv_tendf, u, a_u, v, a_v, xland, muu, a_muu, muv, a_muv, z, &amp; <A href='../../call_to/A_SURFACE_DRAG.html' TARGET='index'>2</A>,<A href='../../call_from/A_SURFACE_DRAG.html' TARGET='index'>2</A><a name='6103'>
&amp;a_z, z_at_w, a_z_at_w, &amp;<a name='6104'>
             ids, ide, jds, jde, kds, kde, &amp;<a name='6105'>
             ims, ime, jms, jme, kms, kme, &amp;<a name='6106'>
             its, ite, jts, jte, kts, kte )<a name='6107'>
<a name='6108'>
<font color=#447700>!USE module_big_step_utilities_em<a name='6109'></font>
implicit none<a name='6110'>
<a name='6111'>
<font color=#447700>!==============================================<a name='6112'></font>
<font color=#447700>! declare arguments<a name='6113'></font>
<font color=#447700>!==============================================<a name='6114'></font>
integer, intent(in) :: ime<a name='6115'>
integer, intent(in) :: ims<a name='6116'>
integer, intent(in) :: jme<a name='6117'>
integer, intent(in) :: jms<a name='6118'>
real, intent(inout) :: a_muu(ims:ime,jms:jme)<a name='6119'>
real, intent(inout) :: a_muv(ims:ime,jms:jme)<a name='6120'>
integer, intent(in) :: kme<a name='6121'>
integer, intent(in) :: kms<a name='6122'>
real, intent(inout) :: a_ru_tendf(ims:ime,kms:kme,jms:jme)<a name='6123'>
real, intent(inout) :: a_rv_tendf(ims:ime,kms:kme,jms:jme)<a name='6124'>
real, intent(inout) :: a_u(ims:ime,kms:kme,jms:jme)<a name='6125'>
real, intent(inout) :: a_v(ims:ime,kms:kme,jms:jme)<a name='6126'>
real, intent(inout) :: a_z(ims:ime,kms:kme,jms:jme)<a name='6127'>
real, intent(inout) :: a_z_at_w(ims:ime,kms:kme,jms:jme)<a name='6128'>
<font color=#447700>!real epsilon<a name='6129'></font>
integer, intent(in) :: ids<a name='6130'>
integer, intent(in) :: ide<a name='6131'>
integer, intent(in) :: ite <a name='6132'>
integer, intent(in) :: its<a name='6133'>
integer, intent(in) :: jds<a name='6134'>
integer, intent(in) :: jde<a name='6135'>
integer, intent(in) :: jte<a name='6136'>
integer, intent(in) :: jts<a name='6137'>
integer, intent(in) :: kde<a name='6138'>
integer, intent(in) :: kds<a name='6139'>
integer, intent(in) :: kte<a name='6140'>
integer, intent(in) :: kts<a name='6141'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='6142'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='6143'>
real, intent(inout) :: ru_tendf(ims:ime,kms:kme,jms:jme)<a name='6144'>
real, intent(inout) :: rv_tendf(ims:ime,kms:kme,jms:jme)<a name='6145'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='6146'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='6147'>
real, intent(in) :: xland(ims:ime,jms:jme)<a name='6148'>
real, intent(in) :: z(ims:ime,kms:kme,jms:jme)<a name='6149'>
real, intent(in) :: z_at_w(ims:ime,kms:kme,jms:jme)<a name='6150'>
<a name='6151'>
<font color=#447700>!==============================================<a name='6152'></font>
<font color=#447700>! declare local variables<a name='6153'></font>
<font color=#447700>!==============================================<a name='6154'></font>
real a_cd<a name='6155'>
real a_tao_xz<a name='6156'>
real a_tao_yz<a name='6157'>
real a_v0_u<a name='6158'>
real a_v0_ui<a name='6159'>
real a_v0_v<a name='6160'>
real a_v0_vi<a name='6161'>
real a_zu<a name='6162'>
real a_zv<a name='6163'>
real a_zwt<a name='6164'>
real cd <a name='6165'>
integer i<a name='6166'>
integer i_end<a name='6167'>
integer i_endu<a name='6168'>
integer i_start<a name='6169'>
integer j<a name='6170'>
integer j_end<a name='6171'>
integer j_endv<a name='6172'>
integer j_start<a name='6173'>
integer k<a name='6174'>
real tao_xz<a name='6175'>
real tao_yz<a name='6176'>
real v0_u<a name='6177'>
real v0_v<a name='6178'>
real zu<a name='6179'>
real zv<a name='6180'>
real zwt<a name='6181'>
<a name='6182'>
REAL, PARAMETER :: epsilon = 1.e-10<a name='6183'>
<a name='6184'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_SURFACE_DRAG' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_43">("a_surface_drag")<a name='6185'>
<a name='6186'>
<font color=#447700>!----------------------------------------------<a name='6187'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='6188'></font>
<font color=#447700>!----------------------------------------------<a name='6189'></font>
a_cd = 0.<a name='6190'>
a_tao_xz = 0.<a name='6191'>
a_tao_yz = 0.<a name='6192'>
a_v0_u = 0.<a name='6193'>
a_v0_v = 0.<a name='6194'>
a_zu = 0.<a name='6195'>
a_zv = 0.<a name='6196'>
a_zwt = 0.<a name='6197'>
<a name='6198'>
<font color=#447700>!----------------------------------------------<a name='6199'></font>
<font color=#447700>! ROUTINE BODY<a name='6200'></font>
<font color=#447700>! ROUTINE BODY<a name='6201'></font>
<font color=#447700>!----------------------------------------------<a name='6202'></font>
<font color=#447700>!----------------------------------------------<a name='6203'></font>
<font color=#447700>! FUNCTION AND TAPE COMPUTATIONS<a name='6204'></font>
<font color=#447700>!----------------------------------------------<a name='6205'></font>
i_start = its<a name='6206'>
i_end = min(ite,ide-1)<a name='6207'>
i_endu = ite<a name='6208'>
j_start = jts<a name='6209'>
j_end = min(jte,jde-1)<a name='6210'>
j_endv = jte<a name='6211'>
#if 0<a name='6212'>
do j = j_start, j_end<a name='6213'>
  do i = i_start, i_endu<a name='6214'>
    v0_u = sqrt(u(i,kts,j)**2+((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/4)**2)+epsilon<a name='6215'>
    if (xland(i,j) .eq. xland(i-1,j)) then<a name='6216'>
      if (xland(i,j) .lt. 1.5) then<a name='6217'>
        cd = 0.01<a name='6218'>
      else <a name='6219'>
        cd = 0.001<a name='6220'>
        cd = max(cd,0.0001*v0_u)<a name='6221'>
        cd = min(cd,0.003)<a name='6222'>
      endif<a name='6223'>
    else <a name='6224'>
      cd = 0.003<a name='6225'>
    endif<a name='6226'>
    tao_xz = cd*v0_u*u(i,kts,j)<a name='6227'>
    do k = kts, kte<a name='6228'>
      zu = 0.5*(z(i,k,j)+z(i-1,k,j)-z_at_w(i,kts,j)-z_at_w(i-1,kts,j))<a name='6229'>
      if (zu .lt. 1000.) then<a name='6230'>
        zwt = 2.*(1000.-zu)/1000.<a name='6231'>
<font color=#447700>!X        ru_tendf(i,k,j) = ru_tendf(i,k,j)-zwt*0.5*muu(i,j)*tao_xz/1000.<a name='6232'></font>
      endif<a name='6233'>
    end do<a name='6234'>
  end do<a name='6235'>
end do<a name='6236'>
do j = j_start, j_endv<a name='6237'>
  do i = i_start, i_end<a name='6238'>
    v0_v = sqrt(v(i,kts,j)**2+((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/4)**2)+epsilon<a name='6239'>
    if (xland(i,j) .eq. xland(i,j-1)) then<a name='6240'>
      if (xland(i,j) .lt. 1.5) then<a name='6241'>
        cd = 0.01<a name='6242'>
      else<a name='6243'>
        cd = 0.001<a name='6244'>
        cd = max(cd,0.0001*v0_v)<a name='6245'>
        cd = min(cd,0.003)<a name='6246'>
      endif<a name='6247'>
    else<a name='6248'>
      cd = 0.003<a name='6249'>
    endif<a name='6250'>
    tao_yz = cd*v0_v*v(i,kts,j)<a name='6251'>
    do k = kts, kte<a name='6252'>
      zv = 0.5*(z(i,k,j)+z(i,k,j-1)-z_at_w(i,kts,j)-z_at_w(i,kts,j-1))<a name='6253'>
      if (zv .lt. 1000.) then<a name='6254'>
        zwt = 2.*(1000.-zv)/1000.<a name='6255'>
<font color=#447700>!X        rv_tendf(i,k,j) = rv_tendf(i,k,j)-zwt*0.5*muv(i,j)*tao_yz/1000.<a name='6256'></font>
      endif<a name='6257'>
    end do<a name='6258'>
  end do<a name='6259'>
end do<a name='6260'>
#endif<a name='6261'>
<a name='6262'>
<font color=#447700>!----------------------------------------------<a name='6263'></font>
<font color=#447700>! ADJOINT COMPUTATIONS<a name='6264'></font>
<font color=#447700>!----------------------------------------------<a name='6265'></font>
<font color=#447700>! recompute : i_start<a name='6266'></font>
<font color=#447700>! recompute : i_end<a name='6267'></font>
<font color=#447700>! recompute : i_endu<a name='6268'></font>
<font color=#447700>! recompute : j_start<a name='6269'></font>
<font color=#447700>! recompute : j_end<a name='6270'></font>
<font color=#447700>! recompute : j_endv<a name='6271'></font>
<font color=#447700>! TBH:  Redundant computation into halo region for X(i,j-1) = X(i,j-1) + ...<a name='6272'></font>
do j = min(j_endv+1,jde), j_start, -1<a name='6273'>
  <font color=#447700>! TBH:  Redundant computation into halo region for X(i+1,j) = X(i+1,j) + ...<a name='6274'></font>
  do i = i_end, max(i_start-1,ids), -1<a name='6275'>
    v0_v = sqrt(v(i,kts,j)**2+((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/4)**2)+epsilon<a name='6276'>
<font color=#447700>! recompute : v0_v<a name='6277'></font>
<font color=#447700>! recompute : v0_v<a name='6278'></font>
    if (xland(i,j) .eq. xland(i,j-1)) then<a name='6279'>
      if (xland(i,j) .lt. 1.5) then<a name='6280'>
        cd = 0.01<a name='6281'>
      else<a name='6282'>
        cd = 0.001<a name='6283'>
        cd = max(cd,0.0001*v0_v)<a name='6284'>
        cd = min(cd,0.003)<a name='6285'>
      endif<a name='6286'>
    else<a name='6287'>
      cd = 0.003<a name='6288'>
    endif<a name='6289'>
<font color=#447700>! recompute : cd<a name='6290'></font>
<font color=#447700>! recompute : cd<a name='6291'></font>
    tao_yz = cd*v0_v*v(i,kts,j)<a name='6292'>
<font color=#447700>! recompute : tao_yz<a name='6293'></font>
<font color=#447700>! recompute : tao_yz<a name='6294'></font>
    do k = kts, kte<a name='6295'>
      a_zv = 0.<a name='6296'>
      a_zwt = 0.<a name='6297'>
      zv = 0.5*(z(i,k,j)+z(i,k,j-1)-z_at_w(i,kts,j)-z_at_w(i,kts,j-1))<a name='6298'>
<font color=#447700>! recompute : zv<a name='6299'></font>
<font color=#447700>! recompute : zv<a name='6300'></font>
      if (zv .lt. 1000.) then<a name='6301'>
        zwt = 2.*(1000.-zv)/1000.<a name='6302'>
<font color=#447700>! recompute : zwt<a name='6303'></font>
<font color=#447700>! recompute : zwt<a name='6304'></font>
        a_muv(i,j) = a_muv(i,j)-a_rv_tendf(i,k,j)*(0.5*zwt*tao_yz/1000.)<a name='6305'>
        a_tao_yz = a_tao_yz-a_rv_tendf(i,k,j)*(0.5*zwt*muv(i,j)/1000.)<a name='6306'>
        a_zwt = a_zwt-a_rv_tendf(i,k,j)*(0.5*muv(i,j)*tao_yz/1000.)<a name='6307'>
        a_zv = a_zv-0.002*a_zwt<a name='6308'>
        a_zwt = 0.<a name='6309'>
      endif<a name='6310'>
      a_z(i,k,j-1) = a_z(i,k,j-1)+0.5*a_zv<a name='6311'>
      a_z(i,k,j) = a_z(i,k,j)+0.5*a_zv<a name='6312'>
      a_z_at_w(i,kts,j-1) = a_z_at_w(i,kts,j-1)-0.5*a_zv<a name='6313'>
      a_z_at_w(i,kts,j) = a_z_at_w(i,kts,j)-0.5*a_zv<a name='6314'>
      a_zv = 0.<a name='6315'>
    end do<a name='6316'>
    a_cd = a_cd+a_tao_yz*v0_v*v(i,kts,j)<a name='6317'>
    a_v(i,kts,j) = a_v(i,kts,j)+a_tao_yz*cd*v0_v<a name='6318'>
    a_v0_v = a_v0_v+a_tao_yz*cd*v(i,kts,j)<a name='6319'>
    a_tao_yz = 0.<a name='6320'>
    if (xland(i,j) .eq. xland(i,j-1)) then<a name='6321'>
      if (xland(i,j) .lt. 1.5) then<a name='6322'>
        a_cd = 0.<a name='6323'>
      else<a name='6324'>
        cd = 0.001<a name='6325'>
<font color=#447700>! recompute : cd<a name='6326'></font>
<font color=#447700>! recompute : cd<a name='6327'></font>
        cd = max(cd,0.0001*v0_v)<a name='6328'>
<font color=#447700>! recompute : cd<a name='6329'></font>
<font color=#447700>! recompute : cd<a name='6330'></font>
        a_cd = a_cd*(0.5+sign(0.5,0.003-cd))<a name='6331'>
<font color=#447700>! recompute pos : ASSIGN_STMT surface_drag.f90:90<a name='6332'></font>
<font color=#447700>! recompute vars : cd<a name='6333'></font>
        cd = 0.001<a name='6334'>
<font color=#447700>! recompute : cd<a name='6335'></font>
<font color=#447700>! recompute vars : cd<a name='6336'></font>
        a_v0_v = a_v0_v+0.0001*a_cd*(0.5-sign(0.5,cd-0.0001*v0_v))<a name='6337'>
        a_cd = a_cd*(0.5+sign(0.5,cd-0.0001*v0_v))<a name='6338'>
        a_cd = 0.<a name='6339'>
      endif<a name='6340'>
    else<a name='6341'>
      a_cd = 0.<a name='6342'>
    endif<a name='6343'>
    a_v0_vi = a_v0_v*(1./(2.*sqrt(v(i,kts,j)**2+((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/4)**2)))<a name='6344'>
    a_u(i+1,kts,j-1) = a_u(i+1,kts,j-1)+2*a_v0_vi/float(4)*((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/float(4))<a name='6345'>
    a_u(i,kts,j-1) = a_u(i,kts,j-1)+2*a_v0_vi/float(4)*((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/float(4))<a name='6346'>
    a_u(i+1,kts,j) = a_u(i+1,kts,j)+2*a_v0_vi/float(4)*((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/float(4))<a name='6347'>
    a_u(i,kts,j) = a_u(i,kts,j)+2*a_v0_vi/float(4)*((u(i,kts,j)+u(i,kts,j-1)+u(i+1,kts,j)+u(i+1,kts,j-1))/float(4))<a name='6348'>
    a_v(i,kts,j) = a_v(i,kts,j)+2*a_v0_vi*v(i,kts,j)<a name='6349'>
    a_v0_v = 0.<a name='6350'>
  end do<a name='6351'>
end do<a name='6352'>
<font color=#447700>! TBH:  Redundant computation into halo region for X(i,j+1) = X(i,j+1) + ...<a name='6353'></font>
do j = j_end, max(j_start-1,jds), -1<a name='6354'>
  <font color=#447700>! TBH:  Redundant computation into halo region for X(i-1,j) = X(i-1,j) + ...<a name='6355'></font>
  do i = min(i_endu+1,ide), i_start, -1<a name='6356'>
    v0_u = sqrt(u(i,kts,j)**2+((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/4)**2)+epsilon<a name='6357'>
<font color=#447700>! recompute : v0_u<a name='6358'></font>
<font color=#447700>! recompute : v0_u<a name='6359'></font>
    if (xland(i,j) .eq. xland(i-1,j)) then<a name='6360'>
      if (xland(i,j) .lt. 1.5) then<a name='6361'>
        cd = 0.01<a name='6362'>
      else<a name='6363'>
        cd = 0.001<a name='6364'>
        cd = max(cd,0.0001*v0_u)<a name='6365'>
        cd = min(cd,0.003)<a name='6366'>
      endif<a name='6367'>
    else<a name='6368'>
      cd = 0.003<a name='6369'>
    endif<a name='6370'>
<font color=#447700>! recompute : cd<a name='6371'></font>
<font color=#447700>! recompute : cd<a name='6372'></font>
    tao_xz = cd*v0_u*u(i,kts,j)<a name='6373'>
<font color=#447700>! recompute : tao_xz<a name='6374'></font>
<font color=#447700>! recompute : tao_xz<a name='6375'></font>
    do k = kts, kte<a name='6376'>
      a_zu = 0.<a name='6377'>
      a_zwt = 0.<a name='6378'>
      zu = 0.5*(z(i,k,j)+z(i-1,k,j)-z_at_w(i,kts,j)-z_at_w(i-1,kts,j))<a name='6379'>
<font color=#447700>! recompute : zu<a name='6380'></font>
<font color=#447700>! recompute : zu<a name='6381'></font>
      if (zu .lt. 1000.) then<a name='6382'>
        zwt = 2.*(1000.-zu)/1000.<a name='6383'>
<font color=#447700>! recompute : zwt<a name='6384'></font>
<font color=#447700>! recompute : zwt<a name='6385'></font>
        a_muu(i,j) = a_muu(i,j)-a_ru_tendf(i,k,j)*(0.5*zwt*tao_xz/1000.)<a name='6386'>
        a_tao_xz = a_tao_xz-a_ru_tendf(i,k,j)*(0.5*zwt*muu(i,j)/1000.)<a name='6387'>
        a_zwt = a_zwt-a_ru_tendf(i,k,j)*(0.5*muu(i,j)*tao_xz/1000.)<a name='6388'>
        a_zu = a_zu-0.002*a_zwt<a name='6389'>
        a_zwt = 0.<a name='6390'>
      endif<a name='6391'>
      a_z(i-1,k,j) = a_z(i-1,k,j)+0.5*a_zu<a name='6392'>
      a_z(i,k,j) = a_z(i,k,j)+0.5*a_zu<a name='6393'>
      a_z_at_w(i-1,kts,j) = a_z_at_w(i-1,kts,j)-0.5*a_zu<a name='6394'>
      a_z_at_w(i,kts,j) = a_z_at_w(i,kts,j)-0.5*a_zu<a name='6395'>
      a_zu = 0.<a name='6396'>
    end do<a name='6397'>
    a_cd = a_cd+a_tao_xz*v0_u*u(i,kts,j)<a name='6398'>
    a_u(i,kts,j) = a_u(i,kts,j)+a_tao_xz*cd*v0_u<a name='6399'>
    a_v0_u = a_v0_u+a_tao_xz*cd*u(i,kts,j)<a name='6400'>
    a_tao_xz = 0.<a name='6401'>
    if (xland(i,j) .eq. xland(i-1,j)) then<a name='6402'>
      if (xland(i,j) .lt. 1.5) then<a name='6403'>
        a_cd = 0.<a name='6404'>
      else<a name='6405'>
        cd = 0.001<a name='6406'>
<font color=#447700>! recompute : cd<a name='6407'></font>
<font color=#447700>! recompute : cd<a name='6408'></font>
        cd = max(cd,0.0001*v0_u)<a name='6409'>
<font color=#447700>! recompute : cd<a name='6410'></font>
<font color=#447700>! recompute : cd<a name='6411'></font>
        a_cd = a_cd*(0.5+sign(0.5,0.003-cd))<a name='6412'>
<font color=#447700>! recompute pos : ASSIGN_STMT surface_drag.f90:54<a name='6413'></font>
<font color=#447700>! recompute vars : cd<a name='6414'></font>
        cd = 0.001<a name='6415'>
<font color=#447700>! recompute : cd<a name='6416'></font>
<font color=#447700>! recompute vars : cd<a name='6417'></font>
        a_v0_u = a_v0_u+0.0001*a_cd*(0.5-sign(0.5,cd-0.0001*v0_u))<a name='6418'>
        a_cd = a_cd*(0.5+sign(0.5,cd-0.0001*v0_u))<a name='6419'>
        a_cd = 0.<a name='6420'>
      endif<a name='6421'>
    else<a name='6422'>
      a_cd = 0.<a name='6423'>
    endif<a name='6424'>
    a_v0_ui = a_v0_u*(1./(2.*sqrt(u(i,kts,j)**2+((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/4)**2)))<a name='6425'>
    a_u(i,kts,j) = a_u(i,kts,j)+2*a_v0_ui*u(i,kts,j)<a name='6426'>
    a_v(i-1,kts,j+1) = a_v(i-1,kts,j+1)+2*a_v0_ui/float(4)*((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/float(4))<a name='6427'>
    a_v(i,kts,j+1) = a_v(i,kts,j+1)+2*a_v0_ui/float(4)*((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/float(4))<a name='6428'>
    a_v(i-1,kts,j) = a_v(i-1,kts,j)+2*a_v0_ui/float(4)*((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/float(4))<a name='6429'>
    a_v(i,kts,j) = a_v(i,kts,j)+2*a_v0_ui/float(4)*((v(i,kts,j)+v(i,kts,j+1)+v(i-1,kts,j)+v(i-1,kts,j+1))/float(4))<a name='6430'>
    a_v0_u = 0.<a name='6431'>
  end do<a name='6432'>
end do<a name='6433'>
<a name='6434'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_SURFACE_DRAG' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_43">("a_surface_drag")<a name='6435'>
<a name='6436'>
end subroutine a_surface_drag<a name='6437'>
<a name='6438'>
<a name='6439'>
<a name='6440'>
<a name='6441'>
<a name='6442'>
<a name='6443'>
<a name='6444'>
<font color=#447700>!                           DISCLAIMER<a name='6445'></font>
<font color=#447700>!<a name='6446'></font>
<font color=#447700>!   This file was generated by TAF version 1.8.81<a name='6447'></font>
<font color=#447700>!<a name='6448'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6449'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='6450'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='6451'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='6452'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='6453'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='6454'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='6455'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='6456'></font>
<font color=#447700>!<a name='6457'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='6458'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='6459'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='6460'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='6461'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='6462'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='6463'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='6464'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='6465'></font>
<font color=#447700>!<a name='6466'></font>
<A NAME='A_MOIST_PHYSICS_PREP_EM'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MOIST_PHYSICS_PREP_EM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6467'>
<font color=#993300>subroutine </font><font color=#cc0000>a_moist_physics_prep_em</font>( t_new, a_t_new, t_old, a_t_old, t0, rho, a_rho, al, a_al, alb, p, a_p, p8w, a_p8w, p0, &amp; <A href='../../call_to/A_MOIST_PHYSICS_PREP_EM.html' TARGET='index'>2</A>,<A href='../../call_from/A_MOIST_PHYSICS_PREP_EM.html' TARGET='index'>2</A><a name='6468'>
&amp;pb, ph, a_ph, phb, pii, a_pii, pf, a_pf, z, a_z, z_at_w, a_z_at_w, dz8w, a_dz8w, h_diabatic, a_h_diabatic, fzm, fzp, &amp;<a name='6469'>
&amp;ide, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='6470'>
<font color=#447700>!******************************************************************<a name='6471'></font>
<font color=#447700>!******************************************************************<a name='6472'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='6473'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.8.81  **<a name='6474'></font>
<font color=#447700>!******************************************************************<a name='6475'></font>
<font color=#447700>!******************************************************************<a name='6476'></font>
<font color=#447700>!==============================================<a name='6477'></font>
<font color=#447700>! all entries are defined explicitly<a name='6478'></font>
<font color=#447700>!==============================================<a name='6479'></font>
implicit none<a name='6480'>
<a name='6481'>
<font color=#447700>!==============================================<a name='6482'></font>
<font color=#447700>! declare arguments<a name='6483'></font>
<font color=#447700>!==============================================<a name='6484'></font>
integer, intent(in) :: ime<a name='6485'>
integer, intent(in) :: ims<a name='6486'>
integer, intent(in) :: jme<a name='6487'>
integer, intent(in) :: jms<a name='6488'>
integer, intent(in) :: kme<a name='6489'>
integer, intent(in) :: kms<a name='6490'>
real, intent(inout) :: a_al(ims:ime,kms:kme,jms:jme)<a name='6491'>
real                :: a_alb(ims:ime,kms:kme,jms:jme)<a name='6492'>
real, intent(out)   :: a_dz8w(ims:ime,kms:kme,jms:jme)<a name='6493'>
real, intent(inout) :: a_h_diabatic(ims:ime,kms:kme,jms:jme)<a name='6494'>
real, intent(inout) :: a_p(ims:ime,kms:kme,jms:jme)<a name='6495'>
real, intent(inout) :: a_p8w(ims:ime,kms:kme,jms:jme)<a name='6496'>
real                :: a_pb(ims:ime,kms:kme,jms:jme)<a name='6497'>
real, intent(inout) :: a_pf(ims:ime,kms:kme,jms:jme)<a name='6498'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='6499'>
real                :: a_phb(ims:ime,kms:kme,jms:jme)<a name='6500'>
real, intent(out)   :: a_pii(ims:ime,kms:kme,jms:jme)<a name='6501'>
real, intent(out)   :: a_rho(ims:ime,kms:kme,jms:jme)<a name='6502'>
real, intent(inout) :: a_t_new(ims:ime,kms:kme,jms:jme)<a name='6503'>
real, intent(inout) :: a_t_old(ims:ime,kms:kme,jms:jme)<a name='6504'>
real, intent(inout) :: a_z(ims:ime,kms:kme,jms:jme)<a name='6505'>
real, intent(inout) :: a_z_at_w(ims:ime,kms:kme,jms:jme)<a name='6506'>
real, intent(in) :: al(ims:ime,kms:kme,jms:jme)<a name='6507'>
real, intent(in) :: alb(ims:ime,kms:kme,jms:jme)<a name='6508'>
real, intent(out) :: dz8w(ims:ime,kms:kme,jms:jme)<a name='6509'>
real, intent(in) :: fzm(kms:kme)<a name='6510'>
real, intent(in) :: fzp(kms:kme)<a name='6511'>
real, intent(inout) :: h_diabatic(ims:ime,kms:kme,jms:jme)<a name='6512'>
integer, intent(in) :: ide<a name='6513'>
integer, intent(in) :: ite<a name='6514'>
integer, intent(in) :: its<a name='6515'>
integer, intent(in) :: jde<a name='6516'>
integer, intent(in) :: jte<a name='6517'>
integer, intent(in) :: jts<a name='6518'>
integer, intent(in) :: kde<a name='6519'>
integer, intent(in) :: kte<a name='6520'>
integer, intent(in) :: kts<a name='6521'>
real, intent(in) :: p(ims:ime,kms:kme,jms:jme)<a name='6522'>
real, intent(in) :: p0<a name='6523'>
real, intent(out) :: p8w(ims:ime,kms:kme,jms:jme)<a name='6524'>
real, intent(in) :: pb(ims:ime,kms:kme,jms:jme)<a name='6525'>
real, intent(out) :: pf(ims:ime,kms:kme,jms:jme)<a name='6526'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='6527'>
real, intent(in) :: phb(ims:ime,kms:kme,jms:jme)<a name='6528'>
real, intent(out) :: pii(ims:ime,kms:kme,jms:jme)<a name='6529'>
real, intent(out) :: rho(ims:ime,kms:kme,jms:jme)<a name='6530'>
real, intent(in) :: t0<a name='6531'>
real, intent(inout) :: t_new(ims:ime,kms:kme,jms:jme)<a name='6532'>
real, intent(inout) :: t_old(ims:ime,kms:kme,jms:jme)<a name='6533'>
real, intent(out) :: z(ims:ime,kms:kme,jms:jme)<a name='6534'>
real, intent(out) :: z_at_w(ims:ime,kms:kme,jms:jme)<a name='6535'>
<a name='6536'>
<font color=#447700>!==============================================<a name='6537'></font>
<font color=#447700>! declare local variables<a name='6538'></font>
<font color=#447700>!==============================================<a name='6539'></font>
real a_w1<a name='6540'>
real a_w2<a name='6541'>
real a_z0<a name='6542'>
real a_z1<a name='6543'>
real a_z2<a name='6544'>
integer i<a name='6545'>
integer i_end<a name='6546'>
integer i_start<a name='6547'>
integer j<a name='6548'>
integer j_end<a name='6549'>
integer j_start<a name='6550'>
integer k<a name='6551'>
integer k_end<a name='6552'>
integer k_start<a name='6553'>
real w1<a name='6554'>
real w2<a name='6555'>
real z0<a name='6556'>
real z1<a name='6557'>
real z2<a name='6558'>
<a name='6559'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MOIST_PHYSICS_PREP_EM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_44">("a_moist_physics_prep_em")<a name='6560'>
<a name='6561'>
<font color=#447700>!----------------------------------------------<a name='6562'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='6563'></font>
<font color=#447700>!----------------------------------------------<a name='6564'></font>
a_pb(:,:,:)=0.<a name='6565'>
a_phb(:,:,:)=0.<a name='6566'>
a_alb(:,:,:)=0.<a name='6567'>
<a name='6568'>
a_w1 = 0.<a name='6569'>
a_w2 = 0.<a name='6570'>
a_z0 = 0.<a name='6571'>
a_z1 = 0.<a name='6572'>
a_z2 = 0.<a name='6573'>
<a name='6574'>
<font color=#447700>!----------------------------------------------<a name='6575'></font>
<font color=#447700>! ROUTINE BODY<a name='6576'></font>
<font color=#447700>!----------------------------------------------<a name='6577'></font>
<font color=#447700>!----------------------------------------------<a name='6578'></font>
<font color=#447700>! FUNCTION AND TAPE COMPUTATIONS<a name='6579'></font>
<font color=#447700>!----------------------------------------------<a name='6580'></font>
i_start = its<a name='6581'>
i_end = min(ite,ide-1)<a name='6582'>
j_start = jts<a name='6583'>
j_end = min(jte,jde-1)<a name='6584'>
k_start = kts<a name='6585'>
k_end = min(kte,kde-1)<a name='6586'>
<a name='6587'>
do j = j_start, j_end<a name='6588'>
  do k = k_start, kte<a name='6589'>
    do i = i_start, i_end<a name='6590'>
      z_at_w(i,k,j) = (ph(i,k,j)+phb(i,k,j))/g<a name='6591'>
    end do<a name='6592'>
  end do<a name='6593'>
end do<a name='6594'>
do j = j_start, j_end<a name='6595'>
  do k = k_start, kte-1<a name='6596'>
    do i = i_start, i_end<a name='6597'>
      dz8w(i,k,j) = z_at_w(i,k+1,j)-z_at_w(i,k,j)<a name='6598'>
    end do<a name='6599'>
  end do<a name='6600'>
end do<a name='6601'>
do j = j_start, j_end<a name='6602'>
  do i = i_start, i_end<a name='6603'>
    dz8w(i,kte,j) = 0.<a name='6604'>
  end do<a name='6605'>
end do<a name='6606'>
do j = j_start, j_end<a name='6607'>
  do k = k_start, k_end<a name='6608'>
    do i = i_start, i_end<a name='6609'>
<font color=#447700>!      h_diabatic(i,k,j) = t_new(i,k,j)   !This is the key, comment this line make it right.<a name='6610'></font>
      t_new(i,k,j) = t_new(i,k,j)+t0<a name='6611'>
      t_old(i,k,j) = t_old(i,k,j)+t0<a name='6612'>
      rho(i,k,j) = 1./(al(i,k,j)+alb(i,k,j))<a name='6613'>
      pii(i,k,j) = ((p(i,k,j)+pb(i,k,j))/p0)**rcp<a name='6614'>
      z(i,k,j) = 0.5*(z_at_w(i,k,j)+z_at_w(i,k+1,j))<a name='6615'>
      pf(i,k,j) = p(i,k,j)+pb(i,k,j)<a name='6616'>
    end do<a name='6617'>
  end do<a name='6618'>
end do<a name='6619'>
<a name='6620'>
<font color=#447700>!----------------------------------------------<a name='6621'></font>
<font color=#447700>! ADJOINT COMPUTATIONS<a name='6622'></font>
<font color=#447700>!----------------------------------------------<a name='6623'></font>
do j = j_start, j_end<a name='6624'>
  do k = k_start, k_end<a name='6625'>
    do i = i_start, i_end<a name='6626'>
      a_p(i,k,j) = a_p(i,k,j)+a_pf(i,k,j)<a name='6627'>
      a_pb(i,k,j) = a_pb(i,k,j)+a_pf(i,k,j)<a name='6628'>
      a_pf(i,k,j) = 0.<a name='6629'>
      a_z_at_w(i,k+1,j) = a_z_at_w(i,k+1,j)+0.5*a_z(i,k,j)<a name='6630'>
      a_z_at_w(i,k,j) = a_z_at_w(i,k,j)+0.5*a_z(i,k,j)<a name='6631'>
      a_z(i,k,j) = 0.<a name='6632'>
      a_p(i,k,j) = a_p(i,k,j)+a_pii(i,k,j)/p0*rcp*((p(i,k,j)+pb(i,k,j))/p0)**(rcp-1)<a name='6633'>
      a_pb(i,k,j) = a_pb(i,k,j)+a_pii(i,k,j)/p0*rcp*((p(i,k,j)+pb(i,k,j))/p0)**(rcp-1)<a name='6634'>
      a_pii(i,k,j) = 0.<a name='6635'>
      a_al(i,k,j) = a_al(i,k,j)-a_rho(i,k,j)/((al(i,k,j)+alb(i,k,j))*(al(i,k,j)+alb(i,k,j)))<a name='6636'>
      a_alb(i,k,j) = a_alb(i,k,j)-a_rho(i,k,j)/((al(i,k,j)+alb(i,k,j))*(al(i,k,j)+alb(i,k,j)))<a name='6637'>
      a_rho(i,k,j) = 0.<a name='6638'>
    end do<a name='6639'>
  end do<a name='6640'>
end do<a name='6641'>
do j = j_start, j_end<a name='6642'>
  do i = i_start, i_end<a name='6643'>
    a_dz8w(i,kte,j) = 0.<a name='6644'>
  end do<a name='6645'>
end do<a name='6646'>
do j = j_start, j_end<a name='6647'>
  do k = k_start, kte-1<a name='6648'>
    do i = i_start, i_end<a name='6649'>
      a_z_at_w(i,k+1,j) = a_z_at_w(i,k+1,j)+a_dz8w(i,k,j)<a name='6650'>
      a_z_at_w(i,k,j) = a_z_at_w(i,k,j)-a_dz8w(i,k,j)<a name='6651'>
      a_dz8w(i,k,j) = 0.<a name='6652'>
    end do<a name='6653'>
  end do<a name='6654'>
end do<a name='6655'>
do j = j_start, j_end<a name='6656'>
  do k = k_start, kte<a name='6657'>
    do i = i_start, i_end<a name='6658'>
      a_ph(i,k,j) = a_ph(i,k,j)+a_z_at_w(i,k,j)/g<a name='6659'>
      a_phb(i,k,j) = a_phb(i,k,j)+a_z_at_w(i,k,j)/g<a name='6660'>
      a_z_at_w(i,k,j) = 0.<a name='6661'>
    end do<a name='6662'>
  end do<a name='6663'>
end do<a name='6664'>
<a name='6665'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MOIST_PHYSICS_PREP_EM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_44">("a_moist_physics_prep_em")<a name='6666'>
<a name='6667'>
end subroutine a_moist_physics_prep_em<a name='6668'>
<a name='6669'>
<a name='6670'>
<font color=#447700>!                           DISCLAIMER<a name='6671'></font>
<font color=#447700>!<a name='6672'></font>
<font color=#447700>!   This file was generated by TAF version 1.8.81<a name='6673'></font>
<font color=#447700>!<a name='6674'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6675'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='6676'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='6677'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='6678'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='6679'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='6680'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='6681'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='6682'></font>
<font color=#447700>!<a name='6683'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='6684'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='6685'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='6686'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='6687'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='6688'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='6689'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='6690'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='6691'></font>
<font color=#447700>!<a name='6692'></font>
<font color=#447700>!!subroutine a_moist_physics_finish_em( t_new, a_t_new, t_old, a_t_old, t0, h_diabatic, a_h_diabatic, dt, ide, jde, kde, &amp;<a name='6693'></font>
<font color=#447700>!!&amp;ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='6694'></font>
<a name='6695'>
<A NAME='A_MOIST_PHYSICS_FINISH_EM'><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MOIST_PHYSICS_FINISH_EM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6696'>
<font color=#993300>subroutine </font><font color=#cc0000>a_moist_physics_finish_em</font>( a_t_new, a_t_old, t0, a_h_diabatic, dt, ide, jde, kde, &amp; <A href='../../call_to/A_MOIST_PHYSICS_FINISH_EM.html' TARGET='index'>1</A>,<A href='../../call_from/A_MOIST_PHYSICS_FINISH_EM.html' TARGET='index'>2</A><a name='6697'>
&amp;ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='6698'>
<font color=#447700>!******************************************************************<a name='6699'></font>
<font color=#447700>!******************************************************************<a name='6700'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='6701'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.8.81  **<a name='6702'></font>
<font color=#447700>!******************************************************************<a name='6703'></font>
<font color=#447700>!******************************************************************<a name='6704'></font>
<font color=#447700>!==============================================<a name='6705'></font>
<font color=#447700>! all entries are defined explicitly<a name='6706'></font>
<font color=#447700>!==============================================<a name='6707'></font>
implicit none<a name='6708'>
<a name='6709'>
<font color=#447700>!==============================================<a name='6710'></font>
<font color=#447700>! declare arguments<a name='6711'></font>
<font color=#447700>!==============================================<a name='6712'></font>
integer, intent(in) :: ime<a name='6713'>
integer, intent(in) :: ims<a name='6714'>
integer, intent(in) :: jme<a name='6715'>
integer, intent(in) :: jms<a name='6716'>
integer, intent(in) :: kme<a name='6717'>
integer, intent(in) :: kms<a name='6718'>
real, intent(inout) :: a_h_diabatic(ims:ime,kms:kme,jms:jme)<a name='6719'>
real, intent(inout) :: a_t_new(ims:ime,kms:kme,jms:jme)<a name='6720'>
real, intent(inout) :: a_t_old(ims:ime,kms:kme,jms:jme)<a name='6721'>
real, intent(in) :: dt<a name='6722'>
integer, intent(in) :: ide<a name='6723'>
integer, intent(in) :: ite<a name='6724'>
integer, intent(in) :: its<a name='6725'>
integer, intent(in) :: jde<a name='6726'>
integer, intent(in) :: jte<a name='6727'>
integer, intent(in) :: jts<a name='6728'>
integer, intent(in) :: kde<a name='6729'>
integer, intent(in) :: kte<a name='6730'>
integer, intent(in) :: kts<a name='6731'>
real, intent(in) :: t0<a name='6732'>
real                :: t_new(ims:ime,kms:kme,jms:jme)<a name='6733'>
real                :: t_old(ims:ime,kms:kme,jms:jme)<a name='6734'>
<a name='6735'>
<font color=#447700>!==============================================<a name='6736'></font>
<font color=#447700>! declare local variables<a name='6737'></font>
<font color=#447700>!==============================================<a name='6738'></font>
integer i<a name='6739'>
integer i_end<a name='6740'>
integer i_start<a name='6741'>
integer j<a name='6742'>
integer j_end<a name='6743'>
integer j_start<a name='6744'>
integer k<a name='6745'>
integer k_end<a name='6746'>
integer k_start<a name='6747'>
<a name='6748'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MOIST_PHYSICS_FINISH_EM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_45">("a_moist_physics_finish_em")<a name='6749'>
<a name='6750'>
<font color=#447700>!----------------------------------------------<a name='6751'></font>
<font color=#447700>! ROUTINE BODY<a name='6752'></font>
<font color=#447700>!----------------------------------------------<a name='6753'></font>
<font color=#447700>!----------------------------------------------<a name='6754'></font>
<font color=#447700>! FUNCTION AND TAPE COMPUTATIONS<a name='6755'></font>
<font color=#447700>!----------------------------------------------<a name='6756'></font>
i_start = its<a name='6757'>
i_end = min(ite,ide-1)<a name='6758'>
j_start = jts<a name='6759'>
j_end = min(jte,jde-1)<a name='6760'>
k_start = kts<a name='6761'>
k_end = min(kte,kde-1)<a name='6762'>
<a name='6763'>
<font color=#447700>!----------------------------------------------<a name='6764'></font>
<font color=#447700>! ADJOINT COMPUTATIONS<a name='6765'></font>
<font color=#447700>!----------------------------------------------<a name='6766'></font>
do j = j_start, j_end<a name='6767'>
  do k = k_start, k_end<a name='6768'>
    do i = i_start, i_end<a name='6769'>
      a_t_old(i,k,j) = a_t_old(i,k,j)<a name='6770'>
      a_t_new(i,k,j) = a_t_new(i,k,j)<a name='6771'>
    end do<a name='6772'>
  end do<a name='6773'>
end do<a name='6774'>
<a name='6775'>
   call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_big_step_utilities_em_ad.F.html#A_MOIST_PHYSICS_FINISH_EM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_45">("a_moist_physics_finish_em")<a name='6776'>
<a name='6777'>
end subroutine a_moist_physics_finish_em<a name='6778'>
<a name='6779'>
<a name='6780'>
end module     a_module_big_step_utilities_em<a name='6781'>
</pre></body></html>