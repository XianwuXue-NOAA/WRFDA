<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.18<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='A_MODULE_BC_EM'><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_MODULE_BC_EM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module     </font><font color=#cc0000>a_module_bc_em</font> <A href='../../call_to/A_MODULE_BC_EM.html' TARGET='index'>2</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#module_bc_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_7"><a name='35'>
use <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_MODULE_BC'>a_module_bc</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#module_bc_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_MODULE_BC_2"><a name='36'>
use <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#module_bc_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_5"><a name='37'>
use <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#module_bc_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_6"><a name='38'>
use <A href='../../html_code/dyn_em/module_bc_em.F.html#MODULE_BC_EM'>module_bc_em</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#module_bc_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_EM_1"><a name='39'>
<a name='40'>
USE <A href='../../html_code/frame/module_trace.F.html#MODULE_TRACE'>module_trace</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#module_bc_em_ad.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_TRACE_4">, only : trace_entry, trace_exit<a name='41'>
<a name='42'>
<font color=#447700>!==============================================<a name='43'></font>
<font color=#447700>! all entries are defined explicitly<a name='44'></font>
<font color=#447700>!==============================================<a name='45'></font>
implicit none<a name='46'>
<a name='47'>
contains<a name='48'>
<a name='49'>
<A NAME='A_RELAX_BDY_DRY'><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='50'>
<font color=#993300>subroutine </font><font color=#cc0000>a_relax_bdy_dry</font>( config_flags, a_ru_tendf, a_rv_tendf, a_ph_tendf, a_t_tendf, a_rw_tendf, a_mu_tend, a_ru, a_rv, ph, &amp; <A href='../../call_to/A_RELAX_BDY_DRY.html' TARGET='index'>2</A>,<A href='../../call_from/A_RELAX_BDY_DRY.html' TARGET='index'>8</A><a name='51'>
&amp;a_ph, t, a_t, w, a_w, a_mu, mut, a_mut, a_u_b, a_v_b, a_ph_b, a_t_b, a_w_b, a_mu_b, a_u_bt, a_v_bt, a_ph_bt, a_t_bt, a_w_bt, &amp;<a name='52'>
&amp;a_mu_bt, spec_bdy_width, spec_zone, relax_zone, dtbc, fcx, gcx, ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, kms,&amp;<a name='53'>
&amp; kme, its, ite, jts, jte, kts, kte )<a name='54'>
<font color=#447700>!******************************************************************<a name='55'></font>
<font color=#447700>!******************************************************************<a name='56'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='57'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='58'></font>
<font color=#447700>!******************************************************************<a name='59'></font>
<font color=#447700>!******************************************************************<a name='60'></font>
<font color=#447700>!==============================================<a name='61'></font>
<font color=#447700>! all entries are defined explicitly<a name='62'></font>
<font color=#447700>!==============================================<a name='63'></font>
implicit none<a name='64'>
<a name='65'>
<font color=#447700>!==============================================<a name='66'></font>
<font color=#447700>! declare arguments<a name='67'></font>
<font color=#447700>!==============================================<a name='68'></font>
integer, intent(in) :: ime<a name='69'>
integer, intent(in) :: ims<a name='70'>
integer, intent(in) :: jme<a name='71'>
integer, intent(in) :: jms<a name='72'>
real, intent(inout) :: a_mu(ims:ime,jms:jme)<a name='73'>
integer, intent(in) :: ijde<a name='74'>
integer, intent(in) :: ijds<a name='75'>
integer, intent(in) :: spec_bdy_width<a name='76'>
real, intent(inout) :: a_mu_b(ijds:ijde,1:1,spec_bdy_width,4)<a name='77'>
real, intent(inout) :: a_mu_bt(ijds:ijde,1:1,spec_bdy_width,4)<a name='78'>
real, intent(inout) :: a_mu_tend(ims:ime,jms:jme)<a name='79'>
real, intent(inout) :: a_mut(ims:ime,jms:jme)<a name='80'>
integer, intent(in) :: kme<a name='81'>
integer, intent(in) :: kms<a name='82'>
real, intent(inout) :: a_ph(ims:ime,kms:kme,jms:jme)<a name='83'>
integer, intent(in) :: kde<a name='84'>
integer, intent(in) :: kds<a name='85'>
real, intent(inout) :: a_ph_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='86'>
real, intent(inout) :: a_ph_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='87'>
real, intent(inout) :: a_ph_tendf(ims:ime,kms:kme,jms:jme)<a name='88'>
real, intent(inout) :: a_ru(ims:ime,kms:kme,jms:jme)<a name='89'>
real, intent(inout) :: a_ru_tendf(ims:ime,kms:kme,jms:jme)<a name='90'>
real, intent(inout) :: a_rv(ims:ime,kms:kme,jms:jme)<a name='91'>
real, intent(inout) :: a_rv_tendf(ims:ime,kms:kme,jms:jme)<a name='92'>
real, intent(inout) :: a_rw_tendf(ims:ime,kms:kme,jms:jme)<a name='93'>
real, intent(inout) :: a_t(ims:ime,kms:kme,jms:jme)<a name='94'>
real, intent(inout) :: a_t_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='95'>
real, intent(inout) :: a_t_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='96'>
real, intent(inout) :: a_t_tendf(ims:ime,kms:kme,jms:jme)<a name='97'>
real, intent(inout) :: a_u_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='98'>
real, intent(inout) :: a_u_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='99'>
real, intent(inout) :: a_v_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='100'>
real, intent(inout) :: a_v_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='101'>
real, intent(inout) :: a_w(ims:ime,kms:kme,jms:jme)<a name='102'>
real, intent(inout) :: a_w_b(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='103'>
real, intent(inout) :: a_w_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='104'>
type (grid_config_rec_type) config_flags<a name='105'>
real, intent(in) :: dtbc<a name='106'>
real, intent(in) :: fcx(spec_bdy_width)<a name='107'>
real, intent(in) :: gcx(spec_bdy_width)<a name='108'>
integer, intent(in) :: ide<a name='109'>
integer, intent(in) :: ids<a name='110'>
integer, intent(in) :: ite<a name='111'>
integer, intent(in) :: its<a name='112'>
integer, intent(in) :: jde<a name='113'>
integer, intent(in) :: jds<a name='114'>
integer, intent(in) :: jte<a name='115'>
integer, intent(in) :: jts<a name='116'>
integer, intent(in) :: kte<a name='117'>
integer, intent(in) :: kts<a name='118'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='119'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='120'>
integer, intent(in) :: relax_zone<a name='121'>
integer, intent(in) :: spec_zone<a name='122'>
real, intent(in) :: t(ims:ime,kms:kme,jms:jme)<a name='123'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='124'>
<a name='125'>
<font color=#447700>!==============================================<a name='126'></font>
<font color=#447700>! declare local variables<a name='127'></font>
<font color=#447700>!==============================================<a name='128'></font>
real a_rfield(ims:ime,kms:kme,jms:jme)<a name='129'>
integer i<a name='130'>
integer i_end<a name='131'>
integer i_start<a name='132'>
integer j<a name='133'>
integer j_end<a name='134'>
integer j_start<a name='135'>
integer k<a name='136'>
<a name='137'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_10">("a_relax_bdy_dry")<a name='138'>
<a name='139'>
<font color=#447700>!----------------------------------------------<a name='140'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='141'></font>
<font color=#447700>!----------------------------------------------<a name='142'></font>
a_rfield(:,:,:) = 0.<a name='143'>
<a name='144'>
<font color=#447700>!----------------------------------------------<a name='145'></font>
<font color=#447700>! ROUTINE BODY<a name='146'></font>
<font color=#447700>!----------------------------------------------<a name='147'></font>
if (config_flags%nested) then<a name='148'>
  i_start = max(its-1,ids)<a name='149'>
<font color=#447700>! recompute : i_start<a name='150'></font>
  i_end = min(ite+1,ide-1)<a name='151'>
<font color=#447700>! recompute : i_end<a name='152'></font>
  j_start = max(jts-1,jds)<a name='153'>
<font color=#447700>! recompute : j_start<a name='154'></font>
  j_end = min(jte+1,jde-1)<a name='155'>
<font color=#447700>! recompute : j_end<a name='156'></font>
  call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND'>a_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_RELAX_BDYTEND_1">( a_rfield,a_rw_tendf,a_w_b,a_w_bt,'h',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,ijde,ids,ide,&amp;<a name='157'>
&amp;jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='158'>
  do j = j_start, j_end<a name='159'>
    do k = kts, kte<a name='160'>
      do i = i_start, i_end<a name='161'>
        a_mut(i,j) = a_mut(i,j)+a_rfield(i,k,j)*w(i,k,j)<a name='162'>
        a_w(i,k,j) = a_w(i,k,j)+a_rfield(i,k,j)*mut(i,j)<a name='163'>
        a_rfield(i,k,j) = 0.<a name='164'>
      end do<a name='165'>
    end do<a name='166'>
  end do<a name='167'>
endif<a name='168'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND'>a_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_RELAX_BDYTEND_2">( a_mu,a_mu_tend,a_mu_b,a_mu_bt,'m',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,ijde,ids,ide,jds,jde,&amp;<a name='169'>
&amp;1,1,ims,ime,jms,jme,1,1,its,ite,jts,jte,1,1 )<a name='170'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND'>a_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_RELAX_BDYTEND_3">( a_rfield,a_t_tendf,a_t_b,a_t_bt,'t',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,ijde,ids,ide,jds,&amp;<a name='171'>
&amp;jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='172'>
<font color=#447700>! recdepend vars : ids,its<a name='173'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:231<a name='174'></font>
<font color=#447700>! recompute vars : i_start<a name='175'></font>
i_start = max(its-1,ids)<a name='176'>
<font color=#447700>! recompute vars : i_start<a name='177'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='178'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:232<a name='179'></font>
<font color=#447700>! recompute vars : i_end<a name='180'></font>
i_end = min(ite+1,ide-1)<a name='181'>
<font color=#447700>! recompute vars : i_end<a name='182'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jds,jts<a name='183'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:233<a name='184'></font>
<font color=#447700>! recompute vars : j_start<a name='185'></font>
j_start = max(jts-1,jds)<a name='186'>
<font color=#447700>! recompute vars : j_start<a name='187'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='188'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:234<a name='189'></font>
<font color=#447700>! recompute vars : j_end<a name='190'></font>
j_end = min(jte+1,jde-1)<a name='191'>
<font color=#447700>! recompute vars : j_end<a name='192'></font>
do j = j_start, j_end<a name='193'>
  do k = kts, kte-1<a name='194'>
    do i = i_start, i_end<a name='195'>
      a_mut(i,j) = a_mut(i,j)+a_rfield(i,k,j)*t(i,k,j)<a name='196'>
      a_t(i,k,j) = a_t(i,k,j)+a_rfield(i,k,j)*mut(i,j)<a name='197'>
      a_rfield(i,k,j) = 0.<a name='198'>
    end do<a name='199'>
  end do<a name='200'>
end do<a name='201'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND'>a_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_RELAX_BDYTEND_4">( a_rfield,a_ph_tendf,a_ph_b,a_ph_bt,'h',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,ijde,ids,ide,&amp;<a name='202'>
&amp;jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='203'>
<font color=#447700>! recdepend vars : ids,its<a name='204'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:231<a name='205'></font>
<font color=#447700>! recompute vars : i_start<a name='206'></font>
i_start = max(its-1,ids)<a name='207'>
<font color=#447700>! recompute vars : i_start<a name='208'></font>
<font color=#447700>! recdepend vars : i_start,ide,ite<a name='209'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:232<a name='210'></font>
<font color=#447700>! recompute vars : i_end<a name='211'></font>
i_end = min(ite+1,ide-1)<a name='212'>
<font color=#447700>! recompute vars : i_end<a name='213'></font>
<font color=#447700>! recdepend vars : i_end,i_start,jds,jts<a name='214'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:233<a name='215'></font>
<font color=#447700>! recompute vars : j_start<a name='216'></font>
j_start = max(jts-1,jds)<a name='217'>
<font color=#447700>! recompute vars : j_start<a name='218'></font>
<font color=#447700>! recdepend vars : i_end,i_start,j_start,jde,jte<a name='219'></font>
<font color=#447700>! recompute pos : ASSIGN_STMT module_bc_em.f90:234<a name='220'></font>
<font color=#447700>! recompute vars : j_end<a name='221'></font>
j_end = min(jte+1,jde-1)<a name='222'>
<font color=#447700>! recompute vars : j_end<a name='223'></font>
do j = j_start, j_end<a name='224'>
  do k = kts, kte<a name='225'>
    do i = i_start, i_end<a name='226'>
      a_mut(i,j) = a_mut(i,j)+a_rfield(i,k,j)*ph(i,k,j)<a name='227'>
      a_ph(i,k,j) = a_ph(i,k,j)+a_rfield(i,k,j)*mut(i,j)<a name='228'>
      a_rfield(i,k,j) = 0.<a name='229'>
    end do<a name='230'>
  end do<a name='231'>
end do<a name='232'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND'>a_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_RELAX_BDYTEND_5">( a_rv,a_rv_tendf,a_v_b,a_v_bt,'v',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,ijde,ids,ide,jds,jde,&amp;<a name='233'>
&amp;kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='234'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_RELAX_BDYTEND'>a_relax_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_RELAX_BDYTEND_6">( a_ru,a_ru_tendf,a_u_b,a_u_bt,'u',spec_bdy_width,spec_zone,relax_zone,dtbc,fcx,gcx,ijds,ijde,ids,ide,jds,jde,&amp;<a name='235'>
&amp;kds,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='236'>
<a name='237'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_RELAX_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_10">("a_relax_bdy_dry")<a name='238'>
<a name='239'>
end subroutine a_relax_bdy_dry<a name='240'>
<a name='241'>
<a name='242'>
<A NAME='A_SPEC_BDY_DRY'><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='243'>
<font color=#993300>subroutine </font><font color=#cc0000>a_spec_bdy_dry</font>( config_flags, a_ru_tend, a_rv_tend, a_ph_tend, a_t_tend, a_rw_tend, a_mu_tend, a_u_bt, a_v_bt, a_ph_bt, &amp; <A href='../../call_to/A_SPEC_BDY_DRY.html' TARGET='index'>2</A>,<A href='../../call_from/A_SPEC_BDY_DRY.html' TARGET='index'>8</A><a name='244'>
&amp;a_t_bt, a_w_bt, a_mu_bt, spec_bdy_width, spec_zone, ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, kms, kme, its, &amp;<a name='245'>
&amp;ite, jts, jte, kts, kte )<a name='246'>
<font color=#447700>!******************************************************************<a name='247'></font>
<font color=#447700>!******************************************************************<a name='248'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='249'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='250'></font>
<font color=#447700>!******************************************************************<a name='251'></font>
<font color=#447700>!******************************************************************<a name='252'></font>
<font color=#447700>!==============================================<a name='253'></font>
<font color=#447700>! all entries are defined explicitly<a name='254'></font>
<font color=#447700>!==============================================<a name='255'></font>
implicit none<a name='256'>
<a name='257'>
<font color=#447700>!==============================================<a name='258'></font>
<font color=#447700>! declare arguments<a name='259'></font>
<font color=#447700>!==============================================<a name='260'></font>
integer, intent(in) :: ijde<a name='261'>
integer, intent(in) :: ijds<a name='262'>
integer, intent(in) :: spec_bdy_width<a name='263'>
real, intent(inout) :: a_mu_bt(ijds:ijde,1:1,spec_bdy_width,4)<a name='264'>
integer, intent(in) :: ime<a name='265'>
integer, intent(in) :: ims<a name='266'>
integer, intent(in) :: jme<a name='267'>
integer, intent(in) :: jms<a name='268'>
real, intent(inout) :: a_mu_tend(ims:ime,jms:jme)<a name='269'>
integer, intent(in) :: kde<a name='270'>
integer, intent(in) :: kds<a name='271'>
real, intent(inout) :: a_ph_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='272'>
integer, intent(in) :: kme<a name='273'>
integer, intent(in) :: kms<a name='274'>
real, intent(inout) :: a_ph_tend(ims:ime,kms:kme,jms:jme)<a name='275'>
real, intent(inout) :: a_ru_tend(ims:ime,kms:kme,jms:jme)<a name='276'>
real, intent(inout) :: a_rv_tend(ims:ime,kms:kme,jms:jme)<a name='277'>
real, intent(inout) :: a_rw_tend(ims:ime,kms:kme,jms:jme)<a name='278'>
real, intent(inout) :: a_t_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='279'>
real, intent(inout) :: a_t_tend(ims:ime,kms:kme,jms:jme)<a name='280'>
real, intent(inout) :: a_u_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='281'>
real, intent(inout) :: a_v_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='282'>
real, intent(inout) :: a_w_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='283'>
type (grid_config_rec_type) config_flags<a name='284'>
integer, intent(in) :: ide<a name='285'>
integer, intent(in) :: ids<a name='286'>
integer, intent(in) :: ite<a name='287'>
integer, intent(in) :: its<a name='288'>
integer, intent(in) :: jde<a name='289'>
integer, intent(in) :: jds<a name='290'>
integer, intent(in) :: jte<a name='291'>
integer, intent(in) :: jts<a name='292'>
integer, intent(in) :: kte<a name='293'>
integer, intent(in) :: kts<a name='294'>
integer, intent(in) :: spec_zone<a name='295'>
<a name='296'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_11">("a_spec_bdy_dry")<a name='297'>
<a name='298'>
<font color=#447700>!----------------------------------------------<a name='299'></font>
<font color=#447700>! ROUTINE BODY<a name='300'></font>
<font color=#447700>!----------------------------------------------<a name='301'></font>
if (config_flags%nested) then<a name='302'>
  call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_1">( a_rw_tend,a_w_bt,'h',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,&amp;<a name='303'>
&amp;ite,jts,jte,kts,kte )<a name='304'>
endif<a name='305'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_2">( a_mu_tend,a_mu_bt,'m',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,1,1,ims,ime,jms,jme,1,1,its,ite,jts,&amp;<a name='306'>
&amp;jte,1,1 )<a name='307'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_3">( a_t_tend,a_t_bt,'t',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,&amp;<a name='308'>
&amp;ite,jts,jte,kts,kte )<a name='309'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_4">( a_ph_tend,a_ph_bt,'h',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,&amp;<a name='310'>
&amp;ite,jts,jte,kts,kte )<a name='311'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_5">( a_rv_tend,a_v_bt,'v',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,&amp;<a name='312'>
&amp;ite,jts,jte,kts,kte )<a name='313'>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_6">( a_ru_tend,a_u_bt,'u',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,kme,its,&amp;<a name='314'>
&amp;ite,jts,jte,kts,kte )<a name='315'>
<a name='316'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_11">("a_spec_bdy_dry")<a name='317'>
<a name='318'>
end subroutine a_spec_bdy_dry<a name='319'>
<a name='320'>
<a name='321'>
<A NAME='A_SPEC_BDY_SCALAR'><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_SCALAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='322'>
<font color=#993300>subroutine </font><font color=#cc0000>a_spec_bdy_scalar</font>( a_scalar_tend, a_scalar_bt, spec_bdy_width, spec_zone, ijds, ijde, ids, ide, jds, jde, kds, kde, ims,&amp; <A href='../../call_to/A_SPEC_BDY_SCALAR.html' TARGET='index'>7</A>,<A href='../../call_from/A_SPEC_BDY_SCALAR.html' TARGET='index'>3</A><a name='323'>
&amp; ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='324'>
<font color=#447700>!******************************************************************<a name='325'></font>
<font color=#447700>!******************************************************************<a name='326'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='327'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='328'></font>
<font color=#447700>!******************************************************************<a name='329'></font>
<font color=#447700>!******************************************************************<a name='330'></font>
<font color=#447700>!==============================================<a name='331'></font>
<font color=#447700>! all entries are defined explicitly<a name='332'></font>
<font color=#447700>!==============================================<a name='333'></font>
implicit none<a name='334'>
<a name='335'>
<font color=#447700>!==============================================<a name='336'></font>
<font color=#447700>! declare arguments<a name='337'></font>
<font color=#447700>!==============================================<a name='338'></font>
integer, intent(in) :: ijde<a name='339'>
integer, intent(in) :: ijds<a name='340'>
integer, intent(in) :: kde<a name='341'>
integer, intent(in) :: kds<a name='342'>
integer, intent(in) :: spec_bdy_width<a name='343'>
real, intent(inout) :: a_scalar_bt(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='344'>
integer, intent(in) :: ime<a name='345'>
integer, intent(in) :: ims<a name='346'>
integer, intent(in) :: jme<a name='347'>
integer, intent(in) :: jms<a name='348'>
integer, intent(in) :: kme<a name='349'>
integer, intent(in) :: kms<a name='350'>
real, intent(inout) :: a_scalar_tend(ims:ime,kms:kme,jms:jme)<a name='351'>
integer, intent(in) :: ide<a name='352'>
integer, intent(in) :: ids<a name='353'>
integer, intent(in) :: ite<a name='354'>
integer, intent(in) :: its<a name='355'>
integer, intent(in) :: jde<a name='356'>
integer, intent(in) :: jds<a name='357'>
integer, intent(in) :: jte<a name='358'>
integer, intent(in) :: jts<a name='359'>
integer, intent(in) :: kte<a name='360'>
integer, intent(in) :: kts<a name='361'>
integer, intent(in) :: spec_zone<a name='362'>
<a name='363'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_12">("a_spec_bdy_scalar")<a name='364'>
<a name='365'>
<font color=#447700>!----------------------------------------------<a name='366'></font>
<font color=#447700>! ROUTINE BODY<a name='367'></font>
<font color=#447700>!----------------------------------------------<a name='368'></font>
call <A href='../../html_code/dyn_em/module_bc_ad.F.html#A_SPEC_BDYTEND'>a_spec_bdytend</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="A_SPEC_BDYTEND_7">( a_scalar_tend,a_scalar_bt,'q',spec_bdy_width,spec_zone,ijds,ijde,ids,ide,jds,jde,kds,kde,ims,ime,jms,jme,kms,&amp;<a name='369'>
&amp;kme,its,ite,jts,jte,kts,kte )<a name='370'>
<a name='371'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDY_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_12">("a_spec_bdy_scalar")<a name='372'>
<a name='373'>
end subroutine a_spec_bdy_scalar<a name='374'>
<a name='375'>
<a name='376'>
<A NAME='A_SPEC_BDYUPDATE_PH'><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDYUPDATE_PH' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='377'>
<font color=#993300>subroutine </font><font color=#cc0000>a_spec_bdyupdate_ph</font>( ph_save, a_ph_save, field, a_field, field_tend, a_field_tend, mu_tend, a_mu_tend, muts, a_muts, dt,&amp; <A href='../../call_to/A_SPEC_BDYUPDATE_PH.html' TARGET='index'>2</A>,<A href='../../call_from/A_SPEC_BDYUPDATE_PH.html' TARGET='index'>2</A><a name='378'>
&amp; variable_in, spec_zone, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='379'>
<font color=#447700>!******************************************************************<a name='380'></font>
<font color=#447700>!******************************************************************<a name='381'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='382'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='383'></font>
<font color=#447700>!******************************************************************<a name='384'></font>
<font color=#447700>!******************************************************************<a name='385'></font>
<font color=#447700>!==============================================<a name='386'></font>
<font color=#447700>! all entries are defined explicitly<a name='387'></font>
<font color=#447700>!==============================================<a name='388'></font>
implicit none<a name='389'>
<a name='390'>
<font color=#447700>!==============================================<a name='391'></font>
<font color=#447700>! declare arguments<a name='392'></font>
<font color=#447700>!==============================================<a name='393'></font>
integer, intent(in) :: ime<a name='394'>
integer, intent(in) :: ims<a name='395'>
integer, intent(in) :: jme<a name='396'>
integer, intent(in) :: jms<a name='397'>
integer, intent(in) :: kme<a name='398'>
integer, intent(in) :: kms<a name='399'>
real, intent(inout) :: a_field(ims:ime,kms:kme,jms:jme)<a name='400'>
real, intent(inout) :: a_field_tend(ims:ime,kms:kme,jms:jme)<a name='401'>
real, intent(inout) :: a_mu_tend(ims:ime,jms:jme)<a name='402'>
real, intent(inout) :: a_muts(ims:ime,jms:jme)<a name='403'>
real, intent(inout) :: a_ph_save(ims:ime,kms:kme,jms:jme)<a name='404'>
real, intent(in) :: dt<a name='405'>
real, intent(inout) :: field(ims:ime,kms:kme,jms:jme)<a name='406'>
real, intent(in) :: field_tend(ims:ime,kms:kme,jms:jme)<a name='407'>
integer, intent(in) :: ide<a name='408'>
integer, intent(in) :: ids<a name='409'>
integer, intent(in) :: ite<a name='410'>
integer, intent(in) :: its<a name='411'>
integer, intent(in) :: jde<a name='412'>
integer, intent(in) :: jds<a name='413'>
integer, intent(in) :: jte<a name='414'>
integer, intent(in) :: jts<a name='415'>
integer, intent(in) :: kde<a name='416'>
integer, intent(in) :: kte<a name='417'>
integer, intent(in) :: kts<a name='418'>
real, intent(in) :: mu_tend(ims:ime,jms:jme)<a name='419'>
real, intent(in) :: muts(ims:ime,jms:jme)<a name='420'>
real, intent(in) :: ph_save(ims:ime,kms:kme,jms:jme)<a name='421'>
integer, intent(in) :: spec_zone<a name='422'>
character, intent(in) :: variable_in<a name='423'>
<a name='424'>
<font color=#447700>!==============================================<a name='425'></font>
<font color=#447700>! declare local variables<a name='426'></font>
<font color=#447700>!==============================================<a name='427'></font>
real a_mu_old(its:ite,jts:jte)<a name='428'>
integer b_dist<a name='429'>
real fieldh(ims:ime,kms:kme,jms:jme)<a name='430'>
integer i<a name='431'>
integer ibe<a name='432'>
integer ibs<a name='433'>
integer itf<a name='434'>
integer j<a name='435'>
integer jbe<a name='436'>
integer jbs<a name='437'>
integer jtf<a name='438'>
integer k<a name='439'>
integer ktf<a name='440'>
real mu_old(its:ite,jts:jte)<a name='441'>
character variable<a name='442'>
<a name='443'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDYUPDATE_PH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_13">("a_spec_bdyupdate_ph")<a name='444'>
<a name='445'>
<font color=#447700>!----------------------------------------------<a name='446'></font>
<font color=#447700>! SAVE REQUIRED INPUT VARIABLES<a name='447'></font>
<font color=#447700>!----------------------------------------------<a name='448'></font>
fieldh(:,:,:) = field(:,:,:)<a name='449'>
<a name='450'>
<font color=#447700>!----------------------------------------------<a name='451'></font>
<font color=#447700>! RESET LOCAL ADJOINT VARIABLES<a name='452'></font>
<font color=#447700>!----------------------------------------------<a name='453'></font>
a_mu_old(:,:) = 0.<a name='454'>
<a name='455'>
<font color=#447700>!----------------------------------------------<a name='456'></font>
<font color=#447700>! ROUTINE BODY<a name='457'></font>
<font color=#447700>!----------------------------------------------<a name='458'></font>
variable = variable_in<a name='459'>
<font color=#447700>! recompute : variable<a name='460'></font>
if (variable .eq. 'U') then<a name='461'>
  variable = 'u'<a name='462'>
endif<a name='463'>
<font color=#447700>! recompute : variable<a name='464'></font>
if (variable .eq. 'V') then<a name='465'>
  variable = 'v'<a name='466'>
endif<a name='467'>
<font color=#447700>! recompute : variable<a name='468'></font>
if (variable .eq. 'M') then<a name='469'>
  variable = 'm'<a name='470'>
endif<a name='471'>
<font color=#447700>! recompute : variable<a name='472'></font>
if (variable .eq. 'H') then<a name='473'>
  variable = 'h'<a name='474'>
endif<a name='475'>
<font color=#447700>! recompute : variable<a name='476'></font>
ibs = ids<a name='477'>
<font color=#447700>! recompute : ibs<a name='478'></font>
ibe = ide-1<a name='479'>
<font color=#447700>! recompute : ibe<a name='480'></font>
itf = min(ite,ide-1)<a name='481'>
<font color=#447700>! recompute : itf<a name='482'></font>
jbs = jds<a name='483'>
<font color=#447700>! recompute : jbs<a name='484'></font>
jbe = jde-1<a name='485'>
<font color=#447700>! recompute : jbe<a name='486'></font>
jtf = min(jte,jde-1)<a name='487'>
<font color=#447700>! recompute : jtf<a name='488'></font>
ktf = kde-1<a name='489'>
<font color=#447700>! recompute : ktf<a name='490'></font>
if (variable .eq. 'u') then<a name='491'>
  ibe = ide<a name='492'>
endif<a name='493'>
<font color=#447700>! recompute : ibe<a name='494'></font>
if (variable .eq. 'u') then<a name='495'>
  itf = min(ite,ide)<a name='496'>
endif<a name='497'>
<font color=#447700>! recompute : itf<a name='498'></font>
if (variable .eq. 'v') then<a name='499'>
  jbe = jde<a name='500'>
endif<a name='501'>
<font color=#447700>! recompute : jbe<a name='502'></font>
if (variable .eq. 'v') then<a name='503'>
  jtf = min(jte,jde)<a name='504'>
endif<a name='505'>
<font color=#447700>! recompute : jtf<a name='506'></font>
if (variable .eq. 'm') then<a name='507'>
  ktf = kte<a name='508'>
endif<a name='509'>
<font color=#447700>! recompute : ktf<a name='510'></font>
if (variable .eq. 'h') then<a name='511'>
  ktf = kte<a name='512'>
endif<a name='513'>
<font color=#447700>! recompute : ktf<a name='514'></font>
if (jts-jbs .lt. spec_zone) then<a name='515'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='516'>
    b_dist = j-jbs<a name='517'>
    do k = kts, ktf<a name='518'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='519'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='520'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='521'>
      end do<a name='522'>
    end do<a name='523'>
  end do<a name='524'>
endif<a name='525'>
<font color=#447700>! recompute : field<a name='526'></font>
if (jbe-jtf .lt. spec_zone) then<a name='527'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='528'>
    b_dist = jbe-j<a name='529'>
    do k = kts, ktf<a name='530'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='531'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='532'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='533'>
      end do<a name='534'>
    end do<a name='535'>
  end do<a name='536'>
endif<a name='537'>
<font color=#447700>! recompute : field<a name='538'></font>
if (its-ibs .lt. spec_zone) then<a name='539'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='540'>
    b_dist = i-ibs<a name='541'>
    do k = kts, ktf<a name='542'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='543'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='544'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='545'>
      end do<a name='546'>
    end do<a name='547'>
  end do<a name='548'>
endif<a name='549'>
<font color=#447700>! recompute : field<a name='550'></font>
if (ibe-itf .lt. spec_zone) then<a name='551'>
  do i = max(its,ibe-spec_zone+1), itf<a name='552'>
    b_dist = ibe-i<a name='553'>
<font color=#447700>! recompute : b_dist<a name='554'></font>
    do k = kts, ktf<a name='555'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='556'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='557'>
<font color=#447700>! recompute : mu_old<a name='558'></font>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*(dt/muts(i,j))<a name='559'>
        a_mu_old(i,j) = a_mu_old(i,j)+a_field(i,k,j)*(field(i,k,j)/muts(i,j)+ph_save(i,k,j)/muts(i,j))<a name='560'>
        a_muts(i,j) = a_muts(i,j)+a_field(i,k,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/(muts(i,&amp;<a name='561'>
&amp;j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))<a name='562'>
        a_ph_save(i,k,j) = a_ph_save(i,k,j)+a_field(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='563'>
        a_field(i,k,j) = a_field(i,k,j)*(mu_old(i,j)/muts(i,j))<a name='564'>
        a_mu_tend(i,j) = a_mu_tend(i,j)-a_mu_old(i,j)*dt<a name='565'>
        a_muts(i,j) = a_muts(i,j)+a_mu_old(i,j)<a name='566'>
        a_mu_old(i,j) = 0.<a name='567'>
      end do<a name='568'>
    end do<a name='569'>
  end do<a name='570'>
endif<a name='571'>
field(:,:,:) = fieldh(:,:,:)<a name='572'>
<font color=#447700>!  recdepend vars : dt,field,field_tend,ibe,ibs,itf,its,jbs,jtf,jts,ktf,<a name='573'></font>
<font color=#447700>! kts,mu_tend,muts,ph_save,spec_zone<a name='574'></font>
<font color=#447700>! recompute pos : IF_STMT module_bc_em.f90:71<a name='575'></font>
<font color=#447700>! recompute vars : field<a name='576'></font>
if (jts-jbs .lt. spec_zone) then<a name='577'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='578'>
    b_dist = j-jbs<a name='579'>
    do k = kts, ktf<a name='580'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='581'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='582'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='583'>
      end do<a name='584'>
    end do<a name='585'>
  end do<a name='586'>
endif<a name='587'>
<font color=#447700>! recompute vars : field<a name='588'></font>
<font color=#447700>!  recdepend vars : dt,field,field_tend,ibe,ibs,itf,its,jbe,jtf,jts,ktf,<a name='589'></font>
<font color=#447700>! kts,mu_tend,muts,ph_save,spec_zone<a name='590'></font>
<font color=#447700>! recompute pos : IF_STMT module_bc_em.f90:88<a name='591'></font>
<font color=#447700>! recompute vars : field<a name='592'></font>
if (jbe-jtf .lt. spec_zone) then<a name='593'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='594'>
    b_dist = jbe-j<a name='595'>
    do k = kts, ktf<a name='596'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='597'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='598'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='599'>
      end do<a name='600'>
    end do<a name='601'>
  end do<a name='602'>
endif<a name='603'>
<font color=#447700>! recompute vars : field<a name='604'></font>
if (its-ibs .lt. spec_zone) then<a name='605'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='606'>
    b_dist = i-ibs<a name='607'>
<font color=#447700>! recompute : b_dist<a name='608'></font>
    do k = kts, ktf<a name='609'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='610'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='611'>
<font color=#447700>! recompute : mu_old<a name='612'></font>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*(dt/muts(i,j))<a name='613'>
        a_mu_old(i,j) = a_mu_old(i,j)+a_field(i,k,j)*(field(i,k,j)/muts(i,j)+ph_save(i,k,j)/muts(i,j))<a name='614'>
        a_muts(i,j) = a_muts(i,j)+a_field(i,k,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/(muts(i,&amp;<a name='615'>
&amp;j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))<a name='616'>
        a_ph_save(i,k,j) = a_ph_save(i,k,j)+a_field(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='617'>
        a_field(i,k,j) = a_field(i,k,j)*(mu_old(i,j)/muts(i,j))<a name='618'>
        a_mu_tend(i,j) = a_mu_tend(i,j)-a_mu_old(i,j)*dt<a name='619'>
        a_muts(i,j) = a_muts(i,j)+a_mu_old(i,j)<a name='620'>
        a_mu_old(i,j) = 0.<a name='621'>
      end do<a name='622'>
    end do<a name='623'>
  end do<a name='624'>
endif<a name='625'>
field(:,:,:) = fieldh(:,:,:)<a name='626'>
<font color=#447700>!  recdepend vars : dt,field,field_tend,ibe,ibs,itf,its,jbs,jtf,jts,ktf,<a name='627'></font>
<font color=#447700>! kts,mu_tend,muts,ph_save,spec_zone<a name='628'></font>
<font color=#447700>! recompute pos : IF_STMT module_bc_em.f90:71<a name='629'></font>
<font color=#447700>! recompute vars : field<a name='630'></font>
if (jts-jbs .lt. spec_zone) then<a name='631'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='632'>
    b_dist = j-jbs<a name='633'>
    do k = kts, ktf<a name='634'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='635'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='636'>
        field(i,k,j) = field(i,k,j)*mu_old(i,j)/muts(i,j)+dt*field_tend(i,k,j)/muts(i,j)+ph_save(i,k,j)*(mu_old(i,j)/muts(i,j)-1.)<a name='637'>
      end do<a name='638'>
    end do<a name='639'>
  end do<a name='640'>
endif<a name='641'>
<font color=#447700>! recompute vars : field<a name='642'></font>
if (jbe-jtf .lt. spec_zone) then<a name='643'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='644'>
    b_dist = jbe-j<a name='645'>
<font color=#447700>! recompute : b_dist<a name='646'></font>
    do k = kts, ktf<a name='647'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='648'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='649'>
<font color=#447700>! recompute : mu_old<a name='650'></font>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*(dt/muts(i,j))<a name='651'>
        a_mu_old(i,j) = a_mu_old(i,j)+a_field(i,k,j)*(field(i,k,j)/muts(i,j)+ph_save(i,k,j)/muts(i,j))<a name='652'>
        a_muts(i,j) = a_muts(i,j)+a_field(i,k,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/(muts(i,&amp;<a name='653'>
&amp;j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))<a name='654'>
        a_ph_save(i,k,j) = a_ph_save(i,k,j)+a_field(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='655'>
        a_field(i,k,j) = a_field(i,k,j)*(mu_old(i,j)/muts(i,j))<a name='656'>
        a_mu_tend(i,j) = a_mu_tend(i,j)-a_mu_old(i,j)*dt<a name='657'>
        a_muts(i,j) = a_muts(i,j)+a_mu_old(i,j)<a name='658'>
        a_mu_old(i,j) = 0.<a name='659'>
      end do<a name='660'>
    end do<a name='661'>
  end do<a name='662'>
endif<a name='663'>
field(:,:,:) = fieldh(:,:,:)<a name='664'>
if (jts-jbs .lt. spec_zone) then<a name='665'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='666'>
    b_dist = j-jbs<a name='667'>
<font color=#447700>! recompute : b_dist<a name='668'></font>
    do k = kts, ktf<a name='669'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='670'>
        mu_old(i,j) = muts(i,j)-dt*mu_tend(i,j)<a name='671'>
<font color=#447700>! recompute : mu_old<a name='672'></font>
        a_field_tend(i,k,j) = a_field_tend(i,k,j)+a_field(i,k,j)*(dt/muts(i,j))<a name='673'>
        a_mu_old(i,j) = a_mu_old(i,j)+a_field(i,k,j)*(field(i,k,j)/muts(i,j)+ph_save(i,k,j)/muts(i,j))<a name='674'>
        a_muts(i,j) = a_muts(i,j)+a_field(i,k,j)*((-(field(i,k,j)*mu_old(i,j)/(muts(i,j)*muts(i,j))))-dt*field_tend(i,k,j)/(muts(i,&amp;<a name='675'>
&amp;j)*muts(i,j))-ph_save(i,k,j)*(mu_old(i,j)/(muts(i,j)*muts(i,j))))<a name='676'>
        a_ph_save(i,k,j) = a_ph_save(i,k,j)+a_field(i,k,j)*((-1)+mu_old(i,j)/muts(i,j))<a name='677'>
        a_field(i,k,j) = a_field(i,k,j)*(mu_old(i,j)/muts(i,j))<a name='678'>
        a_mu_tend(i,j) = a_mu_tend(i,j)-a_mu_old(i,j)*dt<a name='679'>
        a_muts(i,j) = a_muts(i,j)+a_mu_old(i,j)<a name='680'>
        a_mu_old(i,j) = 0.<a name='681'>
      end do<a name='682'>
    end do<a name='683'>
  end do<a name='684'>
endif<a name='685'>
<a name='686'>
<font color=#447700>!----------------------------------------------<a name='687'></font>
<font color=#447700>! FREE DYNAMIC MEMORY<a name='688'></font>
<font color=#447700>!----------------------------------------------<a name='689'></font>
<a name='690'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_bc_em_ad.F.html#A_SPEC_BDYUPDATE_PH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_13">("a_spec_bdyupdate_ph")<a name='691'>
<a name='692'>
end subroutine a_spec_bdyupdate_ph<a name='693'>
<a name='694'>
<a name='695'>
end module     a_module_bc_em<a name='696'>
<a name='697'>
<a name='698'>
</pre></body></html>