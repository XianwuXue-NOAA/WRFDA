<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.22<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='G_MODULE_BC'><A href='../../html_code/dyn_em/module_bc_tl.F.html#G_MODULE_BC' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module     </font><font color=#cc0000>g_module_bc</font> <A href='../../call_to/G_MODULE_BC.html' TARGET='index'>5</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_bc_tl.F.html#module_bc_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_7"><a name='35'>
use <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/dyn_em/module_bc_tl.F.html#module_bc_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_8"><a name='36'>
use <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_bc_tl.F.html#module_bc_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_9"><a name='37'>
<a name='38'>
<font color=#447700>!==============================================<a name='39'></font>
<font color=#447700>! all entries are defined explicitly<a name='40'></font>
<font color=#447700>!==============================================<a name='41'></font>
implicit none<a name='42'>
<a name='43'>
contains<a name='44'>
<A NAME='G_RELAX_BDYTEND'><A href='../../html_code/dyn_em/module_bc_tl.F.html#G_RELAX_BDYTEND' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='45'>
<font color=#993300>subroutine </font><font color=#cc0000>g_relax_bdytend</font>( field, g_field, field_tend, g_field_tend, field_bdy, g_field_bdy, field_bdy_tend, g_field_bdy_tend, &amp; <A href='../../call_to/G_RELAX_BDYTEND.html' TARGET='index'>6</A><a name='46'>
&amp;variable_in, spec_bdy_width, spec_zone, relax_zone, dtbc, fcx, gcx, ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, &amp;<a name='47'>
&amp;kms, kme, its, ite, jts, jte, kts, kte )<a name='48'>
<font color=#447700>!******************************************************************<a name='49'></font>
<font color=#447700>!******************************************************************<a name='50'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='51'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='52'></font>
<font color=#447700>!******************************************************************<a name='53'></font>
<font color=#447700>!******************************************************************<a name='54'></font>
<font color=#447700>!==============================================<a name='55'></font>
<font color=#447700>! all entries are defined explicitly<a name='56'></font>
<font color=#447700>!==============================================<a name='57'></font>
implicit none<a name='58'>
<a name='59'>
<font color=#447700>!==============================================<a name='60'></font>
<font color=#447700>! declare arguments<a name='61'></font>
<font color=#447700>!==============================================<a name='62'></font>
real, intent(in) :: dtbc<a name='63'>
integer, intent(in) :: spec_bdy_width<a name='64'>
real, intent(in) :: fcx(spec_bdy_width)<a name='65'>
integer, intent(in) :: ime<a name='66'>
integer, intent(in) :: ims<a name='67'>
integer, intent(in) :: jme<a name='68'>
integer, intent(in) :: jms<a name='69'>
integer, intent(in) :: kme<a name='70'>
integer, intent(in) :: kms<a name='71'>
real, intent(in) :: field(ims:ime,kms:kme,jms:jme)<a name='72'>
integer, intent(in) :: ijde<a name='73'>
integer, intent(in) :: ijds<a name='74'>
integer, intent(in) :: kde<a name='75'>
integer, intent(in) :: kds<a name='76'>
real, intent(in) :: field_bdy(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='77'>
real, intent(in) :: field_bdy_tend(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='78'>
real, intent(inout) :: field_tend(ims:ime,kms:kme,jms:jme)<a name='79'>
real, intent(in) :: g_field(ims:ime,kms:kme,jms:jme)<a name='80'>
real, intent(in) :: g_field_bdy(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='81'>
real, intent(in) :: g_field_bdy_tend(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='82'>
real, intent(inout) :: g_field_tend(ims:ime,kms:kme,jms:jme)<a name='83'>
real, intent(in) :: gcx(spec_bdy_width)<a name='84'>
integer, intent(in) :: ide<a name='85'>
integer, intent(in) :: ids<a name='86'>
integer, intent(in) :: ite<a name='87'>
integer, intent(in) :: its<a name='88'>
integer, intent(in) :: jde<a name='89'>
integer, intent(in) :: jds<a name='90'>
integer, intent(in) :: jte<a name='91'>
integer, intent(in) :: jts<a name='92'>
integer, intent(in) :: kte<a name='93'>
integer, intent(in) :: kts<a name='94'>
integer, intent(in) :: relax_zone<a name='95'>
integer, intent(in) :: spec_zone<a name='96'>
character, intent(in) :: variable_in<a name='97'>
<a name='98'>
<font color=#447700>!==============================================<a name='99'></font>
<font color=#447700>! declare local variables<a name='100'></font>
<font color=#447700>!==============================================<a name='101'></font>
integer b_dist<a name='102'>
real fls0<a name='103'>
real fls1<a name='104'>
real fls2<a name='105'>
real fls3<a name='106'>
real fls4<a name='107'>
real g_fls0<a name='108'>
real g_fls1<a name='109'>
real g_fls2<a name='110'>
real g_fls3<a name='111'>
real g_fls4<a name='112'>
integer i<a name='113'>
integer ibe<a name='114'>
integer ibs<a name='115'>
integer itf<a name='116'>
integer j<a name='117'>
integer jbe<a name='118'>
integer jbs<a name='119'>
integer jtf<a name='120'>
integer k<a name='121'>
integer ktf<a name='122'>
character variable<a name='123'>
<a name='124'>
<font color=#447700>!----------------------------------------------<a name='125'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='126'></font>
<font color=#447700>!----------------------------------------------<a name='127'></font>
variable = variable_in<a name='128'>
if (variable .eq. 'U') then<a name='129'>
  variable = 'u'<a name='130'>
endif<a name='131'>
if (variable .eq. 'V') then<a name='132'>
  variable = 'v'<a name='133'>
endif<a name='134'>
if (variable .eq. 'M') then<a name='135'>
  variable = 'm'<a name='136'>
endif<a name='137'>
if (variable .eq. 'H') then<a name='138'>
  variable = 'h'<a name='139'>
endif<a name='140'>
ibs = ids<a name='141'>
ibe = ide-1<a name='142'>
itf = min(ite,ide-1)<a name='143'>
jbs = jds<a name='144'>
jbe = jde-1<a name='145'>
jtf = min(jte,jde-1)<a name='146'>
ktf = kde-1<a name='147'>
if (variable .eq. 'u') then<a name='148'>
  ibe = ide<a name='149'>
endif<a name='150'>
if (variable .eq. 'u') then<a name='151'>
  itf = min(ite,ide)<a name='152'>
endif<a name='153'>
if (variable .eq. 'v') then<a name='154'>
  jbe = jde<a name='155'>
endif<a name='156'>
if (variable .eq. 'v') then<a name='157'>
  jtf = min(jte,jde)<a name='158'>
endif<a name='159'>
if (variable .eq. 'm') then<a name='160'>
  ktf = kte<a name='161'>
endif<a name='162'>
if (variable .eq. 'h') then<a name='163'>
  ktf = kte<a name='164'>
endif<a name='165'>
if (jts-jbs .lt. relax_zone) then<a name='166'>
  do j = max(jts,jbs+spec_zone), min(jtf,jbs+relax_zone-1)<a name='167'>
    b_dist = j-jbs<a name='168'>
    do k = kts, ktf<a name='169'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='170'>
        g_fls0 = (-g_field(i,k,j))+g_field_bdy(i,k,b_dist+1,p_ysb)+g_field_bdy_tend(i,k,b_dist+1,p_ysb)*dtbc<a name='171'>
        fls0 = field_bdy(i,k,b_dist+1,p_ysb)+dtbc*field_bdy_tend(i,k,b_dist+1,p_ysb)-field(i,k,j)<a name='172'>
        g_fls1 = (-g_field(i-1,k,j))+g_field_bdy(i-1,k,b_dist+1,p_ysb)+g_field_bdy_tend(i-1,k,b_dist+1,p_ysb)*dtbc<a name='173'>
        fls1 = field_bdy(i-1,k,b_dist+1,p_ysb)+dtbc*field_bdy_tend(i-1,k,b_dist+1,p_ysb)-field(i-1,k,j)<a name='174'>
        g_fls2 = (-g_field(i+1,k,j))+g_field_bdy(i+1,k,b_dist+1,p_ysb)+g_field_bdy_tend(i+1,k,b_dist+1,p_ysb)*dtbc<a name='175'>
        fls2 = field_bdy(i+1,k,b_dist+1,p_ysb)+dtbc*field_bdy_tend(i+1,k,b_dist+1,p_ysb)-field(i+1,k,j)<a name='176'>
        g_fls3 = (-g_field(i,k,j-1))+g_field_bdy(i,k,b_dist,p_ysb)+g_field_bdy_tend(i,k,b_dist,p_ysb)*dtbc<a name='177'>
        fls3 = field_bdy(i,k,b_dist,p_ysb)+dtbc*field_bdy_tend(i,k,b_dist,p_ysb)-field(i,k,j-1)<a name='178'>
        g_fls4 = (-g_field(i,k,j+1))+g_field_bdy(i,k,b_dist+2,p_ysb)+g_field_bdy_tend(i,k,b_dist+2,p_ysb)*dtbc<a name='179'>
        fls4 = field_bdy(i,k,b_dist+2,p_ysb)+dtbc*field_bdy_tend(i,k,b_dist+2,p_ysb)-field(i,k,j+1)<a name='180'>
        g_field_tend(i,k,j) = g_field_tend(i,k,j)+g_fls0*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))-g_fls1*gcx(b_dist+1)-g_fls2*gcx(b_dist+&amp;<a name='181'>
&amp;1)-g_fls3*gcx(b_dist+1)-g_fls4*gcx(b_dist+1)<a name='182'>
        field_tend(i,k,j) = field_tend(i,k,j)+fcx(b_dist+1)*fls0-gcx(b_dist+1)*(fls1+fls2+fls3+fls4-4.*fls0)<a name='183'>
      end do<a name='184'>
    end do<a name='185'>
  end do<a name='186'>
endif<a name='187'>
if (jbe-jtf .lt. relax_zone) then<a name='188'>
  do j = max(jts,jbe-relax_zone+1), min(jtf,jbe-spec_zone)<a name='189'>
    b_dist = jbe-j<a name='190'>
    do k = kts, ktf<a name='191'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='192'>
        g_fls0 = (-g_field(i,k,j))+g_field_bdy(i,k,b_dist+1,p_yeb)+g_field_bdy_tend(i,k,b_dist+1,p_yeb)*dtbc<a name='193'>
        fls0 = field_bdy(i,k,b_dist+1,p_yeb)+dtbc*field_bdy_tend(i,k,b_dist+1,p_yeb)-field(i,k,j)<a name='194'>
        g_fls1 = (-g_field(i-1,k,j))+g_field_bdy(i-1,k,b_dist+1,p_yeb)+g_field_bdy_tend(i-1,k,b_dist+1,p_yeb)*dtbc<a name='195'>
        fls1 = field_bdy(i-1,k,b_dist+1,p_yeb)+dtbc*field_bdy_tend(i-1,k,b_dist+1,p_yeb)-field(i-1,k,j)<a name='196'>
        g_fls2 = (-g_field(i+1,k,j))+g_field_bdy(i+1,k,b_dist+1,p_yeb)+g_field_bdy_tend(i+1,k,b_dist+1,p_yeb)*dtbc<a name='197'>
        fls2 = field_bdy(i+1,k,b_dist+1,p_yeb)+dtbc*field_bdy_tend(i+1,k,b_dist+1,p_yeb)-field(i+1,k,j)<a name='198'>
        g_fls3 = (-g_field(i,k,j+1))+g_field_bdy(i,k,b_dist,p_yeb)+g_field_bdy_tend(i,k,b_dist,p_yeb)*dtbc<a name='199'>
        fls3 = field_bdy(i,k,b_dist,p_yeb)+dtbc*field_bdy_tend(i,k,b_dist,p_yeb)-field(i,k,j+1)<a name='200'>
        g_fls4 = (-g_field(i,k,j-1))+g_field_bdy(i,k,b_dist+2,p_yeb)+g_field_bdy_tend(i,k,b_dist+2,p_yeb)*dtbc<a name='201'>
        fls4 = field_bdy(i,k,b_dist+2,p_yeb)+dtbc*field_bdy_tend(i,k,b_dist+2,p_yeb)-field(i,k,j-1)<a name='202'>
        g_field_tend(i,k,j) = g_field_tend(i,k,j)+g_fls0*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))-g_fls1*gcx(b_dist+1)-g_fls2*gcx(b_dist+&amp;<a name='203'>
&amp;1)-g_fls3*gcx(b_dist+1)-g_fls4*gcx(b_dist+1)<a name='204'>
        field_tend(i,k,j) = field_tend(i,k,j)+fcx(b_dist+1)*fls0-gcx(b_dist+1)*(fls1+fls2+fls3+fls4-4.*fls0)<a name='205'>
      end do<a name='206'>
    end do<a name='207'>
  end do<a name='208'>
endif<a name='209'>
if (its-ibs .lt. relax_zone) then<a name='210'>
  do i = max(its,ibs+spec_zone), min(itf,ibs+relax_zone-1)<a name='211'>
    b_dist = i-ibs<a name='212'>
    do k = kts, ktf<a name='213'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='214'>
        g_fls0 = (-g_field(i,k,j))+g_field_bdy(j,k,b_dist+1,p_xsb)+g_field_bdy_tend(j,k,b_dist+1,p_xsb)*dtbc<a name='215'>
        fls0 = field_bdy(j,k,b_dist+1,p_xsb)+dtbc*field_bdy_tend(j,k,b_dist+1,p_xsb)-field(i,k,j)<a name='216'>
        g_fls1 = (-g_field(i,k,j-1))+g_field_bdy(j-1,k,b_dist+1,p_xsb)+g_field_bdy_tend(j-1,k,b_dist+1,p_xsb)*dtbc<a name='217'>
        fls1 = field_bdy(j-1,k,b_dist+1,p_xsb)+dtbc*field_bdy_tend(j-1,k,b_dist+1,p_xsb)-field(i,k,j-1)<a name='218'>
        g_fls2 = (-g_field(i,k,j+1))+g_field_bdy(j+1,k,b_dist+1,p_xsb)+g_field_bdy_tend(j+1,k,b_dist+1,p_xsb)*dtbc<a name='219'>
        fls2 = field_bdy(j+1,k,b_dist+1,p_xsb)+dtbc*field_bdy_tend(j+1,k,b_dist+1,p_xsb)-field(i,k,j+1)<a name='220'>
        g_fls3 = (-g_field(i-1,k,j))+g_field_bdy(j,k,b_dist,p_xsb)+g_field_bdy_tend(j,k,b_dist,p_xsb)*dtbc<a name='221'>
        fls3 = field_bdy(j,k,b_dist,p_xsb)+dtbc*field_bdy_tend(j,k,b_dist,p_xsb)-field(i-1,k,j)<a name='222'>
        g_fls4 = (-g_field(i+1,k,j))+g_field_bdy(j,k,b_dist+2,p_xsb)+g_field_bdy_tend(j,k,b_dist+2,p_xsb)*dtbc<a name='223'>
        fls4 = field_bdy(j,k,b_dist+2,p_xsb)+dtbc*field_bdy_tend(j,k,b_dist+2,p_xsb)-field(i+1,k,j)<a name='224'>
        g_field_tend(i,k,j) = g_field_tend(i,k,j)+g_fls0*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))-g_fls1*gcx(b_dist+1)-g_fls2*gcx(b_dist+&amp;<a name='225'>
&amp;1)-g_fls3*gcx(b_dist+1)-g_fls4*gcx(b_dist+1)<a name='226'>
        field_tend(i,k,j) = field_tend(i,k,j)+fcx(b_dist+1)*fls0-gcx(b_dist+1)*(fls1+fls2+fls3+fls4-4.*fls0)<a name='227'>
      end do<a name='228'>
    end do<a name='229'>
  end do<a name='230'>
endif<a name='231'>
if (ibe-itf .lt. relax_zone) then<a name='232'>
  do i = max(its,ibe-relax_zone+1), min(itf,ibe-spec_zone)<a name='233'>
    b_dist = ibe-i<a name='234'>
    do k = kts, ktf<a name='235'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='236'>
        g_fls0 = (-g_field(i,k,j))+g_field_bdy(j,k,b_dist+1,p_xeb)+g_field_bdy_tend(j,k,b_dist+1,p_xeb)*dtbc<a name='237'>
        fls0 = field_bdy(j,k,b_dist+1,p_xeb)+dtbc*field_bdy_tend(j,k,b_dist+1,p_xeb)-field(i,k,j)<a name='238'>
        g_fls1 = (-g_field(i,k,j-1))+g_field_bdy(j-1,k,b_dist+1,p_xeb)+g_field_bdy_tend(j-1,k,b_dist+1,p_xeb)*dtbc<a name='239'>
        fls1 = field_bdy(j-1,k,b_dist+1,p_xeb)+dtbc*field_bdy_tend(j-1,k,b_dist+1,p_xeb)-field(i,k,j-1)<a name='240'>
        g_fls2 = (-g_field(i,k,j+1))+g_field_bdy(j+1,k,b_dist+1,p_xeb)+g_field_bdy_tend(j+1,k,b_dist+1,p_xeb)*dtbc<a name='241'>
        fls2 = field_bdy(j+1,k,b_dist+1,p_xeb)+dtbc*field_bdy_tend(j+1,k,b_dist+1,p_xeb)-field(i,k,j+1)<a name='242'>
        g_fls3 = (-g_field(i+1,k,j))+g_field_bdy(j,k,b_dist,p_xeb)+g_field_bdy_tend(j,k,b_dist,p_xeb)*dtbc<a name='243'>
        fls3 = field_bdy(j,k,b_dist,p_xeb)+dtbc*field_bdy_tend(j,k,b_dist,p_xeb)-field(i+1,k,j)<a name='244'>
        g_fls4 = (-g_field(i-1,k,j))+g_field_bdy(j,k,b_dist+2,p_xeb)+g_field_bdy_tend(j,k,b_dist+2,p_xeb)*dtbc<a name='245'>
        fls4 = field_bdy(j,k,b_dist+2,p_xeb)+dtbc*field_bdy_tend(j,k,b_dist+2,p_xeb)-field(i-1,k,j)<a name='246'>
        g_field_tend(i,k,j) = g_field_tend(i,k,j)+g_fls0*(fcx(b_dist+1)-(-4)*gcx(b_dist+1))-g_fls1*gcx(b_dist+1)-g_fls2*gcx(b_dist+&amp;<a name='247'>
&amp;1)-g_fls3*gcx(b_dist+1)-g_fls4*gcx(b_dist+1)<a name='248'>
        field_tend(i,k,j) = field_tend(i,k,j)+fcx(b_dist+1)*fls0-gcx(b_dist+1)*(fls1+fls2+fls3+fls4-4.*fls0)<a name='249'>
      end do<a name='250'>
    end do<a name='251'>
  end do<a name='252'>
endif<a name='253'>
<a name='254'>
end subroutine g_relax_bdytend<a name='255'>
<a name='256'>
<a name='257'>
<A NAME='G_SPEC_BDYTEND'><A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYTEND' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='258'>
<font color=#993300>subroutine </font><font color=#cc0000>g_spec_bdytend</font>( field_tend, g_field_tend, field_bdy_tend, g_field_bdy_tend, variable_in, spec_bdy_width, spec_zone, &amp; <A href='../../call_to/G_SPEC_BDYTEND.html' TARGET='index'>7</A><a name='259'>
&amp;ijds, ijde, ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='260'>
<font color=#447700>!******************************************************************<a name='261'></font>
<font color=#447700>!******************************************************************<a name='262'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='263'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='264'></font>
<font color=#447700>!******************************************************************<a name='265'></font>
<font color=#447700>!******************************************************************<a name='266'></font>
<font color=#447700>!==============================================<a name='267'></font>
<font color=#447700>! all entries are defined explicitly<a name='268'></font>
<font color=#447700>!==============================================<a name='269'></font>
implicit none<a name='270'>
<a name='271'>
<font color=#447700>!==============================================<a name='272'></font>
<font color=#447700>! declare arguments<a name='273'></font>
<font color=#447700>!==============================================<a name='274'></font>
integer, intent(in) :: ijde<a name='275'>
integer, intent(in) :: ijds<a name='276'>
integer, intent(in) :: kde<a name='277'>
integer, intent(in) :: kds<a name='278'>
integer, intent(in) :: spec_bdy_width<a name='279'>
real, intent(in) :: field_bdy_tend(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='280'>
integer, intent(in) :: ime<a name='281'>
integer, intent(in) :: ims<a name='282'>
integer, intent(in) :: jme<a name='283'>
integer, intent(in) :: jms<a name='284'>
integer, intent(in) :: kme<a name='285'>
integer, intent(in) :: kms<a name='286'>
real, intent(out) :: field_tend(ims:ime,kms:kme,jms:jme)<a name='287'>
real, intent(in) :: g_field_bdy_tend(ijds:ijde,kds:kde,spec_bdy_width,4)<a name='288'>
real, intent(out) :: g_field_tend(ims:ime,kms:kme,jms:jme)<a name='289'>
integer, intent(in) :: ide<a name='290'>
integer, intent(in) :: ids<a name='291'>
integer, intent(in) :: ite<a name='292'>
integer, intent(in) :: its<a name='293'>
integer, intent(in) :: jde<a name='294'>
integer, intent(in) :: jds<a name='295'>
integer, intent(in) :: jte<a name='296'>
integer, intent(in) :: jts<a name='297'>
integer, intent(in) :: kte<a name='298'>
integer, intent(in) :: kts<a name='299'>
integer, intent(in) :: spec_zone<a name='300'>
character, intent(in) :: variable_in<a name='301'>
<a name='302'>
<font color=#447700>!==============================================<a name='303'></font>
<font color=#447700>! declare local variables<a name='304'></font>
<font color=#447700>!==============================================<a name='305'></font>
integer b_dist<a name='306'>
integer i<a name='307'>
integer ibe<a name='308'>
integer ibs<a name='309'>
integer itf<a name='310'>
integer j<a name='311'>
integer jbe<a name='312'>
integer jbs<a name='313'>
integer jtf<a name='314'>
integer k<a name='315'>
integer ktf<a name='316'>
character variable<a name='317'>
<a name='318'>
<font color=#447700>!----------------------------------------------<a name='319'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='320'></font>
<font color=#447700>!----------------------------------------------<a name='321'></font>
variable = variable_in<a name='322'>
if (variable .eq. 'U') then<a name='323'>
  variable = 'u'<a name='324'>
endif<a name='325'>
if (variable .eq. 'V') then<a name='326'>
  variable = 'v'<a name='327'>
endif<a name='328'>
if (variable .eq. 'M') then<a name='329'>
  variable = 'm'<a name='330'>
endif<a name='331'>
if (variable .eq. 'H') then<a name='332'>
  variable = 'h'<a name='333'>
endif<a name='334'>
ibs = ids<a name='335'>
ibe = ide-1<a name='336'>
itf = min(ite,ide-1)<a name='337'>
jbs = jds<a name='338'>
jbe = jde-1<a name='339'>
jtf = min(jte,jde-1)<a name='340'>
ktf = kde-1<a name='341'>
if (variable .eq. 'u') then<a name='342'>
  ibe = ide<a name='343'>
endif<a name='344'>
if (variable .eq. 'u') then<a name='345'>
  itf = min(ite,ide)<a name='346'>
endif<a name='347'>
if (variable .eq. 'v') then<a name='348'>
  jbe = jde<a name='349'>
endif<a name='350'>
if (variable .eq. 'v') then<a name='351'>
  jtf = min(jte,jde)<a name='352'>
endif<a name='353'>
if (variable .eq. 'm') then<a name='354'>
  ktf = kte<a name='355'>
endif<a name='356'>
if (variable .eq. 'h') then<a name='357'>
  ktf = kte<a name='358'>
endif<a name='359'>
if (jts-jbs .lt. spec_zone) then<a name='360'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='361'>
    b_dist = j-jbs<a name='362'>
    do k = kts, ktf<a name='363'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='364'>
        g_field_tend(i,k,j) = g_field_bdy_tend(i,k,b_dist+1,p_ysb)<a name='365'>
        field_tend(i,k,j) = field_bdy_tend(i,k,b_dist+1,p_ysb)<a name='366'>
      end do<a name='367'>
    end do<a name='368'>
  end do<a name='369'>
endif<a name='370'>
if (jbe-jtf .lt. spec_zone) then<a name='371'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='372'>
    b_dist = jbe-j<a name='373'>
    do k = kts, ktf<a name='374'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='375'>
        g_field_tend(i,k,j) = g_field_bdy_tend(i,k,b_dist+1,p_yeb)<a name='376'>
        field_tend(i,k,j) = field_bdy_tend(i,k,b_dist+1,p_yeb)<a name='377'>
      end do<a name='378'>
    end do<a name='379'>
  end do<a name='380'>
endif<a name='381'>
if (its-ibs .lt. spec_zone) then<a name='382'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='383'>
    b_dist = i-ibs<a name='384'>
    do k = kts, ktf<a name='385'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='386'>
        g_field_tend(i,k,j) = g_field_bdy_tend(j,k,b_dist+1,p_xsb)<a name='387'>
        field_tend(i,k,j) = field_bdy_tend(j,k,b_dist+1,p_xsb)<a name='388'>
      end do<a name='389'>
    end do<a name='390'>
  end do<a name='391'>
endif<a name='392'>
if (ibe-itf .lt. spec_zone) then<a name='393'>
  do i = max(its,ibe-spec_zone+1), itf<a name='394'>
    b_dist = ibe-i<a name='395'>
    do k = kts, ktf<a name='396'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='397'>
        g_field_tend(i,k,j) = g_field_bdy_tend(j,k,b_dist+1,p_xeb)<a name='398'>
        field_tend(i,k,j) = field_bdy_tend(j,k,b_dist+1,p_xeb)<a name='399'>
      end do<a name='400'>
    end do<a name='401'>
  end do<a name='402'>
endif<a name='403'>
<a name='404'>
end subroutine g_spec_bdytend<a name='405'>
<a name='406'>
<a name='407'>
<A NAME='G_SPEC_BDYUPDATE'><A href='../../html_code/dyn_em/module_bc_tl.F.html#G_SPEC_BDYUPDATE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='408'>
<font color=#993300>subroutine </font><font color=#cc0000>g_spec_bdyupdate</font>( field, g_field, field_tend, g_field_tend, dt, variable_in, spec_zone, ids, ide, jds, jde, kde, ims, &amp; <A href='../../call_to/G_SPEC_BDYUPDATE.html' TARGET='index'>8</A><a name='409'>
&amp;ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='410'>
<font color=#447700>!******************************************************************<a name='411'></font>
<font color=#447700>!******************************************************************<a name='412'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='413'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='414'></font>
<font color=#447700>!******************************************************************<a name='415'></font>
<font color=#447700>!******************************************************************<a name='416'></font>
<font color=#447700>!==============================================<a name='417'></font>
<font color=#447700>! all entries are defined explicitly<a name='418'></font>
<font color=#447700>!==============================================<a name='419'></font>
implicit none<a name='420'>
<a name='421'>
<font color=#447700>!==============================================<a name='422'></font>
<font color=#447700>! declare arguments<a name='423'></font>
<font color=#447700>!==============================================<a name='424'></font>
real, intent(in) :: dt<a name='425'>
integer, intent(in) :: ime<a name='426'>
integer, intent(in) :: ims<a name='427'>
integer, intent(in) :: jme<a name='428'>
integer, intent(in) :: jms<a name='429'>
integer, intent(in) :: kme<a name='430'>
integer, intent(in) :: kms<a name='431'>
real, intent(inout) :: field(ims:ime,kms:kme,jms:jme)<a name='432'>
real, intent(in) :: field_tend(ims:ime,kms:kme,jms:jme)<a name='433'>
real, intent(inout) :: g_field(ims:ime,kms:kme,jms:jme)<a name='434'>
real, intent(in) :: g_field_tend(ims:ime,kms:kme,jms:jme)<a name='435'>
integer, intent(in) :: ide<a name='436'>
integer, intent(in) :: ids<a name='437'>
integer, intent(in) :: ite<a name='438'>
integer, intent(in) :: its<a name='439'>
integer, intent(in) :: jde<a name='440'>
integer, intent(in) :: jds<a name='441'>
integer, intent(in) :: jte<a name='442'>
integer, intent(in) :: jts<a name='443'>
integer, intent(in) :: kde<a name='444'>
integer, intent(in) :: kte<a name='445'>
integer, intent(in) :: kts<a name='446'>
integer, intent(in) :: spec_zone<a name='447'>
character, intent(in) :: variable_in<a name='448'>
<a name='449'>
<font color=#447700>!==============================================<a name='450'></font>
<font color=#447700>! declare local variables<a name='451'></font>
<font color=#447700>!==============================================<a name='452'></font>
integer b_dist<a name='453'>
integer i<a name='454'>
integer ibe<a name='455'>
integer ibs<a name='456'>
integer itf<a name='457'>
integer j<a name='458'>
integer jbe<a name='459'>
integer jbs<a name='460'>
integer jtf<a name='461'>
integer k<a name='462'>
integer ktf<a name='463'>
character variable<a name='464'>
<a name='465'>
<font color=#447700>!----------------------------------------------<a name='466'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='467'></font>
<font color=#447700>!----------------------------------------------<a name='468'></font>
variable = variable_in<a name='469'>
if (variable .eq. 'U') then<a name='470'>
  variable = 'u'<a name='471'>
endif<a name='472'>
if (variable .eq. 'V') then<a name='473'>
  variable = 'v'<a name='474'>
endif<a name='475'>
if (variable .eq. 'M') then<a name='476'>
  variable = 'm'<a name='477'>
endif<a name='478'>
if (variable .eq. 'H') then<a name='479'>
  variable = 'h'<a name='480'>
endif<a name='481'>
ibs = ids<a name='482'>
ibe = ide-1<a name='483'>
itf = min(ite,ide-1)<a name='484'>
jbs = jds<a name='485'>
jbe = jde-1<a name='486'>
jtf = min(jte,jde-1)<a name='487'>
ktf = kde-1<a name='488'>
if (variable .eq. 'u') then<a name='489'>
  ibe = ide<a name='490'>
endif<a name='491'>
if (variable .eq. 'u') then<a name='492'>
  itf = min(ite,ide)<a name='493'>
endif<a name='494'>
if (variable .eq. 'v') then<a name='495'>
  jbe = jde<a name='496'>
endif<a name='497'>
if (variable .eq. 'v') then<a name='498'>
  jtf = min(jte,jde)<a name='499'>
endif<a name='500'>
if (variable .eq. 'm') then<a name='501'>
  ktf = kte<a name='502'>
endif<a name='503'>
if (variable .eq. 'h') then<a name='504'>
  ktf = kte<a name='505'>
endif<a name='506'>
if (jts-jbs .lt. spec_zone) then<a name='507'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='508'>
    b_dist = j-jbs<a name='509'>
    do k = kts, ktf<a name='510'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='511'>
        g_field(i,k,j) = g_field(i,k,j)+g_field_tend(i,k,j)*dt<a name='512'>
        field(i,k,j) = field(i,k,j)+dt*field_tend(i,k,j)<a name='513'>
      end do<a name='514'>
    end do<a name='515'>
  end do<a name='516'>
endif<a name='517'>
if (jbe-jtf .lt. spec_zone) then<a name='518'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='519'>
    b_dist = jbe-j<a name='520'>
    do k = kts, ktf<a name='521'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='522'>
        g_field(i,k,j) = g_field(i,k,j)+g_field_tend(i,k,j)*dt<a name='523'>
        field(i,k,j) = field(i,k,j)+dt*field_tend(i,k,j)<a name='524'>
      end do<a name='525'>
    end do<a name='526'>
  end do<a name='527'>
endif<a name='528'>
if (its-ibs .lt. spec_zone) then<a name='529'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='530'>
    b_dist = i-ibs<a name='531'>
    do k = kts, ktf<a name='532'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='533'>
        g_field(i,k,j) = g_field(i,k,j)+g_field_tend(i,k,j)*dt<a name='534'>
        field(i,k,j) = field(i,k,j)+dt*field_tend(i,k,j)<a name='535'>
      end do<a name='536'>
    end do<a name='537'>
  end do<a name='538'>
endif<a name='539'>
if (ibe-itf .lt. spec_zone) then<a name='540'>
  do i = max(its,ibe-spec_zone+1), itf<a name='541'>
    b_dist = ibe-i<a name='542'>
    do k = kts, ktf<a name='543'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='544'>
        g_field(i,k,j) = g_field(i,k,j)+g_field_tend(i,k,j)*dt<a name='545'>
        field(i,k,j) = field(i,k,j)+dt*field_tend(i,k,j)<a name='546'>
      end do<a name='547'>
    end do<a name='548'>
  end do<a name='549'>
endif<a name='550'>
<a name='551'>
end subroutine g_spec_bdyupdate<a name='552'>
<a name='553'>
<a name='554'>
<A NAME='G_ZERO_GRAD_BDY'><A href='../../html_code/dyn_em/module_bc_tl.F.html#G_ZERO_GRAD_BDY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='555'>
<font color=#993300>subroutine </font><font color=#cc0000>g_zero_grad_bdy</font>( field, g_field, variable_in, spec_zone, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, &amp; <A href='../../call_to/G_ZERO_GRAD_BDY.html' TARGET='index'>1</A><a name='556'>
&amp;ite, jts, jte, kts )<a name='557'>
<font color=#447700>!******************************************************************<a name='558'></font>
<font color=#447700>!******************************************************************<a name='559'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='560'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.22  **<a name='561'></font>
<font color=#447700>!******************************************************************<a name='562'></font>
<font color=#447700>!******************************************************************<a name='563'></font>
<font color=#447700>!==============================================<a name='564'></font>
<font color=#447700>! all entries are defined explicitly<a name='565'></font>
<font color=#447700>!==============================================<a name='566'></font>
implicit none<a name='567'>
<a name='568'>
<font color=#447700>!==============================================<a name='569'></font>
<font color=#447700>! declare arguments<a name='570'></font>
<font color=#447700>!==============================================<a name='571'></font>
integer, intent(in) :: ime<a name='572'>
integer, intent(in) :: ims<a name='573'>
integer, intent(in) :: jme<a name='574'>
integer, intent(in) :: jms<a name='575'>
integer, intent(in) :: kme<a name='576'>
integer, intent(in) :: kms<a name='577'>
real, intent(inout) :: field(ims:ime,kms:kme,jms:jme)<a name='578'>
real, intent(inout) :: g_field(ims:ime,kms:kme,jms:jme)<a name='579'>
integer, intent(in) :: ide<a name='580'>
integer, intent(in) :: ids<a name='581'>
integer, intent(in) :: ite<a name='582'>
integer, intent(in) :: its<a name='583'>
integer, intent(in) :: jde<a name='584'>
integer, intent(in) :: jds<a name='585'>
integer, intent(in) :: jte<a name='586'>
integer, intent(in) :: jts<a name='587'>
integer, intent(in) :: kde<a name='588'>
integer, intent(in) :: kts<a name='589'>
integer, intent(in) :: spec_zone<a name='590'>
character, intent(in) :: variable_in<a name='591'>
<a name='592'>
<font color=#447700>!==============================================<a name='593'></font>
<font color=#447700>! declare local variables<a name='594'></font>
<font color=#447700>!==============================================<a name='595'></font>
integer b_dist<a name='596'>
integer i<a name='597'>
integer i_inner<a name='598'>
integer ibe<a name='599'>
integer ibs<a name='600'>
integer itf<a name='601'>
integer j<a name='602'>
integer j_inner<a name='603'>
integer jbe<a name='604'>
integer jbs<a name='605'>
integer jtf<a name='606'>
integer k<a name='607'>
integer ktf<a name='608'>
character variable<a name='609'>
<a name='610'>
<font color=#447700>!----------------------------------------------<a name='611'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='612'></font>
<font color=#447700>!----------------------------------------------<a name='613'></font>
variable = variable_in<a name='614'>
if (variable .eq. 'U') then<a name='615'>
  variable = 'u'<a name='616'>
endif<a name='617'>
if (variable .eq. 'V') then<a name='618'>
  variable = 'v'<a name='619'>
endif<a name='620'>
ibs = ids<a name='621'>
ibe = ide-1<a name='622'>
itf = min(ite,ide-1)<a name='623'>
jbs = jds<a name='624'>
jbe = jde-1<a name='625'>
jtf = min(jte,jde-1)<a name='626'>
ktf = kde-1<a name='627'>
if (variable .eq. 'u') then<a name='628'>
  ibe = ide<a name='629'>
endif<a name='630'>
if (variable .eq. 'u') then<a name='631'>
  itf = min(ite,ide)<a name='632'>
endif<a name='633'>
if (variable .eq. 'v') then<a name='634'>
  jbe = jde<a name='635'>
endif<a name='636'>
if (variable .eq. 'v') then<a name='637'>
  jtf = min(jte,jde)<a name='638'>
endif<a name='639'>
if (variable .eq. 'w') then<a name='640'>
  ktf = kde<a name='641'>
endif<a name='642'>
if (jts-jbs .lt. spec_zone) then<a name='643'>
  do j = jts, min(jtf,jbs+spec_zone-1)<a name='644'>
    b_dist = j-jbs<a name='645'>
    do k = kts, ktf<a name='646'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='647'>
        i_inner = max(i,ibs+spec_zone)<a name='648'>
        i_inner = min(i_inner,ibe-spec_zone)<a name='649'>
        g_field(i,k,j) = g_field(i_inner,k,jbs+spec_zone)<a name='650'>
        field(i,k,j) = field(i_inner,k,jbs+spec_zone)<a name='651'>
      end do<a name='652'>
    end do<a name='653'>
  end do<a name='654'>
endif<a name='655'>
if (jbe-jtf .lt. spec_zone) then<a name='656'>
  do j = max(jts,jbe-spec_zone+1), jtf<a name='657'>
    b_dist = jbe-j<a name='658'>
    do k = kts, ktf<a name='659'>
      do i = max(its,b_dist+ibs), min(itf,ibe-b_dist)<a name='660'>
        i_inner = max(i,ibs+spec_zone)<a name='661'>
        i_inner = min(i_inner,ibe-spec_zone)<a name='662'>
        g_field(i,k,j) = g_field(i_inner,k,jbe-spec_zone)<a name='663'>
        field(i,k,j) = field(i_inner,k,jbe-spec_zone)<a name='664'>
      end do<a name='665'>
    end do<a name='666'>
  end do<a name='667'>
endif<a name='668'>
if (its-ibs .lt. spec_zone) then<a name='669'>
  do i = its, min(itf,ibs+spec_zone-1)<a name='670'>
    b_dist = i-ibs<a name='671'>
    do k = kts, ktf<a name='672'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='673'>
        j_inner = max(j,jbs+spec_zone)<a name='674'>
        j_inner = min(j_inner,jbe-spec_zone)<a name='675'>
        g_field(i,k,j) = g_field(ibs+spec_zone,k,j_inner)<a name='676'>
        field(i,k,j) = field(ibs+spec_zone,k,j_inner)<a name='677'>
      end do<a name='678'>
    end do<a name='679'>
  end do<a name='680'>
endif<a name='681'>
if (ibe-itf .lt. spec_zone) then<a name='682'>
  do i = max(its,ibe-spec_zone+1), itf<a name='683'>
    b_dist = ibe-i<a name='684'>
    do k = kts, ktf<a name='685'>
      do j = max(jts,b_dist+jbs+1), min(jtf,jbe-b_dist-1)<a name='686'>
        j_inner = max(j,jbs+spec_zone)<a name='687'>
        j_inner = min(j_inner,jbe-spec_zone)<a name='688'>
        g_field(i,k,j) = g_field(ibe-spec_zone,k,j_inner)<a name='689'>
        field(i,k,j) = field(ibe-spec_zone,k,j_inner)<a name='690'>
      end do<a name='691'>
    end do<a name='692'>
  end do<a name='693'>
endif<a name='694'>
<a name='695'>
end subroutine g_zero_grad_bdy<a name='696'>
<a name='697'>
<a name='698'>
end module     g_module_bc<a name='699'>
<a name='700'>
<a name='701'>
</pre></body></html>