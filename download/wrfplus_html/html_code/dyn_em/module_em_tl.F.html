<HTML> <BODY BGCOLOR=#cceeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!                           DISCLAIMER<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>!   This file was generated by TAF version 1.7.18<a name='4'></font>
<font color=#447700>!<a name='5'></font>
<font color=#447700>!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,<a name='6'></font>
<font color=#447700>!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF<a name='7'></font>
<font color=#447700>!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH<a name='8'></font>
<font color=#447700>!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT<a name='9'></font>
<font color=#447700>!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-<a name='10'></font>
<font color=#447700>!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR<a name='11'></font>
<font color=#447700>!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED<a name='12'></font>
<font color=#447700>!   OF THE POSSIBILITY OF SUCH DAMAGES.<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>!                           Haftungsbeschraenkung<a name='15'></font>
<font color=#447700>!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,<a name='16'></font>
<font color=#447700>!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten<a name='17'></font>
<font color=#447700>!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer<a name='18'></font>
<font color=#447700>!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und<a name='19'></font>
<font color=#447700>!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen<a name='20'></font>
<font color=#447700>!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen<a name='21'></font>
<font color=#447700>!   Mitteilung darueber an FastOpt.<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<A NAME='G_MODULE_EM'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_MODULE_EM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='24'>
<font color=#993300>module </font><font color=#cc0000>g_module_em</font> <A href='../../call_to/G_MODULE_EM.html' TARGET='index'>3</A><a name='25'>
<font color=#447700>!******************************************************************<a name='26'></font>
<font color=#447700>!******************************************************************<a name='27'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='28'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='29'></font>
<font color=#447700>!******************************************************************<a name='30'></font>
<font color=#447700>!******************************************************************<a name='31'></font>
<font color=#447700>!==============================================<a name='32'></font>
<font color=#447700>! referencing used modules<a name='33'></font>
<font color=#447700>!==============================================<a name='34'></font>
use <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_12"><a name='35'>
use <A href='../../html_code/dyn_em/module_advect_em.F.html#MODULE_ADVECT_EM'>module_advect_em</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_ADVECT_EM_5"><a name='36'>
use <A href='../../html_code/dyn_em/module_big_step_utilities_em.F.html#MODULE_BIG_STEP_UTILITIES_EM'>module_big_step_utilities_em</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BIG_STEP_UTILITIES_EM_10"><a name='37'>
use module_state_description<a name='38'>
use <A href='../../html_code/dyn_em/module_em.F.html#MODULE_EM'>module_em</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_EM_2"><a name='39'>
<a name='40'>
use <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_MODULE_ADVECT_EM'>g_module_advect_em</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_MODULE_ADVECT_EM_2"><a name='41'>
use <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_MODULE_BIG_STEP_UTILITIES_EM'>g_module_big_step_utilities_em</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_MODULE_BIG_STEP_UTILITIES_EM_3"><a name='42'>
<a name='43'>
USE <A href='../../html_code/frame/module_trace.F.html#MODULE_TRACE'>module_trace</A><A href='../../html_code/dyn_em/module_em_tl.F.html#module_em_tl.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_TRACE_9">, only : trace_entry, trace_exit<a name='44'>
<a name='45'>
<font color=#447700>!==============================================<a name='46'></font>
<font color=#447700>! all entries are defined explicitly<a name='47'></font>
<font color=#447700>!==============================================<a name='48'></font>
implicit none<a name='49'>
<a name='50'>
contains<a name='51'>
<A NAME='G_INIT_ZERO_TENDENCY'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='52'>
<font color=#993300>subroutine </font><font color=#cc0000>g_init_zero_tendency</font>( ru_tendf, g_ru_tendf, rv_tendf, g_rv_tendf, rw_tendf, g_rw_tendf, ph_tendf, g_ph_tendf, t_tendf, &amp; <A href='../../call_to/G_INIT_ZERO_TENDENCY.html' TARGET='index'>3</A>,<A href='../../call_from/G_INIT_ZERO_TENDENCY.html' TARGET='index'>8</A><a name='53'>
&amp;g_t_tendf, moist_tendf, g_moist_tendf, n_moist, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='54'>
<font color=#447700>!******************************************************************<a name='55'></font>
<font color=#447700>!******************************************************************<a name='56'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='57'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='58'></font>
<font color=#447700>!******************************************************************<a name='59'></font>
<font color=#447700>!******************************************************************<a name='60'></font>
<font color=#447700>!==============================================<a name='61'></font>
<font color=#447700>! all entries are defined explicitly<a name='62'></font>
<font color=#447700>!==============================================<a name='63'></font>
implicit none<a name='64'>
<a name='65'>
<font color=#447700>!==============================================<a name='66'></font>
<font color=#447700>! declare arguments<a name='67'></font>
<font color=#447700>!==============================================<a name='68'></font>
integer, intent(in) :: ime<a name='69'>
integer, intent(in) :: ims<a name='70'>
integer, intent(in) :: jme<a name='71'>
integer, intent(in) :: jms<a name='72'>
integer, intent(in) :: kme<a name='73'>
integer, intent(in) :: kms<a name='74'>
integer, intent(in) :: n_moist<a name='75'>
real, intent(inout) :: g_moist_tendf(ims:ime,kms:kme,jms:jme,n_moist)<a name='76'>
real, intent(inout) :: g_ph_tendf(ims:ime,kms:kme,jms:jme)<a name='77'>
real, intent(inout) :: g_ru_tendf(ims:ime,kms:kme,jms:jme)<a name='78'>
real, intent(inout) :: g_rv_tendf(ims:ime,kms:kme,jms:jme)<a name='79'>
real, intent(inout) :: g_rw_tendf(ims:ime,kms:kme,jms:jme)<a name='80'>
real, intent(inout) :: g_t_tendf(ims:ime,kms:kme,jms:jme)<a name='81'>
integer, intent(in) :: ite<a name='82'>
integer, intent(in) :: its<a name='83'>
integer, intent(in) :: jte<a name='84'>
integer, intent(in) :: jts<a name='85'>
integer, intent(in) :: kte<a name='86'>
integer, intent(in) :: kts<a name='87'>
real, intent(inout) :: moist_tendf(ims:ime,kms:kme,jms:jme,n_moist)<a name='88'>
real, intent(inout) :: ph_tendf(ims:ime,kms:kme,jms:jme)<a name='89'>
real, intent(inout) :: ru_tendf(ims:ime,kms:kme,jms:jme)<a name='90'>
real, intent(inout) :: rv_tendf(ims:ime,kms:kme,jms:jme)<a name='91'>
real, intent(inout) :: rw_tendf(ims:ime,kms:kme,jms:jme)<a name='92'>
real, intent(inout) :: t_tendf(ims:ime,kms:kme,jms:jme)<a name='93'>
<a name='94'>
<font color=#447700>!==============================================<a name='95'></font>
<font color=#447700>! declare local variables<a name='96'></font>
<font color=#447700>!==============================================<a name='97'></font>
integer im<a name='98'>
<a name='99'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_81">("g_init_zero_tendency")<a name='100'>
<a name='101'>
<font color=#447700>!----------------------------------------------<a name='102'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='103'></font>
<font color=#447700>!----------------------------------------------<a name='104'></font>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_1">( ru_tendf,g_ru_tendf,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='105'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_2">( rv_tendf,g_rv_tendf,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='106'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_3">( rw_tendf,g_rw_tendf,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='107'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_4">( ph_tendf,g_ph_tendf,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='108'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_5">( t_tendf,g_t_tendf,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='109'>
do im = 1, n_moist<a name='110'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_6">( moist_tendf(ims,kms,jms,im),g_moist_tendf(ims,kms,jms,im),ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='111'>
end do<a name='112'>
<a name='113'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_INIT_ZERO_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_81">("g_init_zero_tendency")<a name='114'>
<a name='115'>
end subroutine g_init_zero_tendency<a name='116'>
<a name='117'>
<a name='118'>
<A NAME='G_RK_ADDTEND_DRY'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_ADDTEND_DRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='119'>
<font color=#993300>subroutine </font><font color=#cc0000>g_rk_addtend_dry</font>( ru_tend, g_ru_tend, rv_tend, g_rv_tend, rw_tend, g_rw_tend, ph_tend, g_ph_tend, t_tend, g_t_tend, &amp; <A href='../../call_to/G_RK_ADDTEND_DRY.html' TARGET='index'>3</A>,<A href='../../call_from/G_RK_ADDTEND_DRY.html' TARGET='index'>2</A><a name='120'>
&amp;ru_tendf, g_ru_tendf, rv_tendf, g_rv_tendf, rw_tendf, g_rw_tendf, ph_tendf, g_ph_tendf, t_tendf, g_t_tendf, u_save, g_u_save, &amp;<a name='121'>
&amp;v_save, g_v_save, w_save, g_w_save, ph_save, g_ph_save, t_save, g_t_save, rk_step, h_diabatic, mut, g_mut, msft, msfu, msfv, ide, &amp;<a name='122'>
&amp;jde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='123'>
<font color=#447700>!******************************************************************<a name='124'></font>
<font color=#447700>!******************************************************************<a name='125'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='126'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='127'></font>
<font color=#447700>!******************************************************************<a name='128'></font>
<font color=#447700>!******************************************************************<a name='129'></font>
<font color=#447700>!==============================================<a name='130'></font>
<font color=#447700>! all entries are defined explicitly<a name='131'></font>
<font color=#447700>!==============================================<a name='132'></font>
implicit none<a name='133'>
<a name='134'>
<font color=#447700>!==============================================<a name='135'></font>
<font color=#447700>! declare arguments<a name='136'></font>
<font color=#447700>!==============================================<a name='137'></font>
integer, intent(in) :: ime<a name='138'>
integer, intent(in) :: ims<a name='139'>
integer, intent(in) :: jme<a name='140'>
integer, intent(in) :: jms<a name='141'>
real, intent(in) :: g_mut(ims:ime,jms:jme)<a name='142'>
integer, intent(in) :: kme<a name='143'>
integer, intent(in) :: kms<a name='144'>
real, intent(in) :: g_ph_save(ims:ime,kms:kme,jms:jme)<a name='145'>
real, intent(inout) :: g_ph_tend(ims:ime,kms:kme,jms:jme)<a name='146'>
real, intent(inout) :: g_ph_tendf(ims:ime,kms:kme,jms:jme)<a name='147'>
real, intent(inout) :: g_ru_tend(ims:ime,kms:kme,jms:jme)<a name='148'>
real, intent(inout) :: g_ru_tendf(ims:ime,kms:kme,jms:jme)<a name='149'>
real, intent(inout) :: g_rv_tend(ims:ime,kms:kme,jms:jme)<a name='150'>
real, intent(inout) :: g_rv_tendf(ims:ime,kms:kme,jms:jme)<a name='151'>
real, intent(inout) :: g_rw_tend(ims:ime,kms:kme,jms:jme)<a name='152'>
real, intent(inout) :: g_rw_tendf(ims:ime,kms:kme,jms:jme)<a name='153'>
real, intent(in) :: g_t_save(ims:ime,kms:kme,jms:jme)<a name='154'>
real, intent(inout) :: g_t_tend(ims:ime,kms:kme,jms:jme)<a name='155'>
real, intent(inout) :: g_t_tendf(ims:ime,kms:kme,jms:jme)<a name='156'>
real, intent(in) :: g_u_save(ims:ime,kms:kme,jms:jme)<a name='157'>
real, intent(in) :: g_v_save(ims:ime,kms:kme,jms:jme)<a name='158'>
real, intent(in) :: g_w_save(ims:ime,kms:kme,jms:jme)<a name='159'>
real, intent(in) :: h_diabatic(ims:ime,kms:kme,jms:jme)<a name='160'>
integer, intent(in) :: ide<a name='161'>
integer, intent(in) :: ite<a name='162'>
integer, intent(in) :: its<a name='163'>
integer, intent(in) :: jde<a name='164'>
integer, intent(in) :: jte<a name='165'>
integer, intent(in) :: jts<a name='166'>
integer, intent(in) :: kte<a name='167'>
integer, intent(in) :: kts<a name='168'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='169'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='170'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='171'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='172'>
real, intent(in) :: ph_save(ims:ime,kms:kme,jms:jme)<a name='173'>
real, intent(inout) :: ph_tend(ims:ime,kms:kme,jms:jme)<a name='174'>
real, intent(inout) :: ph_tendf(ims:ime,kms:kme,jms:jme)<a name='175'>
integer, intent(in) :: rk_step<a name='176'>
real, intent(inout) :: ru_tend(ims:ime,kms:kme,jms:jme)<a name='177'>
real, intent(inout) :: ru_tendf(ims:ime,kms:kme,jms:jme)<a name='178'>
real, intent(inout) :: rv_tend(ims:ime,kms:kme,jms:jme)<a name='179'>
real, intent(inout) :: rv_tendf(ims:ime,kms:kme,jms:jme)<a name='180'>
real, intent(inout) :: rw_tend(ims:ime,kms:kme,jms:jme)<a name='181'>
real, intent(inout) :: rw_tendf(ims:ime,kms:kme,jms:jme)<a name='182'>
real, intent(in) :: t_save(ims:ime,kms:kme,jms:jme)<a name='183'>
real, intent(inout) :: t_tend(ims:ime,kms:kme,jms:jme)<a name='184'>
real, intent(inout) :: t_tendf(ims:ime,kms:kme,jms:jme)<a name='185'>
real, intent(in) :: u_save(ims:ime,kms:kme,jms:jme)<a name='186'>
real, intent(in) :: v_save(ims:ime,kms:kme,jms:jme)<a name='187'>
real, intent(in) :: w_save(ims:ime,kms:kme,jms:jme)<a name='188'>
<a name='189'>
<font color=#447700>!==============================================<a name='190'></font>
<font color=#447700>! declare local variables<a name='191'></font>
<font color=#447700>!==============================================<a name='192'></font>
integer i<a name='193'>
integer j<a name='194'>
integer k<a name='195'>
<a name='196'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_ADDTEND_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_82">("g_rk_addtend_dry")<a name='197'>
<a name='198'>
<font color=#447700>!----------------------------------------------<a name='199'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='200'></font>
<font color=#447700>!----------------------------------------------<a name='201'></font>
do j = jts, min(jte,jde-1)<a name='202'>
  do k = kts, kte-1<a name='203'>
    do i = its, ite<a name='204'>
      if (rk_step .eq. 1) then<a name='205'>
        g_ru_tendf(i,k,j) = g_ru_tendf(i,k,j)+g_u_save(i,k,j)*msfu(i,j)<a name='206'>
        ru_tendf(i,k,j) = ru_tendf(i,k,j)+u_save(i,k,j)*msfu(i,j)<a name='207'>
      endif<a name='208'>
      g_ru_tend(i,k,j) = g_ru_tend(i,k,j)+g_ru_tendf(i,k,j)/msfu(i,j)<a name='209'>
      ru_tend(i,k,j) = ru_tend(i,k,j)+ru_tendf(i,k,j)/msfu(i,j)<a name='210'>
    end do<a name='211'>
  end do<a name='212'>
end do<a name='213'>
do j = jts, jte<a name='214'>
  do k = kts, kte-1<a name='215'>
    do i = its, min(ite,ide-1)<a name='216'>
      if (rk_step .eq. 1) then<a name='217'>
        g_rv_tendf(i,k,j) = g_rv_tendf(i,k,j)+g_v_save(i,k,j)*msfv(i,j)<a name='218'>
        rv_tendf(i,k,j) = rv_tendf(i,k,j)+v_save(i,k,j)*msfv(i,j)<a name='219'>
      endif<a name='220'>
      g_rv_tend(i,k,j) = g_rv_tend(i,k,j)+g_rv_tendf(i,k,j)/msfv(i,j)<a name='221'>
      rv_tend(i,k,j) = rv_tend(i,k,j)+rv_tendf(i,k,j)/msfv(i,j)<a name='222'>
    end do<a name='223'>
  end do<a name='224'>
end do<a name='225'>
do j = jts, min(jte,jde-1)<a name='226'>
  do k = kts, kte<a name='227'>
    do i = its, min(ite,ide-1)<a name='228'>
      if (rk_step .eq. 1) then<a name='229'>
        g_rw_tendf(i,k,j) = g_rw_tendf(i,k,j)+g_w_save(i,k,j)*msft(i,j)<a name='230'>
        rw_tendf(i,k,j) = rw_tendf(i,k,j)+w_save(i,k,j)*msft(i,j)<a name='231'>
      endif<a name='232'>
      g_rw_tend(i,k,j) = g_rw_tend(i,k,j)+g_rw_tendf(i,k,j)/msft(i,j)<a name='233'>
      rw_tend(i,k,j) = rw_tend(i,k,j)+rw_tendf(i,k,j)/msft(i,j)<a name='234'>
      if (rk_step .eq. 1) then<a name='235'>
        g_ph_tendf(i,k,j) = g_ph_save(i,k,j)+g_ph_tendf(i,k,j)<a name='236'>
        ph_tendf(i,k,j) = ph_tendf(i,k,j)+ph_save(i,k,j)<a name='237'>
      endif<a name='238'>
      g_ph_tend(i,k,j) = g_ph_tend(i,k,j)+g_ph_tendf(i,k,j)/msft(i,j)<a name='239'>
      ph_tend(i,k,j) = ph_tend(i,k,j)+ph_tendf(i,k,j)/msft(i,j)<a name='240'>
    end do<a name='241'>
  end do<a name='242'>
end do<a name='243'>
do j = jts, min(jte,jde-1)<a name='244'>
  do k = kts, kte-1<a name='245'>
    do i = its, min(ite,ide-1)<a name='246'>
      if (rk_step .eq. 1) then<a name='247'>
        g_t_tendf(i,k,j) = g_t_save(i,k,j)+g_t_tendf(i,k,j)<a name='248'>
        t_tendf(i,k,j) = t_tendf(i,k,j)+t_save(i,k,j)<a name='249'>
      endif<a name='250'>
      g_t_tend(i,k,j) = g_mut(i,j)*(h_diabatic(i,k,j)/msft(i,j))+g_t_tend(i,k,j)+g_t_tendf(i,k,j)/msft(i,j)<a name='251'>
      t_tend(i,k,j) = t_tend(i,k,j)+t_tendf(i,k,j)/msft(i,j)+mut(i,j)*h_diabatic(i,k,j)/msft(i,j)<a name='252'>
    end do<a name='253'>
  end do<a name='254'>
end do<a name='255'>
<a name='256'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_ADDTEND_DRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_82">("g_rk_addtend_dry")<a name='257'>
<a name='258'>
end subroutine g_rk_addtend_dry<a name='259'>
<a name='260'>
<a name='261'>
<A NAME='G_RK_SCALAR_TEND'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='262'>
<font color=#993300>subroutine </font><font color=#cc0000>g_rk_scalar_tend</font>( scs, sce, config_flags, rk_step, ru, g_ru, rv, g_rv, ww, g_ww, mut, g_mut, alt, g_alt, scalar_old, &amp; <A href='../../call_to/G_RK_SCALAR_TEND.html' TARGET='index'>3</A>,<A href='../../call_from/G_RK_SCALAR_TEND.html' TARGET='index'>11</A><a name='263'>
&amp;g_scalar_old, scalar, g_scalar, scalar_tends, g_scalar_tends, advect_tend, g_advect_tend, base, moist_step, fnm, fnp, msfu, msfv, &amp;<a name='264'>
&amp;msft, rdx, rdy, rdn, rdnw, kvdif, xkmhd, g_xkmhd, leapfrog, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, &amp;<a name='265'>
&amp;jte, kts, kte )<a name='266'>
<font color=#447700>!******************************************************************<a name='267'></font>
<font color=#447700>!******************************************************************<a name='268'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='269'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='270'></font>
<font color=#447700>!******************************************************************<a name='271'></font>
<font color=#447700>!******************************************************************<a name='272'></font>
<font color=#447700>!==============================================<a name='273'></font>
<font color=#447700>! all entries are defined explicitly<a name='274'></font>
<font color=#447700>!==============================================<a name='275'></font>
implicit none<a name='276'>
<a name='277'>
<font color=#447700>!==============================================<a name='278'></font>
<font color=#447700>! declare arguments<a name='279'></font>
<font color=#447700>!==============================================<a name='280'></font>
integer, intent(in) :: ime<a name='281'>
integer, intent(in) :: ims<a name='282'>
integer, intent(in) :: jme<a name='283'>
integer, intent(in) :: jms<a name='284'>
integer, intent(in) :: kme<a name='285'>
integer, intent(in) :: kms<a name='286'>
real advect_tend(ims:ime,kms:kme,jms:jme)<a name='287'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='288'>
real, intent(in) :: base(kms:kme)<a name='289'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='290'>
real, intent(in) :: fnm(kms:kme)<a name='291'>
real, intent(in) :: fnp(kms:kme)<a name='292'>
real g_advect_tend(ims:ime,kms:kme,jms:jme)<a name='293'>
real, intent(in) :: g_alt(ims:ime,kms:kme,jms:jme)<a name='294'>
real, intent(in) :: g_mut(ims:ime,jms:jme)<a name='295'>
real, intent(in) :: g_ru(ims:ime,kms:kme,jms:jme)<a name='296'>
real, intent(in) :: g_rv(ims:ime,kms:kme,jms:jme)<a name='297'>
integer, intent(in) :: sce<a name='298'>
integer, intent(in) :: scs<a name='299'>
real, intent(inout) :: g_scalar(ims:ime,kms:kme,jms:jme,scs:sce)<a name='300'>
real, intent(inout) :: g_scalar_old(ims:ime,kms:kme,jms:jme,scs:sce)<a name='301'>
real, intent(out) :: g_scalar_tends(ims:ime,kms:kme,jms:jme,scs:sce)<a name='302'>
real, intent(in) :: g_ww(ims:ime,kms:kme,jms:jme)<a name='303'>
real, intent(in) :: g_xkmhd(ims:ime,kms:kme,jms:jme)<a name='304'>
integer, intent(in) :: ide<a name='305'>
integer, intent(in) :: ids<a name='306'>
integer, intent(in) :: ite<a name='307'>
integer, intent(in) :: its<a name='308'>
integer, intent(in) :: jde<a name='309'>
integer, intent(in) :: jds<a name='310'>
integer, intent(in) :: jte<a name='311'>
integer, intent(in) :: jts<a name='312'>
integer, intent(in) :: kde<a name='313'>
integer, intent(in) :: kte<a name='314'>
integer, intent(in) :: kts<a name='315'>
real, intent(in) :: kvdif<a name='316'>
logical, intent(in) :: leapfrog<a name='317'>
logical, intent(in) :: moist_step<a name='318'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='319'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='320'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='321'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='322'>
real, intent(in) :: rdn(kms:kme)<a name='323'>
real, intent(in) :: rdnw(kms:kme)<a name='324'>
real, intent(in) :: rdx<a name='325'>
real, intent(in) :: rdy<a name='326'>
integer, intent(in) :: rk_step<a name='327'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='328'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='329'>
real, intent(inout) :: scalar(ims:ime,kms:kme,jms:jme,scs:sce)<a name='330'>
real, intent(inout) :: scalar_old(ims:ime,kms:kme,jms:jme,scs:sce)<a name='331'>
real, intent(out) :: scalar_tends(ims:ime,kms:kme,jms:jme,scs:sce)<a name='332'>
real, intent(in) :: ww(ims:ime,kms:kme,jms:jme)<a name='333'>
real, intent(in) :: xkmhd(ims:ime,kms:kme,jms:jme)<a name='334'>
<a name='335'>
<font color=#447700>!==============================================<a name='336'></font>
<font color=#447700>! declare local variables<a name='337'></font>
<font color=#447700>!==============================================<a name='338'></font>
integer im<a name='339'>
real kvdq<a name='340'>
<a name='341'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_83">("g_rk_scalar_tend")<a name='342'>
<a name='343'>
<font color=#447700>!----------------------------------------------<a name='344'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='345'></font>
<font color=#447700>!----------------------------------------------<a name='346'></font>
kvdq = kvdif/prandtl<a name='347'>
scalar_loop: do im = scs, sce<a name='348'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_7">( advect_tend(ims,kms,jms),g_advect_tend(ims,kms,jms),ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='349'>
  if ( .not. leapfrog) then<a name='350'>
    call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_SCALAR'>g_advect_scalar</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_SCALAR_3">( scalar(ims,kms,jms,im),g_scalar(ims,kms,jms,im),scalar(ims,kms,jms,im),g_scalar(ims,kms,jms,im),&amp;<a name='351'>
&amp;advect_tend(ims,kms,jms),g_advect_tend(ims,kms,jms),ru,g_ru,rv,g_rv,ww,g_ww,config_flags,msft,fnm,fnp,rdx,rdy,rdnw,ids,ide,&amp;<a name='352'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='353'>
  else<a name='354'>
    call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_SCALAR'>g_advect_scalar</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_SCALAR_4">( scalar(ims,kms,jms,im),g_scalar(ims,kms,jms,im),scalar_old(ims,kms,jms,im),g_scalar_old(ims,kms,jms,im),&amp;<a name='355'>
&amp;advect_tend(ims,kms,jms),g_advect_tend(ims,kms,jms),ru,g_ru,rv,g_rv,ww,g_ww,config_flags,msft,fnm,fnp,rdx,rdy,rdnw,ids,ide,&amp;<a name='356'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='357'>
  endif<a name='358'>
  diff_opt2: if (config_flags%diff_opt .eq. 1) then<a name='359'>
    rk_step_2: if (rk_step .eq. 1) then<a name='360'>
      if ( .not. leapfrog) then<a name='361'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_1">( 'm',scalar(ims,kms,jms,im),g_scalar(ims,kms,jms,im),scalar_tends(ims,kms,jms,im),&amp;<a name='362'>
&amp;g_scalar_tends(ims,kms,jms,im),mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,rdy,ids,ide,jds,jde,kde,ims,ime,&amp;<a name='363'>
&amp;jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='364'>
        pbl_tesu: if (config_flags%bl_pbl_physics .eq. 0) then<a name='365'>
          if (moist_step .and. im .eq. p_qv) then<a name='366'>
            call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_MP'>g_vertical_diffusion_mp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_MP_1">( scalar(ims,kms,jms,im),g_scalar(ims,kms,jms,im),scalar_tends(ims,kms,jms,im),&amp;<a name='367'>
&amp;g_scalar_tends(ims,kms,jms,im),base,alt,g_alt,mut,g_mut,rdn,rdnw,kvdq,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='368'>
          else<a name='369'>
            call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION'>g_vertical_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_1">( 'm',scalar(ims,kms,jms,im),g_scalar(ims,kms,jms,im),scalar_tends(ims,kms,jms,im),&amp;<a name='370'>
&amp;g_scalar_tends(ims,kms,jms,im),alt,g_alt,mut,g_mut,rdn,rdnw,kvdq,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='371'>
          endif<a name='372'>
        endif pbl_tesu<a name='373'>
      else<a name='374'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_2">( 'm',scalar_old(ims,kms,jms,im),g_scalar_old(ims,kms,jms,im),scalar_tends(ims,kms,jms,im),&amp;<a name='375'>
&amp;g_scalar_tends(ims,kms,jms,im),mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,rdy,ids,ide,jds,jde,kde,ims,ime,&amp;<a name='376'>
&amp;jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='377'>
        pbl_test_lg: if (config_flags%bl_pbl_physics .eq. 0) then<a name='378'>
          if (moist_step .and. im .eq. p_qv) then<a name='379'>
            call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_MP'>g_vertical_diffusion_mp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_MP_2">( scalar_old(ims,kms,jms,im),g_scalar_old(ims,kms,jms,im),scalar_tends(ims,kms,jms,im),&amp;<a name='380'>
&amp;g_scalar_tends(ims,kms,jms,im),base,alt,g_alt,mut,g_mut,rdn,rdnw,kvdq,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='381'>
          else<a name='382'>
            call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION'>g_vertical_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_2">( 'm',scalar_old(ims,kms,jms,im),g_scalar_old(ims,kms,jms,im),scalar_tends(ims,kms,jms,im),&amp;<a name='383'>
&amp;g_scalar_tends(ims,kms,jms,im),alt,g_alt,mut,g_mut,rdn,rdnw,kvdq,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='384'>
          endif<a name='385'>
        endif pbl_test_lg<a name='386'>
      endif<a name='387'>
    endif rk_step_2<a name='388'>
  endif diff_opt2<a name='389'>
end do scalar_loop<a name='390'>
<a name='391'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_SCALAR_TEND' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_83">("g_rk_scalar_tend")<a name='392'>
<a name='393'>
end subroutine g_rk_scalar_tend<a name='394'>
<a name='395'>
<a name='396'>
<A NAME='G_RK_STEP_PREP'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='397'>
<font color=#993300>subroutine </font><font color=#cc0000>g_rk_step_prep</font>( config_flags, u, g_u, v, g_v, w, g_w, ph, g_ph, mu, g_mu, moist, g_moist, ru, g_ru, rv, g_rv, rw, g_rw, &amp; <A href='../../call_to/G_RK_STEP_PREP.html' TARGET='index'>3</A>,<A href='../../call_from/G_RK_STEP_PREP.html' TARGET='index'>9</A><a name='398'>
&amp;ww, g_ww, php, g_php, alt, g_alt, muu, g_muu, muv, g_muv, mub, mut, g_mut, phb, al, g_al, alb, cqu, g_cqu, cqv, g_cqv, cqw, g_cqw,&amp;<a name='399'>
&amp; msfu, msfv, msft, dnw, rdx, rdy, n_moist, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='400'>
<font color=#447700>!******************************************************************<a name='401'></font>
<font color=#447700>!******************************************************************<a name='402'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='403'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='404'></font>
<font color=#447700>!******************************************************************<a name='405'></font>
<font color=#447700>!******************************************************************<a name='406'></font>
<font color=#447700>!==============================================<a name='407'></font>
<font color=#447700>! all entries are defined explicitly<a name='408'></font>
<font color=#447700>!==============================================<a name='409'></font>
implicit none<a name='410'>
<a name='411'>
<font color=#447700>!==============================================<a name='412'></font>
<font color=#447700>! declare arguments<a name='413'></font>
<font color=#447700>!==============================================<a name='414'></font>
integer, intent(in) :: ime<a name='415'>
integer, intent(in) :: ims<a name='416'>
integer, intent(in) :: jme<a name='417'>
integer, intent(in) :: jms<a name='418'>
integer, intent(in) :: kme<a name='419'>
integer, intent(in) :: kms<a name='420'>
real, intent(in) :: al(ims:ime,kms:kme,jms:jme)<a name='421'>
real, intent(in) :: alb(ims:ime,kms:kme,jms:jme)<a name='422'>
real, intent(out) :: alt(ims:ime,kms:kme,jms:jme)<a name='423'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='424'>
real, intent(out) :: cqu(ims:ime,kms:kme,jms:jme)<a name='425'>
real, intent(out) :: cqv(ims:ime,kms:kme,jms:jme)<a name='426'>
real, intent(out) :: cqw(ims:ime,kms:kme,jms:jme)<a name='427'>
real, intent(in) :: dnw(kms:kme)<a name='428'>
real, intent(in) :: g_al(ims:ime,kms:kme,jms:jme)<a name='429'>
real, intent(out) :: g_alt(ims:ime,kms:kme,jms:jme)<a name='430'>
real, intent(out) :: g_cqu(ims:ime,kms:kme,jms:jme)<a name='431'>
real, intent(out) :: g_cqv(ims:ime,kms:kme,jms:jme)<a name='432'>
real, intent(out) :: g_cqw(ims:ime,kms:kme,jms:jme)<a name='433'>
integer, intent(in) :: n_moist<a name='434'>
real, intent(in) :: g_moist(ims:ime,kms:kme,jms:jme,n_moist)<a name='435'>
real, intent(in) :: g_mu(ims:ime,jms:jme)<a name='436'>
real, intent(out) :: g_mut(ims:ime,jms:jme)<a name='437'>
real, intent(out) :: g_muu(ims:ime,jms:jme)<a name='438'>
real, intent(out) :: g_muv(ims:ime,jms:jme)<a name='439'>
real, intent(in) :: g_ph(ims:ime,kms:kme,jms:jme)<a name='440'>
real, intent(out) :: g_php(ims:ime,kms:kme,jms:jme)<a name='441'>
real, intent(out) :: g_ru(ims:ime,kms:kme,jms:jme)<a name='442'>
real, intent(out) :: g_rv(ims:ime,kms:kme,jms:jme)<a name='443'>
real, intent(out) :: g_rw(ims:ime,kms:kme,jms:jme)<a name='444'>
real, intent(in) :: g_u(ims:ime,kms:kme,jms:jme)<a name='445'>
real, intent(in) :: g_v(ims:ime,kms:kme,jms:jme)<a name='446'>
real, intent(in) :: g_w(ims:ime,kms:kme,jms:jme)<a name='447'>
real, intent(out) :: g_ww(ims:ime,kms:kme,jms:jme)<a name='448'>
integer, intent(in) :: ide<a name='449'>
integer, intent(in) :: ids<a name='450'>
integer, intent(in) :: ite<a name='451'>
integer, intent(in) :: its<a name='452'>
integer, intent(in) :: jde<a name='453'>
integer, intent(in) :: jds<a name='454'>
integer, intent(in) :: jte<a name='455'>
integer, intent(in) :: jts<a name='456'>
integer, intent(in) :: kde<a name='457'>
integer, intent(in) :: kte<a name='458'>
integer, intent(in) :: kts<a name='459'>
real, intent(in) :: moist(ims:ime,kms:kme,jms:jme,n_moist)<a name='460'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='461'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='462'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='463'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='464'>
real, intent(in) :: mub(ims:ime,jms:jme)<a name='465'>
real, intent(out) :: mut(ims:ime,jms:jme)<a name='466'>
real, intent(out) :: muu(ims:ime,jms:jme)<a name='467'>
real, intent(out) :: muv(ims:ime,jms:jme)<a name='468'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='469'>
real, intent(in) :: phb(ims:ime,kms:kme,jms:jme)<a name='470'>
real, intent(out) :: php(ims:ime,kms:kme,jms:jme)<a name='471'>
real, intent(in) :: rdx<a name='472'>
real, intent(in) :: rdy<a name='473'>
real, intent(out) :: ru(ims:ime,kms:kme,jms:jme)<a name='474'>
real, intent(out) :: rv(ims:ime,kms:kme,jms:jme)<a name='475'>
real, intent(out) :: rw(ims:ime,kms:kme,jms:jme)<a name='476'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='477'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='478'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='479'>
real, intent(out) :: ww(ims:ime,kms:kme,jms:jme)<a name='480'>
<a name='481'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_84">("g_rk_step_prep")<a name='482'>
<a name='483'>
<font color=#447700>!----------------------------------------------<a name='484'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='485'></font>
<font color=#447700>!----------------------------------------------<a name='486'></font>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CALCULATE_FULL'>g_calculate_full</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CALCULATE_FULL_1">( mut,g_mut,mub,mu,g_mu,ide,jde,2,ims,ime,jms,jme,1,1,its,ite,jts,jte,1,1 )<a name='487'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CALC_MU_UV'>g_calc_mu_uv</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CALC_MU_UV_1">( config_flags,mu,g_mu,mub,muu,g_muu,muv,g_muv,ids,ide,jds,jde,ims,ime,jms,jme,its,ite,jts,jte )<a name='488'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_COUPLE_MOMENTUM'>g_couple_momentum</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_COUPLE_MOMENTUM_1">( muu,g_muu,ru,g_ru,u,g_u,msfu,muv,g_muv,rv,g_rv,v,g_v,msfv,mut,g_mut,rw,g_rw,w,g_w,msft,ide,jde,kde,ims,ime,&amp;<a name='489'>
&amp;jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='490'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CALC_WW_CP'>g_calc_ww_cp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CALC_WW_CP_1">( u,g_u,v,g_v,mu,g_mu,mub,ww,g_ww,rdx,rdy,msft,msfu,msfv,dnw,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,&amp;<a name='491'>
&amp;kts,kte )<a name='492'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CALC_CQ'>g_calc_cq</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CALC_CQ_1">( moist,g_moist,cqu,g_cqu,cqv,g_cqv,cqw,g_cqw,n_moist,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='493'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CALC_ALT'>g_calc_alt</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CALC_ALT_1">( alt,g_alt,al,g_al,alb,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='494'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CALC_PHP'>g_calc_php</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CALC_PHP_1">( php,g_php,ph,g_ph,phb,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='495'>
<a name='496'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_STEP_PREP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_84">("g_rk_step_prep")<a name='497'>
<a name='498'>
end subroutine g_rk_step_prep<a name='499'>
<a name='500'>
<a name='501'>
<A NAME='G_RK_TENDENCY'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='502'>
<font color=#993300>subroutine </font><font color=#cc0000>g_rk_tendency</font>( config_flags, rk_step, ru_tend, g_ru_tend, rv_tend, g_rv_tend, rw_tend, g_rw_tend, ph_tend, g_ph_tend, &amp; <A href='../../call_to/G_RK_TENDENCY.html' TARGET='index'>3</A>,<A href='../../call_from/G_RK_TENDENCY.html' TARGET='index'>45</A><a name='503'>
&amp;t_tend, g_t_tend, ru_tendf, g_ru_tendf, rv_tendf, g_rv_tendf, rw_tendf, g_rw_tendf, t_tendf, g_t_tendf, mu_tend, g_mu_tend, &amp;<a name='504'>
&amp;u_save, g_u_save, v_save, g_v_save, w_save, g_w_save, ph_save, g_ph_save, t_save, g_t_save, ru, g_ru, rv, g_rv, rw, g_rw, ww, &amp;<a name='505'>
&amp;g_ww, u, g_u, v, g_v, w, g_w, t, g_t, ph, g_ph, u_old, g_u_old, v_old, g_v_old, w_old, g_w_old, t_old, g_t_old, ph_old, g_ph_old, &amp;<a name='506'>
&amp;phb, t_init, mu, g_mu, mut, g_mut, muu, g_muu, muv, g_muv, mub, al, g_al, alt, g_alt, p, g_p, pb, php, g_php, cqu, g_cqu, cqv, &amp;<a name='507'>
&amp;g_cqv, cqw, g_cqw, u_base, v_base, z_base, msfu, msfv, msft, f, e, sina, cosa, fnm, fnp, rdn, rdnw, dt, rdx, rdy, kvdif, xkmhd, &amp;<a name='508'>
&amp;g_xkmhd, cf1, cf2, cf3, cfn, cfn1, non_hydrostatic, leapfrog, ids, ide, jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, &amp;<a name='509'>
&amp;jts, jte, kts, kte )<a name='510'>
<font color=#447700>!******************************************************************<a name='511'></font>
<font color=#447700>!******************************************************************<a name='512'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='513'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='514'></font>
<font color=#447700>!******************************************************************<a name='515'></font>
<font color=#447700>!******************************************************************<a name='516'></font>
<font color=#447700>!==============================================<a name='517'></font>
<font color=#447700>! all entries are defined explicitly<a name='518'></font>
<font color=#447700>!==============================================<a name='519'></font>
implicit none<a name='520'>
<a name='521'>
<font color=#447700>!==============================================<a name='522'></font>
<font color=#447700>! declare arguments<a name='523'></font>
<font color=#447700>!==============================================<a name='524'></font>
integer, intent(in) :: ime<a name='525'>
integer, intent(in) :: ims<a name='526'>
integer, intent(in) :: jme<a name='527'>
integer, intent(in) :: jms<a name='528'>
integer, intent(in) :: kme<a name='529'>
integer, intent(in) :: kms<a name='530'>
real, intent(in) :: al(ims:ime,kms:kme,jms:jme)<a name='531'>
real, intent(in) :: alt(ims:ime,kms:kme,jms:jme)<a name='532'>
real cf1<a name='533'>
real cf2<a name='534'>
real cf3<a name='535'>
real cfn<a name='536'>
real cfn1<a name='537'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='538'>
real, intent(in) :: cosa(ims:ime,jms:jme)<a name='539'>
real, intent(in) :: cqu(ims:ime,kms:kme,jms:jme)<a name='540'>
real, intent(in) :: cqv(ims:ime,kms:kme,jms:jme)<a name='541'>
real, intent(inout) :: cqw(ims:ime,kms:kme,jms:jme)<a name='542'>
real, intent(in) :: dt<a name='543'>
real, intent(in) :: e(ims:ime,jms:jme)<a name='544'>
real, intent(in) :: f(ims:ime,jms:jme)<a name='545'>
real, intent(in) :: fnm(kms:kme)<a name='546'>
real, intent(in) :: fnp(kms:kme)<a name='547'>
real, intent(in) :: g_al(ims:ime,kms:kme,jms:jme)<a name='548'>
real, intent(in) :: g_alt(ims:ime,kms:kme,jms:jme)<a name='549'>
real, intent(in) :: g_cqu(ims:ime,kms:kme,jms:jme)<a name='550'>
real, intent(in) :: g_cqv(ims:ime,kms:kme,jms:jme)<a name='551'>
real, intent(inout) :: g_cqw(ims:ime,kms:kme,jms:jme)<a name='552'>
real, intent(in) :: g_mu(ims:ime,jms:jme)<a name='553'>
real, intent(out) :: g_mu_tend(ims:ime,jms:jme)<a name='554'>
real, intent(in) :: g_mut(ims:ime,jms:jme)<a name='555'>
real, intent(in) :: g_muu(ims:ime,jms:jme)<a name='556'>
real, intent(in) :: g_muv(ims:ime,jms:jme)<a name='557'>
real, intent(in) :: g_p(ims:ime,kms:kme,jms:jme)<a name='558'>
real, intent(in) :: g_ph(ims:ime,kms:kme,jms:jme)<a name='559'>
real, intent(in) :: g_ph_old(ims:ime,kms:kme,jms:jme)<a name='560'>
real, intent(out) :: g_ph_save(ims:ime,kms:kme,jms:jme)<a name='561'>
real, intent(out) :: g_ph_tend(ims:ime,kms:kme,jms:jme)<a name='562'>
real, intent(in) :: g_php(ims:ime,kms:kme,jms:jme)<a name='563'>
real, intent(in) :: g_ru(ims:ime,kms:kme,jms:jme)<a name='564'>
real, intent(out) :: g_ru_tend(ims:ime,kms:kme,jms:jme)<a name='565'>
real, intent(inout) :: g_ru_tendf(ims:ime,kms:kme,jms:jme)<a name='566'>
real, intent(in) :: g_rv(ims:ime,kms:kme,jms:jme)<a name='567'>
real, intent(out) :: g_rv_tend(ims:ime,kms:kme,jms:jme)<a name='568'>
real, intent(inout) :: g_rv_tendf(ims:ime,kms:kme,jms:jme)<a name='569'>
real, intent(in) :: g_rw(ims:ime,kms:kme,jms:jme)<a name='570'>
real, intent(out) :: g_rw_tend(ims:ime,kms:kme,jms:jme)<a name='571'>
real, intent(inout) :: g_rw_tendf(ims:ime,kms:kme,jms:jme)<a name='572'>
real, intent(in) :: g_t(ims:ime,kms:kme,jms:jme)<a name='573'>
real, intent(in) :: g_t_old(ims:ime,kms:kme,jms:jme)<a name='574'>
real, intent(out) :: g_t_save(ims:ime,kms:kme,jms:jme)<a name='575'>
real, intent(out) :: g_t_tend(ims:ime,kms:kme,jms:jme)<a name='576'>
real, intent(inout) :: g_t_tendf(ims:ime,kms:kme,jms:jme)<a name='577'>
real, intent(in) :: g_u(ims:ime,kms:kme,jms:jme)<a name='578'>
real, intent(in) :: g_u_old(ims:ime,kms:kme,jms:jme)<a name='579'>
real, intent(out) :: g_u_save(ims:ime,kms:kme,jms:jme)<a name='580'>
real, intent(in) :: g_v(ims:ime,kms:kme,jms:jme)<a name='581'>
real, intent(in) :: g_v_old(ims:ime,kms:kme,jms:jme)<a name='582'>
real, intent(out) :: g_v_save(ims:ime,kms:kme,jms:jme)<a name='583'>
real, intent(in) :: g_w(ims:ime,kms:kme,jms:jme)<a name='584'>
real, intent(in) :: g_w_old(ims:ime,kms:kme,jms:jme)<a name='585'>
real, intent(out) :: g_w_save(ims:ime,kms:kme,jms:jme)<a name='586'>
real, intent(in) :: g_ww(ims:ime,kms:kme,jms:jme)<a name='587'>
real, intent(in) :: g_xkmhd(ims:ime,kms:kme,jms:jme)<a name='588'>
integer, intent(in) :: ide<a name='589'>
integer, intent(in) :: ids<a name='590'>
integer, intent(in) :: ite<a name='591'>
integer, intent(in) :: its<a name='592'>
integer, intent(in) :: jde<a name='593'>
integer, intent(in) :: jds<a name='594'>
integer, intent(in) :: jte<a name='595'>
integer, intent(in) :: jts<a name='596'>
integer, intent(in) :: kde<a name='597'>
integer, intent(in) :: kte<a name='598'>
integer, intent(in) :: kts<a name='599'>
real, intent(in) :: kvdif<a name='600'>
logical, intent(in) :: leapfrog<a name='601'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='602'>
real, intent(in) :: msfu(ims:ime,jms:jme)<a name='603'>
real, intent(in) :: msfv(ims:ime,jms:jme)<a name='604'>
real, intent(in) :: mu(ims:ime,jms:jme)<a name='605'>
real, intent(out) :: mu_tend(ims:ime,jms:jme)<a name='606'>
real, intent(in) :: mub(ims:ime,jms:jme)<a name='607'>
real, intent(in) :: mut(ims:ime,jms:jme)<a name='608'>
real, intent(in) :: muu(ims:ime,jms:jme)<a name='609'>
real, intent(in) :: muv(ims:ime,jms:jme)<a name='610'>
logical, intent(in) :: non_hydrostatic<a name='611'>
real, intent(in) :: p(ims:ime,kms:kme,jms:jme)<a name='612'>
real, intent(in) :: pb(ims:ime,kms:kme,jms:jme)<a name='613'>
real, intent(in) :: ph(ims:ime,kms:kme,jms:jme)<a name='614'>
real, intent(in) :: ph_old(ims:ime,kms:kme,jms:jme)<a name='615'>
real, intent(out) :: ph_save(ims:ime,kms:kme,jms:jme)<a name='616'>
real, intent(out) :: ph_tend(ims:ime,kms:kme,jms:jme)<a name='617'>
real, intent(in) :: phb(ims:ime,kms:kme,jms:jme)<a name='618'>
real, intent(in) :: php(ims:ime,kms:kme,jms:jme)<a name='619'>
real, intent(in) :: rdn(kms:kme)<a name='620'>
real, intent(in) :: rdnw(kms:kme)<a name='621'>
real, intent(in) :: rdx<a name='622'>
real, intent(in) :: rdy<a name='623'>
integer, intent(in) :: rk_step<a name='624'>
real, intent(in) :: ru(ims:ime,kms:kme,jms:jme)<a name='625'>
real, intent(out) :: ru_tend(ims:ime,kms:kme,jms:jme)<a name='626'>
real, intent(inout) :: ru_tendf(ims:ime,kms:kme,jms:jme)<a name='627'>
real, intent(in) :: rv(ims:ime,kms:kme,jms:jme)<a name='628'>
real, intent(out) :: rv_tend(ims:ime,kms:kme,jms:jme)<a name='629'>
real, intent(inout) :: rv_tendf(ims:ime,kms:kme,jms:jme)<a name='630'>
real, intent(in) :: rw(ims:ime,kms:kme,jms:jme)<a name='631'>
real, intent(out) :: rw_tend(ims:ime,kms:kme,jms:jme)<a name='632'>
real, intent(inout) :: rw_tendf(ims:ime,kms:kme,jms:jme)<a name='633'>
real, intent(in) :: sina(ims:ime,jms:jme)<a name='634'>
real, intent(in) :: t(ims:ime,kms:kme,jms:jme)<a name='635'>
real, intent(in) :: t_init(ims:ime,kms:kme,jms:jme)<a name='636'>
real, intent(in) :: t_old(ims:ime,kms:kme,jms:jme)<a name='637'>
real, intent(out) :: t_save(ims:ime,kms:kme,jms:jme)<a name='638'>
real, intent(out) :: t_tend(ims:ime,kms:kme,jms:jme)<a name='639'>
real, intent(inout) :: t_tendf(ims:ime,kms:kme,jms:jme)<a name='640'>
real, intent(in) :: u(ims:ime,kms:kme,jms:jme)<a name='641'>
real, intent(in) :: u_base(kms:kme)<a name='642'>
real, intent(in) :: u_old(ims:ime,kms:kme,jms:jme)<a name='643'>
real, intent(out) :: u_save(ims:ime,kms:kme,jms:jme)<a name='644'>
real, intent(in) :: v(ims:ime,kms:kme,jms:jme)<a name='645'>
real, intent(in) :: v_base(kms:kme)<a name='646'>
real, intent(in) :: v_old(ims:ime,kms:kme,jms:jme)<a name='647'>
real, intent(out) :: v_save(ims:ime,kms:kme,jms:jme)<a name='648'>
real, intent(in) :: w(ims:ime,kms:kme,jms:jme)<a name='649'>
real, intent(in) :: w_old(ims:ime,kms:kme,jms:jme)<a name='650'>
real, intent(out) :: w_save(ims:ime,kms:kme,jms:jme)<a name='651'>
real, intent(in) :: ww(ims:ime,kms:kme,jms:jme)<a name='652'>
real, intent(in) :: xkmhd(ims:ime,kms:kme,jms:jme)<a name='653'>
real, intent(in) :: z_base(kms:kme)<a name='654'>
<a name='655'>
<font color=#447700>!==============================================<a name='656'></font>
<font color=#447700>! declare local variables<a name='657'></font>
<font color=#447700>!==============================================<a name='658'></font>
real kvdq<a name='659'>
<a name='660'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_85">("g_rk_tendency")<a name='661'>
<a name='662'>
<font color=#447700>!----------------------------------------------<a name='663'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='664'></font>
<font color=#447700>!----------------------------------------------<a name='665'></font>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_8">( ru_tend,g_ru_tend,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='666'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_9">( rv_tend,g_rv_tend,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='667'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_10">( rw_tend,g_rw_tend,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='668'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_11">( t_tend,g_t_tend,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='669'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_12">( ph_tend,g_ph_tend,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='670'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_13">( u_save,g_u_save,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='671'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_14">( v_save,g_v_save,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='672'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_15">( w_save,g_w_save,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='673'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_16">( ph_save,g_ph_save,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='674'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_17">( t_save,g_t_save,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='675'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_ZERO_TEND'>g_zero_tend</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ZERO_TEND_18">( mu_tend,g_mu_tend,ims,ime,jms,jme,1,1,its,ite,jts,jte,1,1 )<a name='676'>
if ( .not. leapfrog) then<a name='677'>
  call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_U'>g_advect_u</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_U_1">( u,g_u,u,g_u,ru_tend,g_ru_tend,ru,g_ru,rv,g_rv,ww,g_ww,mut,g_mut,config_flags,msfu,fnm,fnp,rdx,rdy,rdnw,ids,ide,&amp;<a name='678'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='679'>
  call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_V'>g_advect_v</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_V_1">( v,g_v,v,g_v,rv_tend,g_rv_tend,ru,g_ru,rv,g_rv,ww,g_ww,mut,g_mut,config_flags,msfv,fnm,fnp,rdx,rdy,rdnw,ids,ide,&amp;<a name='680'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='681'>
  if (non_hydrostatic) then<a name='682'>
    call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_W'>g_advect_w</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_W_1">( w,g_w,w,g_w,rw_tend,g_rw_tend,ru,g_ru,rv,g_rv,ww,g_ww,config_flags,msft,fnm,fnp,rdx,rdy,rdn,ids,ide,jds,jde,&amp;<a name='683'>
&amp;kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='684'>
  endif<a name='685'>
  call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_SCALAR'>g_advect_scalar</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_SCALAR_5">( t,g_t,t,g_t,t_tend,g_t_tend,ru,g_ru,rv,g_rv,ww,g_ww,config_flags,msft,fnm,fnp,rdx,rdy,rdnw,ids,ide,jds,jde,&amp;<a name='686'>
&amp;kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='687'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_RHS_PH'>g_rhs_ph</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RHS_PH_1">( ph_tend,g_ph_tend,u,g_u,v,g_v,ww,g_ww,ph,g_ph,ph,g_ph,phb,w,g_w,mut,g_mut,muu,g_muu,muv,g_muv,fnm,fnp,rdnw,cfn,&amp;<a name='688'>
&amp;cfn1,rdx,rdy,msft,non_hydrostatic,config_flags,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='689'>
else<a name='690'>
  call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_U'>g_advect_u</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_U_2">( u,g_u,u_old,g_u_old,ru_tend,g_ru_tend,ru,g_ru,rv,g_rv,ww,g_ww,mut,g_mut,config_flags,msfu,fnm,fnp,rdx,rdy,rdnw,&amp;<a name='691'>
&amp;ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='692'>
  call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_V'>g_advect_v</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_V_2">( v,g_v,v_old,g_v_old,rv_tend,g_rv_tend,ru,g_ru,rv,g_rv,ww,g_ww,mut,g_mut,config_flags,msfv,fnm,fnp,rdx,rdy,rdnw,&amp;<a name='693'>
&amp;ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='694'>
  if (non_hydrostatic) then<a name='695'>
    call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_W'>g_advect_w</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_W_2">( w,g_w,w_old,g_w_old,rw_tend,g_rw_tend,ru,g_ru,rv,g_rv,ww,g_ww,config_flags,msft,fnm,fnp,rdx,rdy,rdn,ids,ide,&amp;<a name='696'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='697'>
  endif<a name='698'>
  call <A href='../../html_code/dyn_em/module_advect_em_tl.F.html#G_ADVECT_SCALAR'>g_advect_scalar</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_ADVECT_SCALAR_6">( t,g_t,t_old,g_t_old,t_tend,g_t_tend,ru,g_ru,rv,g_rv,ww,g_ww,config_flags,msft,fnm,fnp,rdx,rdy,rdnw,ids,ide,&amp;<a name='699'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='700'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_RHS_PH'>g_rhs_ph</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_RHS_PH_2">( ph_tend,g_ph_tend,u,g_u,v,g_v,ww,g_ww,ph,g_ph,ph_old,g_ph_old,phb,w,g_w,mut,g_mut,muu,g_muu,muv,g_muv,fnm,fnp,&amp;<a name='701'>
&amp;rdnw,cfn,cfn1,rdx,rdy,msft,non_hydrostatic,config_flags,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='702'>
endif<a name='703'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_PRESSURE_GRADIENT'>g_horizontal_pressure_gradient</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_PRESSURE_GRADIENT_1">( ru_tend,g_ru_tend,rv_tend,g_rv_tend,ph,g_ph,alt,g_alt,p,g_p,pb,al,g_al,php,g_php,cqu,g_cqu,&amp;<a name='704'>
&amp;cqv,g_cqv,muu,g_muu,muv,g_muv,mu,g_mu,fnm,fnp,rdnw,cf1,cf2,cf3,rdx,rdy,config_flags,non_hydrostatic,ids,ide,jds,jde,kde,ims,ime,&amp;<a name='705'>
&amp;jms,jme,kms,kme,its,ite,jts,jte,kte )<a name='706'>
if (non_hydrostatic) then<a name='707'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_PG_BUOY_W'>g_pg_buoy_w</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_PG_BUOY_W_1">( rw_tend,g_rw_tend,p,g_p,cqw,g_cqw,mu,g_mu,mub,rdnw,rdn,g,msft,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,&amp;<a name='708'>
&amp;jte )<a name='709'>
endif<a name='710'>
if (config_flags%w_damping .eq. 1) then<a name='711'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_W_DAMP'>g_w_damp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_W_DAMP_1">( rw_tend,g_rw_tend,ww,g_ww,w,g_w,mut,g_mut,rdnw,dt,ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte )<a name='712'>
endif<a name='713'>
if (config_flags%pert_coriolis) then<a name='714'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_PERTURBATION_CORIOLIS'>g_perturbation_coriolis</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_PERTURBATION_CORIOLIS_1">( ru,g_ru,rv,g_rv,rw,g_rw,ru_tend,g_ru_tend,rv_tend,g_rv_tend,rw_tend,g_rw_tend,config_flags,u_base,&amp;<a name='715'>
&amp;v_base,z_base,muu,g_muu,muv,g_muv,phb,ph,g_ph,f,e,sina,cosa,fnm,fnp,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,&amp;<a name='716'>
&amp;kts,kte )<a name='717'>
else<a name='718'>
  call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CORIOLIS'>g_coriolis</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CORIOLIS_1">( ru,g_ru,rv,g_rv,rw,g_rw,ru_tend,g_ru_tend,rv_tend,g_rv_tend,rw_tend,g_rw_tend,config_flags,f,e,sina,cosa,fnm,&amp;<a name='719'>
&amp;fnp,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='720'>
endif<a name='721'>
call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_CURVATURE'>g_curvature</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_CURVATURE_1">( ru,g_ru,rv,g_rv,rw,g_rw,u,g_u,v,g_v,ru_tend,g_ru_tend,rv_tend,g_rv_tend,rw_tend,g_rw_tend,config_flags,msfu,msfv,&amp;<a name='722'>
&amp;fnm,fnp,rdx,rdy,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='723'>
forward_steq: if (rk_step .eq. 1) then<a name='724'>
  diff_opt2: if (config_flags%diff_opt .eq. 1) then<a name='725'>
    leapfrog_tesu: if ( .not. leapfrog) then<a name='726'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_3">( 'u',u,g_u,ru_tendf,g_ru_tendf,mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,rdy,ids,&amp;<a name='727'>
&amp;ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='728'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_4">( 'v',v,g_v,rv_tendf,g_rv_tendf,mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,rdy,ids,&amp;<a name='729'>
&amp;ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='730'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_5">( 'w',w,g_w,rw_tendf,g_rw_tendf,mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,rdy,ids,&amp;<a name='731'>
&amp;ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='732'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION_3DMP'>g_horizontal_diffusion_3dmp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_3DMP_1">( t,g_t,t_tendf,g_t_tendf,mut,g_mut,config_flags,t_init,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,rdy,&amp;<a name='733'>
&amp;ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='734'>
      pbl_tesu: if (config_flags%bl_pbl_physics .eq. 0) then<a name='735'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_U'>g_vertical_diffusion_u</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_U_1">( u,g_u,ru_tendf,g_ru_tendf,config_flags,u_base,alt,g_alt,muu,g_muu,rdn,rdnw,kvdif,ids,ide,jde,&amp;<a name='736'>
&amp;kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='737'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_V'>g_vertical_diffusion_v</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_V_1">( v,g_v,rv_tendf,g_rv_tendf,config_flags,v_base,alt,g_alt,muv,g_muv,rdn,rdnw,kvdif,ide,jds,jde,&amp;<a name='738'>
&amp;kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='739'>
        if (non_hydrostatic) then<a name='740'>
          call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION'>g_vertical_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_3">( 'w',w,g_w,rw_tendf,g_rw_tendf,alt,g_alt,mut,g_mut,rdn,rdnw,kvdif,ide,jde,kde,ims,ime,jms,jme,&amp;<a name='741'>
&amp;kms,kme,its,ite,jts,jte,kts,kte )<a name='742'>
        endif<a name='743'>
        kvdq = 3.*kvdif<a name='744'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_3DMP'>g_vertical_diffusion_3dmp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_3DMP_1">( t,g_t,t_tendf,g_t_tendf,t_init,alt,g_alt,mut,g_mut,rdn,rdnw,kvdq,ide,jde,kde,ims,ime,jms,&amp;<a name='745'>
&amp;jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='746'>
      endif pbl_tesu<a name='747'>
    else leapfrog_tesu<a name='748'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_6">( 'u',u_old,g_u_old,ru_tendf,g_ru_tendf,mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,&amp;<a name='749'>
&amp;rdy,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='750'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_7">( 'v',v_old,g_v_old,rv_tendf,g_rv_tendf,mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,&amp;<a name='751'>
&amp;rdy,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='752'>
      if (non_hydrostatic) then<a name='753'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION'>g_horizontal_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_8">( 'w',w_old,g_w_old,rw_tendf,g_rw_tendf,mut,g_mut,config_flags,msfu,msfv,msft,xkmhd,g_xkmhd,rdx,&amp;<a name='754'>
&amp;rdy,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='755'>
      endif<a name='756'>
      call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_HORIZONTAL_DIFFUSION_3DMP'>g_horizontal_diffusion_3dmp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_HORIZONTAL_DIFFUSION_3DMP_2">( t_old,g_t_old,t_tendf,g_t_tendf,mut,g_mut,config_flags,t_init,msfu,msfv,msft,xkmhd,g_xkmhd,&amp;<a name='757'>
&amp;rdx,rdy,ids,ide,jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='758'>
      pbl_test_lg: if (config_flags%bl_pbl_physics .eq. 0) then<a name='759'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_U'>g_vertical_diffusion_u</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_U_2">( u_old,g_u_old,ru_tendf,g_ru_tendf,config_flags,u_base,alt,g_alt,muu,g_muu,rdn,rdnw,kvdif,ids,&amp;<a name='760'>
&amp;ide,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='761'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_V'>g_vertical_diffusion_v</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_V_2">( v_old,g_v_old,rv_tendf,g_rv_tendf,config_flags,v_base,alt,g_alt,muv,g_muv,rdn,rdnw,kvdif,ide,&amp;<a name='762'>
&amp;jds,jde,kde,ims,ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='763'>
        if (non_hydrostatic) then<a name='764'>
          call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION'>g_vertical_diffusion</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_4">( 'w',w_old,g_w_old,rw_tendf,g_rw_tendf,alt,g_alt,mut,g_mut,rdn,rdnw,kvdif,ide,jde,kde,ims,ime,&amp;<a name='765'>
&amp;jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='766'>
        endif<a name='767'>
        kvdq = 3.*kvdif<a name='768'>
        call <A href='../../html_code/dyn_em/module_big_step_utilities_em_tl.F.html#G_VERTICAL_DIFFUSION_3DMP'>g_vertical_diffusion_3dmp</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G_VERTICAL_DIFFUSION_3DMP_2">( t_old,g_t_old,t_tendf,g_t_tendf,t_init,alt,g_alt,mut,g_mut,rdn,rdnw,kvdq,ide,jde,kde,ims,&amp;<a name='769'>
&amp;ime,jms,jme,kms,kme,its,ite,jts,jte,kts,kte )<a name='770'>
      endif pbl_test_lg<a name='771'>
    endif leapfrog_tesu<a name='772'>
  endif diff_opt2<a name='773'>
endif forward_steq<a name='774'>
<a name='775'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_TENDENCY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_85">("g_rk_tendency")<a name='776'>
<a name='777'>
end subroutine g_rk_tendency<a name='778'>
<a name='779'>
<a name='780'>
<A NAME='G_RK_UPDATE_SCALAR'><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_UPDATE_SCALAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='781'>
<font color=#993300>subroutine </font><font color=#cc0000>g_rk_update_scalar</font>( scs, sce, scalar_1, g_scalar_1, scalar_2, g_scalar_2, sc_tend, g_sc_tend, advect_tend, &amp; <A href='../../call_to/G_RK_UPDATE_SCALAR.html' TARGET='index'>3</A>,<A href='../../call_from/G_RK_UPDATE_SCALAR.html' TARGET='index'>2</A><a name='782'>
&amp;g_advect_tend, msft, mu_old, g_mu_old, mu_new, g_mu_new, mu_base, rk_step, dt, spec_zone, epsts, leapfrog, config_flags, ids, ide,&amp;<a name='783'>
&amp; jds, jde, kde, ims, ime, jms, jme, kms, kme, its, ite, jts, jte, kts, kte )<a name='784'>
<font color=#447700>!******************************************************************<a name='785'></font>
<font color=#447700>!******************************************************************<a name='786'></font>
<font color=#447700>!** This routine was generated by Automatic differentiation.     **<a name='787'></font>
<font color=#447700>!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.7.18  **<a name='788'></font>
<font color=#447700>!******************************************************************<a name='789'></font>
<font color=#447700>!******************************************************************<a name='790'></font>
<font color=#447700>!==============================================<a name='791'></font>
<font color=#447700>! all entries are defined explicitly<a name='792'></font>
<font color=#447700>!==============================================<a name='793'></font>
implicit none<a name='794'>
<a name='795'>
<font color=#447700>!==============================================<a name='796'></font>
<font color=#447700>! declare arguments<a name='797'></font>
<font color=#447700>!==============================================<a name='798'></font>
integer, intent(in) :: ime<a name='799'>
integer, intent(in) :: ims<a name='800'>
integer, intent(in) :: jme<a name='801'>
integer, intent(in) :: jms<a name='802'>
integer, intent(in) :: kme<a name='803'>
integer, intent(in) :: kms<a name='804'>
real, intent(in) :: advect_tend(ims:ime,kms:kme,jms:jme)<a name='805'>
type (grid_config_rec_type), intent(in) :: config_flags<a name='806'>
real, intent(in) :: dt<a name='807'>
real, intent(in) :: epsts<a name='808'>
real, intent(in) :: g_advect_tend(ims:ime,kms:kme,jms:jme)<a name='809'>
real, intent(in) :: g_mu_new(ims:ime,jms:jme)<a name='810'>
real, intent(in) :: g_mu_old(ims:ime,jms:jme)<a name='811'>
integer, intent(in) :: sce<a name='812'>
integer, intent(in) :: scs<a name='813'>
real, intent(inout) :: g_sc_tend(ims:ime,kms:kme,jms:jme,scs:sce)<a name='814'>
real, intent(inout) :: g_scalar_1(ims:ime,kms:kme,jms:jme,scs:sce)<a name='815'>
real, intent(inout) :: g_scalar_2(ims:ime,kms:kme,jms:jme,scs:sce)<a name='816'>
integer, intent(in) :: ide<a name='817'>
integer, intent(in) :: ids<a name='818'>
integer, intent(in) :: ite<a name='819'>
integer, intent(in) :: its<a name='820'>
integer, intent(in) :: jde<a name='821'>
integer, intent(in) :: jds<a name='822'>
integer, intent(in) :: jte<a name='823'>
integer, intent(in) :: jts<a name='824'>
integer, intent(in) :: kde<a name='825'>
integer, intent(in) :: kte<a name='826'>
integer, intent(in) :: kts<a name='827'>
logical, intent(in) :: leapfrog<a name='828'>
real, intent(in) :: msft(ims:ime,jms:jme)<a name='829'>
real, intent(in) :: mu_base(ims:ime,jms:jme)<a name='830'>
real, intent(in) :: mu_new(ims:ime,jms:jme)<a name='831'>
real, intent(in) :: mu_old(ims:ime,jms:jme)<a name='832'>
integer, intent(in) :: rk_step<a name='833'>
real, intent(inout) :: sc_tend(ims:ime,kms:kme,jms:jme,scs:sce)<a name='834'>
real, intent(inout) :: scalar_1(ims:ime,kms:kme,jms:jme,scs:sce)<a name='835'>
real, intent(inout) :: scalar_2(ims:ime,kms:kme,jms:jme,scs:sce)<a name='836'>
integer, intent(in) :: spec_zone<a name='837'>
<a name='838'>
<font color=#447700>!==============================================<a name='839'></font>
<font color=#447700>! declare local variables<a name='840'></font>
<font color=#447700>!==============================================<a name='841'></font>
real g_muold(its:ite)<a name='842'>
real g_r_munew(its:ite)<a name='843'>
real g_sc_middle<a name='844'>
real g_tendency(its:ite,kts:kte,jts:jte)<a name='845'>
integer i<a name='846'>
integer i_end<a name='847'>
integer i_end_spc<a name='848'>
integer i_start<a name='849'>
integer i_start_spc<a name='850'>
integer im<a name='851'>
integer j<a name='852'>
integer j_end<a name='853'>
integer j_end_spc<a name='854'>
integer j_start<a name='855'>
integer j_start_spc<a name='856'>
integer k<a name='857'>
integer k_end<a name='858'>
integer k_end_spc<a name='859'>
integer k_start<a name='860'>
integer k_start_spc<a name='861'>
real muold(its:ite)<a name='862'>
real r_munew(its:ite)<a name='863'>
real sc_middle<a name='864'>
real tendency(its:ite,kts:kte,jts:jte)<a name='865'>
<a name='866'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_ENTRY'>trace_entry</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_UPDATE_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_ENTRY_86">("g_rk_update_scalar")<a name='867'>
<a name='868'>
<font color=#447700>!----------------------------------------------<a name='869'></font>
<font color=#447700>! TANGENT LINEAR AND FUNCTION STATEMENTS<a name='870'></font>
<font color=#447700>!----------------------------------------------<a name='871'></font>
i_start = its<a name='872'>
i_end = ite<a name='873'>
j_start = jts<a name='874'>
j_end = jte<a name='875'>
k_start = kts<a name='876'>
k_end = kte-1<a name='877'>
if (j_end .eq. jde) then<a name='878'>
  j_end = j_end-1<a name='879'>
endif<a name='880'>
if (i_end .eq. ide) then<a name='881'>
  i_end = i_end-1<a name='882'>
endif<a name='883'>
i_start_spc = i_start<a name='884'>
i_end_spc = i_end<a name='885'>
j_start_spc = j_start<a name='886'>
j_end_spc = j_end<a name='887'>
k_start_spc = k_start<a name='888'>
k_end_spc = k_end<a name='889'>
if (config_flags%nested .or. config_flags%specified) then<a name='890'>
  i_start = max(its,ids+spec_zone)<a name='891'>
  i_end = min(ite,ide-spec_zone-1)<a name='892'>
  j_start = max(jts,jds+spec_zone)<a name='893'>
  j_end = min(jte,jde-spec_zone-1)<a name='894'>
  k_start = kts<a name='895'>
  k_end = min(kte,kde-1)<a name='896'>
endif<a name='897'>
if ( .not. leapfrog) then<a name='898'>
  if (rk_step .eq. 1) then<a name='899'>
    do im = scs, sce<a name='900'>
      do j = jts, min(jte,jde-1)<a name='901'>
        do k = kts, min(kte,kde-1)<a name='902'>
          do i = its, min(ite,ide-1)<a name='903'>
            g_tendency(i,k,j) = 0.<a name='904'>
            tendency(i,k,j) = 0.<a name='905'>
          end do<a name='906'>
        end do<a name='907'>
      end do<a name='908'>
      do j = j_start, j_end<a name='909'>
        do k = k_start, k_end<a name='910'>
          do i = i_start, i_end<a name='911'>
            g_tendency(i,k,j) = g_advect_tend(i,k,j)*msft(i,j)<a name='912'>
            tendency(i,k,j) = advect_tend(i,k,j)*msft(i,j)<a name='913'>
          end do<a name='914'>
        end do<a name='915'>
      end do<a name='916'>
      do j = j_start_spc, j_end_spc<a name='917'>
        do k = k_start_spc, k_end_spc<a name='918'>
          do i = i_start_spc, i_end_spc<a name='919'>
            g_tendency(i,k,j) = g_sc_tend(i,k,j,im)+g_tendency(i,k,j)<a name='920'>
            tendency(i,k,j) = tendency(i,k,j)+sc_tend(i,k,j,im)<a name='921'>
          end do<a name='922'>
        end do<a name='923'>
      end do<a name='924'>
      do j = jts, min(jte,jde-1)<a name='925'>
        do i = its, min(ite,ide-1)<a name='926'>
          g_muold(i) = g_mu_old(i,j)<a name='927'>
          muold(i) = mu_old(i,j)+mu_base(i,j)<a name='928'>
          g_r_munew(i) = -(g_mu_new(i,j)/((mu_new(i,j)+mu_base(i,j))*(mu_new(i,j)+mu_base(i,j))))<a name='929'>
          r_munew(i) = 1./(mu_new(i,j)+mu_base(i,j))<a name='930'>
        end do<a name='931'>
        do k = kts, min(kte,kde-1)<a name='932'>
          do i = its, min(ite,ide-1)<a name='933'>
            g_scalar_1(i,k,j,im) = g_scalar_2(i,k,j,im)<a name='934'>
            scalar_1(i,k,j,im) = scalar_2(i,k,j,im)<a name='935'>
            g_scalar_2(i,k,j,im) = g_muold(i)*scalar_1(i,k,j,im)*r_munew(i)+g_r_munew(i)*(muold(i)*scalar_1(i,k,j,im)+dt*&amp;<a name='936'>
&amp;tendency(i,k,j))+g_scalar_1(i,k,j,im)*muold(i)*r_munew(i)+g_tendency(i,k,j)*dt*r_munew(i)<a name='937'>
            scalar_2(i,k,j,im) = (muold(i)*scalar_1(i,k,j,im)+dt*tendency(i,k,j))*r_munew(i)<a name='938'>
          end do<a name='939'>
        end do<a name='940'>
      end do<a name='941'>
    end do<a name='942'>
  else<a name='943'>
    do im = scs, sce<a name='944'>
      do j = jts, min(jte,jde-1)<a name='945'>
        do k = kts, min(kte,kde-1)<a name='946'>
          do i = its, min(ite,ide-1)<a name='947'>
            g_tendency(i,k,j) = 0.<a name='948'>
            tendency(i,k,j) = 0.<a name='949'>
          end do<a name='950'>
        end do<a name='951'>
      end do<a name='952'>
      do j = j_start, j_end<a name='953'>
        do k = k_start, k_end<a name='954'>
          do i = i_start, i_end<a name='955'>
            g_tendency(i,k,j) = g_advect_tend(i,k,j)*msft(i,j)<a name='956'>
            tendency(i,k,j) = advect_tend(i,k,j)*msft(i,j)<a name='957'>
          end do<a name='958'>
        end do<a name='959'>
      end do<a name='960'>
      do j = j_start_spc, j_end_spc<a name='961'>
        do k = k_start_spc, k_end_spc<a name='962'>
          do i = i_start_spc, i_end_spc<a name='963'>
            g_tendency(i,k,j) = g_sc_tend(i,k,j,im)+g_tendency(i,k,j)<a name='964'>
            tendency(i,k,j) = tendency(i,k,j)+sc_tend(i,k,j,im)<a name='965'>
          end do<a name='966'>
        end do<a name='967'>
      end do<a name='968'>
      do j = jts, min(jte,jde-1)<a name='969'>
        do i = its, min(ite,ide-1)<a name='970'>
          g_muold(i) = g_mu_old(i,j)<a name='971'>
          muold(i) = mu_old(i,j)+mu_base(i,j)<a name='972'>
          g_r_munew(i) = -(g_mu_new(i,j)/((mu_new(i,j)+mu_base(i,j))*(mu_new(i,j)+mu_base(i,j))))<a name='973'>
          r_munew(i) = 1./(mu_new(i,j)+mu_base(i,j))<a name='974'>
        end do<a name='975'>
        do k = kts, min(kte,kde-1)<a name='976'>
          do i = its, min(ite,ide-1)<a name='977'>
            g_scalar_2(i,k,j,im) = g_muold(i)*scalar_1(i,k,j,im)*r_munew(i)+g_r_munew(i)*(muold(i)*scalar_1(i,k,j,im)+dt*&amp;<a name='978'>
&amp;tendency(i,k,j))+g_scalar_1(i,k,j,im)*muold(i)*r_munew(i)+g_tendency(i,k,j)*dt*r_munew(i)<a name='979'>
            scalar_2(i,k,j,im) = (muold(i)*scalar_1(i,k,j,im)+dt*tendency(i,k,j))*r_munew(i)<a name='980'>
          end do<a name='981'>
        end do<a name='982'>
      end do<a name='983'>
    end do<a name='984'>
  endif<a name='985'>
else<a name='986'>
  do im = scs, sce<a name='987'>
    do j = jts, min(jte,jde-1)<a name='988'>
      do k = kts, min(kte,kde-1)<a name='989'>
        do i = its, min(ite,ide-1)<a name='990'>
          g_tendency(i,k,j) = 0.<a name='991'>
          tendency(i,k,j) = 0.<a name='992'>
        end do<a name='993'>
      end do<a name='994'>
    end do<a name='995'>
    do j = j_start, j_end<a name='996'>
      do k = k_start, k_end<a name='997'>
        do i = i_start, i_end<a name='998'>
          g_tendency(i,k,j) = g_advect_tend(i,k,j)<a name='999'>
          tendency(i,k,j) = advect_tend(i,k,j)<a name='1000'>
        end do<a name='1001'>
      end do<a name='1002'>
    end do<a name='1003'>
    do j = j_start_spc, j_end_spc<a name='1004'>
      do k = k_start_spc, k_end_spc<a name='1005'>
        do i = i_start_spc, i_end_spc<a name='1006'>
          g_tendency(i,k,j) = g_sc_tend(i,k,j,im)+g_tendency(i,k,j)<a name='1007'>
          tendency(i,k,j) = tendency(i,k,j)+sc_tend(i,k,j,im)<a name='1008'>
        end do<a name='1009'>
      end do<a name='1010'>
    end do<a name='1011'>
    do j = jts, min(jte,jde-1)<a name='1012'>
      do i = its, min(ite,ide-1)<a name='1013'>
        g_muold(i) = g_mu_old(i,j)<a name='1014'>
        muold(i) = mu_old(i,j)+mu_base(i,j)<a name='1015'>
        g_r_munew(i) = -(g_mu_new(i,j)/((mu_new(i,j)+mu_base(i,j))*(mu_new(i,j)+mu_base(i,j))))<a name='1016'>
        r_munew(i) = 1./(mu_new(i,j)+mu_base(i,j))<a name='1017'>
      end do<a name='1018'>
      do k = kts, min(kte,kde-1)<a name='1019'>
        do i = its, min(ite,ide-1)<a name='1020'>
          g_sc_middle = g_scalar_2(i,k,j,im)<a name='1021'>
          sc_middle = scalar_2(i,k,j,im)<a name='1022'>
          g_scalar_2(i,k,j,im) = g_muold(i)*scalar_1(i,k,j,im)*r_munew(i)+g_r_munew(i)*(muold(i)*scalar_1(i,k,j,im)+2*msft(i,j)**2*&amp;<a name='1023'>
&amp;dt*tendency(i,k,j))+g_scalar_1(i,k,j,im)*muold(i)*r_munew(i)+2*g_tendency(i,k,j)*msft(i,j)**2*dt*r_munew(i)<a name='1024'>
          scalar_2(i,k,j,im) = (muold(i)*scalar_1(i,k,j,im)+msft(i,j)**2*2*dt*tendency(i,k,j))*r_munew(i)<a name='1025'>
          g_scalar_1(i,k,j,im) = g_sc_middle*(1+(-2)*epsts)+(g_scalar_1(i,k,j,im)+g_scalar_2(i,k,j,im))*epsts<a name='1026'>
          scalar_1(i,k,j,im) = sc_middle+epsts*(scalar_1(i,k,j,im)-2*sc_middle+scalar_2(i,k,j,im))<a name='1027'>
        end do<a name='1028'>
      end do<a name='1029'>
    end do<a name='1030'>
  end do<a name='1031'>
endif<a name='1032'>
<a name='1033'>
  call <A href='../../html_code/frame/module_trace.F.html#TRACE_EXIT'>trace_exit</A><A href='../../html_code/dyn_em/module_em_tl.F.html#G_RK_UPDATE_SCALAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRACE_EXIT_86">("g_rk_update_scalar")<a name='1034'>
<a name='1035'>
end subroutine g_rk_update_scalar<a name='1036'>
<a name='1037'>
end module g_module_em<a name='1038'>
<a name='1039'>
</pre></body></html>