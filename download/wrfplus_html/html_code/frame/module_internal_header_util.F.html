<HTML> <BODY BGCOLOR=#eeddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<A NAME='MODULE_INTERNAL_HEADER_UTIL'><A href='../../html_code/frame/module_internal_header_util.F.html#MODULE_INTERNAL_HEADER_UTIL' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='2'>
<font color=#993300>MODULE </font><font color=#cc0000>module_internal_header_util</font> <A href='../../call_to/MODULE_INTERNAL_HEADER_UTIL.html' TARGET='index'>1</A><a name='3'>
<a name='4'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='5'></font>
<font color=#447700>!&lt;PRE&gt;<a name='6'></font>
<font color=#447700>! Subroutines defined in this module are used to generate (put together) and get (take apart) <a name='7'></font>
<font color=#447700>! data headers stored in the form of integer vectors.<a name='8'></font>
<font color=#447700>! <a name='9'></font>
<font color=#447700>! Data headers serve two purposes:  <a name='10'></font>
<font color=#447700>!   - Provide a package-independent metadata storage and retrieval mechanism <a name='11'></font>
<font color=#447700>!     for I/O packages that do not support native metadata.  <a name='12'></font>
<font color=#447700>!   - Provide a mechanism for communicating I/O commands from compute <a name='13'></font>
<font color=#447700>!     tasks to quilt tasks when I/O quilt servers are enabled.  <a name='14'></font>
<font color=#447700>! <a name='15'></font>
<font color=#447700>! Within a data header, character strings are stored one character per integer.  <a name='16'></font>
<font color=#447700>! The number of characters is stored immediately before the first character of <a name='17'></font>
<font color=#447700>! each string.<a name='18'></font>
<font color=#447700>!<a name='19'></font>
<font color=#447700>! In an I/O package that does not support native metadata, routines <a name='20'></font>
<font color=#447700>! int_gen_*_header() are called to pack information into data headers that <a name='21'></font>
<font color=#447700>! are then written to files.  Routines int_get_*_header() are called to <a name='22'></font>
<font color=#447700>! extract information from a data headers after they have been read from a <a name='23'></font>
<font color=#447700>! file.  <a name='24'></font>
<font color=#447700>!<a name='25'></font>
<font color=#447700>! When I/O quilt server tasks are used, routines int_gen_*_header() <a name='26'></font>
<font color=#447700>! are called by compute tasks to pack information into data headers <a name='27'></font>
<font color=#447700>! (commands) that are then sent to the I/O quilt servers.  Routines <a name='28'></font>
<font color=#447700>! int_get_*_header() are called by I/O quilt servers to extract <a name='29'></font>
<font color=#447700>! information from data headers (commands) received from the compute <a name='30'></font>
<font color=#447700>! tasks.  <a name='31'></font>
<font color=#447700>!<a name='32'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='33'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='34'></font>
<a name='35'>
<A NAME='INT_GET_TI_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='36'>
<font color=#993300>INTERFACE </font><font color=#cc0000>int_get_ti_header</font> <A href='../../call_to/INT_GET_TI_HEADER.html' TARGET='index'>2</A>,<A href='../../call_from/INT_GET_TI_HEADER.html' TARGET='index'>1</A><a name='37'>
   MODULE PROCEDURE <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_INTEGER'>int_get_ti_header_integer</A><A NAME="INT_GET_TI_HEADER_INTEGER_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a>, <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_REAL'>int_get_ti_header_real</A><A NAME="INT_GET_TI_HEADER_REAL_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='38'>
END INTERFACE<a name='39'>
<A NAME='INT_GEN_TI_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='40'>
<font color=#993300>INTERFACE </font><font color=#cc0000>int_gen_ti_header</font> <A href='../../call_to/INT_GEN_TI_HEADER.html' TARGET='index'>2</A>,<A href='../../call_from/INT_GEN_TI_HEADER.html' TARGET='index'>1</A><a name='41'>
   MODULE PROCEDURE <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_INTEGER'>int_gen_ti_header_integer</A><A NAME="INT_GEN_TI_HEADER_INTEGER_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a>, <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_REAL'>int_gen_ti_header_real</A><A NAME="INT_GEN_TI_HEADER_REAL_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='42'>
END INTERFACE<a name='43'>
<A NAME='INT_GET_TD_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='44'>
<font color=#993300>INTERFACE </font><font color=#cc0000>int_get_td_header</font> <A href='../../call_to/INT_GET_TD_HEADER.html' TARGET='index'>2</A>,<A href='../../call_from/INT_GET_TD_HEADER.html' TARGET='index'>2</A><a name='45'>
   MODULE PROCEDURE <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_INTEGER'>int_get_td_header_integer</A><A NAME="INT_GET_TD_HEADER_INTEGER_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a>, <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_REAL'>int_get_td_header_real</A><A NAME="INT_GET_TD_HEADER_REAL_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='46'>
END INTERFACE<a name='47'>
<A NAME='INT_GEN_TD_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='48'>
<font color=#993300>INTERFACE </font><font color=#cc0000>int_gen_td_header</font>,<A href='../../call_from/INT_GEN_TD_HEADER.html' TARGET='index'>2</A><a name='49'>
   MODULE PROCEDURE <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_INTEGER'>int_gen_td_header_integer</A><A NAME="INT_GEN_TD_HEADER_INTEGER_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a>, <A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_REAL'>int_gen_td_header_real</A><A NAME="INT_GEN_TD_HEADER_REAL_1"><A href='../../html_code/frame/module_internal_header_util.F.html#module_internal_header_util.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='50'>
END INTERFACE<a name='51'>
<a name='52'>
PRIVATE :: int_pack_string, int_unpack_string<a name='53'>
<a name='54'>
CONTAINS<a name='55'>
<font color=#447700>!!!!!!!!!!!!! header manipulation routines !!!!!!!!!!!!!!!<a name='56'></font>
<a name='57'>
<A NAME='GET_HDR_TAG'><A href='../../html_code/frame/module_internal_header_util.F.html#GET_HDR_TAG' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='58'>
INTEGER <font color=#993300>FUNCTION </font><font color=#cc0000>get_hdr_tag</font>( hdrbuf )<a name='59'>
  IMPLICIT NONE<a name='60'>
  INTEGER, INTENT(IN) :: hdrbuf(*)<a name='61'>
  get_hdr_tag = hdrbuf(2)<a name='62'>
  RETURN<a name='63'>
END FUNCTION get_hdr_tag<a name='64'>
<a name='65'>
<A NAME='GET_HDR_REC_SIZE'><A href='../../html_code/frame/module_internal_header_util.F.html#GET_HDR_REC_SIZE' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='66'>
INTEGER <font color=#993300>FUNCTION </font><font color=#cc0000>get_hdr_rec_size</font>( hdrbuf )<a name='67'>
  IMPLICIT NONE<a name='68'>
  INTEGER, INTENT(IN) :: hdrbuf(*)<a name='69'>
  get_hdr_rec_size = hdrbuf(1)<a name='70'>
  RETURN<a name='71'>
END FUNCTION get_hdr_rec_size<a name='72'>
<a name='73'>
<A NAME='INT_GEN_WRITE_FIELD_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='74'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_write_field_header</font> ( hdrbuf, hdrbufsize, itypesize, ftypesize, &amp; <A href='../../call_to/INT_GEN_WRITE_FIELD_HEADER.html' TARGET='index'>2</A>,<A href='../../call_from/INT_GEN_WRITE_FIELD_HEADER.html' TARGET='index'>14</A><a name='75'>
                                        DataHandle , DateStr , VarName , Dummy , FieldType , Comm , IOComm, &amp;<a name='76'>
                                        DomainDesc , MemoryOrder , Stagger , DimNames ,              &amp;<a name='77'>
                                        DomainStart , DomainEnd ,                                    &amp;<a name='78'>
                                        MemoryStart , MemoryEnd ,                                    &amp;<a name='79'>
                                        PatchStart , PatchEnd )<a name='80'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='81'></font>
<font color=#447700>!&lt;PRE&gt;<a name='82'></font>
<font color=#447700>! Items and their starting locations within a "write field" data header.  <a name='83'></font>
<font color=#447700>! Assume that the data header is stored in integer vector "hdrbuf":  <a name='84'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='85'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='86'></font>
<font color=#447700>!  hdrbuf(3) = ftypesize<a name='87'></font>
<font color=#447700>!  hdrbuf(4) = DataHandle<a name='88'></font>
<font color=#447700>!  hdrbuf(5) = LEN(TRIM(DateStr))<a name='89'></font>
<font color=#447700>!  hdrbuf(6:5+n1) = DateStr                                          ! n1 = LEN(TRIM(DateStr)) + 1<a name='90'></font>
<font color=#447700>!  hdrbuf(6+n1) = LEN(TRIM(VarName))<a name='91'></font>
<font color=#447700>!  hdrbuf(7+n1:6+n1+n2) = VarName                                    ! n2 = LEN(TRIM(VarName)) + 1<a name='92'></font>
<font color=#447700>!  hdrbuf(7+n1+n2) = FieldType<a name='93'></font>
<font color=#447700>!  hdrbuf(8+n1+n2) = LEN(TRIM(MemoryOrder))<a name='94'></font>
<font color=#447700>!  hdrbuf(9+n1+n2:8+n1+n2+n3) = MemoryOrder                          ! n3 = LEN(TRIM(MemoryOrder)) + 1<a name='95'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3) = LEN(TRIM(Stagger))<a name='96'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3:8+n1+n2+n3+n4) = Stagger                        ! n4 = LEN(TRIM(Stagger)) + 1<a name='97'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4) = LEN(TRIM(DimNames(1)))<a name='98'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4:8+n1+n2+n3+n4+n5) = DimNames(1)              ! n5 = LEN(TRIM(DimNames(1))) + 1<a name='99'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4+n5) = LEN(TRIM(DimNames(2)))<a name='100'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4+n5:8+n1+n2+n3+n4+n5+n6) = DimNames(2)        ! n6 = LEN(TRIM(DimNames(2))) + 1<a name='101'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4+n5+n6) = LEN(TRIM(DimNames(3)))<a name='102'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4+n5+n6:8+n1+n2+n3+n4+n5+n6+n7) = DimNames(3)  ! n7 = LEN(TRIM(DimNames(3))) + 1<a name='103'></font>
<font color=#447700>!  hdrbuf(9+n1+n2+n3+n4+n5+n6+n7) = DomainStart(1)<a name='104'></font>
<font color=#447700>!  hdrbuf(10+n1+n2+n3+n4+n5+n6+n7) = DomainStart(2)<a name='105'></font>
<font color=#447700>!  hdrbuf(11+n1+n2+n3+n4+n5+n6+n7) = DomainStart(3)<a name='106'></font>
<font color=#447700>!  hdrbuf(12+n1+n2+n3+n4+n5+n6+n7) = DomainEnd(1)<a name='107'></font>
<font color=#447700>!  hdrbuf(13+n1+n2+n3+n4+n5+n6+n7) = DomainEnd(2)<a name='108'></font>
<font color=#447700>!  hdrbuf(14+n1+n2+n3+n4+n5+n6+n7) = DomainEnd(3)<a name='109'></font>
<font color=#447700>!  hdrbuf(15+n1+n2+n3+n4+n5+n6+n7) = PatchStart(1)<a name='110'></font>
<font color=#447700>!  hdrbuf(16+n1+n2+n3+n4+n5+n6+n7) = PatchStart(2)<a name='111'></font>
<font color=#447700>!  hdrbuf(17+n1+n2+n3+n4+n5+n6+n7) = PatchStart(3)<a name='112'></font>
<font color=#447700>!  hdrbuf(18+n1+n2+n3+n4+n5+n6+n7) = PatchEnd(1)<a name='113'></font>
<font color=#447700>!  hdrbuf(19+n1+n2+n3+n4+n5+n6+n7) = PatchEnd(2)<a name='114'></font>
<font color=#447700>!  hdrbuf(20+n1+n2+n3+n4+n5+n6+n7) = PatchEnd(3)<a name='115'></font>
<font color=#447700>!  hdrbuf(21+n1+n2+n3+n4+n5+n6+n7) = DomainDesc<a name='116'></font>
<font color=#447700>!<a name='117'></font>
<font color=#447700>! Further details for some items:  <a name='118'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='119'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='120'></font>
<font color=#447700>!               header this is.  For a "write field" header it must be set to <a name='121'></font>
<font color=#447700>!               int_field.  See file intio_tags.h for a complete list of <a name='122'></font>
<font color=#447700>!               these tags.  <a name='123'></font>
<font color=#447700>!  ftypesize:   Size of field data type in bytes.  <a name='124'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='125'></font>
<font color=#447700>!  DomainDesc:  Additional argument that may be used by some packages as a <a name='126'></font>
<font color=#447700>!               package-specific domain descriptor.  <a name='127'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='128'></font>
<font color=#447700>!  Specification".  <a name='129'></font>
<font color=#447700>!<a name='130'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='131'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='132'></font>
  IMPLICIT NONE<a name='133'>
  INCLUDE 'intio_tags.h'<a name='134'>
  INTEGER,       INTENT(INOUT)  ::  hdrbuf(*)<a name='135'>
  INTEGER,       INTENT(INOUT)  ::  hdrbufsize<a name='136'>
  INTEGER,       INTENT(INOUT)  ::  itypesize, ftypesize<a name='137'>
  INTEGER ,      INTENT(IN)     :: DataHandle<a name='138'>
  CHARACTER*(*), INTENT(IN)  :: DateStr<a name='139'>
  CHARACTER*(*), INTENT(IN)  :: VarName<a name='140'>
  REAL, DIMENSION(*)            :: Dummy<a name='141'>
  INTEGER                       ,intent(in)    :: FieldType<a name='142'>
  INTEGER                       ,intent(inout) :: Comm<a name='143'>
  INTEGER                       ,intent(inout) :: IOComm<a name='144'>
  INTEGER                       ,intent(in)    :: DomainDesc<a name='145'>
  CHARACTER*(*)                 ,intent(in)    :: MemoryOrder<a name='146'>
  CHARACTER*(*)                 ,intent(in)    :: Stagger<a name='147'>
  CHARACTER*(*) , dimension (*) ,intent(in)    :: DimNames<a name='148'>
  INTEGER ,dimension(*)         ,intent(in)    :: DomainStart, DomainEnd<a name='149'>
  INTEGER ,dimension(*)         ,intent(in)    :: MemoryStart, MemoryEnd<a name='150'>
  INTEGER ,dimension(*)         ,intent(in)    :: PatchStart,  PatchEnd<a name='151'>
<a name='152'>
  INTEGER i, n<a name='153'>
<a name='154'>
<a name='155'>
  hdrbuf(1) = 0 <font color=#447700>! deferred -- this will be length of header<a name='156'></font>
  hdrbuf(2) = int_field<a name='157'>
  hdrbuf(3) = ftypesize<a name='158'>
<a name='159'>
  i = 4<a name='160'>
  hdrbuf(i) = DataHandle      ; i = i+1<a name='161'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_18">( DateStr, hdrbuf(i), n ) ; i = i + n<a name='162'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_19">( VarName, hdrbuf(i), n ) ; i = i + n<a name='163'>
  hdrbuf(i) = FieldType       ; i = i+1<a name='164'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_20">( MemoryOrder, hdrbuf(i), n ) ; i = i + n<a name='165'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_21">( Stagger,     hdrbuf(i), n ) ; i = i + n<a name='166'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_22">( DimNames(1), hdrbuf(i), n ) ; i = i + n<a name='167'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_23">( DimNames(2), hdrbuf(i), n ) ; i = i + n<a name='168'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_24">( DimNames(3), hdrbuf(i), n ) ; i = i + n<a name='169'>
  hdrbuf(i) = DomainStart(1)     ; i = i+1<a name='170'>
  hdrbuf(i) = DomainStart(2)     ; i = i+1<a name='171'>
  hdrbuf(i) = DomainStart(3)     ; i = i+1<a name='172'>
  hdrbuf(i) = DomainEnd(1)       ; i = i+1<a name='173'>
  hdrbuf(i) = DomainEnd(2)       ; i = i+1<a name='174'>
  hdrbuf(i) = DomainEnd(3)       ; i = i+1<a name='175'>
  hdrbuf(i) = PatchStart(1)     ; i = i+1<a name='176'>
  hdrbuf(i) = PatchStart(2)     ; i = i+1<a name='177'>
  hdrbuf(i) = PatchStart(3)     ; i = i+1<a name='178'>
  hdrbuf(i) = PatchEnd(1)       ; i = i+1<a name='179'>
  hdrbuf(i) = PatchEnd(2)       ; i = i+1<a name='180'>
  hdrbuf(i) = PatchEnd(3)       ; i = i+1<a name='181'>
  hdrbuf(i) = DomainDesc        ; i = i+1<a name='182'>
<a name='183'>
  hdrbufsize = (i-1) * itypesize  <font color=#447700>! return the number in bytes<a name='184'></font>
  hdrbuf(1) = hdrbufsize<a name='185'>
<a name='186'>
  RETURN<a name='187'>
END SUBROUTINE int_gen_write_field_header<a name='188'>
<a name='189'>
<a name='190'>
<A NAME='INT_GET_WRITE_FIELD_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='191'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_write_field_header</font> ( hdrbuf, hdrbufsize, itypesize, ftypesize, &amp; <A href='../../call_to/INT_GET_WRITE_FIELD_HEADER.html' TARGET='index'>3</A>,<A href='../../call_from/INT_GET_WRITE_FIELD_HEADER.html' TARGET='index'>16</A><a name='192'>
                                        DataHandle , DateStr , VarName , Dummy , FieldType , Comm , IOComm,  &amp;<a name='193'>
                                        DomainDesc , MemoryOrder , Stagger , DimNames ,              &amp;<a name='194'>
                                        DomainStart , DomainEnd ,                                    &amp;<a name='195'>
                                        MemoryStart , MemoryEnd ,                                    &amp;<a name='196'>
                                        PatchStart , PatchEnd )<a name='197'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='198'></font>
<font color=#447700>!&lt;PRE&gt;<a name='199'></font>
<font color=#447700>! See documentation block in int_gen_write_field_header() for <a name='200'></font>
<font color=#447700>! a description of a "write field" header.  <a name='201'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='202'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='203'></font>
  IMPLICIT NONE<a name='204'>
  INCLUDE 'intio_tags.h'<a name='205'>
  INTEGER,       INTENT(INOUT)  ::  hdrbuf(*)<a name='206'>
  INTEGER,       INTENT(OUT)    ::  hdrbufsize<a name='207'>
  INTEGER,       INTENT(INOUT)  ::  itypesize, ftypesize<a name='208'>
  INTEGER ,      INTENT(OUT)    :: DataHandle<a name='209'>
  CHARACTER*(*), INTENT(INOUT)  :: DateStr<a name='210'>
  CHARACTER*(*), INTENT(INOUT)  :: VarName<a name='211'>
  REAL, DIMENSION(*)            :: Dummy<a name='212'>
  INTEGER                                       :: FieldType<a name='213'>
  INTEGER                                       :: Comm<a name='214'>
  INTEGER                                       :: IOComm<a name='215'>
  INTEGER                                       :: DomainDesc<a name='216'>
  CHARACTER*(*)                                 :: MemoryOrder<a name='217'>
  CHARACTER*(*)                                 :: Stagger<a name='218'>
  CHARACTER*(*) , dimension (*)                 :: DimNames<a name='219'>
  INTEGER ,dimension(*)                         :: DomainStart, DomainEnd<a name='220'>
  INTEGER ,dimension(*)                         :: MemoryStart, MemoryEnd<a name='221'>
  INTEGER ,dimension(*)                         :: PatchStart,  PatchEnd<a name='222'>
<font color=#447700>!Local<a name='223'></font>
  CHARACTER*132 mess<a name='224'>
  INTEGER i, n<a name='225'>
<a name='226'>
  hdrbufsize = hdrbuf(1)<a name='227'>
  IF ( hdrbuf(2) .NE. int_field ) THEN<a name='228'>
    write(mess,*)'int_get_write_field_header: hdrbuf(2) ne int_field ',hdrbuf(2),int_field<a name='229'>
    CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_90"> ( mess )<a name='230'>
  ENDIF<a name='231'>
  ftypesize = hdrbuf(3)<a name='232'>
<a name='233'>
   i = 4<a name='234'>
   DataHandle = hdrbuf(i)     ; i = i+1<a name='235'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_18">( DateStr, hdrbuf(i), n )     ; i = i+n<a name='236'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_19">( VarName, hdrbuf(i), n )     ; i = i+n<a name='237'>
   FieldType = hdrbuf(i)      ; i = i+1<a name='238'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_20">( MemoryOrder, hdrbuf(i), n ) ; i = i+n<a name='239'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_21">( Stagger, hdrbuf(i), n )     ; i = i+n<a name='240'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_22">( DimNames(1), hdrbuf(i), n ) ; i = i+n<a name='241'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_23">( DimNames(2), hdrbuf(i), n ) ; i = i+n<a name='242'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_WRITE_FIELD_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_24">( DimNames(3), hdrbuf(i), n ) ; i = i+n<a name='243'>
   DomainStart(1) = hdrbuf(i)    ; i = i+1<a name='244'>
   DomainStart(2) = hdrbuf(i)    ; i = i+1<a name='245'>
   DomainStart(3) = hdrbuf(i)    ; i = i+1<a name='246'>
   DomainEnd(1) = hdrbuf(i)       ; i = i+1<a name='247'>
   DomainEnd(2) = hdrbuf(i)       ; i = i+1<a name='248'>
   DomainEnd(3) = hdrbuf(i)       ; i = i+1<a name='249'>
   PatchStart(1) = hdrbuf(i)     ; i = i+1<a name='250'>
   PatchStart(2) = hdrbuf(i)     ; i = i+1<a name='251'>
   PatchStart(3) = hdrbuf(i)     ; i = i+1<a name='252'>
   PatchEnd(1) = hdrbuf(i)       ; i = i+1<a name='253'>
   PatchEnd(2) = hdrbuf(i)       ; i = i+1<a name='254'>
   PatchEnd(3) = hdrbuf(i)       ; i = i+1<a name='255'>
   DomainDesc = hdrbuf(i)       ; i = i+1<a name='256'>
<a name='257'>
  RETURN<a name='258'>
END SUBROUTINE int_get_write_field_header<a name='259'>
<a name='260'>
<font color=#447700>!!!!!!!!<a name='261'></font>
<a name='262'>
<font color=#447700>!generate open for read header<a name='263'></font>
<A NAME='INT_GEN_OFR_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_OFR_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='264'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_ofr_header</font>( hdrbuf, hdrbufsize, itypesize, &amp;,<A href='../../call_from/INT_GEN_OFR_HEADER.html' TARGET='index'>4</A><a name='265'>
                                FileName, SysDepInfo, DataHandle )<a name='266'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='267'></font>
<font color=#447700>!&lt;PRE&gt;<a name='268'></font>
<font color=#447700>! Items and their starting locations within a "open for read" data header.  <a name='269'></font>
<font color=#447700>! Assume that the data header is stored in integer vector "hdrbuf":  <a name='270'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='271'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='272'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='273'></font>
<font color=#447700>!  hdrbuf(4) = LEN(TRIM(FileName))<a name='274'></font>
<font color=#447700>!  hdrbuf(5:4+n1) = FileName             ! n1 = LEN(TRIM(FileName)) + 1<a name='275'></font>
<font color=#447700>!  hdrbuf(5+n1) = LEN(TRIM(SysDepInfo))<a name='276'></font>
<font color=#447700>!  hdrbuf(6+n1:5+n1+n2) = SysDepInfo     ! n2 = LEN(TRIM(SysDepInfo)) + 1<a name='277'></font>
<font color=#447700>!<a name='278'></font>
<font color=#447700>! Further details for some items:  <a name='279'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='280'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='281'></font>
<font color=#447700>!               header this is.  For an "open for read" header it must be set to <a name='282'></font>
<font color=#447700>!               int_open_for_read.  See file intio_tags.h for a complete list of <a name='283'></font>
<font color=#447700>!               these tags.  <a name='284'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='285'></font>
<font color=#447700>!  FileName:    File name.  <a name='286'></font>
<font color=#447700>!  SysDepInfo:  System dependent information used for optional additional <a name='287'></font>
<font color=#447700>!               I/O control information.  <a name='288'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='289'></font>
<font color=#447700>!  Specification".  <a name='290'></font>
<font color=#447700>!<a name='291'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='292'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='293'></font>
  IMPLICIT NONE<a name='294'>
  INCLUDE 'intio_tags.h'<a name='295'>
  INTEGER,       INTENT(INOUT) ::  hdrbuf(*)<a name='296'>
  INTEGER,       INTENT(OUT)   ::  hdrbufsize<a name='297'>
  INTEGER,       INTENT(INOUT) ::  itypesize<a name='298'>
  INTEGER ,      INTENT(IN)    :: DataHandle<a name='299'>
  CHARACTER*(*), INTENT(INOUT) :: FileName<a name='300'>
  CHARACTER*(*), INTENT(INOUT) :: SysDepInfo<a name='301'>
<font color=#447700>!Local<a name='302'></font>
  INTEGER i, n, i1<a name='303'>
<font color=#447700>!<a name='304'></font>
  hdrbuf(1) = 0  <font color=#447700>!deferred<a name='305'></font>
  hdrbuf(2) = int_open_for_read<a name='306'>
  i = 3<a name='307'>
  hdrbuf(i) = DataHandle     ; i = i+1<a name='308'>
<a name='309'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_OFR_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_25">( TRIM(FileName), hdrbuf(i), n )   ; i = i + n<a name='310'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_OFR_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_26">( TRIM(SysDepInfo), hdrbuf(i), n ) ; i = i + n<a name='311'>
  hdrbufsize = (i-1) * itypesize  <font color=#447700>! return the number in bytes<a name='312'></font>
  hdrbuf(1) = hdrbufsize<a name='313'>
  RETURN<a name='314'>
END SUBROUTINE int_gen_ofr_header<a name='315'>
<a name='316'>
<font color=#447700>!get open for read header<a name='317'></font>
<A NAME='INT_GET_OFR_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_OFR_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='318'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_ofr_header</font>( hdrbuf, hdrbufsize, itypesize, &amp;,<A href='../../call_from/INT_GET_OFR_HEADER.html' TARGET='index'>4</A><a name='319'>
                                FileName, SysDepInfo, DataHandle )<a name='320'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='321'></font>
<font color=#447700>!&lt;PRE&gt;<a name='322'></font>
<font color=#447700>! See documentation block in int_gen_ofr_header() for <a name='323'></font>
<font color=#447700>! a description of a "open for read" header.  <a name='324'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='325'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='326'></font>
  IMPLICIT NONE<a name='327'>
  INCLUDE 'intio_tags.h'<a name='328'>
  INTEGER,       INTENT(INOUT) ::  hdrbuf(*)<a name='329'>
  INTEGER,       INTENT(OUT)   ::  hdrbufsize<a name='330'>
  INTEGER,       INTENT(INOUT) ::  itypesize<a name='331'>
  INTEGER ,      INTENT(OUT)   :: DataHandle<a name='332'>
  CHARACTER*(*), INTENT(INOUT) :: FileName<a name='333'>
  CHARACTER*(*), INTENT(INOUT) :: SysDepInfo<a name='334'>
<font color=#447700>!Local<a name='335'></font>
  INTEGER i, n<a name='336'>
<font color=#447700>!<a name='337'></font>
  hdrbufsize = hdrbuf(1)<a name='338'>
<font color=#447700>!  IF ( hdrbuf(2) .NE. int_open_for_read ) THEN<a name='339'></font>
<font color=#447700>!    CALL wrf_error_fatal ( "int_get_ofr_header: hdrbuf ne int_open_for_read")<a name='340'></font>
<font color=#447700>!  ENDIF<a name='341'></font>
  i = 3<a name='342'>
  DataHandle = hdrbuf(i)    ; i = i+1<a name='343'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_OFR_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_25">( FileName, hdrbuf(i), n ) ; i = i+n<a name='344'>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_OFR_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_26">( SysDepInfo, hdrbuf(i), n ) ; i = i+n<a name='345'>
  RETURN<a name='346'>
END SUBROUTINE int_get_ofr_header<a name='347'>
<a name='348'>
<font color=#447700>!!!!!!!!<a name='349'></font>
<a name='350'>
<font color=#447700>!generate open for write begin header<a name='351'></font>
<A NAME='INT_GEN_OFWB_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_OFWB_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='352'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_ofwb_header</font>( hdrbuf, hdrbufsize, itypesize, &amp; <A href='../../call_to/INT_GEN_OFWB_HEADER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GEN_OFWB_HEADER.html' TARGET='index'>4</A><a name='353'>
                                FileName, SysDepInfo, io_form, DataHandle )<a name='354'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='355'></font>
<font color=#447700>!&lt;PRE&gt;<a name='356'></font>
<font color=#447700>! Items and their starting locations within a "open for write begin" data <a name='357'></font>
<font color=#447700>! header.  Assume that the data header is stored in integer vector "hdrbuf":  <a name='358'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='359'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='360'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='361'></font>
<font color=#447700>!  hdrbuf(4) = io_form<a name='362'></font>
<font color=#447700>!  hdrbuf(5) = LEN(TRIM(FileName))<a name='363'></font>
<font color=#447700>!  hdrbuf(6:5+n1) = FileName             ! n1 = LEN(TRIM(FileName)) + 1<a name='364'></font>
<font color=#447700>!  hdrbuf(6+n1) = LEN(TRIM(SysDepInfo))<a name='365'></font>
<font color=#447700>!  hdrbuf(7+n1:6+n1+n2) = SysDepInfo     ! n2 = LEN(TRIM(SysDepInfo)) + 1<a name='366'></font>
<font color=#447700>!<a name='367'></font>
<font color=#447700>! Further details for some items:  <a name='368'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='369'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='370'></font>
<font color=#447700>!               header this is.  For an "open for write begin" header it must be set to <a name='371'></font>
<font color=#447700>!               int_open_for_write_begin.  See file intio_tags.h for a complete list of <a name='372'></font>
<font color=#447700>!               these tags.  <a name='373'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='374'></font>
<font color=#447700>!  io_form:     I/O format for this file (netCDF, etc.).  <a name='375'></font>
<font color=#447700>!  FileName:    File name.  <a name='376'></font>
<font color=#447700>!  SysDepInfo:  System dependent information used for optional additional <a name='377'></font>
<font color=#447700>!               I/O control information.  <a name='378'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='379'></font>
<font color=#447700>!  Specification".  <a name='380'></font>
<font color=#447700>!<a name='381'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='382'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='383'></font>
  IMPLICIT NONE<a name='384'>
  INCLUDE 'intio_tags.h'<a name='385'>
  INTEGER,       INTENT(INOUT) :: hdrbuf(*)<a name='386'>
  INTEGER,       INTENT(OUT)   :: hdrbufsize<a name='387'>
  INTEGER,       INTENT(INOUT) :: itypesize<a name='388'>
  INTEGER ,      INTENT(IN)    :: io_form<a name='389'>
  INTEGER ,      INTENT(IN)    :: DataHandle<a name='390'>
  CHARACTER*(*), INTENT(INOUT) :: FileName<a name='391'>
  CHARACTER*(*), INTENT(INOUT) :: SysDepInfo<a name='392'>
<font color=#447700>!Local<a name='393'></font>
  INTEGER i, n, j<a name='394'>
<font color=#447700>!<a name='395'></font>
  hdrbuf(1) = 0  <font color=#447700>!deferred<a name='396'></font>
  hdrbuf(2) = int_open_for_write_begin<a name='397'>
  i = 3<a name='398'>
  hdrbuf(i) = DataHandle     ; i = i+1<a name='399'>
  hdrbuf(i) = io_form        ; i = i+1<a name='400'>
<font color=#447700>!j = i<a name='401'></font>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_OFWB_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_27">( FileName, hdrbuf(i), n )   ; i = i + n<a name='402'>
<font color=#447700>!write(0,*)'int_gen_ofwb_header FileName ',TRIM(FileName),hdrbuf(j),n<a name='403'></font>
<font color=#447700>!j = i<a name='404'></font>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_OFWB_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_28">( SysDepInfo, hdrbuf(i), n ) ; i = i + n<a name='405'>
<font color=#447700>!write(0,*)'int_gen_ofwb_header SysDepInfo ',TRIM(SysDepInfo),hdrbuf(j),n<a name='406'></font>
  hdrbufsize = (i-1) * itypesize  <font color=#447700>! return the number in bytes<a name='407'></font>
  hdrbuf(1) = hdrbufsize<a name='408'>
<font color=#447700>!write(0,*)'int_gen_ofwb_header hdrbuf(1) ',hdrbuf(1)<a name='409'></font>
  RETURN<a name='410'>
END SUBROUTINE int_gen_ofwb_header<a name='411'>
<a name='412'>
<font color=#447700>!get open for write begin header<a name='413'></font>
<A NAME='INT_GET_OFWB_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_OFWB_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='414'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_ofwb_header</font>( hdrbuf, hdrbufsize, itypesize, &amp; <A href='../../call_to/INT_GET_OFWB_HEADER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GET_OFWB_HEADER.html' TARGET='index'>4</A><a name='415'>
                                FileName, SysDepInfo, io_form, DataHandle )<a name='416'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='417'></font>
<font color=#447700>!&lt;PRE&gt;<a name='418'></font>
<font color=#447700>! See documentation block in int_gen_ofwb_header() for <a name='419'></font>
<font color=#447700>! a description of a "open for write begin" header.  <a name='420'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='421'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='422'></font>
  IMPLICIT NONE<a name='423'>
  INCLUDE 'intio_tags.h'<a name='424'>
  INTEGER,       INTENT(INOUT)  :: hdrbuf(*)<a name='425'>
  INTEGER,       INTENT(OUT)    :: hdrbufsize<a name='426'>
  INTEGER,       INTENT(INOUT)  :: itypesize<a name='427'>
  INTEGER ,      INTENT(OUT)    :: DataHandle<a name='428'>
  INTEGER ,      INTENT(OUT)    :: io_form<a name='429'>
  CHARACTER*(*), INTENT (INOUT) :: FileName<a name='430'>
  CHARACTER*(*), INTENT (INOUT) :: SysDepInfo<a name='431'>
<font color=#447700>!Local<a name='432'></font>
  INTEGER i, n, j<a name='433'>
<font color=#447700>!<a name='434'></font>
  hdrbufsize = hdrbuf(1)<a name='435'>
<font color=#447700>!write(0,*)' int_get_ofwb_header next rec start ',hdrbuf(hdrbufsize+1)<a name='436'></font>
<font color=#447700>!  IF ( hdrbuf(2) .NE. int_open_for_write_begin ) THEN<a name='437'></font>
<font color=#447700>!    CALL wrf_error_fatal ( "int_get_ofwb_header: hdrbuf ne int_open_for_write_begin") <a name='438'></font>
<font color=#447700>!  ENDIF<a name='439'></font>
  i = 3<a name='440'>
  DataHandle = hdrbuf(i)    ; i = i+1<a name='441'>
<font color=#447700>!write(0,*)' int_get_ofwb_header next rec',i, hdrbuf(hdrbufsize+1)<a name='442'></font>
  io_form    = hdrbuf(i)    ; i = i+1<a name='443'>
<font color=#447700>!write(0,*)' int_get_ofwb_header next rec',i, hdrbuf(hdrbufsize+1)<a name='444'></font>
<a name='445'>
<font color=#447700>!j = i<a name='446'></font>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_OFWB_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_27">( FileName, hdrbuf(i), n ) ; i = i+n<a name='447'>
<font color=#447700>!write(0,*)'int_get_ofwb_header FileName ',TRIM(FileName),hdrbuf(j),n<a name='448'></font>
<font color=#447700>!write(0,*)' int_get_ofwb_header next rec',i, hdrbuf(hdrbufsize+1)<a name='449'></font>
<font color=#447700>!j = i<a name='450'></font>
  call <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_OFWB_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_28">( SysDepInfo, hdrbuf(i), n ) ; i = i+n<a name='451'>
<font color=#447700>!write(0,*)'int_get_ofwb_header SysDepInfo ',TRIM(SysDepInfo),hdrbuf(j),n<a name='452'></font>
<font color=#447700>!write(0,*)' int_get_ofwb_header next rec',i, hdrbuf(hdrbufsize+1)<a name='453'></font>
<font color=#447700>!write(0,*)'int_get_ofwb_header hdrbufsize ',hdrbufsize<a name='454'></font>
  RETURN<a name='455'>
END SUBROUTINE int_get_ofwb_header<a name='456'>
<a name='457'>
<font color=#447700>!!!!!!!!!!<a name='458'></font>
<a name='459'>
<A NAME='INT_GEN_HANDLE_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_HANDLE_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='460'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_handle_header</font>( hdrbuf, hdrbufsize, itypesize, &amp; <A href='../../call_to/INT_GEN_HANDLE_HEADER.html' TARGET='index'>3</A><a name='461'>
                                DataHandle , code )<a name='462'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='463'></font>
<font color=#447700>!&lt;PRE&gt;<a name='464'></font>
<font color=#447700>! Items and their starting locations within a "generic handle" data header.  <a name='465'></font>
<font color=#447700>! Several types of data headers contain only a DataHandle and a header tag <a name='466'></font>
<font color=#447700>! (I/O command).  This routine is used for all of them.  Assume that <a name='467'></font>
<font color=#447700>! the data header is stored in integer vector "hdrbuf":  <a name='468'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='469'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='470'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='471'></font>
<font color=#447700>!<a name='472'></font>
<font color=#447700>! Further details for some items:  <a name='473'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='474'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='475'></font>
<font color=#447700>!               header this is.  For a "generic handle" header there are <a name='476'></font>
<font color=#447700>!               several possible values.  In this routine, dummy argument <a name='477'></font>
<font color=#447700>!               "code" is used as headerTag.  <a name='478'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='479'></font>
<font color=#447700>!<a name='480'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='481'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='482'></font>
  IMPLICIT NONE<a name='483'>
  INCLUDE 'intio_tags.h'<a name='484'>
  INTEGER, INTENT(INOUT) ::  hdrbuf(*)<a name='485'>
  INTEGER, INTENT(OUT)   ::  hdrbufsize<a name='486'>
  INTEGER, INTENT(INOUT) ::  itypesize<a name='487'>
  INTEGER ,INTENT(IN)    :: DataHandle, code<a name='488'>
<font color=#447700>!Local<a name='489'></font>
  INTEGER i<a name='490'>
<font color=#447700>!<a name='491'></font>
  hdrbuf(1) = 0  <font color=#447700>!deferred<a name='492'></font>
  hdrbuf(2) = code<a name='493'>
  i = 3<a name='494'>
  hdrbuf(i) = DataHandle     ; i = i+1<a name='495'>
  hdrbufsize = (i-1) * itypesize  <font color=#447700>! return the number in bytes<a name='496'></font>
  hdrbuf(1) = hdrbufsize<a name='497'>
  RETURN<a name='498'>
END SUBROUTINE int_gen_handle_header<a name='499'>
<a name='500'>
<A NAME='INT_GET_HANDLE_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_HANDLE_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='501'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_handle_header</font>( hdrbuf, hdrbufsize, itypesize, &amp; <A href='../../call_to/INT_GET_HANDLE_HEADER.html' TARGET='index'>3</A><a name='502'>
                                DataHandle , code )<a name='503'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='504'></font>
<font color=#447700>!&lt;PRE&gt;<a name='505'></font>
<font color=#447700>! See documentation block in int_gen_handle_header() for <a name='506'></font>
<font color=#447700>! a description of a "generic handle" header.  <a name='507'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='508'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='509'></font>
  IMPLICIT NONE<a name='510'>
  INCLUDE 'intio_tags.h'<a name='511'>
  INTEGER, INTENT(INOUT) ::  hdrbuf(*)<a name='512'>
  INTEGER, INTENT(OUT)   ::  hdrbufsize<a name='513'>
  INTEGER, INTENT(INOUT) ::  itypesize<a name='514'>
  INTEGER ,INTENT(OUT)   :: DataHandle, code<a name='515'>
<font color=#447700>!Local<a name='516'></font>
  INTEGER i<a name='517'>
<font color=#447700>!<a name='518'></font>
  hdrbufsize = hdrbuf(1)<a name='519'>
  code       = hdrbuf(2)<a name='520'>
  i = 3<a name='521'>
  DataHandle = hdrbuf(i)    ; i = i+1<a name='522'>
  RETURN<a name='523'>
END SUBROUTINE int_get_handle_header<a name='524'>
<a name='525'>
<font color=#447700>!!!!!!!!!!!!<a name='526'></font>
<a name='527'>
<A NAME='INT_GEN_TI_HEADER_INTEGER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='528'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_ti_header_integer</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GEN_TI_HEADER_INTEGER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GEN_TI_HEADER_INTEGER.html' TARGET='index'>1</A><a name='529'>
                                      DataHandle, Element, Data, Count, code )<a name='530'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='531'></font>
<font color=#447700>!&lt;PRE&gt;<a name='532'></font>
<font color=#447700>! Items and their starting locations within a "time-independent integer" <a name='533'></font>
<font color=#447700>! data header.  Assume that the data header is stored in integer vector <a name='534'></font>
<font color=#447700>! "hdrbuf":  <a name='535'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='536'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='537'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='538'></font>
<font color=#447700>!  hdrbuf(4) = typesize<a name='539'></font>
<font color=#447700>!  hdrbuf(5) = Count<a name='540'></font>
<font color=#447700>!  hdrbuf(6:6+n1) = Data              ! n1 = (Count * typesize / itypesize) + 1<a name='541'></font>
<font color=#447700>!  hdrbuf(7+n1) = LEN(TRIM(Element))<a name='542'></font>
<font color=#447700>!  hdrbuf(8+n1:7+n1+n2) = Element     ! n2 = LEN(TRIM(Element)) + 1<a name='543'></font>
<font color=#447700>!<a name='544'></font>
<font color=#447700>! Further details for some items:  <a name='545'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='546'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='547'></font>
<font color=#447700>!               header this is.  For an "time-independent integer" header it must be <a name='548'></font>
<font color=#447700>!               set to int_dom_ti_integer.  See file intio_tags.h for a complete <a name='549'></font>
<font color=#447700>!               list of these tags.  <a name='550'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='551'></font>
<font color=#447700>!  typesize:    Size in bytes of each element of Data.  <a name='552'></font>
<font color=#447700>!  Count:       Number of elements in Data.  <a name='553'></font>
<font color=#447700>!  Data:        Data to write to file.  <a name='554'></font>
<font color=#447700>!  Element:     Name of the data.  <a name='555'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='556'></font>
<font color=#447700>!  Specification".  <a name='557'></font>
<font color=#447700>!<a name='558'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='559'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='560'></font>
  IMPLICIT NONE<a name='561'>
  INCLUDE 'intio_tags.h'<a name='562'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='563'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='564'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='565'>
  CHARACTER*(*), INTENT(INOUT) ::  Element<a name='566'>
  INTEGER, INTENT(IN)          ::  Data(*)<a name='567'>
  INTEGER, INTENT(IN)          ::  DataHandle, Count, code<a name='568'>
<font color=#447700>!Local<a name='569'></font>
  INTEGER i, n<a name='570'>
<font color=#447700>!<a name='571'></font>
  CALL int_gen_ti_header_c ( hdrbuf, hdrbufsize, itypesize, typesize, &amp;<a name='572'>
                             DataHandle, Data, Count, code )<a name='573'>
  i = hdrbufsize/itypesize + 1 ;<a name='574'>
<font color=#447700>!write(0,*)'int_gen_ti_header_integer ',TRIM(Element)<a name='575'></font>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_29"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='576'>
  hdrbufsize = n * itypesize + hdrbufsize <font color=#447700>! return the number in bytes<a name='577'></font>
  hdrbuf(1) = hdrbufsize<a name='578'>
  RETURN<a name='579'>
END SUBROUTINE int_gen_ti_header_integer<a name='580'>
<a name='581'>
<A NAME='INT_GEN_TI_HEADER_REAL'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='582'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_ti_header_real</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GEN_TI_HEADER_REAL.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GEN_TI_HEADER_REAL.html' TARGET='index'>1</A><a name='583'>
                                   DataHandle, Element, Data, Count, code )<a name='584'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='585'></font>
<font color=#447700>!&lt;PRE&gt;<a name='586'></font>
<font color=#447700>! Same as int_gen_ti_header_integer except that Data has type REAL.  <a name='587'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='588'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='589'></font>
  IMPLICIT NONE<a name='590'>
  INCLUDE 'intio_tags.h'<a name='591'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='592'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='593'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='594'>
  CHARACTER*(*), INTENT(INOUT) ::  Element<a name='595'>
  REAL, INTENT(IN)             ::  Data(*)<a name='596'>
  INTEGER, INTENT(IN)          ::  DataHandle, Count, code<a name='597'>
<font color=#447700>!Local<a name='598'></font>
  INTEGER i, n<a name='599'>
<font color=#447700>!<a name='600'></font>
  CALL int_gen_ti_header_c ( hdrbuf, hdrbufsize, itypesize, typesize, &amp;<a name='601'>
                             DataHandle, Data, Count, code )<a name='602'>
  i = hdrbufsize/itypesize + 1 ;<a name='603'>
<font color=#447700>!write(0,*)'int_gen_ti_header_real ',TRIM(Element)<a name='604'></font>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_30"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='605'>
  hdrbufsize = n * itypesize + hdrbufsize <font color=#447700>! return the number in bytes<a name='606'></font>
  hdrbuf(1) = hdrbufsize<a name='607'>
  RETURN<a name='608'>
END SUBROUTINE int_gen_ti_header_real<a name='609'>
<a name='610'>
<A NAME='INT_GET_TI_HEADER_INTEGER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='611'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_ti_header_integer</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GET_TI_HEADER_INTEGER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GET_TI_HEADER_INTEGER.html' TARGET='index'>1</A><a name='612'>
                              DataHandle, Element, Data, Count, code )<a name='613'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='614'></font>
<font color=#447700>!&lt;PRE&gt;<a name='615'></font>
<font color=#447700>! Same as int_gen_ti_header_integer except that Data is read from <a name='616'></font>
<font color=#447700>! the file.  <a name='617'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='618'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='619'></font>
  IMPLICIT NONE<a name='620'>
  INCLUDE 'intio_tags.h'<a name='621'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='622'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='623'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='624'>
  CHARACTER*(*), INTENT(INOUT) ::  Element<a name='625'>
  INTEGER, INTENT(OUT)         ::  Data(*)<a name='626'>
  INTEGER, INTENT(OUT)         ::  DataHandle, Count, code<a name='627'>
<font color=#447700>!Local<a name='628'></font>
  INTEGER i, n<a name='629'>
<font color=#447700>!<a name='630'></font>
<a name='631'>
  CALL int_get_ti_header_c ( hdrbuf, hdrbufsize, n, itypesize, typesize, &amp;<a name='632'>
                           DataHandle, Data, Count, code )<a name='633'>
  i = 1 <a name='634'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_29"> ( Element, hdrbuf( n/itypesize + 1 ), n ) ;<a name='635'>
<font color=#447700>!write(0,*)'int_get_ti_header_integer ',TRIM(Element), Data(1)<a name='636'></font>
  hdrbufsize = hdrbuf(1)<a name='637'>
  RETURN<a name='638'>
END SUBROUTINE int_get_ti_header_integer<a name='639'>
<a name='640'>
<A NAME='INT_GET_TI_HEADER_REAL'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='641'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_ti_header_real</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GET_TI_HEADER_REAL.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GET_TI_HEADER_REAL.html' TARGET='index'>1</A><a name='642'>
                              DataHandle, Element, Data, Count, code )<a name='643'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='644'></font>
<font color=#447700>!&lt;PRE&gt;<a name='645'></font>
<font color=#447700>! Same as int_gen_ti_header_real except that Data is read from <a name='646'></font>
<font color=#447700>! the file.  <a name='647'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='648'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='649'></font>
  IMPLICIT NONE<a name='650'>
  INCLUDE 'intio_tags.h'<a name='651'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='652'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='653'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='654'>
  CHARACTER*(*), INTENT(INOUT) ::  Element<a name='655'>
  REAL, INTENT(OUT)            ::  Data(*)<a name='656'>
  INTEGER, INTENT(OUT)         ::  DataHandle, Count, code<a name='657'>
<font color=#447700>!Local<a name='658'></font>
  INTEGER i, n<a name='659'>
<font color=#447700>!<a name='660'></font>
<a name='661'>
  CALL int_get_ti_header_c ( hdrbuf, hdrbufsize, n, itypesize, typesize, &amp;<a name='662'>
                           DataHandle, Data, Count, code )<a name='663'>
  i = 1<a name='664'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_30"> ( Element, hdrbuf( n/itypesize + 1 ), n ) ;<a name='665'>
<font color=#447700>!write(0,*)'int_get_ti_header_real ',TRIM(Element), Data(1)<a name='666'></font>
  hdrbufsize = hdrbuf(1)<a name='667'>
  RETURN<a name='668'>
END SUBROUTINE int_get_ti_header_real<a name='669'>
<a name='670'>
<font color=#447700>!!!!!!!!!!!!<a name='671'></font>
<a name='672'>
<A NAME='INT_GEN_TI_HEADER_CHAR'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='673'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_ti_header_char</font>( hdrbuf, hdrbufsize, itypesize, &amp; <A href='../../call_to/INT_GEN_TI_HEADER_CHAR.html' TARGET='index'>3</A>,<A href='../../call_from/INT_GEN_TI_HEADER_CHAR.html' TARGET='index'>6</A><a name='674'>
                              DataHandle, Element, VarName, Data, code )<a name='675'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='676'></font>
<font color=#447700>!&lt;PRE&gt;<a name='677'></font>
<font color=#447700>! Items and their starting locations within a "time-independent string" <a name='678'></font>
<font color=#447700>! data header.  Assume that the data header is stored in integer vector <a name='679'></font>
<font color=#447700>! "hdrbuf":  <a name='680'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='681'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='682'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='683'></font>
<font color=#447700>!  hdrbuf(4) = typesize<a name='684'></font>
<font color=#447700>!  hdrbuf(5) = LEN(TRIM(Element))<a name='685'></font>
<font color=#447700>!  hdrbuf(6:5+n1) = Element                ! n1 = LEN(TRIM(Element)) + 1<a name='686'></font>
<font color=#447700>!  hdrbuf(6+n1) = LEN(TRIM(Data))<a name='687'></font>
<font color=#447700>!  hdrbuf(7+n1:6+n1+n2) = Data             ! n2 = LEN(TRIM(Data)) + 1<a name='688'></font>
<font color=#447700>!  hdrbuf(7+n1+n2) = LEN(TRIM(VarName))<a name='689'></font>
<font color=#447700>!  hdrbuf(8+n1+n2:7+n1+n2+n3) = VarName    ! n3 = LEN(TRIM(VarName)) + 1<a name='690'></font>
<font color=#447700>!<a name='691'></font>
<font color=#447700>! Further details for some items:  <a name='692'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='693'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='694'></font>
<font color=#447700>!               header this is.  For an "time-independent string" header it must be <a name='695'></font>
<font color=#447700>!               set to int_dom_ti_char.  See file intio_tags.h for a complete <a name='696'></font>
<font color=#447700>!               list of these tags.  <a name='697'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='698'></font>
<font color=#447700>!  typesize:    1 (size in bytes of a single CHARACTER).  <a name='699'></font>
<font color=#447700>!  Element:     Name of the data.  <a name='700'></font>
<font color=#447700>!  Data:        Data to write to file.  <a name='701'></font>
<font color=#447700>!  VarName:     Variable name.  Used for *_&lt;get|put&gt;_var_ti_char but not for <a name='702'></font>
<font color=#447700>!               *_&lt;get|put&gt;_dom_ti_char.  <a name='703'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='704'></font>
<font color=#447700>!  Specification".  <a name='705'></font>
<font color=#447700>!<a name='706'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='707'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='708'></font>
  IMPLICIT NONE<a name='709'>
  INCLUDE 'intio_tags.h'<a name='710'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='711'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='712'>
  INTEGER, INTENT(IN)          ::  itypesize<a name='713'>
  CHARACTER*(*), INTENT(IN)    :: Element, Data, VarName<a name='714'>
  INTEGER, INTENT(IN)          ::  DataHandle, code<a name='715'>
<font color=#447700>!Local<a name='716'></font>
  INTEGER                      ::  DummyData<a name='717'>
  INTEGER i, n, Count, DummyCount<a name='718'>
<font color=#447700>!<a name='719'></font>
  DummyCount = 0<a name='720'>
  CALL int_gen_ti_header_c ( hdrbuf, hdrbufsize, itypesize, 1, &amp;<a name='721'>
                             DataHandle, DummyData, DummyCount, code )<a name='722'>
  i = hdrbufsize/itypesize+1 ;<a name='723'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_31"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='724'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_32"> ( Data   , hdrbuf( i ), n ) ; i = i + n<a name='725'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TI_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_33"> ( VarName   , hdrbuf( i ), n ) ; i = i + n<a name='726'>
  hdrbufsize = (i-1) * itypesize + hdrbufsize <font color=#447700>! return the number in bytes<a name='727'></font>
  hdrbuf(1) = hdrbufsize<a name='728'>
  RETURN<a name='729'>
END SUBROUTINE int_gen_ti_header_char<a name='730'>
<a name='731'>
<A NAME='INT_GET_TI_HEADER_CHAR'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='732'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_ti_header_char</font>( hdrbuf, hdrbufsize, itypesize, &amp; <A href='../../call_to/INT_GET_TI_HEADER_CHAR.html' TARGET='index'>3</A>,<A href='../../call_from/INT_GET_TI_HEADER_CHAR.html' TARGET='index'>6</A><a name='733'>
                              DataHandle, Element, VarName, Data, code )<a name='734'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='735'></font>
<font color=#447700>!&lt;PRE&gt;<a name='736'></font>
<font color=#447700>! Same as int_gen_ti_header_char except that Data is read from <a name='737'></font>
<font color=#447700>! the file.  <a name='738'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='739'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='740'></font>
  IMPLICIT NONE<a name='741'>
  INCLUDE 'intio_tags.h'<a name='742'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='743'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='744'>
  INTEGER, INTENT(IN)          ::  itypesize<a name='745'>
  CHARACTER*(*), INTENT(INOUT) ::  Element, Data, VarName<a name='746'>
  INTEGER, INTENT(OUT)         ::  DataHandle, code<a name='747'>
<font color=#447700>!Local<a name='748'></font>
  INTEGER i, n, DummyCount, typesize<a name='749'>
  CHARACTER * 132  dummyData<a name='750'>
<font color=#447700>! logical, external :: debug_foo<a name='751'></font>
<font color=#447700>!<a name='752'></font>
  CALL int_get_ti_header_c ( hdrbuf, hdrbufsize, n, itypesize, typesize, &amp;<a name='753'>
                           DataHandle, dummyData, DummyCount, code )<a name='754'>
  i = n/itypesize+1 ;<a name='755'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_31"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='756'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_32"> ( Data   , hdrbuf( i ), n ) ; i = i + n<a name='757'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TI_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_33"> ( VarName  , hdrbuf( i ), n ) ; i = i + n<a name='758'>
  hdrbufsize = hdrbuf(1)<a name='759'>
<a name='760'>
  RETURN<a name='761'>
END SUBROUTINE int_get_ti_header_char<a name='762'>
<a name='763'>
<a name='764'>
<font color=#447700>!!!!!!!!!!!!<a name='765'></font>
<a name='766'>
<A NAME='INT_GEN_TD_HEADER_CHAR'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='767'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_td_header_char</font>( hdrbuf, hdrbufsize, itypesize, &amp;,<A href='../../call_from/INT_GEN_TD_HEADER_CHAR.html' TARGET='index'>3</A><a name='768'>
                              DataHandle, DateStr, Element, Data, code )<a name='769'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='770'></font>
<font color=#447700>!&lt;PRE&gt;<a name='771'></font>
<font color=#447700>! Items and their starting locations within a "time-dependent string" <a name='772'></font>
<font color=#447700>! data header.  Assume that the data header is stored in integer vector <a name='773'></font>
<font color=#447700>! "hdrbuf":  <a name='774'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='775'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='776'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='777'></font>
<font color=#447700>!  hdrbuf(4) = typesize<a name='778'></font>
<font color=#447700>!  hdrbuf(5) = LEN(TRIM(Element))<a name='779'></font>
<font color=#447700>!  hdrbuf(6:5+n1) = Element            ! n1 = LEN(TRIM(Element)) + 1<a name='780'></font>
<font color=#447700>!  hdrbuf(6+n1) = LEN(TRIM(DateStr))<a name='781'></font>
<font color=#447700>!  hdrbuf(7+n1:6+n1+n2) = DateStr      ! n2 = LEN(TRIM(DateStr)) + 1<a name='782'></font>
<font color=#447700>!  hdrbuf(7+n1+n2) = LEN(TRIM(Data))<a name='783'></font>
<font color=#447700>!  hdrbuf(8+n1+n2:7+n1+n2+n3) = Data   ! n3 = LEN(TRIM(Data)) + 1<a name='784'></font>
<font color=#447700>!<a name='785'></font>
<font color=#447700>! Further details for some items:  <a name='786'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='787'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='788'></font>
<font color=#447700>!               header this is.  For an "time-dependent string" header it must be <a name='789'></font>
<font color=#447700>!               set to int_dom_td_char.  See file intio_tags.h for a complete <a name='790'></font>
<font color=#447700>!               list of these tags.  <a name='791'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='792'></font>
<font color=#447700>!  typesize:    1 (size in bytes of a single CHARACTER).  <a name='793'></font>
<font color=#447700>!  Element:     Name of the data.  <a name='794'></font>
<font color=#447700>!  Data:        Data to write to file.  <a name='795'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='796'></font>
<font color=#447700>!  Specification".  <a name='797'></font>
<font color=#447700>!<a name='798'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='799'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='800'></font>
  IMPLICIT NONE<a name='801'>
  INCLUDE 'intio_tags.h'<a name='802'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='803'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='804'>
  INTEGER, INTENT(IN)          ::  itypesize<a name='805'>
  CHARACTER*(*), INTENT(INOUT) ::  DateStr, Element, Data<a name='806'>
  INTEGER, INTENT(IN)          ::  DataHandle, code<a name='807'>
<font color=#447700>!Local<a name='808'></font>
  INTEGER i, n, DummyCount, DummyData<a name='809'>
<font color=#447700>!<a name='810'></font>
  DummyCount = 0<a name='811'>
<a name='812'>
  CALL int_gen_ti_header_c ( hdrbuf, hdrbufsize, itypesize, 1, &amp;<a name='813'>
                           DataHandle, DummyData, DummyCount, code )<a name='814'>
  i = hdrbufsize/itypesize + 1 ;<a name='815'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_34"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='816'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_35"> ( DateStr, hdrbuf( i ), n ) ; i = i + n<a name='817'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_36"> ( Data   , hdrbuf( i ), n ) ; i = i + n<a name='818'>
  hdrbufsize = (i-1) * itypesize + hdrbufsize <font color=#447700>! return the number in bytes<a name='819'></font>
  hdrbuf(1) = hdrbufsize<a name='820'>
  RETURN<a name='821'>
END SUBROUTINE int_gen_td_header_char<a name='822'>
<a name='823'>
<A NAME='INT_GET_TD_HEADER_CHAR'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='824'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_td_header_char</font>( hdrbuf, hdrbufsize, itypesize, &amp;,<A href='../../call_from/INT_GET_TD_HEADER_CHAR.html' TARGET='index'>3</A><a name='825'>
                              DataHandle, DateStr, Element, Data, code )<a name='826'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='827'></font>
<font color=#447700>!&lt;PRE&gt;<a name='828'></font>
<font color=#447700>! Same as int_gen_td_header_char except that Data is read from <a name='829'></font>
<font color=#447700>! the file.  <a name='830'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='831'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='832'></font>
  IMPLICIT NONE<a name='833'>
  INCLUDE 'intio_tags.h'<a name='834'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='835'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='836'>
  INTEGER, INTENT(IN)          ::  itypesize<a name='837'>
  CHARACTER*(*), INTENT(INOUT) ::  DateStr, Element, Data<a name='838'>
  INTEGER, INTENT(OUT)         ::  DataHandle, code<a name='839'>
<font color=#447700>!Local<a name='840'></font>
  INTEGER i, n, Count, typesize<a name='841'>
<font color=#447700>!<a name='842'></font>
<a name='843'>
  CALL int_get_ti_header_c ( hdrbuf, hdrbufsize, n, itypesize, typesize, &amp;<a name='844'>
                           DataHandle, Data, Count, code )<a name='845'>
  i = n/itypesize + 1 ;<a name='846'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_34"> ( Element, hdrbuf( i ), n ) ; i = i + n ;<a name='847'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_35"> ( DateStr, hdrbuf( i ), n ) ; i = i + n ;<a name='848'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_36"> ( Data   , hdrbuf( i ), n ) ; i = i + n ;<a name='849'>
  hdrbufsize = hdrbuf(1)<a name='850'>
  RETURN<a name='851'>
END SUBROUTINE int_get_td_header_char<a name='852'>
<a name='853'>
<A NAME='INT_GEN_TD_HEADER_INTEGER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='854'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_td_header_integer</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GEN_TD_HEADER_INTEGER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GEN_TD_HEADER_INTEGER.html' TARGET='index'>2</A><a name='855'>
                                      DataHandle, DateStr, Element, Data, Count, code )<a name='856'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='857'></font>
<font color=#447700>!&lt;PRE&gt;<a name='858'></font>
<font color=#447700>! Items and their starting locations within a "time-dependent integer" <a name='859'></font>
<font color=#447700>! data header.  Assume that the data header is stored in integer vector <a name='860'></font>
<font color=#447700>! "hdrbuf":  <a name='861'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='862'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='863'></font>
<font color=#447700>!  hdrbuf(3) = DataHandle<a name='864'></font>
<font color=#447700>!  hdrbuf(4) = typesize<a name='865'></font>
<font color=#447700>!  hdrbuf(5) = Count<a name='866'></font>
<font color=#447700>!  hdrbuf(6:6+n1) = Data              ! n1 = (Count * typesize / itypesize) + 1<a name='867'></font>
<font color=#447700>!  hdrbuf(7+n1) = LEN(TRIM(DateStr))<a name='868'></font>
<font color=#447700>!  hdrbuf(8+n1:7+n1+n2) = DateStr      ! n2 = LEN(TRIM(DateStr)) + 1<a name='869'></font>
<font color=#447700>!  hdrbuf(8+n1+n2) = LEN(TRIM(Element))<a name='870'></font>
<font color=#447700>!  hdrbuf(9+n1+n2:8+n1+n2+n3) = Element   ! n3 = LEN(TRIM(Element)) + 1<a name='871'></font>
<font color=#447700>!<a name='872'></font>
<font color=#447700>! Further details for some items:  <a name='873'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='874'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='875'></font>
<font color=#447700>!               header this is.  For an "time-dependent integer" header it must be <a name='876'></font>
<font color=#447700>!               set to int_dom_td_integer.  See file intio_tags.h for a complete <a name='877'></font>
<font color=#447700>!               list of these tags.  <a name='878'></font>
<font color=#447700>!  DataHandle:  Descriptor for an open data set.  <a name='879'></font>
<font color=#447700>!  typesize:    1 (size in bytes of a single CHARACTER).  <a name='880'></font>
<font color=#447700>!  Element:     Name of the data.  <a name='881'></font>
<font color=#447700>!  Count:       Number of elements in Data.  <a name='882'></font>
<font color=#447700>!  Data:        Data to write to file.  <a name='883'></font>
<font color=#447700>!  Other items are described in detail in the "WRF I/O and Model Coupling API <a name='884'></font>
<font color=#447700>!  Specification".  <a name='885'></font>
<font color=#447700>!<a name='886'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='887'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='888'></font>
  IMPLICIT NONE<a name='889'>
  INCLUDE 'intio_tags.h'<a name='890'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='891'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='892'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='893'>
  CHARACTER*(*), INTENT(INOUT) ::  DateStr, Element<a name='894'>
  INTEGER, INTENT(IN)          ::  Data(*)<a name='895'>
  INTEGER, INTENT(IN)          ::  DataHandle, Count, code<a name='896'>
<font color=#447700>!Local<a name='897'></font>
  INTEGER i, n<a name='898'>
<font color=#447700>!<a name='899'></font>
<a name='900'>
  CALL int_gen_ti_header_c ( hdrbuf, hdrbufsize, itypesize, typesize, &amp;<a name='901'>
                           DataHandle, Data, Count, code )<a name='902'>
  i = hdrbufsize/itypesize + 1 ;<a name='903'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_37"> ( DateStr, hdrbuf( i ), n ) ; i = i + n<a name='904'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_38"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='905'>
  hdrbufsize = (i-1) * itypesize + hdrbufsize <font color=#447700>! return the number in bytes<a name='906'></font>
  hdrbuf(1) = hdrbufsize<a name='907'>
  RETURN<a name='908'>
END SUBROUTINE int_gen_td_header_integer<a name='909'>
<a name='910'>
<A NAME='INT_GEN_TD_HEADER_REAL'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='911'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_td_header_real</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GEN_TD_HEADER_REAL.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GEN_TD_HEADER_REAL.html' TARGET='index'>2</A><a name='912'>
                                   DataHandle, DateStr, Element, Data, Count, code )<a name='913'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='914'></font>
<font color=#447700>!&lt;PRE&gt;<a name='915'></font>
<font color=#447700>! Same as int_gen_td_header_integer except that Data has type REAL.  <a name='916'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='917'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='918'></font>
  IMPLICIT NONE<a name='919'>
  INCLUDE 'intio_tags.h'<a name='920'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='921'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='922'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='923'>
  CHARACTER*(*), INTENT(INOUT) ::  DateStr, Element<a name='924'>
  REAL, INTENT(IN)             ::  Data(*)<a name='925'>
  INTEGER, INTENT(IN)          ::  DataHandle, Count, code<a name='926'>
<font color=#447700>!Local<a name='927'></font>
  INTEGER i, n<a name='928'>
<font color=#447700>!<a name='929'></font>
<a name='930'>
  CALL int_gen_ti_header_c ( hdrbuf, hdrbufsize, itypesize, typesize, &amp;<a name='931'>
                           DataHandle, Data, Count, code )<a name='932'>
  i = hdrbufsize/itypesize + 1 ;<a name='933'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_39"> ( DateStr, hdrbuf( i ), n ) ; i = i + n<a name='934'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING'>int_pack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_TD_HEADER_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_PACK_STRING_40"> ( Element, hdrbuf( i ), n ) ; i = i + n<a name='935'>
  hdrbufsize = (i-1) * itypesize + hdrbufsize <font color=#447700>! return the number in bytes<a name='936'></font>
  hdrbuf(1) = hdrbufsize<a name='937'>
  RETURN<a name='938'>
END SUBROUTINE int_gen_td_header_real<a name='939'>
<a name='940'>
<A NAME='INT_GET_TD_HEADER_INTEGER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='941'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_td_header_integer</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GET_TD_HEADER_INTEGER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GET_TD_HEADER_INTEGER.html' TARGET='index'>2</A><a name='942'>
                              DataHandle, DateStr, Element, Data, Count, code )<a name='943'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='944'></font>
<font color=#447700>!&lt;PRE&gt;<a name='945'></font>
<font color=#447700>! Same as int_gen_td_header_integer except that Data is read from <a name='946'></font>
<font color=#447700>! the file.  <a name='947'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='948'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='949'></font>
  IMPLICIT NONE<a name='950'>
  INCLUDE 'intio_tags.h'<a name='951'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='952'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='953'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='954'>
  CHARACTER*(*), INTENT(INOUT) ::  DateStr, Element<a name='955'>
  INTEGER, INTENT(OUT)         ::  Data(*)<a name='956'>
  INTEGER, INTENT(OUT)         ::  DataHandle, Count, code<a name='957'>
<font color=#447700>!Local<a name='958'></font>
  INTEGER i, n<a name='959'>
<font color=#447700>!<a name='960'></font>
<a name='961'>
  CALL int_get_ti_header_c ( hdrbuf, hdrbufsize, n, itypesize, typesize, &amp;<a name='962'>
                           DataHandle, Data, Count, code )<a name='963'>
  i = n/itypesize + 1 ;<a name='964'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_37"> ( DateStr, hdrbuf( i ), n ) ; i = i + n ;<a name='965'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_38"> ( Element, hdrbuf( i ), n ) ; i = i + n ;<a name='966'>
  hdrbufsize = hdrbuf(1)<a name='967'>
  RETURN<a name='968'>
END SUBROUTINE int_get_td_header_integer<a name='969'>
<a name='970'>
<A NAME='INT_GET_TD_HEADER_REAL'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='971'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_td_header_real</font>( hdrbuf, hdrbufsize, itypesize, typesize, &amp; <A href='../../call_to/INT_GET_TD_HEADER_REAL.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GET_TD_HEADER_REAL.html' TARGET='index'>2</A><a name='972'>
                              DataHandle, DateStr, Element, Data, Count, code )<a name='973'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='974'></font>
<font color=#447700>!&lt;PRE&gt;<a name='975'></font>
<font color=#447700>! Same as int_gen_td_header_real except that Data is read from <a name='976'></font>
<font color=#447700>! the file.  <a name='977'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='978'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='979'></font>
  IMPLICIT NONE<a name='980'>
  INCLUDE 'intio_tags.h'<a name='981'>
  INTEGER, INTENT(INOUT)       ::  hdrbuf(*)<a name='982'>
  INTEGER, INTENT(OUT)         ::  hdrbufsize<a name='983'>
  INTEGER, INTENT(IN)          ::  itypesize, typesize<a name='984'>
  CHARACTER*(*), INTENT(INOUT) ::  DateStr, Element<a name='985'>
  REAL , INTENT(OUT)           ::  Data(*)<a name='986'>
  INTEGER, INTENT(OUT)         ::  DataHandle, Count, code<a name='987'>
<font color=#447700>!Local<a name='988'></font>
  INTEGER i, n<a name='989'>
<font color=#447700>!<a name='990'></font>
<a name='991'>
  CALL int_get_ti_header_c ( hdrbuf, hdrbufsize, n, itypesize, typesize, &amp;<a name='992'>
                           DataHandle, Data, Count, code )<a name='993'>
  i = n/itypesize + 1 ;<a name='994'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_39"> ( DateStr, hdrbuf( i ), n ) ; i = i + n ;<a name='995'>
  CALL <A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING'>int_unpack_string</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_TD_HEADER_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INT_UNPACK_STRING_40"> ( Element, hdrbuf( i ), n ) ; i = i + n ;<a name='996'>
  hdrbufsize = hdrbuf(1)<a name='997'>
  RETURN<a name='998'>
END SUBROUTINE int_get_td_header_real<a name='999'>
<a name='1000'>
<font color=#447700>!!!!!!!!!!!!!!<a name='1001'></font>
<a name='1002'>
<A NAME='INT_GEN_NOOP_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GEN_NOOP_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1003'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_gen_noop_header</font> ( hdrbuf, hdrbufsize, itypesize ) <A href='../../call_to/INT_GEN_NOOP_HEADER.html' TARGET='index'>8</A><a name='1004'>
  IMPLICIT NONE<a name='1005'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='1006'></font>
<font color=#447700>!&lt;PRE&gt;<a name='1007'></font>
<font color=#447700>! Items and their starting locations within a "no-operation" <a name='1008'></font>
<font color=#447700>! data header.  Assume that the data header is stored in integer vector <a name='1009'></font>
<font color=#447700>! "hdrbuf":  <a name='1010'></font>
<font color=#447700>!  hdrbuf(1) = hdrbufsize<a name='1011'></font>
<font color=#447700>!  hdrbuf(2) = headerTag<a name='1012'></font>
<font color=#447700>!<a name='1013'></font>
<font color=#447700>! Further details for some items:  <a name='1014'></font>
<font color=#447700>!  hdrbufsize:  Size of this data header in bytes.  <a name='1015'></font>
<font color=#447700>!  headerTag:   "Header tag" that tells the I/O quilt servers what kind of <a name='1016'></font>
<font color=#447700>!               header this is.  For an "no-operation" header it must be <a name='1017'></font>
<font color=#447700>!               set to int_noop.  See file intio_tags.h for a complete <a name='1018'></font>
<font color=#447700>!               list of these tags.  <a name='1019'></font>
<font color=#447700>!<a name='1020'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='1021'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='1022'></font>
  INCLUDE 'intio_tags.h'<a name='1023'>
  INTEGER, INTENT(INOUT) ::  hdrbuf(*)<a name='1024'>
  INTEGER, INTENT(OUT)   ::  hdrbufsize<a name='1025'>
  INTEGER, INTENT(INOUT) ::  itypesize<a name='1026'>
<font color=#447700>!Local<a name='1027'></font>
  INTEGER i<a name='1028'>
<font color=#447700>!<a name='1029'></font>
  hdrbuf(1) = 0  <font color=#447700>!deferred<a name='1030'></font>
  hdrbuf(2) = int_noop<a name='1031'>
  i = 3<a name='1032'>
  hdrbufsize = (i-1) * itypesize  <font color=#447700>! return the number in bytes<a name='1033'></font>
  hdrbuf(1) = hdrbufsize<a name='1034'>
  RETURN<a name='1035'>
END SUBROUTINE int_gen_noop_header<a name='1036'>
<a name='1037'>
<A NAME='INT_GET_NOOP_HEADER'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_NOOP_HEADER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1038'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_get_noop_header</font>( hdrbuf, hdrbufsize, itypesize ) <A href='../../call_to/INT_GET_NOOP_HEADER.html' TARGET='index'>1</A>,<A href='../../call_from/INT_GET_NOOP_HEADER.html' TARGET='index'>2</A><a name='1039'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='1040'></font>
<font color=#447700>!&lt;PRE&gt;<a name='1041'></font>
<font color=#447700>! See documentation block in int_gen_noop_header() for <a name='1042'></font>
<font color=#447700>! a description of a "no-operation" header.  <a name='1043'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='1044'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='1045'></font>
  IMPLICIT NONE<a name='1046'>
  INCLUDE 'intio_tags.h'<a name='1047'>
  INTEGER, INTENT(INOUT) ::  hdrbuf(*)<a name='1048'>
  INTEGER, INTENT(OUT)   ::  hdrbufsize<a name='1049'>
  INTEGER, INTENT(INOUT) ::  itypesize<a name='1050'>
<font color=#447700>!Local<a name='1051'></font>
  INTEGER i<a name='1052'>
<font color=#447700>!<a name='1053'></font>
  hdrbufsize = hdrbuf(1)<a name='1054'>
  IF ( hdrbuf(2) .NE. int_noop ) THEN<a name='1055'>
    CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/frame/module_internal_header_util.F.html#INT_GET_NOOP_HEADER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_91"> ( "int_get_noop_header: hdrbuf ne int_noop")<a name='1056'>
  ENDIF<a name='1057'>
  i = 3<a name='1058'>
  RETURN<a name='1059'>
END SUBROUTINE int_get_noop_header<a name='1060'>
<a name='1061'>
<a name='1062'>
<font color=#447700>! first int is length of string to follow then string encodes as ints<a name='1063'></font>
<A NAME='INT_PACK_STRING'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_PACK_STRING' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1064'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_pack_string</font> ( str, buf, n ) <A href='../../call_to/INT_PACK_STRING.html' TARGET='index'>40</A><a name='1065'>
  IMPLICIT NONE<a name='1066'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='1067'></font>
<font color=#447700>!&lt;PRE&gt;<a name='1068'></font>
<font color=#447700>! This routine is used to store a string as a sequence of integers.  <a name='1069'></font>
<font color=#447700>! The first integer is the string length.  <a name='1070'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='1071'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='1072'></font>
  CHARACTER*(*), INTENT(IN)          :: str<a name='1073'>
  INTEGER, INTENT(OUT)               :: n    <font color=#447700>! on return, N is the number of ints stored in buf<a name='1074'></font>
  INTEGER, INTENT(OUT), DIMENSION(*) :: buf<a name='1075'>
<font color=#447700>!Local<a name='1076'></font>
  INTEGER i<a name='1077'>
<font color=#447700>!<a name='1078'></font>
  n = 1<a name='1079'>
  buf(n) = LEN(TRIM(str))<a name='1080'>
  n = n+1<a name='1081'>
  DO i = 1, LEN(TRIM(str))<a name='1082'>
    buf(n) = ichar(str(i:i))<a name='1083'>
    n = n+1<a name='1084'>
  ENDDO<a name='1085'>
  n = n - 1<a name='1086'>
END SUBROUTINE int_pack_string<a name='1087'>
<a name='1088'>
<A NAME='INT_UNPACK_STRING'><A href='../../html_code/frame/module_internal_header_util.F.html#INT_UNPACK_STRING' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1089'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>int_unpack_string</font> ( str, buf, n ) <A href='../../call_to/INT_UNPACK_STRING.html' TARGET='index'>40</A><a name='1090'>
  IMPLICIT NONE<a name='1091'>
<font color=#447700>!&lt;DESCRIPTION&gt;<a name='1092'></font>
<font color=#447700>!&lt;PRE&gt;<a name='1093'></font>
<font color=#447700>! This routine is used to extract a string from a sequence of integers.  <a name='1094'></font>
<font color=#447700>! The first integer is the string length.  <a name='1095'></font>
<font color=#447700>!&lt;/PRE&gt;<a name='1096'></font>
<font color=#447700>!&lt;/DESCRIPTION&gt;<a name='1097'></font>
  CHARACTER*(*), INTENT(OUT)        :: str<a name='1098'>
  INTEGER, INTENT(OUT)              :: n       <font color=#447700>! on return, N is the number of ints copied from buf<a name='1099'></font>
  INTEGER, INTENT(IN), DIMENSION(*) :: buf<a name='1100'>
<font color=#447700>!Local<a name='1101'></font>
  INTEGER i<a name='1102'>
  INTEGER strlen<a name='1103'>
<a name='1104'>
  strlen = buf(1)<a name='1105'>
  str = ""<a name='1106'>
  DO i = 1, strlen<a name='1107'>
    str(i:i) = char(buf(i+1))<a name='1108'>
  ENDDO<a name='1109'>
  n = strlen + 1<a name='1110'>
END SUBROUTINE int_unpack_string<a name='1111'>
<a name='1112'>
END MODULE module_internal_header_util<a name='1113'>
<a name='1114'>
</pre></body></html>