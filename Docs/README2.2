README
WRF-Var (4D) version 2.2

Xin Zhang
Hans Huang

07/09/07

From Version 2.2, WRF 4DVAR system begin to use wrfvar branch , wrf trunk and wrfplus. 

 To setup the system  :

1, Check out wrfvar (HEAD)
   svn co https://svn-wrf-var.cgd.ucar.edu/branches/WRF-Var4D wrfvar

2, Check out wrfplus  (HEAD)
   svn co https://svn-wrf-var.cgd.ucar.edu/branches/BR_2005workshop wrfplus

3, Check out wrf trunk (version 2348)
   svn -r 2348 co https://svn-wrf-model.cgd.ucar.edu/trunk wrfnl

4, cp wrfplus/Docs/parallel/wrf/Registry/Registry.EM.r2348 wrfnl/Registry/Registry.EM 
   cp wrfplus/Docs/parallel/wrf/external/RSL/module_dm.F wrfnl/external/RSL/module_dm.F 
   cp wrfplus/Docs/parallel/wrf/external/RSL_LITE/module_dm.F wrfnl/external/RSL_LITE/module_dm.F 
   cp wrfplus/Docs/parallel/wrf/main/wrf.F wrfnl/main/wrf.F 

5, Compile wrfvar branch
   cd  wrfvar
   source setup.csh xlf
   ./configure wrfvar (select 1 for serial run and 3 for parallel run)
   ./compile wrfvar

6, Compile wrf trunk (use xlf)
   cd wrfnl
   ./configure (select 1/3)
   ./compile wrf
   cp ../wrfvar/inc/namelist_script_wrf_wps_2004.inc inc/namelist_script.inc

7, Compile wrfplus (use xlf)
   cd wrfplus
   ./configure wrfplus (select 1/3)
   ./compile wrf 
   (note: make sure the namelist_script.inc exists in inc/ diretory, if deleted by "clean -a", use "svn revert inc/namelist_script.inc to restore)
   
8, Run the testdata 
   the test script locate in wrfplus/scripts/da_run_suite_wrapper_test_npe.ksh
   if run multi-incremental 4dvar , please use da_run_multi_increment_wrapper.ksh

Note: The WRF 4DVAR home directory is REL_DIR  
      the input dataset directory is DAT_DIR
      the output directory is EXP_DIR, the print out is in html format now, you can use lynx to see the output (looking for the index.html).
      for 4dvar, set NL_VAR4D = true, otherwise, set NL_VAR4D = false

