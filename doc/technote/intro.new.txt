\chapter{Introduction}
\label{intro}

\section{Overview of Variational Data Assimilation}
\label{overview}

The basic goal of any variational data assimilation system is to produce
an optimal estimate of the true atmospheric state at analysis time
through iterative solution of a prescribed cost-function \citep{ide97}:

\begin{equation}
J({\bf x}) = J_b({\bf x}) + J_o({\bf x}) = \frac{1}{2 
} ({\bf x}-{\bf x}^{b})^{T}{\bf B}^{-1}({\bf x}-{\bf x}^{b}) + 
\frac{1}{2}
({\bf y}-{\bf y}^{o})^{T}({\bf E+F})^{-1}({\bf y}-{\bf y}^{o}).
\label{cost_function}
\end{equation}

The variational problem can be summarized as the iterative minimization
of (\ref{cost_function}) to find the analysis state ${\bf x}$ that
minimizes $J({\bf x})$. This solution represents the {\it a posteriori}
maximum likelihood (minimum variance) estimate of the true state of the
atmosphere given the two sources of {\it a priori} data: the first guess
(or background) ${\bf x^{b}}$ and observations ${\bf y^{o}}$
\citep{lorenc86}. The fit to individual data points is weighted by
estimates of their errors: ${\bf B}$, ${\bf E}$, and ${\bf F}$ are the
background, observation (instrumental), and representivity error
covariance matrices, respectively. Representivity error is an estimate of
inaccuracies introduced in the observation operator $H$ used to
transform the gridded analysis ${\bf x}$ to observation space ${\bf
y}=H({\bf x})$ for comparison against observations. This error will be
resolution dependent and may also include a contribution from
approximations (e.g., linearizations) in $H$.

\section{Overview of WRF-Var}
\label{overview-wrfvar}

As described in \citet{barker04}, the particular variational data
assimilation algorithm adopted in WRF-Var is a model-space, incremental
formulation of the variational problem.  In this approach, observations,
previous forecasts, their errors, and physical laws are combined to
produce analysis increments ${\bf x^{a'}}$, which are added to the first
guess ${\bf x^{b}}$ to provide an updated analysis.

Figure \ref{var-sketch} illustrates the relationship between WRF-Var,
the various datasets, and the other components of a typical NWP system
(here ARW). The WRF-Var assimilation proceeds as described in
\citet{barker04}. A number of recent upgrades to the WRF-Var algorithm
will be described in Section \ref{var-upgrade}.

%
%  Figure 9.1 var-sketch
%
\begin{figure}
  \centering
  \includegraphics[width=6.5in]{figures/var-sketch.pdf}
  \caption{\label{var-sketch}Sketch showing the relationship between datasets (circles), 
           and algorithms (rectangles) of the ARW system.}
\end{figure}

The three inputs to WRF-Var are: 

\vspace{0.5cm}

a) First guess ${\bf x^{b}}$--- In cold-start mode, this is typically a
forecast/analysis from another model interpolated to the ARW grid (and variables) via the 
WRF SI and {\it real} programs. In cycling mode, the first guess 
is a short-range (typically 1--6 hour) ARW forecast. 

\vspace{0.5cm}

b) Observations ${\bf y^{o}}$--- In the current version of WRF-Var, observations may be 
supplied either in a text (MM5 3D-Var) format or BUFR format (but not a 
combination of the two). An observation preprocessor (3DVAR$\_$OBSPROC) 
is supplied with the code release to perform basic quality control, assign 
observation errors, and reformat observations from the MM5 {\it little$\_$r} text 
format into 3D-Var's own text format. Details can be found in \citet{barker03, barker04}.

\vspace{0.5cm}

c) Background error covariances ${\bf B}$--- used to define the spatial
and multivariate response of the analysis to an observation. In
variational systems, these covariances are typically calculated
off-line, and significant tuning is required to optimize performance
for a particular application (e.g., \citet{ingleby01, wu02}). The
amount of work required to do this satisfactorily is significant, and
should not be underestimated. In order to assist the user, WRF
developers supply the following: i) a default set of statistics used
for the initial set up of a domain; ii) a utility {\it gen$\_$be}
(described in Section
\ref{var-be}) to process ensembles of forecasts into the appropriate control variable 
space; and iii) diagnostic routines to assess the accuracy of
observation and background error statistics. These routines include
both innovation vector-based approaches \citep{hollingsworth86} and
variational tuning approaches \citep{desroziers01}.

Following assimilation of all data, an analysis ${\bf x^{a}}$ is produced that must be 
merged with the existing lateral boundary conditions ${\bf x^{lbc}}$ (described in 
\citet{barker03}). Note: In cycling mode, only the {\it wrfbdy} lateral boundary condition 
files (${\bf x^{lbc}}$) output of SI/real are used, and not the {\it wrfinput} initial condition 
files (${\bf x^{b}}$). In cold-start mode, both are required.

\section{This Technical Report}
\label{techrep}

