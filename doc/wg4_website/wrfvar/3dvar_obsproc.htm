<html xmlns:v="urn:schemas-microsoft-com:vml"xmlns:o="urn:schemas-microsoft-com:office:office"xmlns:w="urn:schemas-microsoft-com:office:word"xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=Title content="3DVAR Tutorial"><meta name=Keywords content=""><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=ProgId content=Word.Document><meta name=Generator content="Microsoft Word 10"><meta name=Originator content="Microsoft Word 10"><link rel=File-List href="3dvar_obsproc_files/filelist.xml"><link rel=Edit-Time-Data href="3dvar_obsproc_files/editdata.mso"><!--[if !mso]><style>v\:* {behavior:url(#default#VML);}o\:* {behavior:url(#default#VML);}w\:* {behavior:url(#default#VML);}.shape {behavior:url(#default#VML);}</style><![endif]--><title>3DVAR Tutorial</title><!--[if gte mso 9]><xml> <o:DocumentProperties>  <o:Author>dmbarker</o:Author>  <o:Template>Normal</o:Template>  <o:LastAuthor>Jose Castilleja</o:LastAuthor>  <o:Revision>2</o:Revision>  <o:Created>2005-08-05T23:37:00Z</o:Created>  <o:LastSaved>2005-08-05T23:37:00Z</o:LastSaved>  <o:Pages>5</o:Pages>  <o:Words>617</o:Words>  <o:Characters>3518</o:Characters>  <o:Company>NCAR/UCAR</o:Company>  <o:Lines>29</o:Lines>  <o:Paragraphs>7</o:Paragraphs>  <o:CharactersWithSpaces>4320</o:CharactersWithSpaces>  <o:Version>10.260</o:Version> </o:DocumentProperties> <o:OfficeDocumentSettings>  <o:AllowPNG/> </o:OfficeDocumentSettings></xml><![endif]--><style><!-- /* Font Definitions */@font-face	{font-family:"Times New Roman";	panose-1:0 2 2 6 3 5 4 5 2 3;	mso-font-charset:0;	mso-generic-font-family:auto;	mso-font-pitch:variable;	mso-font-signature:50331648 0 0 0 1 0;}@font-face	{font-family:Arial;	panose-1:0 2 11 6 4 2 2 2 2 2;	mso-font-charset:0;	mso-generic-font-family:auto;	mso-font-pitch:variable;	mso-font-signature:50331648 0 0 0 1 0;}@font-face	{font-family:"Courier New";	panose-1:0 0 0 0 0 0 0 0 0 0;	mso-font-alt:Courier;	mso-font-charset:77;	mso-generic-font-family:modern;	mso-font-format:other;	mso-font-pitch:fixed;	mso-font-signature:50331648 0 0 0 1 0;}@font-face	{font-family:"ＭＳ 明朝";	panose-1:0 0 0 0 0 0 0 0 0 0;	mso-font-charset:128;	mso-generic-font-family:roman;	mso-font-format:other;	mso-font-pitch:fixed;	mso-font-signature:16777216 1800 268435456 0 131072 0;}@font-face	{font-family:바탕;	mso-font-charset:79;	mso-generic-font-family:auto;	mso-font-pitch:variable;	mso-font-signature:16777216 0 103022593 0 524288 0;} /* Style Definitions */p.MsoNormal, li.MsoNormal, div.MsoNormal	{mso-style-parent:"";	margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:12.0pt;	font-family:"Times New Roman";	color:black;}h2	{margin-right:0in;	mso-margin-top-alt:auto;	mso-margin-bottom-alt:auto;	margin-left:0in;	mso-pagination:widow-orphan;	mso-outline-level:2;	font-size:18.0pt;	font-family:"Times New Roman";	color:black;	font-weight:bold;}a:link, span.MsoHyperlink	{color:#0000EE;	text-decoration:underline;	text-underline:single;}a:visited, span.MsoHyperlinkFollowed	{color:#551A8B;	text-decoration:underline;	text-underline:single;}p.MsoPlainText, li.MsoPlainText, div.MsoPlainText	{margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:10.0pt;	font-family:"Courier New";	color:windowtext;}p	{margin-right:0in;	mso-margin-top-alt:auto;	mso-margin-bottom-alt:auto;	margin-left:0in;	mso-pagination:widow-orphan;	font-size:12.0pt;	font-family:"Times New Roman";	color:black;}tt {}@page Section1	{size:8.5in 11.0in;	margin:1.0in 1.25in 1.0in 1.25in;	mso-header-margin:.5in;	mso-footer-margin:.5in;	mso-paper-source:0;}div.Section1	{page:Section1;} /* List Definitions */@list l0	{mso-list-id:1639873314;	mso-list-type:hybrid;	mso-list-template-ids:-6506626 67698705 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}@list l0:level1	{mso-level-text:"%1\)";	mso-level-tab-stop:.5in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level2	{mso-level-tab-stop:1.0in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level3	{mso-level-tab-stop:1.5in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level4	{mso-level-tab-stop:2.0in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level5	{mso-level-tab-stop:2.5in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level6	{mso-level-tab-stop:3.0in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level7	{mso-level-tab-stop:3.5in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level8	{mso-level-tab-stop:4.0in;	mso-level-number-position:left;	text-indent:-.25in;}@list l0:level9	{mso-level-tab-stop:4.5in;	mso-level-number-position:left;	text-indent:-.25in;}ol	{margin-bottom:0in;}ul	{margin-bottom:0in;}--></style><!--[if gte mso 9]><xml> <o:shapedefaults v:ext="edit" spidmax="2050"/></xml><![endif]--><!--[if gte mso 9]><xml> <o:shapelayout v:ext="edit">  <o:idmap v:ext="edit" data="1"/> </o:shapelayout></xml><![endif]--></head><body bgcolor=white lang=EN-GB link="#0000ee" vlink="#551a8b" style='tab-interval:.5in'><div class=Section1><h2 style='text-align:justify'><span lang=EN-US style='font-family:Arial;color:blue'>b. The 3DVAR Observation Preprocessor (3DVAR_OBSPROC)</span><spanlang=EN-US style='color:blue'><o:p></o:p></span></h2><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Bythis stage you have successfully downloaded the test data for the tutorial andare ready to run 3DVAR observation preprocessor (3DVAR_OBSPROC). If not, returnto </span><span lang=EN-US style='font-family:Arial;color:blue'><ahref="wrfvar-download.htm">a. Downloading Test Data</a>.</span><spanlang=EN-US style='font-family:Arial'><o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>1.Accessing and compiling the 3DVAR_OBSPROC code</u></b></span><span lang=EN-US><u><o:p></o:p></u></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>First,go to your working directory and download the 3DVAR_OBSPROC code from<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><ahref="http://www.mmm.ucar.edu/wrf/src/3DVAR_OBSPROC_v2.1.tar.gz">http://www.mmm.ucar.edu/wrf/src/3DVAR_OBSPROC_v2.1.tar.gz</a>.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Onceyou have it on your machine, type the following to unzip and untar it:</span><spanlang=EN-US> </span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>gunzip3DVAR_OBSPROC_v2.1.tar.gz<o:p></o:p></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>tar-xvf 3DVAR_OBSPROC_v2.1.tar</b></span><span lang=EN-US> </span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Afterthis, you should see a directory 3DVAR_OBSPROC_v2.1/ created in your workingdirectory. If so remove the .tar file<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>rm3DVAR_OBSPROC_v2.1.tar</b></span><span lang=EN-US style='font-family:Arial'><o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>and cdto this directory:</span><span lang=EN-US> </span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>cd3DVAR_OBSPROC_v2.1</b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Readthe README file. To compile 3DVAR_OBSPROC, type<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>make<o:p></o:p></b></span></p><p class=MsoNormal><span lang=EN-US style='font-family:Arial'>Once this iscomplete (a minute or less on most machines), you can check for the presence ofthe 3DVAR_OBSPROC executable by issuing the command (from the 3DVAR_OBSPROCdirectory)<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>ls-l src/3dvar_obs.exe<o:p></o:p></b></span></p><p class=MsoPlainText><span lang=EN-US>-rwxr-xr-x<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>1 mmm01<span style="mso-spacerun: yes">&nbsp;</span>system<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>591184May 29<span style="mso-spacerun: yes">&nbsp; </span>2003 src/3dvar_obs.exe*<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>2.Running 3DVAR_OBSPROC</u></b></span><span lang=EN-US><u> <o:p></o:p></u></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>OK, sonow you have compiled 3DVAR_OBSPROC. Before running the 3dvar_obs.exe, createthe namelist file <b><i>namelist.3dvar_obs</i></b></span><span lang=EN-USstyle='font-family:Arial'> and edit (see README.namelist for details);<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>cpnamelist.3dvar_obs.wrfvar-tut namelist.3dvar_obs<o:p></o:p></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>thenedit <b><i>namelist.3dvar_obs</i></b></span><span lang=EN-US style='font-family:Arial'>.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Inthis tutorial, all you need to change is the full path to the observation file(<b>ob.little_r</b></span><span lang=EN-US style='font-family:Arial'>) file,the grid dimensions (nestix=nestjx=45), and the resolution (dis=200[km]).<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>To runthe 3DVAR_OBSPROC, type<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><i>3dvar_obs.exe&gt;&amp;! 3dvar_obs.out<o:p></o:p></i></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>3.Looking at 3DVAR_OBSPROC output.<o:p></o:p></u></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Oncethe <b><i>3dvar_obs.exe</i></b></span><span lang=EN-US style='font-family:Arial'>has completed normally, you will have an observation data file: <b><i>obs_gts.3dvar</i></b></span><spanlang=EN-US style='font-family:Arial'>, which will be used as the input toWRF-Var. Before running WRF-Var, there is a utility to look at the datadistribution for each type of observations.<o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify;text-indent:-.25in'><spanlang=EN-US style='font-family:Arial'>1) <b>cd MAP_plot</b></span><spanlang=EN-US style='font-family:Arial'><o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify;text-indent:-.25in'><spanlang=EN-US style='font-family:Arial'>2) Modify the shell script <b><i>Map.csh</i></b></span><spanlang=EN-US style='font-family:Arial'> to set the time window and full path ofinput observation file (obs_gts.3dvar), The dates are 2003010111,2003010112,2003010113;<o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify;text-indent:-.25in'><spanlang=EN-US style='font-family:Arial'>3) Type<o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify'><span lang=EN-USstyle='font-family:Arial'><b>Map.csh<o:p></o:p></b></span></p><p style='margin-left:.25in;text-align:justify'><span lang=EN-USstyle='font-family:Arial'>the <i>configure.user</i></span><span lang=EN-USstyle='font-family:Arial'> will be automatically picked up for your computersystem when you type <b><i>Map.csh</i></b></span><span lang=EN-USstyle='font-family:Arial'>;<o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify;text-indent:-.25in'><spanlang=EN-US style='font-family:Arial'>4) When the job has completed, you willhave a gmeta file </span><span lang=EN-US style='font-family:Arial;color:blue'><b><i>gmeta.</i></b></span><spanlang=EN-US style='font-family:Arial;color:blue'><i>{analysis_time}</i></span><spanlang=EN-US style='font-family:Arial'><o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify'><span lang=EN-USstyle='font-family:Arial'>which contains plots of data distribution for eachtype of observations contained in the OBS data file: <b><i>obs_gts.3dvar</i></b></span><spanlang=EN-US style='font-family:Arial'>.<span style="mso-spacerun: yes">&nbsp;</span>To view this, type<o:p></o:p></span></p><p style='margin-left:.25in;text-align:justify'><span lang=EN-USstyle='font-family:Arial'><b>idt gmeta.2003010112<o:p></o:p></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Thegmeta file illustrates the geographic distribution of sonde observations forthis case. You should see something like the following:<o:p></o:p></span></p><p align=center style='text-align:center'><span lang=EN-US style='font-family:Arial'><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>  <v:f eqn="if lineDrawn pixelLineWidth 0"/>  <v:f eqn="sum @0 1 0"/>  <v:f eqn="sum 0 0 @1"/>  <v:f eqn="prod @2 1 2"/>  <v:f eqn="prod @3 21600 pixelWidth"/>  <v:f eqn="prod @3 21600 pixelHeight"/>  <v:f eqn="sum @0 0 1"/>  <v:f eqn="prod @6 1 2"/>  <v:f eqn="prod @7 21600 pixelWidth"/>  <v:f eqn="sum @8 21600 0"/>  <v:f eqn="prod @7 21600 pixelHeight"/>  <v:f eqn="sum @10 21600 0"/> </v:formulas> <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/> <o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="_x0000_i1028" type="#_x0000_t75" style='width:6in; height:6in'> <v:imagedata src="3dvar_obsproc_files/image001.png" o:title="obs.gif"/></v:shape><![endif]--><![if !vml]><img border=0 width=432 height=432src="3dvar_obsproc_files/image002.png" v:shapes="_x0000_i1028"><![endif]><o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>4.Saving necessary file for 3DVAR and clean 3DVAR_OBSPROC<o:p></o:p></u></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Inthis tutorial, we are storing data in a directory defined by the environmentvariable $<i>DAT_DIR. </i></span><span lang=EN-US style='font-family:Arial'><spanstyle="mso-spacerun: yes">&nbsp;</span>Having successfully created your ownobservation file <b>(obs_gts.3dvar), </b></span><span lang=EN-USstyle='font-family:Arial'>copy it to $<i>DAT_DIR</i></span><span lang=EN-USstyle='font-family:Arial'><b> </b></span><span lang=EN-US style='font-family:Arial'>using the command (from 3DVAR_OBSPROC directory)<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>mvobs_gts.3dvar $<i>DAT_DIR</i></b></span><span lang=EN-US style='font-family:Arial'><b>/obs_gts.3dvar.2003010112<o:p></o:p></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Finally,to clean up the 3DVAR_OBSPROC directory, type<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>makeclean <o:p></o:p></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>5.What next?</u></b></span><span lang=EN-US><u><o:p></o:p></u></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>OK,you have now created the observation file and looked at some plots ofobservations, now you are ready to move on to WRF-Var:<o:p></o:p></span></p><p><span lang=EN-US style='font-family:Arial'><u><a href="wrfvar-setup.htm"><spanstyle='color:blue'>c) Setting up WRF-Var</span></a></u><o:p></o:p></span></p><div class=MsoNormal align=center style='text-align:center'><span lang=EN-US><hr size=2 width="100%" align=center></span></div><p><span lang=EN-US style='font-family:Arial'><b>Miscellanies:</b></span><spanlang=EN-US> </span></p><p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span lang=EN-US>1)<spanstyle='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><![endif]><spanlang=EN-US>When you run 3dvar_obs.exe, and you did not obtain the file <i>obs_gts.3dvar,</i></span><span lang=EN-US>please check 3dvar_obs.out file to see where theprogram aborted. Usually there is information in this file to tell you what iswrong;</span></p><p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span lang=EN-US>2)<spanstyle='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><![endif]><spanlang=EN-US>When you run 3dvar_obs.exe and got an error as <i>'Error in NAMELISTrecord 2'</i></span><span lang=EN-US> in 3dvar_obs.out file, please check ifyour <i>namelist.3dvar_obs</i></span><span lang=EN-US> file matches with the <i>Makefile</i></span><spanlang=EN-US> settings. Either Your <i>namelist.3dvar_obs</i></span><spanlang=EN-US> file or <i>Makefile</i></span><span lang=EN-US> need to bemodified, then re-compile and re-run the job; </span></p><p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span lang=EN-US>3)<spanstyle='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><![endif]><spanlang=EN-US>From the *.diag files, you may find which observation report causedthe job failed;</span></p><p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span lang=EN-US>4)<spanstyle='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><![endif]><spanlang=EN-US>In most cases, the job failed was caused by incorrect input filesnames, or the specified analysis time, time window, etc. in namelist.3dvar_obs;</span></p><p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span lang=EN-US>5)<spanstyle='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span><![endif]><spanlang=EN-US>If users still cannot figure out the troubles, please inform us andpass us your input files including the namelist file, and printed file3dvar_obs.out.</span></p><div class=MsoNormal align=center style='text-align:center'><span lang=EN-US><hr size=2 width="100%" align=center></span></div><p><span lang=EN-US style='font-family:Arial'><b>Trouble Shooting:</b></span><spanlang=EN-US> </span></p><p><span lang=EN-US style='font-family:Arial'><b>1. </b></span><spanlang=EN-US style='font-family:Arial'><span style="mso-spacerun:yes">&nbsp;</span>If you have questions, ask wrfhelp@ucar.edu.</span></p><div class=MsoNormal align=center style='text-align:center'><span lang=EN-US><hr size=2 width="100%" align=center></span></div><p class=MsoNormal align=center style='text-align:center'><span lang=EN-USstyle='color:windowtext'>&nbsp;</span></p><p class=MsoNormal align=center style='text-align:center'><span lang=EN-USstyle='font-family:Arial'><a href="wrfvar-tutorial.htm">Return to WRF-VarTutorial Page</a></span><span lang=EN-US style='color:windowtext'><o:p></o:p></span></p></div></body></html>