<html xmlns:v="urn:schemas-microsoft-com:vml"xmlns:o="urn:schemas-microsoft-com:office:office"xmlns:w="urn:schemas-microsoft-com:office:word"xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=Title content="3DVAR Tutorial"><meta name=Keywords content=""><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=ProgId content=Word.Document><meta name=Generator content="Microsoft Word 10"><meta name=Originator content="Microsoft Word 10"><link rel=File-List href="wrfvar-diagnostics_files/filelist.xml"><link rel=Edit-Time-Data href="wrfvar-diagnostics_files/editdata.mso"><!--[if !mso]><style>v\:* {behavior:url(#default#VML);}o\:* {behavior:url(#default#VML);}w\:* {behavior:url(#default#VML);}.shape {behavior:url(#default#VML);}</style><![endif]--><title>3DVAR Tutorial</title><!--[if gte mso 9]><xml> <o:DocumentProperties>  <o:Author>dmbarker</o:Author>  <o:Template>Normal</o:Template>  <o:LastAuthor>Jose Castilleja</o:LastAuthor>  <o:Revision>2</o:Revision>  <o:Created>2005-08-05T23:37:00Z</o:Created>  <o:LastSaved>2005-08-05T23:37:00Z</o:LastSaved>  <o:Pages>4</o:Pages>  <o:Words>746</o:Words>  <o:Characters>4254</o:Characters>  <o:Company>NCAR/UCAR</o:Company>  <o:Lines>35</o:Lines>  <o:Paragraphs>8</o:Paragraphs>  <o:CharactersWithSpaces>5224</o:CharactersWithSpaces>  <o:Version>10.260</o:Version> </o:DocumentProperties></xml><![endif]--><style><!-- /* Font Definitions */@font-face	{font-family:"Times New Roman";	panose-1:0 2 2 6 3 5 4 5 2 3;	mso-font-charset:0;	mso-generic-font-family:auto;	mso-font-pitch:variable;	mso-font-signature:50331648 0 0 0 1 0;}@font-face	{font-family:Arial;	panose-1:0 2 11 6 4 2 2 2 2 2;	mso-font-charset:0;	mso-generic-font-family:auto;	mso-font-pitch:variable;	mso-font-signature:50331648 0 0 0 1 0;}@font-face	{font-family:"Courier New";	panose-1:0 0 0 0 0 0 0 0 0 0;	mso-font-alt:Courier;	mso-font-charset:77;	mso-generic-font-family:modern;	mso-font-format:other;	mso-font-pitch:fixed;	mso-font-signature:50331648 0 0 0 1 0;} /* Style Definitions */p.MsoNormal, li.MsoNormal, div.MsoNormal	{mso-style-parent:"";	margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:12.0pt;	font-family:"Times New Roman";	color:black;}h2	{margin-right:0in;	mso-margin-top-alt:auto;	mso-margin-bottom-alt:auto;	margin-left:0in;	mso-pagination:widow-orphan;	mso-outline-level:2;	font-size:18.0pt;	font-family:"Times New Roman";	color:black;	font-weight:bold;}a:link, span.MsoHyperlink	{color:#0000EE;	text-decoration:underline;	text-underline:single;}a:visited, span.MsoHyperlinkFollowed	{color:#551A8B;	text-decoration:underline;	text-underline:single;}p.MsoPlainText, li.MsoPlainText, div.MsoPlainText	{margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:10.0pt;	font-family:"Courier New";	color:windowtext;}p	{margin-right:0in;	mso-margin-top-alt:auto;	mso-margin-bottom-alt:auto;	margin-left:0in;	mso-pagination:widow-orphan;	font-size:12.0pt;	font-family:"Times New Roman";	color:black;}tt {}@page Section1	{size:8.5in 11.0in;	margin:1.0in 1.25in 1.0in 1.25in;	mso-header-margin:.5in;	mso-footer-margin:.5in;	mso-paper-source:0;}div.Section1	{page:Section1;}--></style><!--[if gte mso 9]><xml> <o:shapedefaults v:ext="edit" spidmax="2050"/></xml><![endif]--><!--[if gte mso 9]><xml> <o:shapelayout v:ext="edit">  <o:idmap v:ext="edit" data="1"/> </o:shapelayout></xml><![endif]--></head><body bgcolor=white lang=EN-GB link="#0000ee" vlink="#551a8b" style='tab-interval:.5in'><div class=Section1><h2 style='text-align:justify'><span lang=EN-US style='font-family:Arial;color:blue'>e. WRF-VAR Diagnostics</span><span lang=EN-US><o:p></o:p></span></h2><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>WRF-Varproduces a number of diagnostics file that contain useful information on howthe assimilation has performed. This section will introduce you to some ofthese files, and what to look for.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Bythis stage of the online tutorial you have successfully compiled and runWRF-Var. If not, you should return to the <a href="wrfvar-tutorial.htm">WRF-VarTutorial Page</a> to try these out.</span><span lang=EN-US style='font-family:Arial;color:blue'><o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>1.Which are the important diagnostic to look for?</u></b></span><span lang=EN-US><u><o:p></o:p></u></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Havingrun WRF-Var, it is important to check a number of output files to see if theassimilation appears sensible. Change directory to where you ran the previouscase-study:<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>cd${RUN_DIR}/wrf-var<o:p></o:p></b></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b>ls-l </b></span><span lang=EN-US style='font-family:Arial'><o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Youwill see something like the following:<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>total 37990<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rwxr-xr-x<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun: yes">&nbsp; </span>1081631627 Jul 19:43 wrfvar.exe<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>lrwxr-xr-x<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>63 27 Jul 19:43wrf_3dvar_input<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>5508 27 Jul 19:43 namelist.input.txt<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>lrwxr-xr-x<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>64 27 Jul 19:43 fort.92<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>lrwxr-xr-x<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>47 27 Jul 19:43 fort.33<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>2686 27 Jul 19:43 namelist.3dvar.txt<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>8761 27 Jul 19:43 LANDUSE.TBL<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>194 27 Jul 19:43 fort.82<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;</span>194 27 Jul 19:43 fort.81<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>11848 27 Jul 19:43 fort.12<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>5898 27 Jul 19:44 wrfvar.out<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun: yes">&nbsp;&nbsp;</span>4822312 27 Jul 19:44 wrf_3dvar_output<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>158513 27 Jul 19:44 fort.60<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun: yes">&nbsp;&nbsp;</span>2827915 27 Jul 19:44 fort.50<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>364 27 Jul 19:44 fort.48<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>719125 27 Jul 19:44 fort.47<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>194 27 Jul 19:44DAProg_WRF_Var.grad_fn<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>11848 27 Jul 19:44DAProg_WRF-Var.statistics<o:p></o:p></span></p><p class=MsoPlainText><span lang=EN-US style='font-size:9.0pt'>-rw-r--r--<spanstyle="mso-spacerun: yes">&nbsp; </span>1 dmbarker<span style="mso-spacerun:yes">&nbsp; </span>users<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>194 27 Jul 19:44DAProg_WRF-Var.cost_fn<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Themost important output files here are <o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><i><ahref="wrfvar.out.txt">wrfvar.out</a>: </i></span><span lang=EN-USstyle='font-family:Arial'>Text file containing information output as WRF-Var isrunning. Again, there is a host of information on number of observations,minimization, timings etc. <o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><i><ahref="DAProg_WRF-Var.statistics.txt">DAProg_WRF-Var.statistics</a>: </i></span><spanlang=EN-US style='font-family:Arial'>Text file containing O-B, O-A statistics(minimum, maximum, mean and standard deviation) for each observation type andvariable. This information is very useful in diagnosing how WRF-Var has useddifferent components of the observing system. Also contained are A-B statisticsi.e. statistics of the analysis increments for each model variable at eachmodel level. This information is very useful in checking the range of analysisincrement values found in the analysis, and where they are in the grid.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><i><ahref="fort.50.txt">fort.50</a>: </i></span><span lang=EN-US style='font-family:Arial'>Data file containing detailed observation-based information for everyobservation, e.g. location, observed value, O-B, observation error, O-A, andquality control flag. This information is also used in a number of tuningprograms found in the wrfvar/da_3dvar/utl directory.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><i>wrf_3dvar_output</i></span><spanlang=EN-US style='font-family:Arial'>: WRF (NETCDF) format file containing theanalysis.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Taketime to look through the textual output files to ensure you understand how3DVAR has performed. For example, <o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Howclosely has WRF-Var fitted individual observation types? - Look in the <i><ahref="DAProg_WRF-Var.statistics.txt">DAProg_WRF-Var.statistics</a> </i></span><spanlang=EN-US style='font-family:Arial'>file to compare the O-B and O-Astatistics.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Howbig are the analysis increments? Again, look in the <i><ahref="DAProg_WRF-Var.statistics.txt">DAProg_WRF-Var.statistics</a> </i></span><spanlang=EN-US style='font-family:Arial'>file to see minimum/maximum values of A-Bfor each variable.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>Howlong did WRF-Var take to converge? Is it converged? Look in the <i><ahref="wrfvar.out.txt">wrfvar.out</a> </i></span><span lang=EN-USstyle='font-family:Arial'>file, which will indicate the number of iterationstaken by WRF-Var to converge. If this is the same as the maximum number ofiterations specified in the namelist (DA_NTMAX) then you may need to increasethis value to ensure convergence is achieved.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>2.Plotting WRF-Var analysis increments</u></b></span><span lang=EN-US><u><o:p></o:p></u></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>A goodvisual way of seeing the impact of assimilation of observations is to plot theanalysis increments (i.e. analysis minus first guess difference). There aremany different graphics packages used (e.g. RIP, NCL, GRADS etc) that can dothis. The plot of level 15 theta increments below was produced NCL, but we will notbe covering how to use NCL in this tutorial. The plot indicates the magnitude, and scaleof theta increments - the pattern is a function of observation distribution,observation minus first guess difference, and background error covariances used.<o:p></o:p></span></p><p align=center style='text-align:center'><span lang=EN-US style='font-family:Arial'><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>  <v:f eqn="if lineDrawn pixelLineWidth 0"/>  <v:f eqn="sum @0 1 0"/>  <v:f eqn="sum 0 0 @1"/>  <v:f eqn="prod @2 1 2"/>  <v:f eqn="prod @3 21600 pixelWidth"/>  <v:f eqn="prod @3 21600 pixelHeight"/>  <v:f eqn="sum @0 0 1"/>  <v:f eqn="prod @6 1 2"/>  <v:f eqn="prod @7 21600 pixelWidth"/>  <v:f eqn="sum @8 21600 0"/>  <v:f eqn="prod @7 21600 pixelHeight"/>  <v:f eqn="sum @10 21600 0"/> </v:formulas> <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/> <o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="_x0000_i1028" type="#_x0000_t75" style='width:279pt; height:314pt'> <v:imagedata src="wrfvar-diagnostics_files/image001.png" o:title="wrfinput_d01.2003010#2AD968.gif"  croptop="16682f" cropbottom="11916f" cropleft="11565f" cropright="11565f"/></v:shape><![endif]--><![if !vml]><img border=0 width=279 height=314src="wrfvar-diagnostics_files/image002.gif" v:shapes="_x0000_i1028"><![endif]><o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><b><u>3.What next?</u></b></span><span lang=EN-US><u><o:p></o:p></u></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'>OK,you have run WRF-Var, checked out the diagnostics and are confident things areOK. Before running a forecast, you must first modify the tendencies within thelateral boundary condition files to be consistent with the new 3D-Var initialconditions.<o:p></o:p></span></p><p style='text-align:justify'><span lang=EN-US style='font-family:Arial'><u><ahref="wrfvar-wrf_bc.htm">f) Updating WRF lateral boundary conditions</a><o:p></o:p></u></span></p><div class=MsoNormal align=center style='text-align:center'><span lang=EN-US><hr size=2 width="100%" align=center></span></div><p><span lang=EN-US style='font-family:Arial'><b>Miscellanies:</b></span><spanlang=EN-US>&nbsp; </span></p><div class=MsoNormal align=center style='text-align:center'><span lang=EN-US><hr size=2 width="100%" align=center></span></div><p><span lang=EN-US style='font-family:Arial'><b>Trouble Shooting:</b></span><spanlang=EN-US> </span><span lang=EN-US style='font-family:Arial'>If you havequestions, ask </span><span lang=EN-US style='font-family:Arial;color:#000099'><ahref="mailto:wrfhelp@wrf-model.org"><span style='font-family:"Times New Roman"'>wrfhelp@wrf-model.org</span></a></span><spanlang=EN-US style='font-family:Arial'>.</span><span lang=EN-US> </span></p><div class=MsoNormal align=center style='text-align:center'><span lang=EN-US><hr size=2 width="100%" align=center></span></div><p class=MsoNormal align=center style='text-align:center'><span lang=EN-USstyle='font-family:Arial'><a href="wrfvar-tutorial.htm">Return to WRF-VarTutorial Page</a></span><span lang=EN-US style='color:windowtext'><o:p></o:p></span></p></div></body></html>